"use strict";(self.webpackChunkwebapp=self.webpackChunkwebapp||[]).push([[379],{3379:(b_,st,y)=>{y.r(st),y.d(st,{TelemetryModule:()=>y_});var te=y(4421),t=y(5879),o=y(6516),g=y(6814);function ee(a,r){if(1&a&&t._UZ(0,"img",7),2&a){const e=t.oxw();t.Q6J("src",e.url,t.LSH)}}let ot=(()=>{class a{constructor(e,i){this.storageClient=e.createStorageClient(),this.bucket=i.getDisplayBucket()}init(e){return this.url=this.storageClient.getObjectURL(this.bucket,e),Promise.resolve()}hasPendingChanges(){return!1}static#t=this.\u0275fac=function(i){return new(i||a)(t.Y36(o.C8),t.Y36(o.E4))};static#e=this.\u0275cmp=t.Xpm({type:a,selectors:[["app-image-viewer"]],decls:7,vars:1,consts:[["xmlns","http://www.w3.org/2000/svg","version","1.1",1,"checkerboard"],["id","pattern","x","0","y","0","width","24","height","24","patternUnits","userSpaceOnUse"],["fill","rgba(204, 204, 204, 0.4)","x","0","width","12","height","12","y","0"],["fill","rgba(204, 204, 204, 0.4)","x","12","width","12","height","12","y","12"],["fill","url(#pattern)","x","0","y","0","width","100%","height","100%"],[1,"wrapper"],[3,"src",4,"ngIf"],[3,"src"]],template:function(i,n){1&i&&(t.O4$(),t.TgZ(0,"svg",0)(1,"pattern",1),t._UZ(2,"rect",2)(3,"rect",3),t.qZA(),t._UZ(4,"rect",4),t.qZA(),t.kcU(),t.TgZ(5,"div",5),t.YNc(6,ee,1,1,"img",6),t.qZA()),2&i&&(t.xp6(6),t.Q6J("ngIf",n.url))},dependencies:[g.O5],styles:[".checkerboard[_ngcontent-%COMP%]{position:absolute;width:100%;height:100%}.wrapper[_ngcontent-%COMP%]{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%)}"],changeDetection:0})}return a})();var I=y(5762);class ae{constructor(r){this.messageService=r}writeInfo(r){this.messageService.showInfo(r)}writeError(r){this.messageService.showError(r)}writeWarning(r){this.messageService.showInfo(r)}}class ie{constructor(r){this.prefix=r}resolve(r){let e;if("Liberation Sans"===r.name?(e="LiberationSans-Regular.woff2",r.bold&&r.italic?e="LiberationSans-BoldItalic.woff2":r.bold?e="LiberationSans-Bold.woff2":r.italic&&(e="LiberationSans-Italic.woff2")):"Liberation Mono"===r.name?(e="LiberationMono-Regular.woff2",r.bold&&r.italic?e="LiberationMono-BoldItalic.woff2":r.bold?e="LiberationMono-Bold.woff2":r.italic&&(e="LiberationMono-Italic.woff2")):"Liberation Serif"===r.name&&(e="LiberationSerif-Regular.woff2",r.bold&&r.italic?e="LiberationSerif-BoldItalic.woff2":r.bold?e="LiberationSerif-Bold.woff2":r.italic&&(e="LiberationSerif-Italic.woff2")),e)return new FontFace(r.name,`url(${this.prefix}${e})`,{weight:r.bold?"bold":"normal",style:r.italic?"italic":"normal"})}}class ne extends I.rA{constructor(r,e){super(e),this.storageClient=r}resolve(r,e){if(r.startsWith("ys://")){const i=r.match(/ys:\/\/([^\\\/]+)\/(.+)/);if(i)return this.storageClient.getObjectURL(i[1],i[2])}return super.resolve(r,e)}}class re{constructor(r,e){this.yamcs=r,this.messageService=e}issueCommand(r,e){this.yamcs.yamcsClient.issueCommand(this.yamcs.instance,this.yamcs.processor,r,{args:e}).catch(i=>this.messageService.showError(i))}runProcedure(r,e){const i={};e&&Object.keys(e).forEach(n=>i[n]=String(e[n])),this.yamcs.yamcsClient.startProcedure(this.yamcs.instance,r,{arguments:i}).catch(n=>this.messageService.showError(n))}}var b=y(1896);const se=["displayContainer"],F="MDB:OPS Name",V="ops://";let lt=(()=>{class a{constructor(e,i,n,s,l,_,m){this.yamcs=e,this.router=i,this.route=n,this.synchronizer=s,this.messageService=l,this.baseHref=_,this.idMapping={},this.idInfo={},this.pvsByName=new Map,this.subscriptionDirty=!1,this.storageClient=e.createStorageClient(),this.bucket=m.getDisplayBucket()}setViewerContainerEl(e){this.viewerContainerEl=e}updateSubscription(){if(this.subscriptionDirty){this.subscriptionDirty=!1,this.parameterSubscription&&this.parameterSubscription.cancel();const e=[];for(const i of this.pvsByName.keys())i.startsWith(V)?e.push({namespace:F,name:i.substr(6)}):e.push({name:i});e.length&&(this.parameterSubscription=this.yamcs.yamcsClient.createParameterSubscription({instance:this.yamcs.instance,processor:this.yamcs.processor,id:e,abortOnInvalid:!1,sendFromCache:!0,updateOnExpiration:!0,action:"REPLACE"},i=>{i.mapping&&(this.idMapping=i.mapping),i.info&&(this.idInfo=i.info);for(const n of i.invalid||[]){let s=n.name;n.namespace===F&&(s=V+s);const l=this.display.getPV(s);l&&(l.disconnected=!0)}if(i.values?.length){const n=new Map;for(const s of i.values){s.id=this.idMapping[s.numericId];let l=s.id.name;s.id.namespace===F&&(l=V+l),n.set(l,this.toSample(s,this.idInfo[s.numericId]))}this.display.setValues(n)}}))}}toSample(e,i){const l={time:o.P6.toDate(e.generationTime),severity:this.toAlarmSeverity(e),value:void 0};return e.engValue&&(l.value=o.P6.convertValue(e.engValue),"ENUMERATED"===e.engValue.type&&(l.valueIndex=Number(e.engValue.sint64Value))),i.units&&(l.units=i.units),l}toAlarmSeverity(e){if("EXPIRED"===e.acquisitionStatus||"NOT_RECEIVED"==e.acquisitionStatus||"INVALID"===e.acquisitionStatus)return I.Xm.INVALID;if(!e.monitoringResult)return I.Xm.NONE;switch(e.monitoringResult){case"DISABLED":case"IN_LIMITS":return I.Xm.NONE;case"WATCH":case"WARNING":case"DISTRESS":return I.Xm.MINOR;case"CRITICAL":case"SEVERE":return I.Xm.MAJOR}}init(e){this.display=new I.sS(this.displayContainer.nativeElement),this.display.imagesPrefix=this.baseHref,this.display.setPathResolver(new ne(this.storageClient,this.display)),this.display.setConsoleHandler(new ae(this.messageService)),this.display.setFontResolver(new ie(this.baseHref));let n="";-1!==e.lastIndexOf("/")&&(n=e.substring(0,e.lastIndexOf("/")+1)),this.display.addScriptLibrary("Yamcs",new re(this.yamcs,this.messageService)),this.display.addEventListener("opendisplay",u=>{let h;if(h=u.path.startsWith("/")?`/telemetry/displays/files${u.path}?c=${this.yamcs.context}`:`/telemetry/displays/files/${n}${u.path}?c=${this.yamcs.context}`,u.args)for(const x in u.args)h+="&args."+encodeURIComponent(x)+"="+encodeURIComponent(u.args[x]);this.router.navigateByUrl(h)}),this.display.addEventListener("closedisplay",u=>{this.router.navigateByUrl(`/telemetry/displays/browse?c=${this.yamcs.context}`)}),this.display.addEventListener("openpv",u=>{if(u.pvName.startsWith("/")){const h=encodeURIComponent(u.pvName);this.router.navigateByUrl(`/telemetry/parameters/${h}/summary?c=${this.yamcs.context}`)}else u.pvName.startsWith(V)?this.yamcs.yamcsClient.getParameterById(this.yamcs.instance,{namespace:F,name:u.pvName.substr(6)}).then(h=>{const x=encodeURIComponent(h.qualifiedName);this.router.navigateByUrl(`/telemetry/parameters/${x}/summary?c=${this.yamcs.context}`)}):alert(`Can't navigate to PV ${u.pvName}`)}),this.display.addEventListener("runcommand",u=>{this.yamcs.yamcsClient.issueCommand(this.yamcs.instance,this.yamcs.processor,u.command,{args:u.args}).catch(h=>this.messageService.showError(h))}),this.display.addEventListener("runprocedure",u=>{this.yamcs.yamcsClient.startProcedure(this.yamcs.instance,u.procedure,{arguments:u.args}).catch(h=>this.messageService.showError(h))}),this.display.addProvider(this),this.display.absPrefix=this.storageClient.getObjectURL(this.bucket,"");const s=this.storageClient.getObjectURL(this.bucket,e),l={},_=this.route.snapshot.queryParams;for(const u in _)u.startsWith("args.")&&(l[u.substring(5)]=_[u]);const m=this.display.setSource(s,l);return m.then(()=>{this.syncSubscription=this.synchronizer.sync(()=>this.updateSubscription())}),m}canProvide(e){return!0}startProviding(e){for(const i of e)this.pvsByName.set(i.name,i);this.subscriptionDirty=!0}stopProviding(e){for(const i of e)this.pvsByName.delete(i.name);this.subscriptionDirty=!0}isNavigable(){return!0}shutdown(){}hasPendingChanges(){return!1}zoomIn(){this.display.scale+=.1}zoomOut(){this.display.scale-=.1}resetZoom(){this.display.scale=1}fitZoom(){const e=this.display.instance;if(e&&this.viewerContainerEl){const i=this.viewerContainerEl.clientWidth,n=this.viewerContainerEl.clientHeight,{width:s,height:l}=e.unscaledBounds;this.display.scale=Math.min(i/s,n/l)}}ngOnDestroy(){this.syncSubscription?.unsubscribe(),this.parameterSubscription?.cancel()}static#t=this.\u0275fac=function(i){return new(i||a)(t.Y36(o.C8),t.Y36(b.F0),t.Y36(b.gz),t.Y36(o.jF),t.Y36(o.ez),t.Y36(g.mr),t.Y36(o.E4))};static#e=this.\u0275cmp=t.Xpm({type:a,selectors:[["app-opi-display-viewer"]],viewQuery:function(i,n){if(1&i&&t.Gf(se,7),2&i){let s;t.iGM(s=t.CRH())&&(n.displayContainer=s.first)}},decls:4,vars:0,consts:[[1,"display-frame"],[1,"display-frame-inner"],[2,"display","inline-block"],["displayContainer",""]],template:function(i,n){1&i&&(t.TgZ(0,"div",0)(1,"div",1),t._UZ(2,"div",2,3),t.qZA()())},styles:[".display-frame[_ngcontent-%COMP%]{width:100%;height:100%;display:table}.display-frame-inner[_ngcontent-%COMP%]{display:table-cell;vertical-align:middle;overflow:auto;text-align:center}"],changeDetection:0})}return a})();var f=y(5619),w=y(2296),P=y(617);function le(a,r){if(1&a){const e=t.EpF();t.ynx(0),t.TgZ(1,"button",1),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.fitZoom())}),t.TgZ(2,"mat-icon"),t._uU(3,"fit_screen"),t.qZA(),t._uU(4," ZOOM FIT "),t.qZA(),t.TgZ(5,"button",1),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.zoomIn())}),t.TgZ(6,"mat-icon"),t._uU(7,"add_circle_outline"),t.qZA(),t._uU(8," ZOOM IN "),t.qZA(),t.TgZ(9,"button",1),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.zoomOut())}),t.TgZ(10,"mat-icon"),t._uU(11,"remove_circle_outline"),t.qZA(),t._uU(12," ZOOM OUT "),t.qZA(),t.TgZ(13,"button",1),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.resetZoom())}),t.TgZ(14,"mat-icon"),t._uU(15,"aspect_ratio"),t.qZA(),t._uU(16," ACTUAL SIZE "),t.qZA(),t.BQk()}}let ct=(()=>{class a{constructor(){this.initialized$=new f.X(!1)}init(e){this.viewer=e,this.initialized$.next(!0)}fitZoom(){this.viewer.fitZoom()}zoomIn(){this.viewer.zoomIn()}zoomOut(){this.viewer.zoomOut()}resetZoom(){this.viewer.resetZoom()}static#t=this.\u0275fac=function(i){return new(i||a)};static#e=this.\u0275cmp=t.Xpm({type:a,selectors:[["app-opi-display-viewer-controls"]],decls:2,vars:3,consts:[[4,"ngIf"],["mat-button","","color","primary",3,"click"]],template:function(i,n){1&i&&(t.YNc(0,le,17,0,"ng-container",0),t.ALo(1,"async")),2&i&&t.Q6J("ngIf",t.lcZ(1,1,n.initialized$))},dependencies:[g.O5,w.lW,P.Hw,g.Ov],encapsulation:2})}return a})();var q=y(8337),H=y(4318);class ce{constructor(r=10){this.pointer=0,this.latestValues=new Map,this.buf=Array(r).fill(void 0)}push(r,e){const i={};for(const n of r)i[e[n.numericId].name]=n;this.buf[this.pointer]=i,this.pointer=(this.pointer+1)%this.buf.length;for(const n of r)this.latestValues.set(e[n.numericId].name,n)}getLatestValue(r){return this.latestValues.get(r)}setSize(r){this.buf=Array(r).fill(void 0),this.pointer=0}snapshot(){return 0===this.pointer?[...this.buf]:[...this.buf.slice(this.pointer),...this.buf.slice(0,this.pointer)].reverse()}}var d=y(7700),p=y(9538),Z=y(4643),Y=y(3757);function _e(a,r){if(1&a){const e=t.EpF();t.TgZ(0,"th",19)(1,"input",20),t.NdJ("change",function(n){t.CHM(e);const s=t.oxw(2);return t.KtG(n?s.masterToggle():null)}),t.qZA()()}if(2&a){const e=t.oxw(2);t.xp6(1),t.Q6J("checked",e.selection.hasValue()&&e.isAllSelected())}}function pe(a,r){if(1&a){const e=t.EpF();t.TgZ(0,"td",21)(1,"input",22),t.NdJ("click",function(n){return n.stopPropagation()})("change",function(n){const l=t.CHM(e).$implicit,_=t.oxw(2);return t.KtG(n?_.selection.toggle(l.name):null)}),t.qZA()()}if(2&a){const e=r.$implicit,i=t.oxw(2);t.xp6(1),t.Q6J("checked",i.selection.isSelected(e.name))}}function me(a,r){1&a&&(t.TgZ(0,"th",23),t._uU(1,"Name"),t.qZA())}const ue=function(a){return["/telemetry/parameters",a]},ge=function(a){return{c:a}};function de(a,r){if(1&a&&(t.TgZ(0,"td",24)(1,"a",25),t._uU(2),t.qZA()()),2&a){const e=r.$implicit,i=t.oxw(2);t.xp6(1),t.Q6J("routerLink",t.VKq(3,ue,e.name))("queryParams",t.VKq(5,ge,i.yamcs.context)),t.xp6(1),t.hij(" ",e.name," ")}}function he(a,r){1&a&&(t.TgZ(0,"th",23),t._uU(1,"Severity"),t.qZA())}function fe(a,r){if(1&a&&t._UZ(0,"app-alarm-level",28),2&a){const e=t.oxw().$implicit;t.Q6J("level",null==e.pval?null:e.pval.monitoringResult)}}function xe(a,r){1&a&&(t.TgZ(0,"span"),t._uU(1,"-"),t.qZA())}function ye(a,r){if(1&a&&(t.TgZ(0,"td",21),t.YNc(1,fe,1,1,"app-alarm-level",26),t.YNc(2,xe,2,0,"span",27),t.qZA()),2&a){const e=r.$implicit;t.xp6(1),t.Q6J("ngIf",null==e.pval?null:e.pval.monitoringResult),t.xp6(1),t.Q6J("ngIf",!(null!=e.pval&&e.pval.monitoringResult))}}function be(a,r){1&a&&(t.TgZ(0,"th",23),t._uU(1,"Raw"),t.qZA())}function Te(a,r){if(1&a&&(t.TgZ(0,"td",29),t._uU(1),t.ALo(2,"value"),t.qZA()),2&a){const e=r.$implicit;t.xp6(1),t.Oqu(t.lcZ(2,1,null==e.pval?null:e.pval.rawValue)||"-")}}function ve(a,r){1&a&&(t.TgZ(0,"th",23),t._uU(1,"Eng"),t.qZA())}function Ze(a,r){1&a&&(t.TgZ(0,"span"),t._uU(1,"\u2193"),t.qZA())}function Pe(a,r){1&a&&(t.TgZ(0,"span"),t._uU(1,"\u2191"),t.qZA())}function we(a,r){if(1&a&&(t.TgZ(0,"ya-expirable",31),t._uU(1),t.ALo(2,"value"),t.YNc(3,Ze,2,0,"span",27),t.YNc(4,Pe,2,0,"span",27),t.qZA()),2&a){const e=t.oxw().$implicit;t.Q6J("pval",e.pval),t.xp6(1),t.hij(" ",t.lcZ(2,4,null==e.pval?null:e.pval.engValue)||"-"," "),t.xp6(2),t.Q6J("ngIf","LOW"===(null==e.pval?null:e.pval.rangeCondition)),t.xp6(1),t.Q6J("ngIf","HIGH"===(null==e.pval?null:e.pval.rangeCondition))}}function Ae(a,r){1&a&&(t.TgZ(0,"span"),t._uU(1,"-"),t.qZA())}function Se(a,r){if(1&a&&(t.TgZ(0,"td",29),t.YNc(1,we,5,6,"ya-expirable",30),t.YNc(2,Ae,2,0,"span",27),t.qZA()),2&a){const e=r.$implicit;t.xp6(1),t.Q6J("ngIf",e.pval),t.xp6(1),t.Q6J("ngIf",!e.pval)}}function Ce(a,r){1&a&&(t.TgZ(0,"th",23),t._uU(1,"Reception time"),t.qZA())}function ke(a,r){if(1&a&&(t.TgZ(0,"td",21),t._uU(1),t.ALo(2,"datetime"),t.qZA()),2&a){const e=r.$implicit;t.xp6(1),t.hij(" ",t.lcZ(2,1,null==e.pval?null:e.pval.acquisitionTime)||"-","")}}function Ue(a,r){1&a&&(t.TgZ(0,"th",23),t._uU(1,"Generation time"),t.qZA())}function qe(a,r){if(1&a&&(t.TgZ(0,"td",21),t._uU(1),t.ALo(2,"datetime"),t.qZA()),2&a){const e=r.$implicit;t.xp6(1),t.hij("",t.lcZ(2,1,null==e.pval?null:e.pval.generationTime)||"-"," ")}}function De(a,r){1&a&&(t.TgZ(0,"th",23),t._uU(1,"Acquisition status"),t.qZA())}function Ne(a,r){if(1&a&&(t.TgZ(0,"td",21),t._uU(1),t.qZA()),2&a){const e=r.$implicit;t.xp6(1),t.Oqu((null==e.pval?null:e.pval.acquisitionStatus)||"-")}}function Ie(a,r){1&a&&t._UZ(0,"th",32)}function Qe(a,r){if(1&a){const e=t.EpF();t.TgZ(0,"td",21)(1,"ya-icon-action",33),t.NdJ("click",function(n){const l=t.CHM(e).index;return t.oxw(2).moveDown.emit(l),t.KtG(n.stopPropagation())}),t.qZA(),t.TgZ(2,"ya-icon-action",34),t.NdJ("click",function(n){const l=t.CHM(e).index;return t.oxw(2).moveUp.emit(l),t.KtG(n.stopPropagation())}),t.qZA()()}}function Le(a,r){1&a&&t._UZ(0,"tr",35)}function Je(a,r){if(1&a){const e=t.EpF();t.TgZ(0,"tr",36),t.NdJ("click",function(){const s=t.CHM(e).$implicit,l=t.oxw(2);return t.KtG(l.toggleOne(s.name))}),t.qZA()}if(2&a){const e=r.$implicit,i=t.oxw(2);t.ekj("selected",i.selection.isSelected(e.name))}}function Ye(a,r){if(1&a&&(t.TgZ(0,"table",1),t.ynx(1,2),t.YNc(2,_e,2,1,"th",3),t.YNc(3,pe,2,1,"td",4),t.BQk(),t.ynx(4,5),t.YNc(5,me,2,0,"th",6),t.YNc(6,de,3,7,"td",7),t.BQk(),t.ynx(7,8),t.YNc(8,he,2,0,"th",6),t.YNc(9,ye,3,2,"td",4),t.BQk(),t.ynx(10,9),t.YNc(11,be,2,0,"th",6),t.YNc(12,Te,3,3,"td",10),t.BQk(),t.ynx(13,11),t.YNc(14,ve,2,0,"th",6),t.YNc(15,Se,3,2,"td",10),t.BQk(),t.ynx(16,12),t.YNc(17,Ce,2,0,"th",6),t.YNc(18,ke,3,3,"td",4),t.BQk(),t.ynx(19,13),t.YNc(20,Ue,2,0,"th",6),t.YNc(21,qe,3,3,"td",4),t.BQk(),t.ynx(22,14),t.YNc(23,De,2,0,"th",6),t.YNc(24,Ne,2,1,"td",4),t.BQk(),t.ynx(25,15),t.YNc(26,Ie,1,0,"th",16),t.YNc(27,Qe,3,0,"td",4),t.BQk(),t.YNc(28,Le,1,0,"tr",17),t.YNc(29,Je,1,2,"tr",18),t.qZA()),2&a){const e=t.oxw();t.ekj("paused",e.paused),t.Q6J("dataSource",e.dataSource),t.xp6(28),t.Q6J("cdkHeaderRowDef",e.displayedColumns),t.xp6(1),t.Q6J("cdkRowDefColumns",e.displayedColumns)}}let Me=(()=>{class a{constructor(e,i,n){this.yamcs=e,this.changeDetector=i,this.model={scroll:!1,parameters:[]},this.moveUp=new t.vpe,this.moveDown=new t.vpe,this.dataSource=new p.by([]),this.defaultColumns=["severity","name","generationTime","rawValue","engValue","acquisitionStatus"],this.syncSubscription=n.syncFast(()=>{this.paused||this.refreshTable()})}ngOnInit(){this.refreshTable()}refreshTable(){const e=this.model.parameters.map(i=>({name:i}));for(const i of e)i.pval=this.buffer.getLatestValue(i.name);this.dataSource.data=e,this.changeDetector.detectChanges()}ngOnChanges(){this.displayedColumns=this.showActions?["select",...this.defaultColumns,"actions"]:this.defaultColumns}isAllSelected(){const i=this.dataSource.filteredData.length;return this.selection.selected.length===i&&i>0}masterToggle(){this.isAllSelected()?this.selection.clear():this.dataSource.filteredData.forEach(e=>this.selection.select(e.name))}toggleOne(e){(!this.selection.isSelected(e)||this.selection.selected.length>1)&&this.selection.clear(),this.selection.toggle(e)}ngOnDestroy(){this.syncSubscription&&this.syncSubscription.unsubscribe()}static#t=this.\u0275fac=function(i){return new(i||a)(t.Y36(o.C8),t.Y36(t.sBO),t.Y36(o.jF))};static#e=this.\u0275cmp=t.Xpm({type:a,selectors:[["app-multiple-parameter-table"]],inputs:{model:"model",buffer:"buffer",showActions:"showActions",paused:"paused",selection:"selection"},outputs:{moveUp:"moveUp",moveDown:"moveDown"},features:[t.TTD],decls:1,vars:1,consts:[["mat-table","","class","ya-data-table expand",3,"dataSource","paused",4,"ngIf"],["mat-table","",1,"ya-data-table","expand",3,"dataSource"],["cdkColumnDef","select"],["mat-header-cell","","style","text-align: left",4,"cdkHeaderCellDef"],["mat-cell","",4,"cdkCellDef"],["cdkColumnDef","name"],["mat-header-cell","",4,"cdkHeaderCellDef"],["mat-cell","","style","white-space: nowrap",4,"cdkCellDef"],["cdkColumnDef","severity"],["cdkColumnDef","rawValue"],["mat-cell","","class","wrap200",4,"cdkCellDef"],["cdkColumnDef","engValue"],["cdkColumnDef","receptionTime"],["cdkColumnDef","generationTime"],["cdkColumnDef","acquisitionStatus"],["cdkColumnDef","actions"],["mat-header-cell","","class","expand",4,"cdkHeaderCellDef"],["mat-header-row","",4,"cdkHeaderRowDef"],["mat-row","",3,"selected","click",4,"cdkRowDef","cdkRowDefColumns"],["mat-header-cell","",2,"text-align","left"],["type","checkbox",3,"checked","change"],["mat-cell",""],["type","checkbox",3,"checked","click","change"],["mat-header-cell",""],["mat-cell","",2,"white-space","nowrap"],[3,"routerLink","queryParams"],[3,"level",4,"ngIf"],[4,"ngIf"],[3,"level"],["mat-cell","",1,"wrap200"],[3,"pval",4,"ngIf"],[3,"pval"],["mat-header-cell","",1,"expand"],["icon","keyboard_arrow_down",3,"click"],["icon","keyboard_arrow_up",3,"click"],["mat-header-row",""],["mat-row","",3,"click"]],template:function(i,n){1&i&&t.YNc(0,Ye,30,5,"table",0),2&i&&t.Q6J("ngIf",n.dataSource.data.length)},dependencies:[g.O5,b.rH,Z.Sq,Z.O_,Z.D5,Z.fo,Z.s$,p.BZ,p.ge,p.ev,p.XQ,p.Gk,o.g4,o.J5,Y.i,o.id,o.VC],styles:[".paused[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{font-style:italic}"]})}return a})();var c=y(6223),M=y(6385),S=y(7988);function Oe(a,r){1&a&&(t.TgZ(0,"th",11),t._uU(1,"Generation time"),t.qZA())}function $e(a,r){if(1&a&&(t.TgZ(0,"td",12),t._uU(1),t.ALo(2,"datetime"),t.qZA()),2&a){const e=r.$implicit;t.xp6(1),t.Oqu(t.lcZ(2,1,e.generationTime)||"-")}}function Re(a,r){if(1&a){const e=t.EpF();t.TgZ(0,"ya-more")(1,"button",15),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(2).index,s=t.oxw(2);return t.KtG(s.moveLeft.emit(n))}),t._uU(2,"Move left"),t.qZA(),t.TgZ(3,"button",15),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(2).index,s=t.oxw(2);return t.KtG(s.moveRight.emit(n))}),t._uU(4,"Move right"),t.qZA(),t._UZ(5,"mat-divider"),t.TgZ(6,"button",15),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(2).$implicit,s=t.oxw(2);return t.KtG(s.removeColumn.emit(n))}),t._uU(7,"Remove column"),t.qZA()()}}const Fe=function(a){return["/telemetry/parameters",a]},Ve=function(a){return{c:a}};function He(a,r){if(1&a&&(t.TgZ(0,"th",11)(1,"a",14),t._uU(2),t.qZA(),t.YNc(3,Re,8,0,"ya-more",1),t.qZA()),2&a){const e=t.oxw().$implicit,i=t.oxw(2);t.xp6(1),t.Q6J("routerLink",t.VKq(4,Fe,e))("queryParams",t.VKq(6,Ve,i.yamcs.context)),t.xp6(1),t.hij(" ",e," "),t.xp6(1),t.Q6J("ngIf",i.showActions)}}function Ee(a,r){1&a&&(t.TgZ(0,"span"),t._uU(1,"\u2193"),t.qZA())}function Be(a,r){1&a&&(t.TgZ(0,"span"),t._uU(1,"\u2191"),t.qZA())}function Ge(a,r){if(1&a&&(t.TgZ(0,"ya-expirable",17),t._uU(1),t.ALo(2,"value"),t.YNc(3,Ee,2,0,"span",1),t.YNc(4,Be,2,0,"span",1),t.qZA()),2&a){const e=t.oxw().ngIf;t.Q6J("pval",e),t.xp6(1),t.hij(" ",t.lcZ(2,4,e.engValue)||"-"," "),t.xp6(2),t.Q6J("ngIf","LOW"===e.rangeCondition),t.xp6(1),t.Q6J("ngIf","HIGH"===e.rangeCondition)}}function je(a,r){if(1&a&&(t.ynx(0),t.YNc(1,Ge,5,6,"ya-expirable",16),t.BQk()),2&a){const e=r.ngIf;t.xp6(1),t.Q6J("ngIf",e)}}function ze(a,r){1&a&&(t.TgZ(0,"span"),t._uU(1,"-"),t.qZA())}function Ke(a,r){if(1&a&&(t.TgZ(0,"td",12),t.YNc(1,je,2,1,"ng-container",1),t.YNc(2,ze,2,0,"span",1),t.qZA()),2&a){const e=r.$implicit,i=t.oxw().$implicit;t.xp6(1),t.Q6J("ngIf",e.pvals[i]),t.xp6(1),t.Q6J("ngIf",!e.pvals[i])}}function Xe(a,r){1&a&&(t.ynx(0,13),t.YNc(1,He,4,8,"th",4),t.YNc(2,Ke,3,2,"td",5),t.BQk()),2&a&&t.Q6J("cdkColumnDef",r.$implicit)}function We(a,r){1&a&&t._UZ(0,"th",18)}function ta(a,r){1&a&&t._UZ(0,"td",12)}function ea(a,r){1&a&&t._UZ(0,"tr",19)}function aa(a,r){1&a&&t._UZ(0,"tr",20)}function ia(a,r){if(1&a&&(t.TgZ(0,"table",2),t.ynx(1,3),t.YNc(2,Oe,2,0,"th",4),t.YNc(3,$e,3,3,"td",5),t.BQk(),t.YNc(4,Xe,3,1,"ng-container",6),t.ynx(5,7),t.YNc(6,We,1,0,"th",8),t.YNc(7,ta,1,0,"td",5),t.BQk(),t.YNc(8,ea,1,0,"tr",9),t.YNc(9,aa,1,0,"tr",10),t.qZA()),2&a){const e=t.oxw();t.ekj("paused",e.paused),t.Q6J("dataSource",e.dataSource),t.xp6(4),t.Q6J("ngForOf",e.model.parameters),t.xp6(4),t.Q6J("cdkHeaderRowDef",e.displayedColumns),t.xp6(1),t.Q6J("cdkRowDefColumns",e.displayedColumns)}}function na(a,r){if(1&a&&(t.ynx(0),t.TgZ(1,"p"),t._uU(2,"\xa0"),t.qZA(),t._uU(3," Buffer size: "),t.TgZ(4,"select",21)(5,"option",22),t._uU(6,"10"),t.qZA(),t.TgZ(7,"option",23),t._uU(8,"25"),t.qZA(),t.TgZ(9,"option",24),t._uU(10,"50"),t.qZA(),t.TgZ(11,"option",25),t._uU(12,"75"),t.qZA(),t.TgZ(13,"option",26),t._uU(14,"100"),t.qZA()(),t.BQk()),2&a){const e=t.oxw();t.xp6(4),t.Q6J("formControl",e.bufferSizeControl)}}let ra=(()=>{class a{constructor(e,i,n){this.yamcs=e,this.changeDetector=i,this.model={scroll:!0,parameters:[]},this.removeColumn=new t.vpe,this.moveLeft=new t.vpe,this.moveRight=new t.vpe,this.bufferSize=new t.vpe,this.dataSource=new p.by([]),this.bufferSizeControl=new c.p4("10"),this.displayedColumns=["generationTime","actions"],this.syncSubscription=n.syncFast(()=>{this.paused||this.refreshTable()}),this.bufferSizeControl.valueChanges.subscribe(()=>{const s=this.bufferSizeControl.value;s!==String(this.model.bufferSize)&&this.bufferSize.emit(parseInt(s,10))})}ngOnInit(){this.model.bufferSize&&(this.buffer.setSize(this.model.bufferSize),this.bufferSizeControl.setValue(String(this.model.bufferSize))),this.refreshTable()}refreshTable(){const e=[],i=this.buffer.snapshot();for(const n of i){const s=this.findAnyMatchingParameterValue(n);s&&e.push({generationTime:s.generationTime,pvals:n})}this.dataSource.data=e,this.changeDetector.detectChanges()}findAnyMatchingParameterValue(e){for(const i in e)if(e.hasOwnProperty(i)&&-1!==this.model.parameters.indexOf(i))return e[i]}ngOnChanges(){this.displayedColumns=["generationTime",...this.model.parameters,"actions"]}ngOnDestroy(){this.syncSubscription&&this.syncSubscription.unsubscribe(),this.bufferSizeControlSubscription&&this.bufferSizeControlSubscription.unsubscribe()}static#t=this.\u0275fac=function(i){return new(i||a)(t.Y36(o.C8),t.Y36(t.sBO),t.Y36(o.jF))};static#e=this.\u0275cmp=t.Xpm({type:a,selectors:[["app-scrolling-parameter-table"]],inputs:{model:"model",buffer:"buffer",showActions:"showActions",paused:"paused"},outputs:{removeColumn:"removeColumn",moveLeft:"moveLeft",moveRight:"moveRight",bufferSize:"bufferSize"},features:[t.TTD],decls:2,vars:2,consts:[["mat-table","","class","ya-data-table expand",3,"dataSource","paused",4,"ngIf"],[4,"ngIf"],["mat-table","",1,"ya-data-table","expand",3,"dataSource"],["cdkColumnDef","generationTime"],["mat-header-cell","",4,"cdkHeaderCellDef"],["mat-cell","",4,"cdkCellDef"],[3,"cdkColumnDef",4,"ngFor","ngForOf"],["cdkColumnDef","actions"],["mat-header-cell","","class","expand",4,"cdkHeaderCellDef"],["mat-header-row","",4,"cdkHeaderRowDef"],["mat-row","",4,"cdkRowDef","cdkRowDefColumns"],["mat-header-cell",""],["mat-cell",""],[3,"cdkColumnDef"],[3,"routerLink","queryParams"],["mat-menu-item","",3,"click"],[3,"pval",4,"ngIf"],[3,"pval"],["mat-header-cell","",1,"expand"],["mat-header-row",""],["mat-row",""],[3,"formControl"],["value","10"],["value","25"],["value","50"],["value","75"],["value","100"]],template:function(i,n){1&i&&(t.YNc(0,ia,10,6,"table",0),t.YNc(1,na,15,1,"ng-container",1)),2&i&&(t.Q6J("ngIf",n.dataSource.data.length),t.xp6(1),t.Q6J("ngIf",n.showActions))},dependencies:[g.sg,g.O5,c.YN,c.Kr,c.EJ,c.JJ,c.oH,b.rH,Z.Sq,Z.O_,Z.D5,Z.fo,Z.s$,M.d,S.OP,p.BZ,p.ge,p.ev,p.XQ,p.Gk,o.g4,o.cQ,o.id,o.VC],styles:[".paused[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{font-style:italic}"]})}return a})();function sa(a,r){if(1&a){const e=t.EpF();t.TgZ(0,"app-multiple-parameter-table",6),t.NdJ("moveUp",function(n){t.CHM(e);const s=t.oxw(3);return t.KtG(s.moveUp(n))})("moveDown",function(n){t.CHM(e);const s=t.oxw(3);return t.KtG(s.moveDown(n))}),t.ALo(1,"async"),t.ALo(2,"async"),t.qZA()}if(2&a){const e=t.oxw(2).ngIf,i=t.oxw();t.Q6J("model",e)("buffer",i.buffer)("paused",t.lcZ(1,5,i.paused$))("showActions",t.lcZ(2,7,i.showActions$))("selection",i.selection)}}function oa(a,r){if(1&a){const e=t.EpF();t.TgZ(0,"app-scrolling-parameter-table",7),t.NdJ("moveLeft",function(n){t.CHM(e);const s=t.oxw(3);return t.KtG(s.moveUp(n))})("moveRight",function(n){t.CHM(e);const s=t.oxw(3);return t.KtG(s.moveDown(n))})("removeColumn",function(n){t.CHM(e);const s=t.oxw(3);return t.KtG(s.removeParameter(n))})("bufferSize",function(n){t.CHM(e);const s=t.oxw(3);return t.KtG(s.setBufferSize(n))}),t.ALo(1,"async"),t.ALo(2,"async"),t.qZA()}if(2&a){const e=t.oxw(2).ngIf,i=t.oxw();t.Q6J("model",e)("buffer",i.buffer)("paused",t.lcZ(1,4,i.paused$))("showActions",t.lcZ(2,6,i.showActions$))}}function la(a,r){if(1&a&&(t.ynx(0),t.YNc(1,sa,3,9,"app-multiple-parameter-table",4),t.YNc(2,oa,3,8,"app-scrolling-parameter-table",5),t.BQk()),2&a){const e=t.oxw().ngIf;t.xp6(1),t.Q6J("ngIf",!e.scroll),t.xp6(1),t.Q6J("ngIf",e.scroll)}}function ca(a,r){if(1&a){const e=t.EpF();t.TgZ(0,"ya-empty-message")(1,"div",8)(2,"p"),t._uU(3," This file is empty. "),t._UZ(4,"br"),t._uU(5,"Start by "),t.TgZ(6,"a",9),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(2);return t.KtG(n.showAddParameterDialog())}),t._uU(7,"adding a parameter"),t.qZA(),t._uU(8,". "),t.qZA()()()}}function _a(a,r){if(1&a&&(t.TgZ(0,"div",1),t.YNc(1,la,3,2,"ng-container",2),t.YNc(2,ca,9,0,"ng-template",null,3,t.W1O),t.qZA()),2&a){const e=r.ngIf,i=t.MAs(3);t.xp6(1),t.Q6J("ngIf",e.parameters.length)("ngIfElse",i)}}let _t=(()=>{class a{constructor(e,i,n){this.yamcs=e,this.dialog=i,this.selection=new q.Ov(!0,[]),this.model$=new f.X(null),this.buffer=new ce,this.paused$=new f.X(!1),this.hasUnsavedChanges$=new f.X(!1),this.showActions$=new f.X(!1),this.storageClient=e.createStorageClient(),this.bucket=n.getDisplayBucket()}init(e){return this.objectName=e,this.storageClient.getObject(this.bucket,e).then(i=>{i.text().then(n=>{const s=JSON.parse(n);this.model$.next(s),this.createOrModifySubscription()})}),Promise.resolve()}setEnableActions(){this.showActions$.next(!0)}hasPendingChanges(){return this.hasUnsavedChanges$.value}createOrModifySubscription(){const e=this.model$.value.parameters.map(i=>({name:i}));e.length&&(this.dataSubscription?this.dataSubscription.sendMessage({instance:this.yamcs.instance,processor:this.yamcs.processor,id:e,abortOnInvalid:!1,sendFromCache:!0,updateOnExpiration:!0,action:"REPLACE"}):this.dataSubscription=this.yamcs.yamcsClient.createParameterSubscription({instance:this.yamcs.instance,processor:this.yamcs.processor,id:e,abortOnInvalid:!1,sendFromCache:!0,updateOnExpiration:!0,action:"REPLACE"},i=>{i.mapping&&(this.idMapping=i.mapping),this.buffer.push(i.values||[],this.idMapping)}))}addParameter(e){const i=this.model$.value;i.parameters.push(e),this.emitModelUpdate(i),this.hasUnsavedChanges$.next(!0),this.createOrModifySubscription()}emitModelUpdate(e){this.model$.next({scroll:e.scroll,bufferSize:e.bufferSize||10,parameters:e.parameters})}getModel(){return this.model$.value}pause(){this.paused$.next(!0)}unpause(){this.paused$.next(!1)}delete(){if(!this.selection.isEmpty()){const e=this.model$.value;e.parameters=e.parameters.filter(i=>!this.selection.isSelected(i)),this.emitModelUpdate(e),this.hasUnsavedChanges$.next(!0)}this.selection.clear()}enableScrollView(){this.selection.clear();const e=this.model$.value;e.scroll=!0,this.emitModelUpdate(e),this.hasUnsavedChanges$.next(!0)}enableStandardView(){this.selection.clear();const e=this.model$.value;e.scroll=!1,this.emitModelUpdate(e),this.hasUnsavedChanges$.next(!0)}removeParameter(e){const i=this.model$.value;i.parameters=i.parameters.filter(n=>n!==e),this.emitModelUpdate(i),this.hasUnsavedChanges$.next(!0)}moveUp(e){const i=this.model$.value,n=i.parameters[e];0===e?(i.parameters[e]=i.parameters[i.parameters.length-1],i.parameters[i.parameters.length-1]=n):(i.parameters[e]=i.parameters[e-1],i.parameters[e-1]=n),this.emitModelUpdate(i),this.hasUnsavedChanges$.next(!0)}moveDown(e){const i=this.model$.value,n=i.parameters[e];e===i.parameters.length-1?(i.parameters[e]=i.parameters[0],i.parameters[0]=n):(i.parameters[e]=i.parameters[e+1],i.parameters[e+1]=n),this.emitModelUpdate(i),this.hasUnsavedChanges$.next(!0)}setBufferSize(e){this.buffer.setSize(e);const i=this.model$.value;i.bufferSize=e,this.emitModelUpdate(i),this.hasUnsavedChanges$.next(!0)}save(){const e=new Blob([JSON.stringify({$schema:"https://yamcs.org/schema/parameter-table.schema.json",...this.model$.value},void 0,2)],{type:"application/json"});return this.storageClient.uploadObject(this.bucket,this.objectName,e).then(()=>{this.hasUnsavedChanges$.next(!1)})}showAddParameterDialog(){this.dialog.open(H.M,{width:"500px",data:{okLabel:"ADD",exclude:this.getModel().parameters}}).afterClosed().subscribe(i=>{i&&this.addParameter(i)})}ngOnDestroy(){this.dataSubscription?.cancel()}static#t=this.\u0275fac=function(i){return new(i||a)(t.Y36(o.C8),t.Y36(d.uw),t.Y36(o.E4))};static#e=this.\u0275cmp=t.Xpm({type:a,selectors:[["app-parameter-table-viewer"]],decls:2,vars:3,consts:[["class","panel-content",4,"ngIf"],[1,"panel-content"],[4,"ngIf","ngIfElse"],["empty",""],[3,"model","buffer","paused","showActions","selection","moveUp","moveDown",4,"ngIf"],[3,"model","buffer","paused","showActions","moveLeft","moveRight","removeColumn","bufferSize",4,"ngIf"],[3,"model","buffer","paused","showActions","selection","moveUp","moveDown"],[3,"model","buffer","paused","showActions","moveLeft","moveRight","removeColumn","bufferSize"],[2,"text-align","left"],[1,"ya-link",2,"cursor","pointer",3,"click"]],template:function(i,n){1&i&&(t.YNc(0,_a,4,2,"div",0),t.ALo(1,"async")),2&i&&t.Q6J("ngIf",t.lcZ(1,1,n.model$))},dependencies:[g.O5,o.RR,Me,ra,g.Ov],styles:[".panel-content[_ngcontent-%COMP%]{position:relative;overflow:auto}"],changeDetection:0})}return a})(),pt=(()=>{class a{constructor(e,i,n){this.dialogRef=e,this.yamcs=i,this.data=n,this.delimiterOptions=[{id:"COMMA",label:"Comma"},{id:"SEMICOLON",label:"Semicolon"},{id:"TAB",label:"Tab"}],this.downloadURL$=new f.X(null),this.form=new c.nJ({start:new c.p4(null),stop:new c.p4(null),delimiter:new c.p4(null,c.kI.required),interval:new c.NI(null)});let s=n.start,l=n.stop;(!s||!l)&&(l=i.getMissionTime(),s=o.P6.subtractDuration(l,"PT1H")),this.form.setValue({start:o.P6.toISOString(s),stop:o.P6.toISOString(l),delimiter:"TAB",interval:""}),this.formChangeSubscription=this.form.valueChanges.subscribe(()=>{this.updateURL()}),this.updateURL()}closeDialog(){this.dialogRef.close(!0)}updateURL(){if(this.form.valid){const e={delimiter:this.form.value.delimiter};this.data.parameterIds&&(e.parameters=this.data.parameterIds),this.data.list&&(e.list=this.data.list),this.form.value.start&&(e.start=o.P6.toISOString(this.form.value.start)),this.form.value.stop&&(e.stop=o.P6.toISOString(this.form.value.stop)),this.form.value.interval&&(e.interval=this.form.value.interval),this.data.filename&&(e.filename=this.data.filename);const i=this.yamcs.yamcsClient.getParameterValuesDownloadURL(this.yamcs.instance,e);this.downloadURL$.next(i)}else this.downloadURL$.next(null)}ngOnDestroy(){this.formChangeSubscription?.unsubscribe()}static#t=this.\u0275fac=function(i){return new(i||a)(t.Y36(d.so),t.Y36(o.C8),t.Y36(d.WI))};static#e=this.\u0275cmp=t.Xpm({type:a,selectors:[["app-export-archive-data-dialog"]],decls:29,vars:7,consts:[["mat-dialog-title",""],[1,"mat-typography","ya-form"],[3,"formGroup"],["formControlName","start"],["formControlName","stop"],["formControlName","delimiter",3,"options"],[1,"hint"],["formControlName","interval","type","text",1,"ya-input"],["align","end"],["mat-dialog-close","",1,"ya-button"],[3,"link","primary","disabled","click"]],template:function(i,n){1&i&&(t.TgZ(0,"h2",0),t._uU(1,"Export archive data"),t.qZA(),t.TgZ(2,"mat-dialog-content",1)(3,"form",2)(4,"label"),t._uU(5," Start "),t._UZ(6,"ya-date-time-input",3),t.qZA(),t._UZ(7,"br"),t.TgZ(8,"label"),t._uU(9," Stop "),t._UZ(10,"ya-date-time-input",4),t.qZA(),t._UZ(11,"br"),t.TgZ(12,"label"),t._uU(13," CSV column delimiter"),t._UZ(14,"br")(15,"ya-select",5),t.qZA(),t._UZ(16,"br"),t.TgZ(17,"label"),t._uU(18," Interval (ms) "),t.TgZ(19,"span",6),t._uU(20,"(optional)"),t.qZA(),t._UZ(21,"br")(22,"input",7),t.qZA()()(),t.TgZ(23,"mat-dialog-actions",8)(24,"button",9),t._uU(25,"CANCEL"),t.qZA(),t.TgZ(26,"ya-download-button",10),t.NdJ("click",function(){return n.closeDialog()}),t.ALo(27,"async"),t._uU(28," DOWNLOAD "),t.qZA()()),2&i&&(t.xp6(3),t.Q6J("formGroup",n.form),t.xp6(12),t.Q6J("options",n.delimiterOptions),t.xp6(11),t.Q6J("link",t.lcZ(27,5,n.downloadURL$))("primary",!0)("disabled",!n.form.valid))},dependencies:[c._Y,c.Fj,c.JJ,c.JL,c.sg,c.u,d.ZT,d.uh,d.xY,d.H8,o.t,o.NA,o.Hr,g.Ov],encapsulation:2})}return a})();var mt=y(2939),D=y(5394),X=y(2596);function pa(a,r){if(1&a){const e=t.EpF();t.TgZ(0,"button",10),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(3);return t.KtG(n.save())}),t.ALo(1,"async"),t.TgZ(2,"mat-icon"),t._uU(3,"save"),t.qZA(),t._uU(4," SAVE "),t.qZA()}if(2&a){const e=t.oxw(3);t.Q6J("disabled",!t.lcZ(1,1,e.viewer.hasUnsavedChanges$))}}function ma(a,r){if(1&a){const e=t.EpF();t.TgZ(0,"button",11),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(3);return t.KtG(n.viewer.pause())}),t.TgZ(1,"mat-icon"),t._uU(2,"pause"),t.qZA(),t._uU(3," PAUSE "),t.qZA()}}function ua(a,r){if(1&a){const e=t.EpF();t.TgZ(0,"button",12),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(3);return t.KtG(n.viewer.unpause())}),t.TgZ(1,"mat-icon"),t._uU(2,"play_arrow"),t.qZA(),t._uU(3," UNPAUSE "),t.qZA()}}function ga(a,r){if(1&a){const e=t.EpF();t.TgZ(0,"button",10),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(3);return t.KtG(n.viewer.delete())}),t.TgZ(1,"mat-icon"),t._uU(2,"delete"),t.qZA(),t._uU(3," DELETE "),t.qZA()}if(2&a){const e=t.oxw(3);t.Q6J("disabled",e.viewer.selection.isEmpty())}}function da(a,r){if(1&a){const e=t.EpF();t.TgZ(0,"button",4),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(3);return t.KtG(n.viewer.enableScrollView())}),t.TgZ(1,"mat-icon",13),t._uU(2,"view_headline"),t.qZA(),t._uU(3," SCROLL VIEW "),t.qZA()}}function ha(a,r){if(1&a){const e=t.EpF();t.TgZ(0,"button",4),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(3);return t.KtG(n.viewer.enableStandardView())}),t.TgZ(1,"mat-icon"),t._uU(2,"view_headline"),t.qZA(),t._uU(3," STANDARD VIEW "),t.qZA()}}function fa(a,r){if(1&a){const e=t.EpF();t.ynx(0),t.YNc(1,pa,5,3,"button",1),t.YNc(2,ma,4,0,"button",2),t.ALo(3,"async"),t.YNc(4,ua,4,0,"button",3),t.ALo(5,"async"),t.TgZ(6,"button",4),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(2);return t.KtG(n.addParameter())}),t.TgZ(7,"mat-icon"),t._uU(8,"playlist_add"),t.qZA(),t._uU(9," ADD "),t.qZA(),t.YNc(10,ga,4,1,"button",1),t.YNc(11,da,4,0,"button",5),t.YNc(12,ha,4,0,"button",5),t.TgZ(13,"mat-menu",6,7)(15,"button",8),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(2);return t.KtG(n.exportArchiveData())}),t._uU(16," Export archive data... "),t.qZA()(),t.TgZ(17,"button",9),t.NdJ("click",function(n){return n.stopPropagation()}),t.TgZ(18,"mat-icon"),t._uU(19,"more_vert"),t.qZA()(),t.BQk()}if(2&a){const e=r.ngIf,i=t.MAs(14),n=t.oxw(2);t.xp6(1),t.Q6J("ngIf",n.mayManageDisplays()),t.xp6(1),t.Q6J("ngIf",!t.lcZ(3,8,n.viewer.paused$)),t.xp6(2),t.Q6J("ngIf",t.lcZ(5,10,n.viewer.paused$)),t.xp6(6),t.Q6J("ngIf",!e.scroll),t.xp6(1),t.Q6J("ngIf",!e.scroll),t.xp6(1),t.Q6J("ngIf",e.scroll),t.xp6(3),t.Q6J("disabled",!e.parameters.length),t.xp6(2),t.Q6J("matMenuTriggerFor",i)}}function xa(a,r){if(1&a&&(t.ynx(0),t.YNc(1,fa,20,12,"ng-container",0),t.ALo(2,"async"),t.BQk()),2&a){const e=t.oxw();t.xp6(1),t.Q6J("ngIf",t.lcZ(2,1,e.viewer.model$))}}let ut=(()=>{class a{constructor(e,i,n,s){this.dialog=e,this.snackbar=i,this.authService=n,this.initialized$=new f.X(!1),this.bucket=s.getDisplayBucket()}init(e){this.viewer=e,this.initialized$.next(!0)}addParameter(){this.dialog.open(H.M,{width:"500px",data:{okLabel:"ADD",exclude:this.viewer.getModel().parameters}}).afterClosed().subscribe(i=>{i&&this.viewer.addParameter(i)})}mayManageDisplays(){const e=this.authService.getUser();return e.hasObjectPrivilege("ManageBucket",this.bucket)||e.hasSystemPrivilege("ManageAnyBucket")}save(){this.viewer.save().then(()=>{this.snackbar.open("Changes saved",void 0,{duration:1e3})}).catch(e=>{this.snackbar.open("Failed to save changes: "+e)})}exportArchiveData(){let e=this.viewer.selection.selected;e.length||(e=this.viewer.getModel().parameters),this.dialog.open(pt,{width:"400px",data:{parameterIds:e}})}static#t=this.\u0275fac=function(i){return new(i||a)(t.Y36(d.uw),t.Y36(mt.ux),t.Y36(D.e),t.Y36(o.E4))};static#e=this.\u0275cmp=t.Xpm({type:a,selectors:[["app-parameter-table-viewer-controls"]],decls:2,vars:3,consts:[[4,"ngIf"],["mat-button","","color","primary",3,"disabled","click",4,"ngIf"],["mat-button","","color","primary","matTooltip","Pause value updates",3,"click",4,"ngIf"],["mat-button","","color","primary","matTooltip","Unpause value updates",3,"click",4,"ngIf"],["mat-button","","color","primary",3,"click"],["mat-button","","color","primary",3,"click",4,"ngIf"],["overlapTrigger","false"],["moreMenu","matMenu"],["mat-menu-item","",3,"disabled","click"],["mat-button","",3,"matMenuTriggerFor","click"],["mat-button","","color","primary",3,"disabled","click"],["mat-button","","color","primary","matTooltip","Pause value updates",3,"click"],["mat-button","","color","primary","matTooltip","Unpause value updates",3,"click"],[2,"transform","rotate(90deg)"]],template:function(i,n){1&i&&(t.YNc(0,xa,3,3,"ng-container",0),t.ALo(1,"async")),2&i&&t.Q6J("ngIf",t.lcZ(1,1,n.initialized$))},dependencies:[g.O5,w.lW,P.Hw,S.VK,S.OP,S.p6,X.gM,g.Ov],encapsulation:2})}return a})();var E=y(5861),gt=y(7954);y(8440),y(8743),y(6806);const ya=["scriptContainer"];let dt=(()=>{class a{constructor(e,i,n,s){this.changeDetector=i,this.authService=s,this.hasUnsavedChanges$=new f.X(!1),this.storageClient=e.createStorageClient(),this.bucket=n.getDisplayBucket()}init(e){return this.objectName=e,this.storageClient.getObject(this.bucket,e).then(i=>{i.text().then(n=>{this.editor=gt.edit(this.scriptContainer.nativeElement),this.editor.$blockScrolling=1/0,this.editor.getSession().setMode("ace/mode/javascript"),this.changeDetector.detectChanges(),this.editor.setTheme("ace/theme/eclipse"),this.editor.setValue(n,-1),this.mayManageDisplays()?this.editor.addEventListener("change",()=>{this.hasUnsavedChanges$.next(!0)}):this.editor.setReadOnly(!0)})}),Promise.resolve()}mayManageDisplays(){const e=this.authService.getUser();return e.hasObjectPrivilege("ManageBucket",this.bucket)||e.hasSystemPrivilege("ManageAnyBucket")}hasPendingChanges(){return this.hasUnsavedChanges$.value}save(){var e=this;return(0,E.Z)(function*(){const i=e.editor.getSession().getValue(),n=new Blob([i],{type:"text/javascript"});return e.storageClient.uploadObject(e.bucket,e.objectName,n).then(()=>{e.hasUnsavedChanges$.next(!1)})})()}static#t=this.\u0275fac=function(i){return new(i||a)(t.Y36(o.C8),t.Y36(t.sBO),t.Y36(o.E4),t.Y36(D.e))};static#e=this.\u0275cmp=t.Xpm({type:a,selectors:[["app-script-viewer"]],viewQuery:function(i,n){if(1&i&&t.Gf(ya,7),2&i){let s;t.iGM(s=t.CRH())&&(n.scriptContainer=s.first)}},decls:2,vars:0,consts:[[1,"script-container"],["scriptContainer",""]],template:function(i,n){1&i&&t._UZ(0,"div",0,1)},styles:[".script-container[_ngcontent-%COMP%]{height:100%}"],changeDetection:0})}return a})();function ba(a,r){if(1&a){const e=t.EpF();t.TgZ(0,"button",2),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(2);return t.KtG(n.save())}),t.ALo(1,"async"),t.TgZ(2,"mat-icon"),t._uU(3,"save"),t.qZA(),t._uU(4," SAVE "),t.qZA()}if(2&a){const e=t.oxw(2);t.Q6J("disabled",!t.lcZ(1,1,e.viewer.hasUnsavedChanges$))}}function Ta(a,r){if(1&a&&(t.ynx(0),t.YNc(1,ba,5,3,"button",1),t.BQk()),2&a){const e=t.oxw();t.xp6(1),t.Q6J("ngIf",e.mayManageDisplays())}}let ht=(()=>{class a{constructor(e,i,n){this.snackbar=e,this.authService=i,this.initialized$=new f.X(!1),this.bucket=n.getDisplayBucket()}init(e){this.viewer=e,this.initialized$.next(!0)}mayManageDisplays(){const e=this.authService.getUser();return e.hasObjectPrivilege("ManageBucket",this.bucket)||e.hasSystemPrivilege("ManageAnyBucket")}save(){this.viewer.save().then(()=>{this.snackbar.open("Changes saved",void 0,{duration:1e3})}).catch(e=>{this.snackbar.open("Failed to save changes: "+e)})}static#t=this.\u0275fac=function(i){return new(i||a)(t.Y36(mt.ux),t.Y36(D.e),t.Y36(o.E4))};static#e=this.\u0275cmp=t.Xpm({type:a,selectors:[["ng-component"]],decls:2,vars:3,consts:[[4,"ngIf"],["mat-button","","color","primary",3,"disabled","click",4,"ngIf"],["mat-button","","color","primary",3,"disabled","click"]],template:function(i,n){1&i&&(t.YNc(0,Ta,2,1,"ng-container",0),t.ALo(1,"async")),2&i&&t.Q6J("ngIf",t.lcZ(1,1,n.initialized$))},dependencies:[g.O5,w.lW,P.Hw,g.Ov],encapsulation:2})}return a})();function va(a,r){if(1&a&&(t.TgZ(0,"pre"),t._uU(1),t.qZA()),2&a){const e=t.oxw();t.xp6(1),t.Oqu(e.text)}}let ft=(()=>{class a{constructor(e,i,n){this.changeDetector=i,this.storageClient=e.createStorageClient(),this.bucket=n.getDisplayBucket()}init(e){return this.storageClient.getObject(this.bucket,e).then(i=>{i.text().then(n=>{this.text=n,this.changeDetector.detectChanges()})}),Promise.resolve()}hasPendingChanges(){return!1}static#t=this.\u0275fac=function(i){return new(i||a)(t.Y36(o.C8),t.Y36(t.sBO),t.Y36(o.E4))};static#e=this.\u0275cmp=t.Xpm({type:a,selectors:[["app-text-viewer"]],decls:1,vars:1,consts:[[4,"ngIf"]],template:function(i,n){1&i&&t.YNc(0,va,2,1,"pre",0),2&i&&t.Q6J("ngIf",n.text)},dependencies:[g.O5],styles:["pre[_ngcontent-%COMP%]{margin:1em}"],changeDetection:0})}return a})(),W=(()=>{class a{constructor(e){this.viewContainerRef=e}static#t=this.\u0275fac=function(i){return new(i||a)(t.Y36(t.s_b))};static#e=this.\u0275dir=t.lG2({type:a,selectors:[["","app-viewer-controls-host",""]]})}return a})(),tt=(()=>{class a{constructor(e){this.viewContainerRef=e}static#t=this.\u0275fac=function(i){return new(i||a)(t.Y36(t.s_b))};static#e=this.\u0275dir=t.lG2({type:a,selectors:[["","app-viewer-host",""]]})}return a})(),xt=(()=>{class a{transform(e){if(!e)return null;const i=e.toLowerCase();return i.endsWith(".opi")?"Operator Interface":i.endsWith(".par")?"Parameter Table":i.endsWith(".js")?"Script File":-1!==i.indexOf(".")?i.substr(i.lastIndexOf(".")+1).toUpperCase()+" File":null}static#t=this.\u0275fac=function(i){return new(i||a)};static#e=this.\u0275pipe=t.Yjl({name:"displayType",type:a,pure:!0})}return a})(),yt=(()=>{class a{constructor(e){this.yamcs=e}transform(e){return e?this.yamcs.yamcsClient.getPacketDownloadURL(this.yamcs.instance,e.id.name,e.generationTime,e.sequenceNumber):null}static#t=this.\u0275fac=function(i){return new(i||a)(t.Y36(o.C8,16))};static#e=this.\u0275pipe=t.Yjl({name:"packetDownloadLink",type:a,pure:!0})}return a})();var Za=y(664),bt=y(1293),Pa=y(9295),Tt=y(2181),C=y(6593),k=y(2755),U=y(1237);const wa=["viewerContainer"];function Aa(a,r){}function Sa(a,r){}const Ca=function(a){return{c:a}};let vt=(()=>{class a{constructor(e,i,n,s,l){this.yamcs=e,this.route=i,this.title=s,this.folderPerInstance=l.getConfig().displayFolderPerInstance;const _=this.getObjectNameFromUrl();this.loadFile(_),this.routerSubscription=n.events.pipe((0,Tt.h)(m=>m instanceof b.m2)).subscribe(()=>{const m=this.getObjectNameFromUrl();m!==this.objectName&&this.loadFile(m,!0)})}getObjectNameFromUrl(){const e=this.route.snapshot.url;let i="";this.folderPerInstance&&(i+=this.yamcs.instance);for(const n of e)i&&(i+="/"),i+=n.path;return i}getNameWithoutInstance(e){return this.folderPerInstance?e.substr(this.yamcs.instance.length):e}loadFile(e,i=!1){this.objectName=e;const n=this.objectName.lastIndexOf("/");if(-1===n)this.folderLink="/telemetry/displays/browse/",this.filename=this.objectName;else{const s=this.getNameWithoutInstance(this.objectName.substring(0,n));this.folderLink="/telemetry/displays/browse/"+s,this.filename=this.objectName.substring(n+1)}this.title.setTitle(this.filename),i&&this.ngAfterViewInit()}ngAfterViewInit(){if(this.filename.toLowerCase().endsWith(".opi")){const e=this.createViewer(lt);e.setViewerContainerEl(this.viewerContainer.nativeElement),this.createViewerControls(ct).init(e),this.viewer=e}else if(this.filename.toLowerCase().endsWith(".par")){const e=this.createViewer(_t);this.createViewerControls(ut).init(e),e.setEnableActions(),this.viewer=e}else if(this.isImage())this.viewer=this.createViewer(ot);else if(this.filename.toLocaleLowerCase().endsWith(".js")){const e=this.createViewer(dt);this.createViewerControls(ht).init(e),this.viewer=e}else this.viewer=this.createViewer(ft);this.viewer.init(this.objectName)}createViewer(e){const i=this.viewerHost.viewContainerRef;return i.clear(),i.createComponent(e).instance}createViewerControls(e){const i=this.controlsHost.viewContainerRef;return i.clear(),i.createComponent(e).instance}isImage(){const e=this.filename.toLowerCase();return e.endsWith(".png")||e.endsWith(".gif")||e.endsWith(".jpg")||e.endsWith("jpeg")||e.endsWith("bmp")}hasPendingChanges(){return this.viewer.hasPendingChanges()}ngOnDestroy(){this.routerSubscription?.unsubscribe(),this.syncSubscription?.unsubscribe()}static#t=this.\u0275fac=function(i){return new(i||a)(t.Y36(o.C8),t.Y36(b.gz),t.Y36(b.F0),t.Y36(C.Dx),t.Y36(o.E4))};static#e=this.\u0275cmp=t.Xpm({type:a,selectors:[["ng-component"]],viewQuery:function(i,n){if(1&i&&(t.Gf(W,5),t.Gf(wa,5),t.Gf(tt,5)),2&i){let s;t.iGM(s=t.CRH())&&(n.controlsHost=s.first),t.iGM(s=t.CRH())&&(n.viewerContainer=s.first),t.iGM(s=t.CRH())&&(n.viewerHost=s.first)}},decls:10,vars:5,consts:[["mat-icon-button","","color","primary",3,"routerLink","queryParams"],["app-viewer-controls-host",""],[2,"height","100%","width","100%"],["viewerContainer",""],["app-viewer-host",""]],template:function(i,n){1&i&&(t.TgZ(0,"app-instance-page")(1,"app-instance-toolbar")(2,"a",0)(3,"mat-icon"),t._uU(4,"arrow_back"),t.qZA()(),t._uU(5),t.YNc(6,Aa,0,0,"ng-template",1),t.qZA(),t.TgZ(7,"div",2,3),t.YNc(9,Sa,0,0,"ng-template",4),t.qZA()()),2&i&&(t.xp6(2),t.Q6J("routerLink",n.folderLink)("queryParams",t.VKq(3,Ca,n.yamcs.context)),t.xp6(3),t.hij(" ",n.filename," \xa0\xa0\xa0 "))},dependencies:[b.rH,w.o6,P.Hw,k.a,U.k,W,tt],encapsulation:2,changeDetection:0})}return a})();var Zt=y(5592),ka=y(2096);let Ua=(()=>{class a{constructor(e){this.dialogRef=e}confirmDiscard(){this.dialogRef.close(!0)}static#t=this.\u0275fac=function(i){return new(i||a)(t.Y36(d.so))};static#e=this.\u0275cmp=t.Xpm({type:a,selectors:[["app-display-file-page-dirty-dialog"]],decls:8,vars:0,consts:[[1,"mat-typography"],["align","end"],["mat-dialog-close","",1,"ya-button"],[1,"ya-button","primary",3,"click"]],template:function(i,n){1&i&&(t.TgZ(0,"mat-dialog-content",0)(1,"p"),t._uU(2,"You have unsaved changes on the current page. Do you want to discard them?"),t.qZA()(),t.TgZ(3,"mat-dialog-actions",1)(4,"button",2),t._uU(5,"CANCEL"),t.qZA(),t.TgZ(6,"button",3),t.NdJ("click",function(){return n.confirmDiscard()}),t._uU(7," DISCARD "),t.qZA()())},dependencies:[d.ZT,d.xY,d.H8],encapsulation:2})}return a})(),Pt=(()=>{class a{constructor(e,i,n){this.dialog=e,this.authService=i,this.dialogOpen$=new f.X(!1),this.bucket=n.getDisplayBucket()}canDeactivate(e){return this.dialogOpen$.value?Zt.y.create(i=>{this.dialogRef.afterClosed().subscribe(n=>{i.next(!0===n),i.complete()},n=>{i.next(!1),i.complete()})}):e.hasPendingChanges()&&this.mayManageDisplays()?Zt.y.create(i=>{this.dialogOpen$.next(!0),this.dialogRef=this.dialog.open(Ua,{width:"400px"}),this.dialogRef.afterClosed().subscribe(n=>{this.dialogOpen$.next(!1),i.next(!0===n),i.complete()},n=>{this.dialogOpen$.next(!1),i.next(!1),i.complete()})}):(0,ka.of)(!0)}mayManageDisplays(){const e=this.authService.getUser();return e.hasObjectPrivilege("ManageBucket",this.bucket)||e.hasSystemPrivilege("ManageAnyBucket")}static#t=this.\u0275fac=function(i){return new(i||a)(t.LFG(d.uw),t.LFG(D.e),t.LFG(o.E4))};static#e=this.\u0275prov=t.Yz7({token:a,factory:a.\u0275fac})}return a})();var Da=y(9378);const Na=["filename"];function Ia(a,r){if(1&a&&(t.TgZ(0,"form",7)(1,"label"),t._uU(2," Type "),t.TgZ(3,"select",8)(4,"option",9),t._uU(5,"Parameter Table"),t.qZA()()()()),2&a){const e=t.oxw();t.Q6J("formGroup",e.typeForm)}}function Qa(a,r){1&a&&(t.TgZ(0,"span",14),t._uU(1,"File name must end with "),t.TgZ(2,"code"),t._uU(3,".par"),t.qZA()())}function La(a,r){if(1&a&&(t.TgZ(0,"form",7)(1,"label"),t._uU(2," Name "),t._UZ(3,"input",10,11),t.YNc(5,Qa,4,0,"span",12),t.qZA(),t._UZ(6,"br"),t.TgZ(7,"label"),t._uU(8," Path "),t._UZ(9,"input",13),t.qZA()()),2&a){const e=t.oxw();let i,n;t.Q6J("formGroup",e.filenameForm),t.xp6(1),t.ekj("invalid",null==(i=e.filenameForm.get("name"))?null:i.invalid),t.xp6(4),t.Q6J("ngIf",null==(n=e.filenameForm.get("name"))?null:n.invalid)}}function Ja(a,r){if(1&a){const e=t.EpF();t.TgZ(0,"button",15),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.selectType())}),t._uU(1,"NEXT \xbb"),t.qZA()}if(2&a){const e=t.oxw();t.Q6J("disabled",!e.typeForm.valid)}}function Ya(a,r){if(1&a){const e=t.EpF();t.TgZ(0,"button",16),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.save())}),t._uU(1,"SAVE"),t.qZA()}if(2&a){const e=t.oxw();t.Q6J("disabled",!e.filenameForm.valid)}}let Ma=(()=>{class a{constructor(e,i,n,s,l,_){this.dialogRef=e,this.data=s,this.changeDetector=l,this.configService=_,this.page=1,this.storageClient=n.createStorageClient(),this.typeForm=i.group({type:["par",c.kI.required]}),this.filenameForm=i.group({path:[s.path,c.kI.required],name:["",[c.kI.required,c.kI.pattern(/.*\.par/i)]]})}selectType(){const e=this.typeForm.value.type;this.filenameForm.get("name").setValue(`NewFile.${e}`),this.page=2,this.changeDetector.detectChanges(),this.filenameInput.nativeElement.select()}save(){let e=this.filenameForm.get("path").value.trim();const i=this.filenameForm.get("name").value.trim();e.startsWith("/")&&(e=e.substring(1)),e.endsWith("/")&&(e=e.substring(0,e.length-1));const n=e?e+"/"+i:i,s=new Blob([JSON.stringify({$schema:"https://yamcs.org/schema/parameter-table.schema.json",scroll:!1,parameters:[]},void 0,2)],{type:"application/json"}),l=this.configService.getDisplayBucket();this.storageClient.uploadObject(l,this.data.prefix+n,s).then(()=>{this.dialogRef.close(n)})}static#t=this.\u0275fac=function(i){return new(i||a)(t.Y36(d.so),t.Y36(c.QS),t.Y36(o.C8),t.Y36(d.WI),t.Y36(t.sBO),t.Y36(o.E4))};static#e=this.\u0275cmp=t.Xpm({type:a,selectors:[["app-create-display-dialog"]],viewQuery:function(i,n){if(1&i&&t.Gf(Na,5),2&i){let s;t.iGM(s=t.CRH())&&(n.filenameInput=s.first)}},decls:10,vars:4,consts:[["mat-dialog-title",""],[1,"mat-typography"],["class","ya-form",3,"formGroup",4,"ngIf"],["align","end"],["mat-dialog-close","",1,"ya-button"],["class","ya-button",3,"disabled","click",4,"ngIf"],["class","ya-button primary",3,"disabled","click",4,"ngIf"],[1,"ya-form",3,"formGroup"],["formControlName","type"],["value","par"],["type","text","formControlName","name"],["filename",""],["class","error-message",4,"ngIf"],["type","text","formControlName","path"],[1,"error-message"],[1,"ya-button",3,"disabled","click"],[1,"ya-button","primary",3,"disabled","click"]],template:function(i,n){1&i&&(t.TgZ(0,"h2",0),t._uU(1,"Create display"),t.qZA(),t.TgZ(2,"mat-dialog-content",1),t.YNc(3,Ia,6,1,"form",2),t.YNc(4,La,10,4,"form",2),t.qZA(),t.TgZ(5,"mat-dialog-actions",3)(6,"button",4),t._uU(7,"CANCEL"),t.qZA(),t.YNc(8,Ja,2,1,"button",5),t.YNc(9,Ya,2,1,"button",6),t.qZA()),2&i&&(t.xp6(3),t.Q6J("ngIf",1===n.page),t.xp6(1),t.Q6J("ngIf",2===n.page),t.xp6(4),t.Q6J("ngIf",1===n.page),t.xp6(1),t.Q6J("ngIf",2===n.page))},dependencies:[g.O5,c._Y,c.YN,c.Kr,c.Fj,c.EJ,c.JJ,c.JL,c.sg,c.u,d.ZT,d.uh,d.xY,d.H8],encapsulation:2})}return a})(),Oa=(()=>{class a{constructor(e,i,n,s){this.dialogRef=e,this.data=s,this.storageClient=n.createStorageClient(),this.form=i.group({name:["",c.kI.required]})}save(){let{path:e,bucket:i}=this.data;e.startsWith("/")&&(e=e.substring(1));const n=this.form.value.name;this.storageClient.uploadObject(i,e?`${e}/${n}/`:`${n}/`,new Blob).then(()=>this.dialogRef.close(!0))}static#t=this.\u0275fac=function(i){return new(i||a)(t.Y36(d.so),t.Y36(c.QS),t.Y36(o.C8),t.Y36(d.WI))};static#e=this.\u0275cmp=t.Xpm({type:a,selectors:[["app-create-display-folder-dialog"]],decls:12,vars:2,consts:[["mat-dialog-title",""],[1,"mat-typography"],[1,"ya-form",3,"formGroup"],["type","text","formControlName","name","pattern","\\w[\\w\\s\\.\\-\\(\\)\\[\\]]*"],["align","end"],["mat-dialog-close","",1,"ya-button"],[1,"ya-button","primary",3,"disabled","click"]],template:function(i,n){1&i&&(t.TgZ(0,"h2",0),t._uU(1,"Create folder"),t.qZA(),t.TgZ(2,"mat-dialog-content",1)(3,"form",2)(4,"label"),t._uU(5," Folder name "),t._UZ(6,"input",3),t.qZA()()(),t.TgZ(7,"mat-dialog-actions",4)(8,"button",5),t._uU(9,"CANCEL"),t.qZA(),t.TgZ(10,"button",6),t.NdJ("click",function(){return n.save()}),t._uU(11,"CREATE"),t.qZA()()),2&i&&(t.xp6(3),t.Q6J("formGroup",n.form),t.xp6(7),t.Q6J("disabled",!n.form.valid))},dependencies:[c._Y,c.Fj,c.JJ,c.JL,c.c5,c.sg,c.u,d.ZT,d.uh,d.xY,d.H8],encapsulation:2,changeDetection:0})}return a})(),$a=(()=>{class a{constructor(e,i,n,s,l,_){this.dialogRef=e,this.data=_,this.storageClient=n.createStorageClient(),this.bucket=s.getDisplayBucket();const m=l.transform(this.data.name);this.filenameForm=i.group({name:[m,[c.kI.required]]})}rename(){var e=this;return(0,E.Z)(function*(){let i;const n=e.data.name.lastIndexOf("/");-1!==n&&(i=e.data.name.substring(0,n+1));const l=yield(yield e.storageClient.getObject(e.bucket,e.data.name)).blob(),_=(i||"")+e.filenameForm.get("name").value;yield e.storageClient.uploadObject(e.bucket,_,l),yield e.storageClient.deleteObject(e.bucket,e.data.name),e.dialogRef.close(_)})()}static#t=this.\u0275fac=function(i){return new(i||a)(t.Y36(d.so),t.Y36(c.QS),t.Y36(o.C8),t.Y36(o.E4),t.Y36(o.XB),t.Y36(d.WI))};static#e=this.\u0275cmp=t.Xpm({type:a,selectors:[["app-rename-display-dialog"]],decls:13,vars:4,consts:[["mat-dialog-title",""],[1,"mat-typography"],[1,"ya-form",3,"formGroup"],["type","text","formControlName","name"],["filename",""],["align","end"],["mat-dialog-close","",1,"ya-button"],[1,"ya-button","primary",3,"disabled","click"]],template:function(i,n){if(1&i&&(t.TgZ(0,"h2",0),t._uU(1,"Rename file"),t.qZA(),t.TgZ(2,"mat-dialog-content",1)(3,"form",2)(4,"label"),t._uU(5," Name "),t._UZ(6,"input",3,4),t.qZA()()(),t.TgZ(8,"mat-dialog-actions",5)(9,"button",6),t._uU(10,"CANCEL"),t.qZA(),t.TgZ(11,"button",7),t.NdJ("click",function(){return n.rename()}),t._uU(12,"RENAME"),t.qZA()()),2&i){let s;t.xp6(3),t.Q6J("formGroup",n.filenameForm),t.xp6(1),t.ekj("invalid",null==(s=n.filenameForm.get("name"))?null:s.invalid),t.xp6(7),t.Q6J("disabled",!n.filenameForm.valid)}},dependencies:[c._Y,c.Fj,c.JJ,c.JL,c.sg,c.u,d.ZT,d.uh,d.xY,d.H8],encapsulation:2})}return a})();const Ra=["droparea"],Fa=["uploader"];function Va(a,r){if(1&a){const e=t.EpF();t.TgZ(0,"button",9),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.createDisplay())}),t.TgZ(1,"mat-icon"),t._uU(2,"add_circle_outline"),t.qZA(),t._uU(3," Create display "),t.qZA()}}function Ha(a,r){if(1&a){const e=t.EpF();t.TgZ(0,"button",9),t.NdJ("click",function(){t.CHM(e);const n=t.MAs(5);return t.KtG(n.click())}),t.TgZ(1,"mat-icon"),t._uU(2,"file_upload"),t.qZA(),t._uU(3," Upload files "),t.TgZ(4,"input",10,11),t.NdJ("change",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.uploadFiles())}),t.qZA()()}}function Ea(a,r){if(1&a){const e=t.EpF();t.TgZ(0,"button",9),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.createFolder())}),t.TgZ(1,"mat-icon"),t._uU(2,"create_new_folder"),t.qZA(),t._uU(3," Create folder "),t.qZA()}}function Ba(a,r){if(1&a){const e=t.EpF();t.TgZ(0,"button",12),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.deleteSelectedDisplays())}),t.TgZ(1,"mat-icon"),t._uU(2,"delete"),t.qZA(),t._uU(3," Delete "),t.qZA()}if(2&a){const e=t.oxw();t.Q6J("disabled",!e.selection.hasValue())}}const B=function(a){return{c:a}};function Ga(a,r){if(1&a&&t._UZ(0,"ya-breadcrumb",15),2&a){const e=r.$implicit,i=t.oxw(3);t.Q6J("link",e.route)("queryParams",t.VKq(3,B,i.yamcs.context))("label",e.name)}}function ja(a,r){if(1&a&&(t.TgZ(0,"ya-breadcrumb-trail"),t._UZ(1,"ya-breadcrumb",13),t.YNc(2,Ga,1,5,"ya-breadcrumb",14),t.qZA()),2&a){const e=t.oxw().ngIf,i=t.oxw();t.xp6(1),t.Q6J("queryParams",t.VKq(2,B,i.yamcs.context)),t.xp6(1),t.Q6J("ngForOf",e)}}function za(a,r){if(1&a&&(t.ynx(0),t.YNc(1,ja,3,4,"ya-breadcrumb-trail",6),t.BQk()),2&a){const e=r.ngIf;t.xp6(1),t.Q6J("ngIf",e.length)}}function Ka(a,r){if(1&a){const e=t.EpF();t.TgZ(0,"input",33),t.NdJ("change",function(n){t.CHM(e);const s=t.oxw(3);return t.KtG(n?s.masterToggle():null)}),t.qZA()}if(2&a){const e=t.oxw(3);t.Q6J("checked",e.selection.hasValue()&&e.isAllSelected())}}function Xa(a,r){if(1&a&&(t.TgZ(0,"th",31),t.YNc(1,Ka,1,1,"input",32),t.qZA()),2&a){const e=t.oxw(2);t.xp6(1),t.Q6J("ngIf",e.mayManageDisplays())}}function Wa(a,r){if(1&a){const e=t.EpF();t.TgZ(0,"input",36),t.NdJ("click",function(n){return n.stopPropagation()})("change",function(n){t.CHM(e);const s=t.oxw().$implicit,l=t.oxw(2);return t.KtG(n?l.selection.toggle(s):null)}),t.qZA()}if(2&a){const e=t.oxw().$implicit,i=t.oxw(2);t.Q6J("checked",i.selection.isSelected(e))}}function ti(a,r){if(1&a&&(t.TgZ(0,"td",34),t.YNc(1,Wa,1,1,"input",35),t.qZA()),2&a){const e=t.oxw(2);t.xp6(1),t.Q6J("ngIf",e.mayManageDisplays())}}function ei(a,r){1&a&&(t.TgZ(0,"th",37),t._uU(1,"Name"),t.qZA())}function ai(a,r){if(1&a&&(t.ynx(0),t.TgZ(1,"mat-icon",39),t._uU(2,"folder"),t.qZA(),t.TgZ(3,"a",40),t.NdJ("click",function(i){return i.stopPropagation()}),t._uU(4),t.ALo(5,"filename"),t.qZA(),t.BQk()),2&a){const e=t.oxw().$implicit,i=t.oxw(2);t.xp6(3),t.Q6J("routerLink","/telemetry/displays/browse/"+e.nameWithoutInstance)("queryParams",t.VKq(5,B,i.yamcs.context)),t.xp6(1),t.hij("",t.lcZ(5,3,e.name)," ")}}function ii(a,r){if(1&a&&(t.ynx(0),t.TgZ(1,"mat-icon",39),t._uU(2,"description"),t.qZA(),t.TgZ(3,"a",40),t.NdJ("click",function(i){return i.stopPropagation()}),t._uU(4),t.ALo(5,"filename"),t.qZA(),t.BQk()),2&a){const e=t.oxw().$implicit,i=t.oxw(2);t.xp6(3),t.Q6J("routerLink","/telemetry/displays/files/"+e.nameWithoutInstance)("queryParams",t.VKq(5,B,i.yamcs.context)),t.xp6(1),t.hij("",t.lcZ(5,3,e.name)," ")}}function ni(a,r){if(1&a&&(t.TgZ(0,"td",38),t.YNc(1,ai,6,7,"ng-container",6),t.YNc(2,ii,6,7,"ng-container",6),t.qZA()),2&a){const e=r.$implicit;t.xp6(1),t.Q6J("ngIf",e.folder),t.xp6(1),t.Q6J("ngIf",!e.folder)}}function ri(a,r){1&a&&(t.TgZ(0,"th",37),t._uU(1,"Type"),t.qZA())}function si(a,r){1&a&&(t.ynx(0),t._uU(1,"Folder"),t.BQk())}function oi(a,r){if(1&a&&(t.ynx(0),t._uU(1),t.ALo(2,"displayType"),t.BQk()),2&a){const e=t.oxw().$implicit;t.xp6(1),t.hij(" ",t.lcZ(2,1,e.name)||"-"," ")}}function li(a,r){if(1&a&&(t.TgZ(0,"td",38),t.YNc(1,si,2,0,"ng-container",6),t.YNc(2,oi,3,3,"ng-container",6),t.qZA()),2&a){const e=r.$implicit;t.xp6(1),t.Q6J("ngIf",e.folder),t.xp6(1),t.Q6J("ngIf",!e.folder)}}function ci(a,r){1&a&&(t.TgZ(0,"th",37),t._uU(1,"Visibility"),t.qZA())}function _i(a,r){1&a&&(t.TgZ(0,"td",38),t._uU(1," Private "),t.qZA())}function pi(a,r){1&a&&(t.TgZ(0,"th",37),t._uU(1,"Date modified"),t.qZA())}function mi(a,r){if(1&a&&(t.TgZ(0,"td",38),t._uU(1),t.ALo(2,"datetime"),t.qZA()),2&a){const e=r.$implicit;t.xp6(1),t.hij(" ",t.lcZ(2,1,e.modified)||"-"," ")}}function ui(a,r){1&a&&t._UZ(0,"th",41)}function gi(a,r){if(1&a){const e=t.EpF();t.TgZ(0,"ya-more")(1,"button",42),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(2).$implicit,s=t.oxw(2);return t.KtG(s.renameFile(n))}),t._uU(2," Rename "),t.qZA(),t.TgZ(3,"a",43),t._uU(4," Download "),t.qZA(),t._UZ(5,"mat-divider"),t.TgZ(6,"button",42),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(2).$implicit,s=t.oxw(2);return t.KtG(s.deleteFile(n))}),t._uU(7," Delete "),t.qZA()()}if(2&a){const e=t.oxw(2).$implicit;t.xp6(3),t.Q6J("href",e.objectUrl,t.LSH)}}function di(a,r){if(1&a&&(t.ynx(0),t.YNc(1,gi,8,1,"ya-more",6),t.BQk()),2&a){const e=t.oxw(3);t.xp6(1),t.Q6J("ngIf",e.mayManageDisplays())}}function hi(a,r){if(1&a&&(t.TgZ(0,"td",38),t.YNc(1,di,2,1,"ng-container",6),t.qZA()),2&a){const e=r.$implicit;t.xp6(1),t.Q6J("ngIf",!e.folder)}}function fi(a,r){1&a&&t._UZ(0,"tr",44)}function xi(a,r){if(1&a){const e=t.EpF();t.TgZ(0,"tr",45),t.NdJ("click",function(){const s=t.CHM(e).$implicit,l=t.oxw(2);return t.KtG(l.toggleOne(s))}),t.qZA()}if(2&a){const e=r.$implicit,i=t.oxw(2);t.ekj("selected",i.selection.isSelected(e))}}function yi(a,r){if(1&a&&(t.TgZ(0,"table",16),t.ynx(1,17),t.YNc(2,Xa,2,1,"th",18),t.YNc(3,ti,2,1,"td",19),t.BQk(),t.ynx(4,20),t.YNc(5,ei,2,0,"th",21),t.YNc(6,ni,3,2,"td",22),t.BQk(),t.ynx(7,23),t.YNc(8,ri,2,0,"th",21),t.YNc(9,li,3,2,"td",22),t.BQk(),t.ynx(10,24),t.YNc(11,ci,2,0,"th",21),t.YNc(12,_i,2,0,"td",22),t.BQk(),t.ynx(13,25),t.YNc(14,pi,2,0,"th",21),t.YNc(15,mi,3,3,"td",22),t.BQk(),t.ynx(16,26),t.YNc(17,ui,1,0,"th",27),t.YNc(18,hi,2,1,"td",28),t.BQk(),t.YNc(19,fi,1,0,"tr",29),t.YNc(20,xi,1,2,"tr",30),t.qZA()),2&a){const e=t.oxw();t.Q6J("dataSource",e.dataSource),t.xp6(19),t.Q6J("cdkHeaderRowDef",e.displayedColumns),t.xp6(1),t.Q6J("cdkRowDefColumns",e.displayedColumns)}}function bi(a,r){1&a&&(t.TgZ(0,"ya-empty-message"),t._uU(1,"Empty directory."),t.qZA())}let wt=(()=>{class a{constructor(e,i,n,s,l,_,m,u){this.dialog=e,this.yamcs=i,this.router=s,this.route=l,this.authService=_,this.messageService=m,this.breadcrumb$=new f.X([]),this.dragActive$=new f.X(!1),this.displayedColumns=["select","name","type","modified","actions"],this.dataSource=new p.by([]),this.selection=new q.Ov(!0,[]),n.setTitle("Displays"),this.storageClient=i.createStorageClient();const h=u.getConfig();this.bucket=u.getDisplayBucket(),this.folderPerInstance=h.displayFolderPerInstance,this.loadCurrentFolder(),this.routerSubscription=s.events.pipe((0,Tt.h)(x=>x instanceof b.m2)).subscribe(()=>{this.loadCurrentFolder()})}loadCurrentFolder(){const e={delimiter:"/"};let i="";this.folderPerInstance&&(i=this.yamcs.instance+"/");const n=this.route.snapshot.url;n.length?e.prefix=i+n.map(s=>s.path).join("/")+"/":i&&(e.prefix=i),this.storageClient.listObjects(this.bucket,e).then(s=>{this.updateBrowsePath(),this.changedir(s)})}getNameWithoutInstance(e){return this.folderPerInstance?e.substr(this.yamcs.instance.length):e}changedir(e){this.selection.clear();const i=[];for(const n of e.prefixes||[])i.push({folder:!0,name:n,nameWithoutInstance:this.getNameWithoutInstance(n)});for(const n of e.objects||[])n.name.endsWith("/")||i.push({folder:!1,name:n.name,nameWithoutInstance:this.getNameWithoutInstance(n.name),modified:n.created,objectUrl:this.storageClient.getObjectURL(this.bucket,n.name)});this.dataSource.data=i}isAllSelected(){const i=this.dataSource.filteredData.length;return this.selection.selected.length===i&&i>0}masterToggle(){this.isAllSelected()?this.selection.clear():this.dataSource.filteredData.forEach(e=>this.selection.select(e))}toggleOne(e){(!this.selection.isSelected(e)||this.selection.selected.length>1)&&this.selection.clear(),this.selection.toggle(e)}createDisplay(){this.dialog.open(Ma,{width:"400px",data:{path:this.getCurrentPath(),prefix:this.folderPerInstance?this.yamcs.instance+"/":""}}).afterClosed().subscribe(i=>{i&&this.router.navigateByUrl(`/telemetry/displays/files/${i}?c=${this.yamcs.context}`)})}createFolder(){this.dialog.open(Oa,{width:"400px",data:{bucket:this.bucket,path:this.getCurrentPath()}}).afterClosed().subscribe({next:()=>this.loadCurrentFolder()})}uploadFiles(){let e=this.getCurrentPath();e.startsWith("/")&&(e=e.substring(1));const i=this.uploaderEl.nativeElement.files,n=[];for(const s in i)if(!isNaN(parseInt(s,10))){const l=i[s],h=this.storageClient.uploadObject(this.bucket,(this.folderPerInstance?this.yamcs.instance+"/":"")+(e?e+"/"+l.name:l.name),l);n.push(h)}Promise.all(n).then(()=>this.loadCurrentFolder()).catch(s=>this.messageService.showError(s))}getCurrentPath(){let e="";for(const i of this.route.snapshot.url)e+="/"+i.path;return e||"/"}deleteSelectedDisplays(){const e=[],i=[];for(const n of this.selection.selected)n.folder?i.push(this.storageClient.listObjects(this.bucket,{prefix:n.name}).then(s=>{e.push(...(s.objects||[]).map(_=>_.name))})):e.push(n.name);Promise.all(i).then(()=>{if(confirm(`You are about to delete ${e.length} files. Are you sure you want to continue?`)){const n=[];for(const s of e)n.push(this.storageClient.deleteObject(this.bucket,s));Promise.all(n).then(()=>{this.loadCurrentFolder()})}})}renameFile(e){this.dialog.open($a,{data:{name:e.name},width:"400px"}).afterClosed().subscribe(n=>{n&&this.loadCurrentFolder()})}deleteFile(e){confirm(`Are you sure you want to delete ${e.nameWithoutInstance}?`)&&this.storageClient.deleteObject(this.bucket,e.name).then(()=>{this.loadCurrentFolder()})}dragEnter(e){return this.dragActive$.next(!0),e.preventDefault(),e.stopPropagation(),!1}dragOver(e){return e.preventDefault(),e.stopPropagation(),!1}dragLeave(e){return this.dragActive$.next(!1),e.preventDefault(),e.stopPropagation(),!1}drop(e){const i=e.dataTransfer||{};if(i){let n=this.getCurrentPath().substring(1);""!==n&&(n+="/"),Da.v(i).then(s=>{const l=[];for(const _ of s){let m=n+_._fullPath;this.folderPerInstance&&(m=this.yamcs.instance+"/"+m);const u=this.storageClient.uploadObject(this.bucket,m,_);l.push(u)}Promise.all(l).finally(()=>{this.loadCurrentFolder()})})}return this.dragActive$.next(!1),e.preventDefault(),e.stopPropagation(),!1}mayManageDisplays(){const e=this.authService.getUser();return e.hasObjectPrivilege("ManageBucket",this.bucket)||e.hasSystemPrivilege("ManageAnyBucket")}updateBrowsePath(){const e=[];let i="";for(const n of this.route.snapshot.url)i+="/"+n.path,e.push({name:n.path,route:"/telemetry/displays/browse"+i});return this.breadcrumb$.next(e),i||"/"}ngOnDestroy(){this.routerSubscription&&this.routerSubscription.unsubscribe()}static#t=this.\u0275fac=function(i){return new(i||a)(t.Y36(d.uw),t.Y36(o.C8),t.Y36(C.Dx),t.Y36(b.F0),t.Y36(b.gz),t.Y36(D.e),t.Y36(o.ez),t.Y36(o.E4))};static#e=this.\u0275cmp=t.Xpm({type:a,selectors:[["ng-component"]],viewQuery:function(i,n){if(1&i&&(t.Gf(Ra,7),t.Gf(Fa,5)),2&i){let s;t.iGM(s=t.CRH())&&(n.dropArea=s.first),t.iGM(s=t.CRH())&&(n.uploaderEl=s.first)}},decls:18,vars:17,consts:[["mat-button","","color","primary",3,"click",4,"ngIf"],["mat-button","","color","primary",3,"disabled","click",4,"ngIf"],[1,"droparea",3,"dragenter"],["droparea",""],[1,"droparea-overlay",3,"dragover","dragleave","drop"],[1,"panel-content"],[4,"ngIf"],["mat-table","","class","ya-data-table expand",3,"dataSource",4,"ngIf","ngIfElse"],["empty",""],["mat-button","","color","primary",3,"click"],["type","file","hidden","","multiple","",3,"change"],["uploader",""],["mat-button","","color","primary",3,"disabled","click"],["link","/telemetry/displays/browse","icon","account_tree",3,"queryParams"],[3,"link","queryParams","label",4,"ngFor","ngForOf"],[3,"link","queryParams","label"],["mat-table","",1,"ya-data-table","expand",3,"dataSource"],["cdkColumnDef","select"],["mat-header-cell","","class","checkbox",4,"cdkHeaderCellDef"],["mat-cell","","class","checkbox",4,"cdkCellDef"],["cdkColumnDef","name"],["mat-header-cell","",4,"cdkHeaderCellDef"],["mat-cell","",4,"cdkCellDef"],["cdkColumnDef","type"],["cdkColumnDef","visibility"],["cdkColumnDef","modified"],["matColumnDef","actions"],["mat-header-cell","","class","expand",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["mat-header-row","",4,"cdkHeaderRowDef"],["mat-row","",3,"selected","click",4,"cdkRowDef","cdkRowDefColumns"],["mat-header-cell","",1,"checkbox"],["type","checkbox",3,"checked","change",4,"ngIf"],["type","checkbox",3,"checked","change"],["mat-cell","",1,"checkbox"],["type","checkbox",3,"checked","click","change",4,"ngIf"],["type","checkbox",3,"checked","click","change"],["mat-header-cell",""],["mat-cell",""],[1,"icon12",2,"vertical-align","middle","margin-right","7px"],[3,"routerLink","queryParams","click"],["mat-header-cell","",1,"expand"],["mat-menu-item","",3,"click"],["mat-menu-item","","download","",3,"href"],["mat-header-row",""],["mat-row","",3,"click"]],template:function(i,n){if(1&i&&(t.TgZ(0,"app-instance-page")(1,"app-instance-toolbar"),t._uU(2," Displays \xa0\xa0\xa0 "),t.YNc(3,Va,4,0,"button",0),t.YNc(4,Ha,6,0,"button",0),t.YNc(5,Ea,4,0,"button",0),t.YNc(6,Ba,4,1,"button",1),t.qZA(),t.TgZ(7,"div",2,3),t.NdJ("dragenter",function(l){return n.dragEnter(l)}),t.ALo(9,"async"),t.TgZ(10,"div",4),t.NdJ("dragover",function(l){return n.dragOver(l)})("dragleave",function(l){return n.dragLeave(l)})("drop",function(l){return n.drop(l)}),t.ALo(11,"async"),t.qZA(),t.TgZ(12,"div",5),t.YNc(13,za,2,1,"ng-container",6),t.ALo(14,"async"),t.YNc(15,yi,21,3,"table",7),t.YNc(16,bi,2,0,"ng-template",null,8,t.W1O),t.qZA()()()),2&i){const s=t.MAs(17);t.xp6(3),t.Q6J("ngIf",n.mayManageDisplays()),t.xp6(1),t.Q6J("ngIf",n.mayManageDisplays()),t.xp6(1),t.Q6J("ngIf",n.mayManageDisplays()),t.xp6(1),t.Q6J("ngIf",n.mayManageDisplays()),t.xp6(1),t.ekj("active",t.lcZ(9,11,n.dragActive$)),t.xp6(3),t.ekj("hide",!t.lcZ(11,13,n.dragActive$)),t.xp6(3),t.Q6J("ngIf",t.lcZ(14,15,n.breadcrumb$)),t.xp6(2),t.Q6J("ngIf",n.dataSource&&n.dataSource.data.length)("ngIfElse",s)}},dependencies:[g.sg,g.O5,b.rH,Z.Sq,Z.O_,Z.D5,Z.fo,Z.s$,w.lW,P.Hw,M.d,S.OP,p.BZ,p.fO,p.w1,p.Dz,p.ge,p.ev,p.XQ,p.Gk,o.LI,o.O_,o.RR,o.cQ,k.a,U.k,g.Ov,o.id,o.XB,xt],styles:[".droparea[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;overflow:auto}.droparea-overlay[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;box-sizing:border-box;background:rgba(27,97,185,.1);border:1px solid rgba(27,97,185,1);z-index:10}"],changeDetection:0})}return a})(),At=(()=>{class a{static#t=this.\u0275fac=function(i){return new(i||a)};static#e=this.\u0275cmp=t.Xpm({type:a,selectors:[["app-display-page"]],decls:1,vars:0,template:function(i,n){1&i&&t._UZ(0,"router-outlet")},dependencies:[b.lC],encapsulation:2,changeDetection:0})}return a})(),St=(()=>{class a{static#t=this.\u0275fac=function(i){return new(i||a)};static#e=this.\u0275cmp=t.Xpm({type:a,selectors:[["app-displays-page"]],decls:1,vars:0,template:function(i,n){1&i&&t._UZ(0,"router-outlet")},dependencies:[b.lC],encapsulation:2,changeDetection:0})}return a})();var et=y(5094);const Ti=["hex"];function vi(a,r){if(1&a&&(t.TgZ(0,"tr")(1,"td",31)(2,"mat-icon",32),t._uU(3,"warning"),t.qZA()(),t.TgZ(4,"td",33),t._uU(5),t.qZA()()),2&a){const e=r.$implicit;t.xp6(5),t.Oqu(e)}}function Zi(a,r){if(1&a&&(t.ynx(0),t.TgZ(1,"h4"),t._uU(2,"Warnings"),t.qZA(),t.TgZ(3,"table",28),t.YNc(4,vi,6,1,"tr",29),t.qZA(),t.TgZ(5,"div",30),t._UZ(6,"mat-divider"),t.qZA(),t.BQk()),2&a){const e=t.oxw().ngIf;t.xp6(4),t.Q6J("ngForOf",e.messages)}}function Pi(a,r){1&a&&(t.TgZ(0,"th",34),t._uU(1,"#"),t.qZA())}function wi(a,r){if(1&a&&(t.ynx(0),t._uU(1),t.BQk()),2&a){const e=t.oxw().$implicit;t.xp6(1),t.AsE(" ",e.pval.location,"/",e.pval.size," ")}}function Ai(a,r){if(1&a&&(t.TgZ(0,"td",35),t.YNc(1,wi,2,2,"ng-container",0),t.qZA()),2&a){const e=r.$implicit;t.xp6(1),t.Q6J("ngIf",e.pval)}}function Si(a,r){1&a&&(t.TgZ(0,"th",34),t._uU(1,"Entry"),t.qZA())}const Ci=function(a){return["/telemetry/parameters/",a]},Ct=function(a){return{c:a}};function ki(a,r){if(1&a&&(t.ynx(0),t.TgZ(1,"a",36),t._UZ(2,"ya-highlight",37),t.qZA(),t.BQk()),2&a){const e=t.oxw().$implicit,i=t.oxw(3);t.xp6(1),t.Q6J("routerLink",t.VKq(4,Ci,e.pval.parameter.qualifiedName))("queryParams",t.VKq(6,Ct,i.yamcs.context)),t.xp6(1),t.Q6J("text",e.pval.parameter.qualifiedName)("term",i.filterForm.value.filter)}}function Ui(a,r){if(1&a&&(t.ynx(0),t._uU(1),t.BQk()),2&a){const e=t.oxw().$implicit;t.xp6(1),t.hij(" ",e.container.qualifiedName," ")}}function qi(a,r){if(1&a&&(t.TgZ(0,"td",35),t.YNc(1,ki,3,8,"ng-container",0),t.YNc(2,Ui,2,1,"ng-container",0),t.qZA()),2&a){const e=r.$implicit;t.xp6(1),t.Q6J("ngIf",e.pval),t.xp6(1),t.Q6J("ngIf",e.container)}}function Di(a,r){1&a&&(t.TgZ(0,"th",34),t._uU(1,"Type"),t.qZA())}function Ni(a,r){if(1&a&&(t.ynx(0),t._uU(1),t.BQk()),2&a){const e=t.oxw().$implicit;t.xp6(1),t.hij(" ",e.pval.parameter.type.engType," ")}}function Ii(a,r){1&a&&(t.ynx(0),t._uU(1," container "),t.BQk())}function Qi(a,r){if(1&a&&(t.TgZ(0,"td",38),t.YNc(1,Ni,2,1,"ng-container",0),t.YNc(2,Ii,2,0,"ng-container",0),t.qZA()),2&a){const e=r.$implicit;t.xp6(1),t.Q6J("ngIf",e.pval),t.xp6(1),t.Q6J("ngIf",e.container)}}function Li(a,r){1&a&&(t.TgZ(0,"th",34),t._uU(1,"Raw value"),t.qZA())}function Ji(a,r){if(1&a&&(t.ynx(0),t._UZ(1,"ya-value",40),t.BQk()),2&a){const e=t.oxw().$implicit;t.xp6(1),t.Q6J("value",e.pval.rawValue)}}function Yi(a,r){if(1&a&&(t.TgZ(0,"td",39),t.YNc(1,Ji,2,1,"ng-container",0),t.qZA()),2&a){const e=r.$implicit;t.xp6(1),t.Q6J("ngIf",e.pval)}}function Mi(a,r){1&a&&(t.TgZ(0,"th",34),t._uU(1,"Engineering value"),t.qZA())}function Oi(a,r){if(1&a&&(t.ynx(0),t._uU(1),t.ALo(2,"units"),t.BQk()),2&a){const e=r.ngIf;t.xp6(1),t.hij(" ",t.lcZ(2,1,e)," ")}}function $i(a,r){if(1&a&&(t.ynx(0),t._UZ(1,"ya-value",40),t.YNc(2,Oi,3,3,"ng-container",0),t.BQk()),2&a){const e=t.oxw().$implicit;t.xp6(1),t.Q6J("value",e.pval.engValue),t.xp6(1),t.Q6J("ngIf",null==e.pval.parameter||null==e.pval.parameter.type?null:e.pval.parameter.type.unitSet)}}function Ri(a,r){if(1&a&&(t.TgZ(0,"td",39),t.YNc(1,$i,3,2,"ng-container",0),t.qZA()),2&a){const e=r.$implicit;t.xp6(1),t.Q6J("ngIf",e.pval)}}function Fi(a,r){1&a&&t._UZ(0,"th",41)}function Vi(a,r){1&a&&(t.TgZ(0,"mat-icon",44),t._uU(1,"expand_more"),t.qZA())}function Hi(a,r){1&a&&(t.TgZ(0,"mat-icon",44),t._uU(1,"expand_less"),t.qZA())}function Ei(a,r){if(1&a&&(t.ynx(0),t.YNc(1,Vi,2,0,"mat-icon",43),t.YNc(2,Hi,2,0,"mat-icon",43),t.BQk()),2&a){const e=t.oxw().$implicit;t.xp6(1),t.Q6J("ngIf",!e.expanded),t.xp6(1),t.Q6J("ngIf",e.expanded)}}function Bi(a,r){if(1&a&&(t.TgZ(0,"td",42),t.YNc(1,Ei,3,2,"ng-container",0),t.qZA()),2&a){const e=r.$implicit;t.xp6(1),t.Q6J("ngIf",e.container)}}function Gi(a,r){1&a&&t._UZ(0,"tr",45)}function ji(a,r){if(1&a){const e=t.EpF();t.TgZ(0,"tr",46),t.NdJ("mouseover",function(){const s=t.CHM(e).$implicit,l=t.oxw(3);return t.KtG(l.highlightBitRange(s))})("mouseout",function(){t.CHM(e);const n=t.oxw(3);return t.KtG(n.clearHighlightedBitRange())})("click",function(){const s=t.CHM(e).$implicit,l=t.oxw(3);return t.KtG(l.toggleRow(s))}),t.qZA()}if(2&a){const e=r.$implicit;t.ekj("container",!!e.container)("pval",!!e.pval)("hide",e.pval&&!(null!=e.parent&&e.parent.expanded))}}function zi(a,r){if(1&a&&(t.TgZ(0,"div",7),t.YNc(1,Zi,7,1,"ng-container",0),t.TgZ(2,"form",8)(3,"div",9),t._UZ(4,"ya-search-filter",10)(5,"ya-column-chooser",11,12),t.qZA()(),t.TgZ(7,"table",13),t.ynx(8,14),t.YNc(9,Pi,2,0,"th",15),t.YNc(10,Ai,2,1,"td",16),t.BQk(),t.ynx(11,17),t.YNc(12,Si,2,0,"th",15),t.YNc(13,qi,3,2,"td",16),t.BQk(),t.ynx(14,18),t.YNc(15,Di,2,0,"th",15),t.YNc(16,Qi,3,2,"td",19),t.BQk(),t.ynx(17,20),t.YNc(18,Li,2,0,"th",15),t.YNc(19,Yi,2,1,"td",21),t.BQk(),t.ynx(20,22),t.YNc(21,Mi,2,0,"th",15),t.YNc(22,Ri,2,1,"td",21),t.BQk(),t.ynx(23,23),t.YNc(24,Fi,1,0,"th",24),t.YNc(25,Bi,2,1,"td",25),t.BQk(),t.YNc(26,Gi,1,0,"tr",26),t.ALo(27,"async"),t.YNc(28,ji,1,6,"tr",27),t.ALo(29,"async"),t.qZA()()),2&a){const e=r.ngIf,i=t.MAs(6),n=t.oxw(2);t.xp6(1),t.Q6J("ngIf",null==e.messages?null:e.messages.length),t.xp6(1),t.Q6J("formGroup",n.filterForm),t.xp6(3),t.Q6J("columns",n.columns),t.xp6(2),t.Q6J("dataSource",n.dataSource),t.xp6(19),t.Q6J("matHeaderRowDef",t.lcZ(27,6,i.displayedColumns$)),t.xp6(2),t.Q6J("matRowDefColumns",t.lcZ(29,8,i.displayedColumns$))}}function Ki(a,r){if(1&a&&(t.TgZ(0,"app-instance-page")(1,"app-instance-toolbar")(2,"a",1)(3,"mat-icon"),t._uU(4,"arrow_back"),t.qZA()(),t._uU(5),t.qZA(),t.TgZ(6,"ya-detail-pane")(7,"ya-detail-toolbar"),t._uU(8," Hex view "),t.qZA(),t.TgZ(9,"div",2),t._UZ(10,"app-hex",3,4),t.qZA()(),t.TgZ(12,"div",5),t.YNc(13,zi,30,10,"div",6),t.ALo(14,"async"),t.qZA()()),2&a){const e=r.ngIf,i=t.oxw();t.xp6(2),t.Q6J("queryParams",t.VKq(8,Ct,i.yamcs.context)),t.xp6(3),t.lnq(" ",e.id.name," / ",e.generationTime," / ",e.sequenceNumber," "),t.xp6(5),t.Q6J("base64String",e.packet),t.xp6(3),t.Q6J("ngIf",t.lcZ(14,6,i.result$))}}let kt=(()=>{class a{constructor(e,i,n,s){this.route=i,this.yamcs=n,this.filterForm=new c.nJ({filter:new c.p4,type:new c.p4("ANY")}),this.packet$=new f.X(null),this.result$=new f.X(null),this.dataSource=new p.by,this.columns=[{id:"position",label:"Position",visible:!0},{id:"entry",label:"Entry",alwaysVisible:!0},{id:"type",label:"Type",visible:!0},{id:"rawValue",label:"Raw value",visible:!1},{id:"engValue",label:"Engineering value",visible:!0},{id:"actions",label:"",alwaysVisible:!0}],this.typeOptions=[{id:"ANY",label:"Any type"},{id:"aggregate",label:"aggregate"},{id:"array",label:"array"},{id:"binary",label:"binary"},{id:"boolean",label:"boolean"},{id:"enumeration",label:"enumeration"},{id:"float",label:"float"},{id:"integer",label:"integer"},{id:"string",label:"string"},{id:"time",label:"time"}];const l=decodeURIComponent(i.snapshot.paramMap.get("pname")),_=i.snapshot.paramMap.get("gentime"),m=Number(i.snapshot.paramMap.get("seqno"));e.setTitle(l),this.dataSource.filterPredicate=(u,h)=>!u.pval||u.pval.parameter.qualifiedName.toLowerCase().indexOf(h)>=0,n.yamcsClient.getPacket(n.instance,l,_,m).then(u=>{this.packet$.next(u)}).catch(u=>s.showError(u)),n.yamcsClient.extractPacket(n.instance,l,_,m).then(u=>{this.result$.next(u);const h=[];let x;for(const v of u.parameterValues){if(v.entryContainer.qualifiedName!==x?.container?.qualifiedName){const R={type:"CONTAINER",container:v.entryContainer,expanded:!1};h.push(R),x=R}h.push({type:"PARAMETER",pval:v,parent:x,expanded:!1})}x&&(x.expanded=!0),this.dataSource.data=h}).catch(u=>s.showError(u))}ngAfterViewInit(){this.filterForm.valueChanges.subscribe(e=>{this.dataSource.filter=(e.filter??"").toLowerCase()})}get hex(){return this._hex}set hex(e){this._hex=e}highlightBitRange(e){if(e.pval){const{pval:i}=e;this.hex?.setHighlight(new o.rf(i.location,i.size))}}clearHighlightedBitRange(){this.hex?.setHighlight(null)}toggleRow(e){e.container&&(e.expanded=!e.expanded)}static#t=this.\u0275fac=function(i){return new(i||a)(t.Y36(C.Dx),t.Y36(b.gz),t.Y36(o.C8),t.Y36(o.ez))};static#e=this.\u0275cmp=t.Xpm({type:a,selectors:[["ng-component"]],viewQuery:function(i,n){if(1&i&&t.Gf(Ti,5),2&i){let s;t.iGM(s=t.CRH())&&(n.hex=s.first)}},decls:2,vars:3,consts:[[4,"ngIf"],["mat-icon-button","","routerLink","../../..","color","primary",3,"queryParams"],[2,"padding","0 16px"],[3,"base64String"],["hex",""],[1,"table-wrapper"],["class","panel-content",4,"ngIf"],[1,"panel-content"],[3,"formGroup"],[1,"filter-bar"],["formControlName","filter","placeholder","Filter parameters"],["preferenceKey","packet.extract",3,"columns"],["columnChooser",""],["mat-table","",1,"ya-data-table","expand",3,"dataSource"],["matColumnDef","position"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","entry"],["matColumnDef","type"],["mat-cell","","class","mono",4,"matCellDef"],["matColumnDef","rawValue"],["mat-cell","","class","wrap400",4,"matCellDef"],["matColumnDef","engValue"],["matColumnDef","actions"],["mat-header-cell","","class","expand",4,"matHeaderCellDef"],["mat-cell","","style","text-align: right",4,"matCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",3,"container","pval","hide","mouseover","mouseout","click",4,"matRowDef","matRowDefColumns"],["yaDataTable","",1,"expand"],[4,"ngFor","ngForOf"],[1,"section-divider"],[1,"iconcol"],[1,"icon12"],[1,"expand"],["mat-header-cell",""],["mat-cell",""],[1,"ya-link",3,"routerLink","queryParams"],[3,"text","term"],["mat-cell","",1,"mono"],["mat-cell","",1,"wrap400"],[3,"value"],["mat-header-cell","",1,"expand"],["mat-cell","",2,"text-align","right"],["style","vertical-align: middle",4,"ngIf"],[2,"vertical-align","middle"],["mat-header-row",""],["mat-row","",3,"mouseover","mouseout","click"]],template:function(i,n){1&i&&(t.YNc(0,Ki,15,10,"app-instance-page",0),t.ALo(1,"async")),2&i&&t.Q6J("ngIf",t.lcZ(1,1,n.packet$))},dependencies:[g.sg,g.O5,c._Y,c.JJ,c.JL,c.sg,c.u,b.rH,o.Gj,w.o6,P.Hw,M.d,p.BZ,p.fO,p.as,p.w1,p.Dz,p.nj,p.ge,p.ev,p.XQ,p.Gk,o.b8,o.J8,o.MD,o.oQ,o.cF,o.u$,et.p,k.a,U.k,g.Ov,o.HQ],styles:[".detail[_ngcontent-%COMP%]{background-color:#fcfcfc;float:right;height:100%;width:450px;overflow:auto;border-left:1px solid #d3d3d3;box-sizing:border-box}.table-wrapper[_ngcontent-%COMP%]{position:relative;overflow:auto;height:100%}tr.container[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{background-color:#f0f0f0;cursor:pointer}tr.container[_ngcontent-%COMP%]:hover   td[_ngcontent-%COMP%]{background-color:#f0f0f0!important}"],changeDetection:0})}return a})();class Xi{constructor(){this.dirty=!1,this.archivePackets=[]}addArchiveData(r){this.archivePackets=this.archivePackets.concat(r),this.dirty=!0}reset(){this.archivePackets=[],this.dirty=!0}snapshot(){return this.archivePackets}}class Wi extends q.o2{constructor(r,e){super(),this.yamcs=r,this.pageSize=100,this.blockHasMore=!1,this.packets$=new f.X([]),this.loading$=new f.X(!1),this.syncSubscription=e.sync(()=>{this.buffer.dirty&&!this.loading$.getValue()&&(this.packets$.next(this.buffer.snapshot()),this.buffer.dirty=!1)}),this.buffer=new Xi}connect(){return this.packets$}loadEntries(r,e){return this.loading$.next(!0),this.loadPage({...e,limit:this.pageSize}).then(i=>{this.loading$.next(!1),this.buffer.reset(),this.blockHasMore=!1,this.buffer.addArchiveData(i)})}hasMore(){return!!this.continuationToken&&!this.blockHasMore}loadPage(r){return this.yamcs.yamcsClient.getPackets(this.yamcs.instance,r).then(e=>(this.continuationToken=e.continuationToken,e.packet||[]))}loadMoreData(r){this.continuationToken&&this.loadPage({...r,next:this.continuationToken,limit:this.pageSize}).then(e=>{this.buffer.addArchiveData(e)})}disconnect(){this.syncSubscription?.unsubscribe(),this.packets$.complete(),this.loading$.complete()}isEmpty(){return!this.packets$.getValue().length}}var Ut=y(342),at=y(1274);const tn=["intervalSelect"];function en(a,r){if(1&a&&(t.ynx(0),t._uU(1),t.ALo(2,"deltaWith"),t.BQk()),2&a){const e=t.oxw().ngIf;t.xp6(1),t.hij(" (",t.xi3(2,1,e.earthReceptionTime,e.generationTime),") ")}}function an(a,r){if(1&a){const e=t.EpF();t.ynx(0),t.TgZ(1,"ya-detail-toolbar"),t._uU(2," Packet Detail "),t.qZA(),t.TgZ(3,"div",36)(4,"div",37),t._uU(5,"Packet name"),t.qZA(),t.TgZ(6,"div",38),t._uU(7),t.qZA(),t.TgZ(8,"div",37),t._uU(9,"Generation time"),t.qZA(),t.TgZ(10,"div",38),t._uU(11),t.ALo(12,"datetime"),t.qZA(),t.TgZ(13,"div",37),t._uU(14,"Earth reception time"),t.qZA(),t.TgZ(15,"div",38),t._uU(16),t.ALo(17,"datetime"),t.YNc(18,en,3,4,"ng-container",15),t.qZA(),t.TgZ(19,"div",37),t._uU(20,"Reception time"),t.qZA(),t.TgZ(21,"div",38),t._uU(22),t.ALo(23,"datetime"),t.ALo(24,"deltaWith"),t.qZA(),t.TgZ(25,"div",37),t._uU(26,"Link"),t.qZA(),t.TgZ(27,"div",38),t._uU(28),t.qZA(),t.TgZ(29,"div",37),t._uU(30,"Size"),t.qZA(),t.TgZ(31,"div",38),t._uU(32),t.ALo(33,"formatBytes"),t.ALo(34,"binarySize"),t.qZA(),t.TgZ(35,"div",37),t._uU(36," Data "),t.TgZ(37,"ya-more",39)(38,"button",40),t.NdJ("click",function(){const s=t.CHM(e).ngIf,l=t.oxw();return t.KtG(l.copyHex(s))}),t._uU(39," Copy Hex "),t.qZA(),t.TgZ(40,"button",40),t.NdJ("click",function(){const s=t.CHM(e).ngIf,l=t.oxw();return t.KtG(l.copyBinary(s))}),t._uU(41," Copy Binary "),t.qZA(),t._UZ(42,"mat-divider"),t.TgZ(43,"ya-download-menu-item",2),t.ALo(44,"packetDownloadLink"),t._uU(45," Download "),t.qZA()()(),t.TgZ(46,"div",41),t._UZ(47,"app-hex",42,43),t.qZA()(),t.BQk()}if(2&a){const e=r.ngIf;t.xp6(7),t.hij(" ",e.id.name," "),t.xp6(4),t.hij(" ",t.lcZ(12,10,e.generationTime)," "),t.xp6(5),t.hij(" ",t.lcZ(17,12,e.earthReceptionTime)||"-"," "),t.xp6(2),t.Q6J("ngIf",e.earthReceptionTime),t.xp6(4),t.AsE(" ",t.lcZ(23,14,e.receptionTime)," (",t.xi3(24,16,e.receptionTime,e.generationTime),") "),t.xp6(6),t.hij(" ",e.link||"-"," "),t.xp6(4),t.hij(" ",t.lcZ(33,19,t.lcZ(34,21,e.packet))," "),t.xp6(11),t.Q6J("link",t.lcZ(44,23,e)),t.xp6(4),t.Q6J("base64String",e.packet)}}function nn(a,r){1&a&&(t.TgZ(0,"ya-detail-toolbar"),t._uU(1," Select a packet "),t.qZA())}function rn(a,r){if(1&a){const e=t.EpF();t.ynx(0),t._UZ(1,"ya-date-time-input",44)(2,"ya-date-time-input",45),t.TgZ(3,"button",35),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.applyCustomDates())}),t._uU(4,"Apply"),t.qZA(),t.BQk()}if(2&a){const e=t.oxw();t.xp6(3),t.Q6J("disabled",e.filterForm.invalid)}}function sn(a,r){if(1&a){const e=t.EpF();t.ynx(0),t.TgZ(1,"button",46),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.jumpToNow())}),t._uU(2," Jump to now "),t.qZA(),t.BQk()}}function on(a,r){1&a&&t._UZ(0,"ya-dots")}function ln(a,r){1&a&&(t.TgZ(0,"th",47),t._uU(1,"Packet name"),t.qZA())}function cn(a,r){if(1&a&&(t.TgZ(0,"td",48),t._uU(1),t.qZA()),2&a){const e=r.$implicit;t.xp6(1),t.hij(" ",e.id.name," ")}}function _n(a,r){1&a&&(t.TgZ(0,"th",47),t._uU(1,"Generation time"),t.qZA())}function pn(a,r){if(1&a&&(t.TgZ(0,"td",48),t._uU(1),t.ALo(2,"datetime"),t.qZA()),2&a){const e=r.$implicit;t.xp6(1),t.hij(" ",t.lcZ(2,1,e.generationTime)," ")}}function mn(a,r){1&a&&(t.TgZ(0,"th",47),t._uU(1,"Seq"),t.qZA())}function un(a,r){if(1&a&&(t.TgZ(0,"td",48),t._uU(1),t.qZA()),2&a){const e=r.$implicit;let i;t.xp6(1),t.hij(" ",null!==(i=e.sequenceNumber)&&void 0!==i?i:"-"," ")}}function gn(a,r){1&a&&(t.TgZ(0,"th",47),t._uU(1,"Earth reception time"),t.qZA())}function dn(a,r){if(1&a&&(t.TgZ(0,"td",48),t._uU(1),t.ALo(2,"datetime"),t.qZA()),2&a){const e=r.$implicit;t.xp6(1),t.hij(" ",t.lcZ(2,1,e.earthReceptionTime)||"-"," ")}}function hn(a,r){1&a&&(t.TgZ(0,"th",47),t._uU(1,"Reception time"),t.qZA())}function fn(a,r){if(1&a&&(t.TgZ(0,"td",48),t._uU(1),t.ALo(2,"datetime"),t.qZA()),2&a){const e=r.$implicit;t.xp6(1),t.hij(" ",t.lcZ(2,1,e.receptionTime)," ")}}function xn(a,r){1&a&&(t.TgZ(0,"th",47),t._uU(1,"Link"),t.qZA())}function yn(a,r){if(1&a&&(t.TgZ(0,"td",48),t._uU(1),t.qZA()),2&a){const e=r.$implicit;t.xp6(1),t.hij(" ",e.link||"-"," ")}}function bn(a,r){1&a&&(t.TgZ(0,"th",47),t._uU(1,"Size"),t.qZA())}function Tn(a,r){if(1&a&&(t.TgZ(0,"td",48),t._uU(1),t.ALo(2,"formatBytes"),t.ALo(3,"binarySize"),t.qZA()),2&a){const e=r.$implicit;t.xp6(1),t.hij(" ",t.lcZ(2,1,t.lcZ(3,3,e.packet))," ")}}function vn(a,r){1&a&&(t.TgZ(0,"th",47),t._uU(1,"Data"),t.qZA())}function Zn(a,r){if(1&a&&(t.TgZ(0,"td",49),t._uU(1),t.ALo(2,"hex"),t.qZA()),2&a){const e=r.$implicit;t.xp6(1),t.hij(" ",t.lcZ(2,1,e.packet)," ")}}function Pn(a,r){1&a&&t._UZ(0,"th",50)}function wn(a,r){if(1&a){const e=t.EpF();t.TgZ(0,"td",48)(1,"ya-text-action",51),t.NdJ("click",function(){const s=t.CHM(e).$implicit,l=t.oxw();return t.KtG(l.extractPacket(s))}),t._uU(2," Extract "),t.qZA(),t.TgZ(3,"ya-more")(4,"button",40),t.NdJ("click",function(){const s=t.CHM(e).$implicit,l=t.oxw();return t.KtG(l.copyHex(s))}),t._uU(5," Copy Hex "),t.qZA(),t.TgZ(6,"button",40),t.NdJ("click",function(){const s=t.CHM(e).$implicit,l=t.oxw();return t.KtG(l.copyBinary(s))}),t._uU(7," Copy Binary "),t.qZA(),t._UZ(8,"mat-divider"),t.TgZ(9,"ya-download-menu-item",2),t.ALo(10,"packetDownloadLink"),t._uU(11," Download "),t.qZA()()()}if(2&a){const e=r.$implicit;t.xp6(9),t.Q6J("link",t.lcZ(10,1,e))}}function An(a,r){1&a&&t._UZ(0,"tr",52)}function Sn(a,r){if(1&a){const e=t.EpF();t.TgZ(0,"tr",53),t.NdJ("click",function(){const s=t.CHM(e).$implicit,l=t.oxw();return t.KtG(l.selectPacket(s))}),t.ALo(1,"async"),t.qZA()}if(2&a){const e=r.$implicit,i=t.oxw();t.ekj("selected",t.lcZ(1,3,i.detailPacket$)===e),t.Q6J("@rowAnimation",e.animate)}}const O="PT1H";let qt=(()=>{class a{constructor(e,i,n,s,l,_){this.yamcs=e,this.router=i,this.route=n,this.clipboard=_,this.columns=[{id:"packetName",label:"Packet name",alwaysVisible:!0},{id:"generationTime",label:"Generation time",alwaysVisible:!0},{id:"earthReceptionTime",label:"Earth reception time",visible:!1},{id:"receptionTime",label:"Reception time",visible:!0},{id:"sequenceNumber",label:"Sequence number",visible:!1},{id:"link",label:"Link",visible:!0},{id:"data",label:"Data",visible:!1},{id:"size",label:"Size",visible:!0},{id:"actions",label:"",alwaysVisible:!0}],this.filterForm=new c.nJ({name:new c.p4("ANY"),link:new c.p4("ANY"),interval:new c.p4(O),customStart:new c.p4(null),customStop:new c.p4(null)}),this.detailPacket$=new f.X(null),this.nameOptions$=new f.X([{id:"ANY",label:"Any name"}]),this.linkOptions$=new f.X([{id:"ANY",label:"Any link"}]),this.intervalOptions=[{id:"PT1H",label:"Last hour"},{id:"PT6H",label:"Last 6 hours"},{id:"P1D",label:"Last 24 hours"},{id:"NO_LIMIT",label:"No limit"},{id:"CUSTOM",label:"Custom",group:!0}],this.downloadURL$=new f.X(null),s.setTitle("Packets"),this.dataSource=new Wi(this.yamcs,l),e.yamcsClient.getPacketNames(e.instance).then(m=>{for(const u of m.packets||[])this.nameOptions$.next([...this.nameOptions$.value,{id:u,label:u}]);for(const u of m.links||[])this.linkOptions$.next([...this.linkOptions$.value,{id:u,label:u}])}),this.initializeOptions(),this.loadData(),this.filterForm.get("name").valueChanges.forEach(m=>{this.name="ANY"!==m?m:null,this.loadData()}),this.filterForm.get("link").valueChanges.forEach(m=>{this.link="ANY"!==m?m:null,this.loadData()}),this.filterForm.get("interval").valueChanges.forEach(m=>{if("CUSTOM"===m){const u=this.validStart||this.yamcs.getMissionTime(),h=this.validStop||this.yamcs.getMissionTime();this.filterForm.get("customStart").setValue(o.P6.toISOString(u)),this.filterForm.get("customStop").setValue(o.P6.toISOString(h))}else"NO_LIMIT"===m?(this.validStart=null,this.validStop=null,this.appliedInterval=m,this.loadData()):(this.validStop=e.getMissionTime(),this.validStart=o.P6.subtractDuration(this.validStop,m),this.appliedInterval=m,this.loadData())}),this.dataSource.packets$.subscribe(m=>{m&&m.length&&this.jumpToNow()})}initializeOptions(){const e=this.route.snapshot.queryParamMap;if(e.has("name")&&(this.name=e.get("name")||"",this.filterForm.get("name").setValue(this.name)),e.has("link")&&(this.link=e.get("link")||"",this.filterForm.get("link").setValue(this.link)),e.has("interval"))if(this.appliedInterval=e.get("interval"),this.filterForm.get("interval").setValue(this.appliedInterval),"CUSTOM"===this.appliedInterval){const i=e.get("customStart");this.filterForm.get("customStart").setValue(i),this.validStart=new Date(i);const n=e.get("customStop");this.filterForm.get("customStop").setValue(n),this.validStop=new Date(n)}else"NO_LIMIT"===this.appliedInterval?(this.validStart=null,this.validStop=null):(this.validStop=this.yamcs.getMissionTime(),this.validStart=o.P6.subtractDuration(this.validStop,this.appliedInterval));else this.appliedInterval=O,this.validStop=this.yamcs.getMissionTime(),this.validStart=o.P6.subtractDuration(this.validStop,O)}jumpToNow(){const e=this.filterForm.value.interval;"NO_LIMIT"===e||"CUSTOM"===e?this.filterForm.get("interval").setValue(O):(this.validStop=this.yamcs.getMissionTime(),this.validStart=o.P6.subtractDuration(this.validStop,e),this.loadData())}applyCustomDates(){this.validStart=o.P6.toDate(this.filterForm.value.customStart),this.validStop=o.P6.toDate(this.filterForm.value.customStop),this.appliedInterval="CUSTOM",this.loadData()}loadData(){this.updateURL();const e={};this.validStart&&(e.start=this.validStart.toISOString()),this.validStop&&(e.stop=this.validStop.toISOString()),this.name&&(e.name=this.name),this.link&&(e.link=this.link);const i={};this.validStart&&(i.start=this.validStart.toISOString()),this.validStop&&(i.stop=this.validStop.toISOString()),this.name&&(i.name=this.name),this.link&&(i.link=this.link),this.dataSource.loadEntries("realtime",e).then(n=>{const s=this.yamcs.yamcsClient.getPacketsDownloadURL(this.yamcs.instance,i);this.downloadURL$.next(s)})}loadMoreData(){const e={};this.validStart&&(e.start=this.validStart.toISOString()),this.name&&(e.name=this.name),this.link&&(e.link=this.link),this.dataSource.loadMoreData(e)}copyHex(e){const i=o.P6.convertBase64ToHex(e.packet);this.clipboard.copy(i)}copyBinary(e){const i=window.atob(e.packet);this.clipboard.copy(i)}updateURL(){this.router.navigate([],{replaceUrl:!0,relativeTo:this.route,queryParams:{name:this.name||null,link:this.link||null,interval:this.appliedInterval,customStart:"CUSTOM"===this.appliedInterval?this.filterForm.value.customStart:null,customStop:"CUSTOM"===this.appliedInterval?this.filterForm.value.customStop:null},queryParamsHandling:"merge"})}selectPacket(e){this.detailPacket$.next(e)}extractPacket(e){this.router.navigate([encodeURIComponent(e.id.name),e.generationTime,e.sequenceNumber],{relativeTo:this.route,queryParams:{c:this.yamcs.context}})}static#t=this.\u0275fac=function(i){return new(i||a)(t.Y36(o.C8),t.Y36(b.F0),t.Y36(b.gz),t.Y36(C.Dx),t.Y36(o.jF),t.Y36(Ut.TU))};static#e=this.\u0275cmp=t.Xpm({type:a,selectors:[["ng-component"]],viewQuery:function(i,n){if(1&i&&t.Gf(tn,5),2&i){let s;t.iGM(s=t.CRH())&&(n.intervalSelect=s.first)}},decls:74,vars:33,consts:[[1,"ya-menu"],["exportMenu","matMenu"],[3,"link"],["mat-button","","color","primary",3,"matMenuTriggerFor","disabled"],["mat-icon-button","","matTooltip","Jump to now","color","primary",3,"click"],[4,"ngIf","ngIfElse"],["noSelection",""],[1,"table-wrapper"],[1,"panel-content"],[3,"formGroup"],[1,"filter-bar"],["formControlName","name",3,"options"],["formControlName","link",3,"options"],["icon","access_time","formControlName","interval",3,"options"],["intervalSelect",""],[4,"ngIf"],["preferenceKey","tmPackets",3,"columns"],["columnChooser",""],["mat-table","",1,"ya-data-table","expand",3,"dataSource"],["matColumnDef","packetName"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","generationTime"],["matColumnDef","sequenceNumber"],["matColumnDef","earthReceptionTime"],["matColumnDef","receptionTime"],["matColumnDef","link"],["matColumnDef","size"],["matColumnDef","data"],["mat-cell","","class","mono",4,"matCellDef"],["matColumnDef","actions"],["mat-header-cell","","class","expand",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",3,"selected","click",4,"matRowDef","matRowDefColumns"],[2,"flex","1 1 auto"],[1,"ya-button",3,"disabled","click"],[2,"padding","0 16px"],[1,"block-title"],[1,"block"],["icon","more_horiz"],["mat-menu-item","",3,"click"],[1,"block",2,"margin-top","4px"],[3,"base64String"],["hexdump",""],["formControlName","customStart"],["formControlName","customStop"],[1,"ya-button",3,"click"],["mat-header-cell",""],["mat-cell",""],["mat-cell","",1,"mono"],["mat-header-cell","",1,"expand"],["icon","output",3,"click"],["mat-header-row",""],["mat-row","",3,"click"]],template:function(i,n){if(1&i&&(t.TgZ(0,"app-instance-page")(1,"app-instance-toolbar"),t._uU(2," Packets \xa0\xa0\xa0 "),t.TgZ(3,"mat-menu",0,1)(5,"ya-download-menu-item",2),t.ALo(6,"async"),t._uU(7," Raw dump "),t.qZA()(),t.TgZ(8,"button",3),t.ALo(9,"async"),t.TgZ(10,"mat-icon"),t._uU(11,"save_alt"),t.qZA(),t._uU(12," Export "),t.qZA(),t.TgZ(13,"button",4),t.NdJ("click",function(){return n.jumpToNow()}),t.TgZ(14,"mat-icon"),t._uU(15,"refresh"),t.qZA()()(),t.TgZ(16,"ya-detail-pane"),t.YNc(17,an,49,25,"ng-container",5),t.ALo(18,"async"),t.YNc(19,nn,2,0,"ng-template",null,6,t.W1O),t.qZA(),t.TgZ(21,"div",7)(22,"div",8)(23,"form",9)(24,"div",10),t._UZ(25,"ya-select",11),t.ALo(26,"async"),t._UZ(27,"ya-select",12),t.ALo(28,"async"),t._UZ(29,"ya-select",13,14),t.YNc(31,rn,5,1,"ng-container",15),t.YNc(32,sn,3,0,"ng-container",15),t._UZ(33,"ya-column-chooser",16,17),t.YNc(35,on,1,0,"ya-dots",15),t.ALo(36,"async"),t.qZA()(),t.TgZ(37,"table",18),t.ynx(38,19),t.YNc(39,ln,2,0,"th",20),t.YNc(40,cn,2,1,"td",21),t.BQk(),t.ynx(41,22),t.YNc(42,_n,2,0,"th",20),t.YNc(43,pn,3,3,"td",21),t.BQk(),t.ynx(44,23),t.YNc(45,mn,2,0,"th",20),t.YNc(46,un,2,1,"td",21),t.BQk(),t.ynx(47,24),t.YNc(48,gn,2,0,"th",20),t.YNc(49,dn,3,3,"td",21),t.BQk(),t.ynx(50,25),t.YNc(51,hn,2,0,"th",20),t.YNc(52,fn,3,3,"td",21),t.BQk(),t.ynx(53,26),t.YNc(54,xn,2,0,"th",20),t.YNc(55,yn,2,1,"td",21),t.BQk(),t.ynx(56,27),t.YNc(57,bn,2,0,"th",20),t.YNc(58,Tn,4,5,"td",21),t.BQk(),t.ynx(59,28),t.YNc(60,vn,2,0,"th",20),t.YNc(61,Zn,3,3,"td",29),t.BQk(),t.ynx(62,30),t.YNc(63,Pn,1,0,"th",31),t.YNc(64,wn,12,3,"td",21),t.BQk(),t.YNc(65,An,1,0,"tr",32),t.ALo(66,"async"),t.YNc(67,Sn,2,5,"tr",33),t.ALo(68,"async"),t.qZA(),t.TgZ(69,"mat-toolbar"),t._UZ(70,"span",34),t.TgZ(71,"button",35),t.NdJ("click",function(){return n.loadMoreData()}),t._uU(72,"Load More"),t.qZA(),t._UZ(73,"span",34),t.qZA()()()()),2&i){const s=t.MAs(4),l=t.MAs(20),_=t.MAs(34);let m;t.xp6(5),t.Q6J("link",t.lcZ(6,17,n.downloadURL$)),t.xp6(3),t.Q6J("matMenuTriggerFor",s)("disabled",!(null!=(m=t.lcZ(9,19,n.dataSource.packets$))&&m.length)),t.xp6(9),t.Q6J("ngIf",t.lcZ(18,21,n.detailPacket$))("ngIfElse",l),t.xp6(6),t.Q6J("formGroup",n.filterForm),t.xp6(2),t.Q6J("options",t.lcZ(26,23,n.nameOptions$)),t.xp6(2),t.Q6J("options",t.lcZ(28,25,n.linkOptions$)),t.xp6(2),t.Q6J("options",n.intervalOptions),t.xp6(2),t.Q6J("ngIf","CUSTOM"===n.filterForm.value.interval),t.xp6(1),t.Q6J("ngIf","CUSTOM"!==n.filterForm.value.interval),t.xp6(1),t.Q6J("columns",n.columns),t.xp6(2),t.Q6J("ngIf",t.lcZ(36,27,n.dataSource.loading$)),t.xp6(2),t.Q6J("dataSource",n.dataSource),t.xp6(28),t.Q6J("matHeaderRowDef",t.lcZ(66,29,_.displayedColumns$)),t.xp6(2),t.Q6J("matRowDefColumns",t.lcZ(68,31,_.displayedColumns$)),t.xp6(4),t.Q6J("disabled",!n.dataSource.hasMore())}},dependencies:[g.O5,c._Y,c.JJ,c.JL,c.sg,c.u,w.lW,w.RK,P.Hw,M.d,S.VK,S.OP,S.p6,p.BZ,p.fO,p.as,p.w1,p.Dz,p.nj,p.ge,p.ev,p.XQ,p.Gk,at.Ye,X.gM,o.b8,o.t,o.J8,o.MD,o.Zy,o.U9,o.cQ,o.Hr,o.ll,et.p,k.a,U.k,g.Ov,o.nz,o.id,o.mX,o.bP,o.l0,yt],styles:[".detail[_ngcontent-%COMP%]{background-color:#fcfcfc;float:right;height:100%;width:450px;overflow:auto;border-left:1px solid #d3d3d3;box-sizing:border-box}.table-wrapper[_ngcontent-%COMP%]{position:relative;overflow:auto;height:100%}"],data:{animation:[o.q5]},changeDetection:0})}return a})();function Cn(a,r){1&a&&(t.TgZ(0,"tr")(1,"td",12),t._uU(2,"No rows to display"),t.qZA()())}function kn(a,r){if(1&a){const e=t.EpF();t.TgZ(0,"tr")(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td",13)(4,"ya-icon-action",14),t.NdJ("click",function(n){const l=t.CHM(e).index;return t.oxw(2).moveDown(l),t.KtG(n.stopPropagation())}),t.qZA(),t.TgZ(5,"ya-icon-action",15),t.NdJ("click",function(n){const l=t.CHM(e).index;return t.oxw(2).moveUp(l),t.KtG(n.stopPropagation())}),t.qZA(),t.TgZ(6,"ya-text-action",16),t.NdJ("click",function(){const s=t.CHM(e).index,l=t.oxw(2);return t.KtG(l.deletePattern(s))}),t._uU(7,"DELETE"),t.qZA()()()}if(2&a){const e=r.$implicit;t.xp6(2),t.Oqu(e)}}function Un(a,r){if(1&a&&(t.TgZ(0,"table",9)(1,"tr")(2,"th"),t._uU(3,"Pattern"),t.qZA(),t._UZ(4,"th"),t.qZA(),t.YNc(5,Cn,3,0,"tr",10),t.YNc(6,kn,8,1,"tr",11),t.qZA()),2&a){const e=r.ngIf;t.xp6(5),t.Q6J("ngIf",!e.length),t.xp6(1),t.Q6J("ngForOf",e)}}const qn=function(a){return{c:a}};let Dt=(()=>{class a{constructor(e,i,n,s,l,_,m,u){this.router=n,this.route=s,this.yamcs=l,this.dialog=_,this.messageService=m,this.location=u,this.patterns$=new f.X([]),i.setTitle("Create a Parameter List"),this.form=e.group({name:new c.p4("",[c.kI.required]),description:new c.p4})}showAddPatternDialog(){this.dialog.open(H.M,{width:"500px",data:{label:"Add parameter or pattern",okLabel:"ADD",hint:"Either an exact parameter name, or a glob pattern with *, **, or ? wildcards."}}).afterClosed().subscribe(i=>{i&&this.patterns$.next([...this.patterns$.value,i])})}deletePattern(e){this.patterns$.value.splice(e,1),this.patterns$.next([...this.patterns$.value])}moveUp(e){const i=this.patterns$.value,n=i[e];0===e?(i[e]=i[i.length-1],i[i.length-1]=n):(i[e]=i[e-1],i[e-1]=n),this.patterns$.next([...this.patterns$.value])}moveDown(e){const i=this.patterns$.value,n=i[e];e===i.length-1?(i[e]=i[0],i[0]=n):(i[e]=i[e+1],i[e+1]=n),this.patterns$.next([...this.patterns$.value])}onConfirm(){const e={name:this.form.value.name,description:this.form.value.description,patterns:[...this.patterns$.value]};this.yamcs.yamcsClient.createParameterList(this.yamcs.instance,e).then(()=>this.router.navigate([".."],{relativeTo:this.route,queryParams:{c:this.yamcs.context}})).catch(i=>this.messageService.showError(i))}static#t=this.\u0275fac=function(i){return new(i||a)(t.Y36(c.QS),t.Y36(C.Dx),t.Y36(b.F0),t.Y36(b.gz),t.Y36(o.C8),t.Y36(d.uw),t.Y36(o.ez),t.Y36(g.Ye))};static#e=this.\u0275cmp=t.Xpm({type:a,selectors:[["ng-component"]],decls:33,vars:8,consts:[["mat-icon-button","","routerLink","..","color","primary",3,"queryParams"],[1,"form-content","ya-form"],["novalidate","",3,"formGroup"],["formControlName","name","type","text"],["formControlName","description","rows","5",2,"resize","none"],[1,"ya-button",3,"click"],["yaDataTable","","style","width: 100%",4,"ngIf"],[1,"action-bar"],["type","submit",1,"ya-button","primary",3,"disabled","click"],["yaDataTable","",2,"width","100%"],[4,"ngIf"],[4,"ngFor","ngForOf"],["colspan","3"],[2,"text-align","right"],["icon","keyboard_arrow_down",3,"click"],["icon","keyboard_arrow_up",3,"click"],["icon","delete",3,"click"]],template:function(i,n){1&i&&(t.TgZ(0,"app-instance-page")(1,"app-instance-toolbar")(2,"a",0)(3,"mat-icon"),t._uU(4,"arrow_back"),t.qZA()(),t._uU(5," Create parameter list "),t.qZA(),t.TgZ(6,"div",1)(7,"form",2)(8,"label"),t._uU(9," Name"),t._UZ(10,"br")(11,"input",3),t.qZA(),t._UZ(12,"br"),t.TgZ(13,"label"),t._uU(14," Description "),t._UZ(15,"textarea",4),t.qZA()(),t.TgZ(16,"p"),t._uU(17,"\xa0"),t.qZA(),t.TgZ(18,"button",5),t.NdJ("click",function(){return n.showAddPatternDialog()}),t.TgZ(19,"mat-icon"),t._uU(20,"add_circle_outline"),t.qZA(),t._uU(21," Add parameter or pattern "),t.qZA(),t.TgZ(22,"p"),t._uU(23,"\xa0"),t.qZA(),t.YNc(24,Un,7,2,"table",6),t.ALo(25,"async"),t.TgZ(26,"p"),t._uU(27,"\xa0"),t.qZA(),t.TgZ(28,"div",7)(29,"button",5),t.NdJ("click",function(){return n.location.back()}),t._uU(30,"Cancel"),t.qZA(),t.TgZ(31,"button",8),t.NdJ("click",function(){return n.onConfirm()}),t._uU(32,"CREATE"),t.qZA()()()()),2&i&&(t.xp6(2),t.Q6J("queryParams",t.VKq(6,qn,n.yamcs.context)),t.xp6(5),t.Q6J("formGroup",n.form),t.xp6(17),t.Q6J("ngIf",t.lcZ(25,4,n.patterns$)),t.xp6(7),t.Q6J("disabled",!n.form.valid))},dependencies:[g.sg,g.O5,c._Y,c.Fj,c.JJ,c.JL,c.sg,c.u,b.rH,o.Gj,w.o6,P.Hw,o.J5,o.ll,k.a,U.k,g.Ov],encapsulation:2,changeDetection:0})}return a})();function Dn(a,r){1&a&&(t.TgZ(0,"tr")(1,"td",11),t._uU(2,"No rows to display"),t.qZA()())}function Nn(a,r){if(1&a){const e=t.EpF();t.TgZ(0,"tr")(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td",12)(4,"ya-icon-action",13),t.NdJ("click",function(n){const l=t.CHM(e).index;return t.oxw(3).moveDown(l),t.KtG(n.stopPropagation())}),t.qZA(),t.TgZ(5,"ya-icon-action",14),t.NdJ("click",function(n){const l=t.CHM(e).index;return t.oxw(3).moveUp(l),t.KtG(n.stopPropagation())}),t.qZA(),t.TgZ(6,"ya-text-action",15),t.NdJ("click",function(){const s=t.CHM(e).index,l=t.oxw(3);return t.KtG(l.deletePattern(s))}),t._uU(7,"DELETE"),t.qZA()()()}if(2&a){const e=r.$implicit;t.xp6(2),t.Oqu(e)}}function In(a,r){if(1&a&&(t.TgZ(0,"table",9)(1,"tr")(2,"th"),t._uU(3,"Pattern"),t.qZA(),t._UZ(4,"th"),t.qZA(),t.YNc(5,Dn,3,0,"tr",0),t.YNc(6,Nn,8,1,"tr",10),t.qZA()),2&a){const e=r.ngIf;t.xp6(5),t.Q6J("ngIf",!e.length),t.xp6(1),t.Q6J("ngForOf",e)}}function Qn(a,r){if(1&a){const e=t.EpF();t.TgZ(0,"app-instance-page")(1,"app-instance-toolbar"),t._uU(2),t.qZA(),t.TgZ(3,"div",1)(4,"form",2)(5,"label"),t._uU(6," Name"),t._UZ(7,"br")(8,"input",3),t.qZA(),t._UZ(9,"br"),t.TgZ(10,"label"),t._uU(11," Description "),t._UZ(12,"textarea",4),t.qZA()(),t.TgZ(13,"p"),t._uU(14,"\xa0"),t.qZA(),t.TgZ(15,"button",5),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.showAddPatternDialog())}),t.TgZ(16,"mat-icon"),t._uU(17,"add_circle_outline"),t.qZA(),t._uU(18," Add parameter or pattern "),t.qZA(),t.TgZ(19,"p"),t._uU(20,"\xa0"),t.qZA(),t.YNc(21,In,7,2,"table",6),t.ALo(22,"async"),t.TgZ(23,"p"),t._uU(24,"\xa0"),t.qZA(),t.TgZ(25,"div",7)(26,"button",5),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.location.back())}),t._uU(27,"Cancel"),t.qZA(),t.TgZ(28,"button",8),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.onConfirm())}),t.ALo(29,"async"),t._uU(30,"SAVE CHANGES"),t.qZA()()()()}if(2&a){const e=r.ngIf,i=t.oxw();t.xp6(2),t.hij(" Edit list: ",e.name," "),t.xp6(2),t.Q6J("formGroup",i.form),t.xp6(17),t.Q6J("ngIf",t.lcZ(22,4,i.patterns$)),t.xp6(7),t.Q6J("disabled",!t.lcZ(29,6,i.dirty$)||!i.form.valid)}}let Nt=(()=>{class a{constructor(e,i,n,s,l,_,m,u){this.router=n,this.route=s,this.yamcs=l,this.dialog=_,this.messageService=m,this.location=u,this.patterns$=new f.X([]),this.dirty$=new f.X(!1),i.setTitle("Edit Parameter List");const h=s.snapshot.paramMap.get("list");this.plist$=l.yamcsClient.getParameterList(l.instance,h),this.plist$.then(x=>{this.plist=x,this.form=e.group({name:new c.p4(x.name,[c.kI.required]),description:new c.p4(x.description)}),this.formSubscription=this.form.valueChanges.subscribe(()=>{this.dirty$.next(!0)}),this.patterns$.next(x.patterns||[])})}showAddPatternDialog(){this.dialog.open(H.M,{width:"500px",data:{label:"Add parameter or pattern",okLabel:"ADD",hint:"Either an exact parameter name, or a glob pattern with *, **, or ? wildcards."}}).afterClosed().subscribe(i=>{i&&(this.patterns$.next([...this.patterns$.value,i]),this.dirty$.next(!0))})}deletePattern(e){this.patterns$.value.splice(e,1),this.patterns$.next([...this.patterns$.value]),this.dirty$.next(!0)}moveUp(e){const i=this.patterns$.value,n=i[e];0===e?(i[e]=i[i.length-1],i[i.length-1]=n):(i[e]=i[e-1],i[e-1]=n),this.patterns$.next([...this.patterns$.value]),this.dirty$.next(!0)}moveDown(e){const i=this.patterns$.value,n=i[e];e===i.length-1?(i[e]=i[0],i[0]=n):(i[e]=i[e+1],i[e+1]=n),this.patterns$.next([...this.patterns$.value]),this.dirty$.next(!0)}onConfirm(){const e={name:this.form.value.name,description:this.form.value.description,patternDefinition:{patterns:[...this.patterns$.value]}};this.yamcs.yamcsClient.updateParameterList(this.yamcs.instance,this.plist.id,e).then(()=>this.router.navigateByUrl(`/telemetry/parameter-lists/${this.plist.id}?c=${this.yamcs.context}`)).catch(i=>this.messageService.showError(i))}ngOnDestroy(){this.formSubscription?.unsubscribe()}static#t=this.\u0275fac=function(i){return new(i||a)(t.Y36(c.QS),t.Y36(C.Dx),t.Y36(b.F0),t.Y36(b.gz),t.Y36(o.C8),t.Y36(d.uw),t.Y36(o.ez),t.Y36(g.Ye))};static#e=this.\u0275cmp=t.Xpm({type:a,selectors:[["ng-component"]],decls:2,vars:3,consts:[[4,"ngIf"],[1,"form-content","ya-form"],["novalidate","",3,"formGroup"],["formControlName","name","type","text"],["formControlName","description","rows","5",2,"resize","none"],[1,"ya-button",3,"click"],["yaDataTable","","style","width: 100%",4,"ngIf"],[1,"action-bar"],["type","submit",1,"ya-button","primary",3,"disabled","click"],["yaDataTable","",2,"width","100%"],[4,"ngFor","ngForOf"],["colspan","3"],[2,"text-align","right"],["icon","keyboard_arrow_down",3,"click"],["icon","keyboard_arrow_up",3,"click"],["icon","delete",3,"click"]],template:function(i,n){1&i&&(t.YNc(0,Qn,31,8,"app-instance-page",0),t.ALo(1,"async")),2&i&&t.Q6J("ngIf",t.lcZ(1,1,n.plist$))},dependencies:[g.sg,g.O5,c._Y,c.Fj,c.JJ,c.JL,c.sg,c.u,o.Gj,P.Hw,o.J5,o.ll,k.a,U.k,g.Ov],encapsulation:2,changeDetection:0})}return a})();function Ln(a,r){if(1&a){const e=t.EpF();t.ynx(0),t._UZ(1,"ya-date-time-input",12)(2,"ya-date-time-input",13),t.TgZ(3,"button",14),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(2);return t.KtG(n.applyCustomDates())}),t._uU(4,"Apply"),t.qZA(),t.BQk()}if(2&a){const e=t.oxw(2);t.xp6(3),t.Q6J("disabled",e.filterForm.invalid)}}function Jn(a,r){if(1&a){const e=t.EpF();t.ynx(0),t.TgZ(1,"button",15),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(2);return t.KtG(n.jumpToNow())}),t._uU(2," Jump to now "),t.qZA(),t.BQk()}}function Yn(a,r){if(1&a&&(t.TgZ(0,"span"),t._uU(1," Showing data from "),t.TgZ(2,"b"),t._uU(3,"the last hour"),t.qZA(),t._uU(4," ending at "),t.TgZ(5,"b"),t._uU(6),t.ALo(7,"datetime"),t.qZA(),t._uU(8," (Mission Time) "),t.qZA()),2&a){const e=t.oxw(2);t.xp6(6),t.Oqu(t.lcZ(7,1,e.validStop))}}function Mn(a,r){if(1&a&&(t.TgZ(0,"span"),t._uU(1," Showing data from "),t.TgZ(2,"b"),t._uU(3,"the last 6 hours"),t.qZA(),t._uU(4," ending at "),t.TgZ(5,"b"),t._uU(6),t.ALo(7,"datetime"),t.qZA(),t._uU(8," (Mission Time) "),t.qZA()),2&a){const e=t.oxw(2);t.xp6(6),t.Oqu(t.lcZ(7,1,e.validStop))}}function On(a,r){if(1&a&&(t.TgZ(0,"span"),t._uU(1," Showing data from "),t.TgZ(2,"b"),t._uU(3,"the last 24 hours"),t.qZA(),t._uU(4," ending at "),t.TgZ(5,"b"),t._uU(6),t.ALo(7,"datetime"),t.qZA(),t._uU(8," (Mission Time) "),t.qZA()),2&a){const e=t.oxw(2);t.xp6(6),t.Oqu(t.lcZ(7,1,e.validStop))}}function $n(a,r){1&a&&(t.TgZ(0,"span"),t._uU(1," Showing data from "),t.TgZ(2,"b"),t._uU(3,"all time"),t.qZA()())}function Rn(a,r){if(1&a&&(t.TgZ(0,"span"),t._uU(1," Showing data from "),t.TgZ(2,"b"),t._uU(3),t.ALo(4,"datetime"),t.qZA(),t._uU(5," to "),t.TgZ(6,"b"),t._uU(7),t.ALo(8,"datetime"),t.qZA(),t._uU(9," (Mission Time) "),t.qZA()),2&a){const e=t.oxw(2);t.xp6(3),t.Oqu(t.lcZ(4,2,e.validStart)),t.xp6(4),t.Oqu(t.lcZ(8,4,e.validStop))}}function Fn(a,r){1&a&&(t.TgZ(0,"th",26),t._uU(1,"Generation time"),t.qZA())}function Vn(a,r){if(1&a&&(t.TgZ(0,"td",27),t._uU(1),t.ALo(2,"datetime"),t.qZA()),2&a){const e=r.$implicit;t.xp6(1),t.hij(" ",t.lcZ(2,1,e.generationTime)," ")}}function Hn(a,r){if(1&a&&(t.TgZ(0,"th",26),t._uU(1),t.qZA()),2&a){const e=t.oxw().$implicit;t.xp6(1),t.Oqu(e)}}function En(a,r){if(1&a&&(t.TgZ(0,"td",27),t._uU(1),t.qZA()),2&a){const e=r.$implicit,i=t.oxw().index;let n;t.xp6(1),t.hij(" ",null!==(n=e.values[i])&&void 0!==n?n:"-"," ")}}function Bn(a,r){1&a&&(t.ynx(0,28),t.YNc(1,Hn,2,1,"th",19),t.YNc(2,En,2,1,"td",20),t.BQk()),2&a&&t.Q6J("cdkColumnDef",r.$implicit)}function Gn(a,r){1&a&&t._UZ(0,"th",29)}function jn(a,r){1&a&&t._UZ(0,"td",27)}function zn(a,r){1&a&&t._UZ(0,"tr",30)}function Kn(a,r){1&a&&t._UZ(0,"tr",31)}function Xn(a,r){if(1&a&&(t.TgZ(0,"div",16)(1,"table",17),t.ynx(2,18),t.YNc(3,Fn,2,0,"th",19),t.YNc(4,Vn,3,3,"td",20),t.BQk(),t.YNc(5,Bn,3,1,"ng-container",21),t.ynx(6,22),t.YNc(7,Gn,1,0,"th",23),t.YNc(8,jn,1,0,"td",20),t.BQk(),t.YNc(9,zn,1,0,"tr",24),t.ALo(10,"async"),t.YNc(11,Kn,1,0,"tr",25),t.ALo(12,"async"),t.qZA()()),2&a){const e=r.ngIf,i=t.oxw(2);t.xp6(1),t.Q6J("dataSource",i.dataSource),t.xp6(4),t.Q6J("ngForOf",e.headers),t.xp6(4),t.Q6J("matHeaderRowDef",t.lcZ(10,5,i.displayedColumns$))("matHeaderRowDefSticky",!0),t.xp6(2),t.Q6J("cdkRowDefColumns",t.lcZ(12,7,i.displayedColumns$))}}function Wn(a,r){if(1&a){const e=t.EpF();t.TgZ(0,"div",1)(1,"form",2)(2,"div",3),t._UZ(3,"ya-select",4),t.YNc(4,Ln,5,1,"ng-container",5),t.YNc(5,Jn,3,0,"ng-container",5),t._UZ(6,"div",6),t.TgZ(7,"button",7),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.exportParameterData())}),t.TgZ(8,"mat-icon"),t._uU(9,"download"),t.qZA(),t._uU(10," Export CSV "),t.qZA()()(),t.TgZ(11,"div",8),t._UZ(12,"div",9),t.YNc(13,Yn,9,3,"span",10),t.YNc(14,Mn,9,3,"span",10),t.YNc(15,On,9,3,"span",10),t.YNc(16,$n,4,0,"span",10),t.YNc(17,Rn,10,6,"span",10),t.qZA(),t.YNc(18,Xn,13,9,"div",11),t.ALo(19,"async"),t.qZA()}if(2&a){const e=t.oxw();t.xp6(1),t.Q6J("formGroup",e.filterForm),t.xp6(2),t.Q6J("options",e.intervalOptions),t.xp6(1),t.Q6J("ngIf","CUSTOM"===e.filterForm.value.interval),t.xp6(1),t.Q6J("ngIf","CUSTOM"!==e.filterForm.value.interval),t.xp6(6),t.Q6J("ngSwitch",e.appliedInterval),t.xp6(2),t.Q6J("ngSwitchCase","PT1H"),t.xp6(1),t.Q6J("ngSwitchCase","PT6H"),t.xp6(1),t.Q6J("ngSwitchCase","P1D"),t.xp6(1),t.Q6J("ngSwitchCase","NO_LIMIT"),t.xp6(1),t.Q6J("ngSwitchCase","CUSTOM"),t.xp6(1),t.Q6J("ngIf",t.lcZ(19,11,e.exportData$))}}const Q="PT1H";let It=(()=>{class a{constructor(e,i,n,s,l){this.router=e,this.route=i,this.yamcs=n,this.dialog=s,this.filenamePipe=l,this.intervalOptions=[{id:"PT1H",label:"Last Hour"},{id:"PT6H",label:"Last 6 Hours"},{id:"P1D",label:"Last 24 Hours"},{id:"NO_LIMIT",label:"No Limit"},{id:"CUSTOM",label:"Custom"}],this.filterForm=new c.nJ({interval:new c.p4(Q),customStart:new c.p4(null),customStop:new c.p4(null)}),this.displayedColumns=["generationTime","actions"],this.displayedColumns$=new f.X(this.displayedColumns),this.plist$=new f.X(null),this.exportData$=new f.X(null),this.dataSource=new p.by,this.plistId=i.snapshot.paramMap.get("list"),this.validStop=n.getMissionTime(),this.validStart=o.P6.subtractDuration(this.validStop,Q),this.appliedInterval=Q,this.initializeOptions(),this.loadData(),this.filterForm.get("interval").valueChanges.forEach(_=>{if("CUSTOM"===_){const m=this.validStart||this.yamcs.getMissionTime(),u=this.validStop||this.yamcs.getMissionTime();this.filterForm.get("customStart").setValue(o.P6.toISOString(m)),this.filterForm.get("customStop").setValue(o.P6.toISOString(u))}else"NO_LIMIT"===_?(this.validStart=null,this.validStop=null,this.appliedInterval=_,this.loadData()):(this.validStop=n.getMissionTime(),this.validStart=o.P6.subtractDuration(this.validStop,_),this.appliedInterval=_,this.loadData())})}initializeOptions(){const e=this.route.snapshot.queryParamMap;if(e.has("interval"))if(this.appliedInterval=e.get("interval"),this.filterForm.get("interval").setValue(this.appliedInterval),"CUSTOM"===this.appliedInterval){const i=e.get("customStart");this.filterForm.get("customStart").setValue(i),this.validStart=new Date(i);const n=e.get("customStop");this.filterForm.get("customStop").setValue(n),this.validStop=new Date(n)}else"NO_LIMIT"===this.appliedInterval?(this.validStart=null,this.validStop=null):(this.validStop=this.yamcs.getMissionTime(),this.validStart=o.P6.subtractDuration(this.validStop,this.appliedInterval));else this.appliedInterval=Q,this.validStop=this.yamcs.getMissionTime(),this.validStart=o.P6.subtractDuration(this.validStop,Q)}jumpToNow(){const e=this.filterForm.value.interval;"NO_LIMIT"===e?this.filterForm.get("interval").setValue(Q):(this.validStop=this.yamcs.getMissionTime(),this.validStart=o.P6.subtractDuration(this.validStop,e),this.loadData())}applyCustomDates(){this.validStart=o.P6.toDate(this.filterForm.value.customStart),this.validStop=o.P6.toDate(this.filterForm.value.customStop),this.appliedInterval="CUSTOM",this.loadData()}loadData(){this.updateURL();const e={delimiter:"TAB",limit:100,order:"desc"};if(this.validStart){const i=new Date(this.validStart.getTime());i.setUTCMilliseconds(this.validStart.getUTCMilliseconds()-1),e.start=i.toISOString()}this.validStop&&(e.stop=this.validStop.toISOString()),this.yamcs.yamcsClient.getParameterList(this.yamcs.instance,this.plistId).then(i=>{this.plist$.next(i),i.match&&this.yamcs.yamcsClient.exportParameterValues(this.yamcs.instance,{...e,list:i.id}).then(n=>{const s=this.processCsv(n);this.exportData$.next(s),this.displayedColumns$.next(["generationTime",...s.headers,"actions"]),this.dataSource.data=s.records})})}processCsv(e){const i=[],n=e.split(/\r?\n/);for(let m=1;m<n.length;m++){const u=n[m];if(!u)continue;const h=u.split(/\t/),x={generationTime:h[0],values:[]};for(let v=1;v<h.length;v++)x.values[v-1]=h[v]||null;i.push(x)}return{headers:n[0].split(/\t/).slice(1).map(m=>this.filenamePipe.transform(m)),records:i}}updateURL(){this.router.navigate([],{replaceUrl:!0,relativeTo:this.route,queryParams:{interval:this.appliedInterval,customStart:"CUSTOM"===this.appliedInterval?this.filterForm.value.customStart:null,customStop:"CUSTOM"===this.appliedInterval?this.filterForm.value.customStop:null},queryParamsHandling:"merge"})}exportParameterData(){const e=this.plist$.value;if(e?.match){let n=e.name;this.validStart&&this.validStop?n+="_"+this.validStart.toISOString()+"_"+this.validStop.toISOString():this.validStart?n+="_"+this.validStart.toISOString():this.validStop&&(n+="_"+this.validStop.toISOString()),n+=".csv",this.dialog.open(pt,{width:"400px",data:{list:e.id,start:this.validStart,stop:this.validStop,filename:n}})}}static#t=this.\u0275fac=function(i){return new(i||a)(t.Y36(b.F0),t.Y36(b.gz),t.Y36(o.C8),t.Y36(d.uw),t.Y36(o.XB))};static#e=this.\u0275cmp=t.Xpm({type:a,selectors:[["ng-component"]],decls:2,vars:3,consts:[["class","panel-content",4,"ngIf"],[1,"panel-content"],[3,"formGroup"],[1,"filter-bar"],["icon","access_time","formControlName","interval",3,"options"],[4,"ngIf"],[2,"flex","1 1 auto"],[1,"ya-button","primary",2,"margin-right","0",3,"click"],[1,"table-status",3,"ngSwitch"],[1,"toggles"],[4,"ngSwitchCase"],["class","table-container",4,"ngIf"],["formControlName","customStart"],["formControlName","customStop"],[1,"ya-button",3,"disabled","click"],[1,"ya-button",3,"click"],[1,"table-container"],["mat-table","",1,"ya-data-table","expand",3,"dataSource"],["matColumnDef","generationTime","sticky",""],["mat-header-cell","",4,"cdkHeaderCellDef"],["mat-cell","",4,"cdkCellDef"],[3,"cdkColumnDef",4,"ngFor","ngForOf"],["cdkColumnDef","actions"],["mat-header-cell","","class","expand",4,"cdkHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef","matHeaderRowDefSticky"],["mat-row","",4,"cdkRowDef","cdkRowDefColumns"],["mat-header-cell",""],["mat-cell",""],[3,"cdkColumnDef"],["mat-header-cell","",1,"expand"],["mat-header-row",""],["mat-row",""]],template:function(i,n){1&i&&(t.YNc(0,Wn,20,13,"div",0),t.ALo(1,"async")),2&i&&t.Q6J("ngIf",t.lcZ(1,1,n.plist$))},dependencies:[g.sg,g.O5,g.RF,g.n9,c._Y,c.JJ,c.JL,c.sg,c.u,Z.Sq,Z.O_,Z.D5,Z.fo,P.Hw,p.BZ,p.as,p.w1,p.ge,p.ev,p.XQ,p.Gk,o.t,o.Hr,g.Ov,o.id],styles:[".table-container[_ngcontent-%COMP%]{position:absolute;inset:96px 0 0;overflow:auto;margin-top:24px}.table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]{padding-left:24px;padding-right:24px;background-color:inherit;border-bottom:none}.table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{background-color:#fff}.table-status[_ngcontent-%COMP%]{background-color:#f7f7f7;height:24px;line-height:24px;font-size:12px;padding-left:6px}.table-status[_ngcontent-%COMP%]   .toggles[_ngcontent-%COMP%]{float:right;height:24px;line-height:24px;font-size:12px;padding-right:6px}.table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:first-child, .table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:first-child{background-color:#f7f7f7;border-left:1px solid rgba(0,0,0,.1);border-right:1px solid rgba(0,0,0,.1)}.table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:last-child, .table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:last-child{border-right:1px solid rgba(0,0,0,.1)}.table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:last-child   td[_ngcontent-%COMP%]{border-bottom:1px solid rgba(0,0,0,.1)}"],changeDetection:0})}return a})();var L=y(4104);const G=function(a){return{c:a}};function tr(a,r){if(1&a&&(t.TgZ(0,"a",10)(1,"mat-icon"),t._uU(2,"edit"),t.qZA(),t._uU(3," Edit list "),t.qZA()),2&a){const e=t.oxw(2);t.Q6J("queryParams",t.VKq(1,G,e.yamcs.context))}}function er(a,r){if(1&a&&(t.TgZ(0,"a",11,12),t._uU(2," Historical Data "),t.qZA()),2&a){const e=t.MAs(1),i=t.oxw(2);t.Q6J("active",e.isActive)("queryParams",t.VKq(2,G,i.yamcs.context))}}function ar(a,r){if(1&a&&(t.TgZ(0,"app-instance-page")(1,"app-instance-toolbar")(2,"a",1)(3,"mat-icon"),t._uU(4,"arrow_back"),t.qZA()(),t._uU(5),t.YNc(6,tr,4,3,"a",2),t.qZA(),t.TgZ(7,"nav",3,4)(9,"a",5,6),t._uU(11," Realtime "),t.qZA(),t.YNc(12,er,3,4,"a",7),t.qZA(),t.TgZ(13,"div",8)(14,"mat-tab-nav-panel",null,9),t._UZ(16,"router-outlet"),t.qZA()()()),2&a){const e=r.ngIf,i=t.MAs(10),n=t.MAs(15),s=t.oxw();t.xp6(2),t.Q6J("queryParams",t.VKq(8,G,s.yamcs.context)),t.xp6(3),t.hij(" ",e.name," \xa0\xa0\xa0 "),t.xp6(1),t.Q6J("ngIf",s.mayManageParameterLists()),t.xp6(1),t.Q6J("mat-stretch-tabs",!1)("tabPanel",n),t.xp6(2),t.Q6J("active",i.isActive)("queryParams",t.VKq(10,G,s.yamcs.context)),t.xp6(3),t.Q6J("ngIf",s.config.tmArchive)}}let Qt=(()=>{class a{constructor(e,i,n,s,l,_){this.yamcs=i,this.authService=n,this.title=s,this.synchronizer=l,this.plist$=new f.X(null),this.config=_.getConfig(),e.paramMap.subscribe(m=>{const u=m.get("list");this.changeList(u)})}mayManageParameterLists(){return this.authService.getUser().hasSystemPrivilege("ManageParameterLists")}changeList(e){this.yamcs.yamcsClient.getParameterList(this.yamcs.instance,e).then(i=>{this.plist$.next(i),this.title.setTitle(i.name)})}static#t=this.\u0275fac=function(i){return new(i||a)(t.Y36(b.gz),t.Y36(o.C8),t.Y36(D.e),t.Y36(C.Dx),t.Y36(o.jF),t.Y36(o.E4))};static#e=this.\u0275cmp=t.Xpm({type:a,selectors:[["ng-component"]],decls:2,vars:3,consts:[[4,"ngIf"],["mat-icon-button","","routerLink","..","color","primary",3,"queryParams"],["mat-button","","color","primary","routerLink","edit",3,"queryParams",4,"ngIf"],["mat-tab-nav-bar","",1,"secondary",3,"mat-stretch-tabs","tabPanel"],["tabs",""],["mat-tab-link","","routerLink","realtime","routerLinkActive","",3,"active","queryParams"],["rla","routerLinkActive"],["mat-tab-link","","routerLink","data","routerLinkActive","",3,"active","queryParams",4,"ngIf"],[1,"tab-content-wrapper"],["tabPanel",""],["mat-button","","color","primary","routerLink","edit",3,"queryParams"],["mat-tab-link","","routerLink","data","routerLinkActive","",3,"active","queryParams"],["rlb","routerLinkActive"]],template:function(i,n){1&i&&(t.YNc(0,ar,17,12,"app-instance-page",0),t.ALo(1,"async")),2&i&&t.Q6J("ngIf",t.lcZ(1,1,n.plist$))},dependencies:[g.O5,b.lC,b.rH,b.Od,w.zs,w.o6,P.Hw,L.BU,L.sW,L.Nj,k.a,U.k,g.Ov],encapsulation:2,changeDetection:0})}return a})();var Lt=y(9887);class ir extends q.o2{constructor(r,e,i){super(),this.yamcs=r,this.synchronizer=e,this.memberPathPipe=i,this.binaryPreview=16,this.items$=new f.X([]),this.totalSize$=new f.X(0),this.loading$=new f.X(!1),this.idMapping={},this.latestValues=new Map}connect(){return this.syncSubscription=this.synchronizer.syncFast(()=>{this.refreshTable()}),this.items$}loadParameters(r){var e=this;return(0,E.Z)(function*(){return e.loading$.next(!0),e.dataSubscription&&(e.dataSubscription.cancel(),e.dataSubscription=void 0),e.yamcs.yamcsClient.getParameters(e.yamcs.instance,r).then(i=>{e.totalSize$.next(i.totalSize);const n=[];for(const s of i.systems||[])n.push({name:s.qualifiedName,system:s});for(const s of i.parameters||[])n.push({name:e.memberPathPipe.transform(s),parameter:s});e.items$.next(n),e.startSubscription(i.parameters||[])}).finally(()=>e.loading$.next(!1))})()}refreshTable(){const r=this.items$.value;for(const e of r)e.system||(e.pval=this.latestValues.get(e.name));this.items$.next([...r])}startSubscription(r){const e=r.map(i=>({name:this.memberPathPipe.transform(i)}));e.length&&(this.dataSubscription=this.yamcs.yamcsClient.createParameterSubscription({instance:this.yamcs.instance,processor:this.yamcs.processor,id:e,abortOnInvalid:!1,sendFromCache:!0,updateOnExpiration:!0,maxBytes:this.binaryPreview+1,action:"REPLACE"},i=>{i.mapping&&(this.idMapping=i.mapping,this.latestValues.clear()),this.processDelivery(i.values||[])}))}processDelivery(r){for(const e of r){const i=this.idMapping[e.numericId];i&&this.latestValues.set(i.name,e)}}getAliasNamespaces(){const r=[];for(const e of this.items$.value)if(e.parameter?.alias)for(const i of e.parameter.alias)i.namespace&&-1===r.indexOf(i.namespace)&&r.push(i.namespace);return r.sort()}disconnect(){this.syncSubscription?.unsubscribe(),this.dataSubscription?.cancel(),this.items$.complete(),this.totalSize$.complete(),this.loading$.complete()}}const nr=["top"];function rr(a,r){if(1&a&&t._UZ(0,"ya-breadcrumb",17),2&a){const e=r.$implicit;t.Q6J("link",e.route)("queryParams",e.queryParams)("label",e.name)}}const Jt=function(a){return{c:a}};function sr(a,r){if(1&a&&(t.TgZ(0,"div",4)(1,"ya-breadcrumb-trail"),t._UZ(2,"ya-breadcrumb",15),t.YNc(3,rr,1,3,"ya-breadcrumb",16),t.qZA()()),2&a){const e=t.oxw().ngIf,i=t.oxw();t.xp6(2),t.Q6J("queryParams",t.VKq(2,Jt,i.yamcs.context)),t.xp6(1),t.Q6J("ngForOf",e)}}function or(a,r){if(1&a&&(t.ynx(0),t.YNc(1,sr,4,4,"div",14),t.BQk()),2&a){const e=r.ngIf;t.xp6(1),t.Q6J("ngIf",e.length)}}function lr(a,r){1&a&&t._UZ(0,"ya-dots")}function cr(a,r){1&a&&(t.TgZ(0,"th",36),t._uU(1,"Name"),t.qZA())}const _r=function(){return["/telemetry/parameters"]},pr=function(a,r){return{c:a,system:r}};function mr(a,r){if(1&a&&(t.ynx(0),t.TgZ(1,"mat-icon",38),t._uU(2,"folder"),t.qZA(),t.TgZ(3,"a",39),t._uU(4),t.ALo(5,"filename"),t.qZA(),t.BQk()),2&a){const e=t.oxw().$implicit,i=t.oxw(2);t.xp6(3),t.Q6J("routerLink",t.DdM(5,_r))("queryParams",t.WLB(6,pr,i.yamcs.context,e.name)),t.xp6(1),t.hij("",t.lcZ(5,3,e.name),"/ ")}}function ur(a,r){if(1&a&&t._UZ(0,"ya-highlight",41),2&a){const e=t.oxw(2).$implicit,i=t.oxw(2);t.Q6J("text",e.name)("term",i.filterForm.value.filter)}}function gr(a,r){if(1&a&&(t._UZ(0,"ya-highlight",41),t.ALo(1,"slice")),2&a){const e=r.ngIf,i=t.oxw(2).$implicit,n=t.oxw(2);t.Q6J("text",t.xi3(1,2,i.name,e.length+1))("term",n.filterForm.value.filter)}}const dr=function(a){return["/telemetry/parameters",a]};function hr(a,r){if(1&a&&(t.ynx(0),t.TgZ(1,"mat-icon",38),t._uU(2,"toll"),t.qZA(),t.TgZ(3,"a",39),t.YNc(4,ur,1,2,"ya-highlight",40),t.ALo(5,"async"),t.YNc(6,gr,2,5,"ya-highlight",40),t.ALo(7,"async"),t.qZA(),t.BQk()),2&a){const e=t.oxw().$implicit,i=t.oxw(2);t.xp6(3),t.Q6J("routerLink",t.VKq(8,dr,e.name))("queryParams",t.VKq(10,Jt,i.yamcs.context)),t.xp6(1),t.Q6J("ngIf",!t.lcZ(5,4,i.system$)),t.xp6(2),t.Q6J("ngIf",t.lcZ(7,6,i.system$))}}function fr(a,r){if(1&a&&(t.TgZ(0,"td",37),t.YNc(1,mr,6,9,"ng-container",3),t.YNc(2,hr,8,12,"ng-container",3),t.qZA()),2&a){const e=r.$implicit;t.xp6(1),t.Q6J("ngIf",e.system),t.xp6(1),t.Q6J("ngIf",!e.system)}}function xr(a,r){1&a&&(t.TgZ(0,"th",42),t._uU(1,"Raw value"),t.qZA())}const Yt=function(a){return{maxBytes:a}};function yr(a,r){if(1&a&&(t.TgZ(0,"td",43),t._uU(1),t.ALo(2,"value"),t.qZA()),2&a){const e=r.$implicit,i=t.oxw(2);t.xp6(1),t.hij(" ",t.xi3(2,1,null==e.pval?null:e.pval.rawValue,t.VKq(4,Yt,i.dataSource.binaryPreview))||"-"," ")}}function br(a,r){1&a&&(t.TgZ(0,"th",42),t._uU(1,"Value"),t.qZA())}function Tr(a,r){if(1&a&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"units"),t.ALo(3,"parameterTypeForPath"),t.qZA()),2&a){const e=t.oxw(2).$implicit;let i;t.xp6(1),t.hij(" ",t.lcZ(2,1,null==(i=t.lcZ(3,3,e.parameter))?null:i.unitSet)," ")}}function vr(a,r){1&a&&(t.TgZ(0,"span"),t._uU(1,"\u2193"),t.qZA())}function Zr(a,r){1&a&&(t.TgZ(0,"span"),t._uU(1,"\u2191"),t.qZA())}function Pr(a,r){if(1&a&&(t.TgZ(0,"ya-expirable",45),t._uU(1),t.ALo(2,"value"),t.YNc(3,Tr,4,5,"span",3),t.YNc(4,vr,2,0,"span",3),t.YNc(5,Zr,2,0,"span",3),t.qZA()),2&a){const e=t.oxw().$implicit,i=t.oxw(2);t.Q6J("pval",e.pval),t.xp6(1),t.hij(" ",t.xi3(2,5,null==e.pval?null:e.pval.engValue,t.VKq(8,Yt,i.dataSource.binaryPreview))||"-"," "),t.xp6(2),t.Q6J("ngIf",null==e.parameter||null==e.parameter.type?null:e.parameter.type.unitSet),t.xp6(1),t.Q6J("ngIf","LOW"===(null==e.pval?null:e.pval.rangeCondition)),t.xp6(1),t.Q6J("ngIf","HIGH"===(null==e.pval?null:e.pval.rangeCondition))}}function wr(a,r){1&a&&(t.TgZ(0,"span"),t._uU(1,"-"),t.qZA())}function Ar(a,r){if(1&a&&(t.TgZ(0,"td",43),t.YNc(1,Pr,6,10,"ya-expirable",44),t.YNc(2,wr,2,0,"span",3),t.qZA()),2&a){const e=r.$implicit;t.ekj("alert",(null==e.pval?null:e.pval.monitoringResult)&&"IN_LIMITS"!==(null==e.pval?null:e.pval.monitoringResult)),t.xp6(1),t.Q6J("ngIf",e.pval),t.xp6(1),t.Q6J("ngIf",!e.pval)}}function Sr(a,r){1&a&&(t.TgZ(0,"th",36),t._uU(1,"Type"),t.qZA())}function Cr(a,r){if(1&a&&(t.TgZ(0,"span",47),t._uU(1),t.qZA()),2&a){const e=r.ngIf;t.xp6(1),t.hij(" ",e," ")}}function kr(a,r){if(1&a&&(t.TgZ(0,"td",43),t.YNc(1,Cr,2,1,"span",46),t.ALo(2,"parameterTypeForPath"),t.qZA()),2&a){const e=r.$implicit;t.oxw(2);const i=t.MAs(23);let n;t.xp6(1),t.Q6J("ngIf",null==(n=t.lcZ(2,2,e.parameter))?null:n.engType)("ngIfElse",i)}}function Ur(a,r){1&a&&(t.TgZ(0,"th",36),t._uU(1,"Data source"),t.qZA())}function qr(a,r){if(1&a&&(t.TgZ(0,"td",43),t._uU(1),t.ALo(2,"titlecase"),t.qZA()),2&a){const e=r.$implicit;t.xp6(1),t.Oqu(t.lcZ(2,1,null==e.parameter?null:e.parameter.dataSource)||"-")}}function Dr(a,r){1&a&&(t.TgZ(0,"th",42),t._uU(1,"Description"),t.qZA())}function Nr(a,r){if(1&a&&(t.ynx(0),t._uU(1),t.BQk()),2&a){const e=t.oxw().$implicit;t.xp6(1),t.hij(" ",e.system.shortDescription||"-"," ")}}function Ir(a,r){if(1&a&&(t.ynx(0),t._uU(1),t.BQk()),2&a){const e=t.oxw().$implicit;t.xp6(1),t.hij(" ",e.parameter.shortDescription||"-"," ")}}function Qr(a,r){if(1&a&&(t.TgZ(0,"td",43),t.YNc(1,Nr,2,1,"ng-container",3),t.YNc(2,Ir,2,1,"ng-container",3),t.qZA()),2&a){const e=r.$implicit;t.xp6(1),t.Q6J("ngIf",e.system),t.xp6(1),t.Q6J("ngIf",e.parameter)}}function Lr(a,r){if(1&a&&(t.TgZ(0,"th",36),t._uU(1),t.qZA()),2&a){const e=t.oxw().$implicit;t.xp6(1),t.hij(" ",e.label," ")}}function Jr(a,r){if(1&a&&(t.ynx(0),t._UZ(1,"ya-highlight",41),t.BQk()),2&a){const e=r.ngIf,i=t.oxw(4);t.xp6(1),t.Q6J("text",e)("term",i.filterForm.value.filter)}}function Yr(a,r){if(1&a&&(t.TgZ(0,"td",43),t.YNc(1,Jr,2,2,"ng-container",49),t.ALo(2,"alias"),t.qZA()),2&a){const e=r.$implicit,i=t.oxw().$implicit;t.oxw(2);const n=t.MAs(23);t.xp6(1),t.Q6J("ngIf",t.xi3(2,2,e.parameter,i.id))("ngIfElse",n)}}function Mr(a,r){1&a&&(t.ynx(0,48),t.YNc(1,Lr,2,1,"th",20),t.YNc(2,Yr,3,5,"td",28),t.BQk()),2&a&&t.Q6J("matColumnDef",r.$implicit.id)}function Or(a,r){1&a&&t._UZ(0,"th",50)}function $r(a,r){1&a&&t._UZ(0,"td",43)}function Rr(a,r){1&a&&t._UZ(0,"tr",51)}function Fr(a,r){if(1&a&&t._UZ(0,"tr",52),2&a){const e=r.$implicit,i=t.oxw(2);t.ekj("selected",i.selection.isSelected(e))}}function Vr(a,r){if(1&a&&(t.TgZ(0,"table",18),t.ynx(1,19),t.YNc(2,cr,2,0,"th",20),t.YNc(3,fr,3,2,"td",21),t.BQk(),t.ynx(4,22),t.YNc(5,xr,2,0,"th",23),t.YNc(6,yr,3,6,"td",24),t.BQk(),t.ynx(7,25),t.YNc(8,br,2,0,"th",23),t.YNc(9,Ar,3,4,"td",26),t.BQk(),t.ynx(10,27),t.YNc(11,Sr,2,0,"th",20),t.YNc(12,kr,3,4,"td",28),t.BQk(),t.ynx(13,29),t.YNc(14,Ur,2,0,"th",20),t.YNc(15,qr,3,3,"td",28),t.BQk(),t.ynx(16,30),t.YNc(17,Dr,2,0,"th",23),t.YNc(18,Qr,3,2,"td",28),t.BQk(),t.YNc(19,Mr,3,1,"ng-container",31),t.ALo(20,"async"),t.ynx(21,32),t.YNc(22,Or,1,0,"th",33),t.YNc(23,$r,1,0,"td",28),t.BQk(),t.YNc(24,Rr,1,0,"tr",34),t.ALo(25,"async"),t.YNc(26,Fr,1,2,"tr",35),t.ALo(27,"async"),t.qZA()),2&a){const e=t.oxw(),i=t.MAs(14);t.Q6J("dataSource",e.dataSource),t.xp6(19),t.Q6J("ngForOf",t.lcZ(20,4,e.aliasColumns$)),t.xp6(5),t.Q6J("matHeaderRowDef",t.lcZ(25,6,i.displayedColumns$)),t.xp6(2),t.Q6J("matRowDefColumns",t.lcZ(27,8,i.displayedColumns$))}}function Hr(a,r){if(1&a&&(t.TgZ(0,"div",1),t._uU(1," The Mission Database for "),t.TgZ(2,"i"),t._uU(3),t.qZA(),t._uU(4," does not define any parameters. "),t.qZA()),2&a){const e=t.oxw();t.xp6(3),t.Oqu(e.yamcs.instance)}}function Er(a,r){1&a&&t._uU(0,"-")}const Mt=[{id:"name",label:"Name",alwaysVisible:!0},{id:"type",label:"Type",visible:!0},{id:"dataSource",label:"Data source",visible:!0},{id:"engValue",label:"Value",visible:!0},{id:"shortDescription",label:"Description",visible:!0},{id:"actions",label:"",alwaysVisible:!0}],Br=[{id:"ANY",label:"Any type"},{id:"aggregate",label:"aggregate"},{id:"array",label:"array"},{id:"binary",label:"binary"},{id:"boolean",label:"boolean"},{id:"enumeration",label:"enumeration"},{id:"float",label:"float"},{id:"integer",label:"integer"},{id:"string",label:"string"},{id:"time",label:"time"}],Gr=[{id:"ANY",label:"Any source"},{id:"COMMAND",label:"Command"},{id:"COMMAND_HISTORY",label:"Command History"},{id:"CONSTANT",label:"Constant"},{id:"DERIVED",label:"Derived"},{id:"EXTERNAL1",label:"External 1"},{id:"EXTERNAL2",label:"External 2"},{id:"EXTERNAL3",label:"External 3"},{id:"GROUND",label:"Ground"},{id:"LOCAL",label:"Local"},{id:"SYSTEM",label:"System"},{id:"TELEMETERED",label:"Telemetered"}];let Ot=(()=>{class a{constructor(e,i,n,s,l,_){this.yamcs=e,this.route=n,this.router=s,this.filterForm=new c.nJ({filter:new c.p4,type:new c.p4("ANY"),source:new c.p4("ANY")}),this.shortName=!1,this.pageSize=100,this.system=null,this.system$=new f.X(null),this.breadcrumb$=new f.X([]),this.columns=Mt,this.typeOptions=Br,this.sourceOptions=Gr,this.aliasColumns$=new f.X([]),this.selection=new q.Ov(!1),i.setTitle("Parameters"),this.dataSource=new ir(e,l,_)}ngAfterViewInit(){const e=this.route.snapshot.queryParamMap;e.has("filter")&&(this.filter=e.get("filter")||"",this.filterForm.get("filter").setValue(this.filter)),e.has("type")&&(this.type=e.get("type"),this.filterForm.get("type").setValue(this.type)),e.has("source")&&(this.source=e.get("source"),this.filterForm.get("source").setValue(this.source)),this.filterForm.get("filter").valueChanges.subscribe(i=>{this.paginator.pageIndex=0,this.filter=i,this.updateDataSource()}),this.filterForm.get("type").valueChanges.forEach(i=>{this.type="ANY"!==i?i:null,this.updateDataSource()}),this.filterForm.get("source").valueChanges.forEach(i=>{this.source="ANY"!==i?i:null,this.updateDataSource()}),this.changeSystem(this.route.snapshot.queryParamMap),this.queryParamMapSubscription=this.route.queryParamMap.subscribe(i=>{i.get("system")!==this.system&&this.changeSystem(i)}),this.paginator.page.subscribe(()=>{this.updateDataSource(),this.top.nativeElement.scrollIntoView()})}changeSystem(e){this.system=e.get("system"),this.updateBrowsePath(),this.paginator.pageIndex=e.has("page")?Number(e.get("page")):0,this.updateDataSource()}updateDataSource(){this.updateURL();const e={system:this.system||"/",details:!0,pos:this.paginator.pageIndex*this.pageSize,limit:this.pageSize};this.filter&&(e.q=this.filter,e.searchMembers=!0),this.type&&(e.type=this.type),this.source&&(e.source=this.source),this.dataSource.loadParameters(e).then(()=>{this.selection.clear(),this.updateBrowsePath(),this.system$.next(this.system);for(const n of this.aliasColumns$.value){const s=this.columns.indexOf(n);-1!==s&&this.columns.splice(s,1)}const i=[];for(const n of this.dataSource.getAliasNamespaces())i.push({id:n,label:n,alwaysVisible:!0});this.columns.splice(1,0,...i),this.aliasColumns$.next(i),this.columnChooser.recalculate(this.columns)})}updateURL(){this.router.navigate([],{replaceUrl:!0,relativeTo:this.route,queryParams:{page:this.paginator.pageIndex||null,filter:this.filter||null,type:this.type||null,source:this.source||null,system:this.system||null},queryParamsHandling:"merge"})}updateBrowsePath(){const e=[];let i="";if(this.system)for(const n of this.system.slice(1).split("/"))i+="/"+n,e.push({name:n,route:"/telemetry/parameters",queryParams:{system:i,c:this.yamcs.context}});this.breadcrumb$.next(e)}selectNext(){const e=this.dataSource.items$.value;let i=0;if(this.selection.hasValue()){const n=this.selection.selected[0];-1!==e.indexOf(n)&&(i=Math.min(e.indexOf(n)+1,e.length-1))}this.selection.select(e[i])}selectPrevious(){const e=this.dataSource.items$.value;let i=0;if(this.selection.hasValue()){const n=this.selection.selected[0];-1!==e.indexOf(n)&&(i=Math.max(e.indexOf(n)-1,0))}this.selection.select(e[i])}applySelection(){if(this.selection.hasValue()){const e=this.selection.selected[0];e.parameter&&-1!==this.dataSource.items$.value.indexOf(e)&&this.router.navigate(["/telemetry/parameters",e.parameter?.qualifiedName],{queryParams:{c:this.yamcs.context}})}}ngOnDestroy(){this.queryParamMapSubscription?.unsubscribe(),this.dataSource.disconnect()}static#t=this.\u0275fac=function(i){return new(i||a)(t.Y36(o.C8),t.Y36(C.Dx),t.Y36(b.gz),t.Y36(b.F0),t.Y36(o.jF),t.Y36(o.en))};static#e=this.\u0275cmp=t.Xpm({type:a,selectors:[["ng-component"]],viewQuery:function(i,n){if(1&i&&(t.Gf(nr,7),t.Gf(Lt.NW,7),t.Gf(o.b8,5)),2&i){let s;t.iGM(s=t.CRH())&&(n.top=s.first),t.iGM(s=t.CRH())&&(n.paginator=s.first),t.iGM(s=t.CRH())&&(n.columnChooser=s.first)}},decls:24,vars:18,consts:[["top",""],[1,"panel-content"],[3,"formGroup"],[4,"ngIf"],[1,"filter-bar"],["placeholder","Search by name","icon","search",3,"formControl","onArrowDown","onArrowUp","onEnter"],["formControlName","type",3,"options"],["formControlName","source",3,"options"],["preferenceKey","tmParameters",3,"columns"],["columnChooser",""],["mat-table","","class","ya-data-table expand",3,"dataSource",4,"ngIf"],[3,"pageSize","hidePageSize","showFirstLastButtons","length"],["empty",""],["dash",""],["class","filter-bar",4,"ngIf"],["link","/telemetry/parameters","icon","account_tree",3,"queryParams"],[3,"link","queryParams","label",4,"ngFor","ngForOf"],[3,"link","queryParams","label"],["mat-table","",1,"ya-data-table","expand",3,"dataSource"],["matColumnDef","name"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","","class","primary-td",4,"matCellDef"],["matColumnDef","rawValue"],["mat-header-cell","","class","wrap200",4,"matHeaderCellDef"],["mat-cell","",4,"cdkCellDef"],["matColumnDef","engValue"],["mat-cell","",3,"alert",4,"matCellDef"],["matColumnDef","type"],["mat-cell","",4,"matCellDef"],["matColumnDef","dataSource"],["matColumnDef","shortDescription"],[3,"matColumnDef",4,"ngFor","ngForOf"],["matColumnDef","actions"],["mat-header-cell","","class","expand",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",3,"selected",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell","",1,"primary-td"],[1,"icon12",2,"vertical-align","middle"],[3,"routerLink","queryParams"],[3,"text","term",4,"ngIf"],[3,"text","term"],["mat-header-cell","",1,"wrap200"],["mat-cell",""],[3,"pval",4,"ngIf"],[3,"pval"],["class","mono",4,"ngIf","ngIfElse"],[1,"mono"],[3,"matColumnDef"],[4,"ngIf","ngIfElse"],["mat-header-cell","",1,"expand"],["mat-header-row",""],["mat-row",""]],template:function(i,n){1&i&&(t.TgZ(0,"app-instance-page")(1,"app-instance-toolbar"),t._uU(2," Parameters "),t.qZA(),t._UZ(3,"span",null,0),t.TgZ(5,"div",1)(6,"form",2),t.YNc(7,or,2,1,"ng-container",3),t.ALo(8,"async"),t.TgZ(9,"div",4)(10,"ya-search-filter",5),t.NdJ("onArrowDown",function(){return n.selectNext()})("onArrowUp",function(){return n.selectPrevious()})("onEnter",function(){return n.applySelection()}),t.qZA(),t._UZ(11,"ya-select",6)(12,"ya-select",7)(13,"ya-column-chooser",8,9),t.YNc(15,lr,1,0,"ya-dots",3),t.ALo(16,"async"),t.qZA()(),t.YNc(17,Vr,28,10,"table",10),t._UZ(18,"mat-paginator",11),t.ALo(19,"async"),t.qZA(),t.YNc(20,Hr,5,1,"ng-template",null,12,t.W1O),t.YNc(22,Er,1,0,"ng-template",null,13,t.W1O),t.qZA()),2&i&&(t.xp6(6),t.Q6J("formGroup",n.filterForm),t.xp6(1),t.Q6J("ngIf",t.lcZ(8,12,n.breadcrumb$)),t.xp6(3),t.Q6J("formControl",n.filterForm.controls.filter),t.xp6(1),t.Q6J("options",n.typeOptions),t.xp6(1),t.Q6J("options",n.sourceOptions),t.xp6(1),t.Q6J("columns",n.columns),t.xp6(2),t.Q6J("ngIf",t.lcZ(16,14,n.dataSource.loading$)),t.xp6(2),t.Q6J("ngIf",n.dataSource),t.xp6(1),t.Q6J("pageSize",n.pageSize)("hidePageSize",!0)("showFirstLastButtons",!0)("length",t.lcZ(19,16,n.dataSource.totalSize$)))},dependencies:[g.sg,g.O5,c._Y,c.JJ,c.JL,c.oH,c.sg,c.u,b.rH,Z.O_,P.Hw,Lt.NW,p.BZ,p.fO,p.as,p.w1,p.Dz,p.nj,p.ge,p.ev,p.XQ,p.Gk,o.LI,o.O_,o.b8,o.Zy,o.g4,o.oQ,o.cF,o.Hr,k.a,U.k,g.Ov,g.OU,g.rS,o.p3,o.XB,o.Wt,o.HQ,o.VC],styles:[".primary-td[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{margin-right:7px}"],changeDetection:0})}return a})();class jr extends q.o2{constructor(r,e){super(),this.yamcs=r,this.synchronizer=e,this.binaryPreview=16,this.items$=new f.X([]),this.totalSize$=new f.X(0),this.loading$=new f.X(!1),this.idMapping={},this.latestValues=new Map}connect(){return this.syncSubscription=this.synchronizer.syncFast(()=>{this.refreshTable()}),this.items$}loadParameters(r){var e=this;return(0,E.Z)(function*(){e.loading$.next(!0),e.dataSubscription&&(e.dataSubscription.cancel(),e.dataSubscription=void 0);const i=[];for(const n of r)i.push({name:n.qualifiedName,parameter:n});e.items$.next(i),e.startSubscription(r||[])})()}refreshTable(){const r=this.items$.value;for(const e of r)e.pval=this.latestValues.get(e.name);this.items$.next([...r])}startSubscription(r){const e=r.map(i=>({name:i.qualifiedName}));e.length&&(this.dataSubscription=this.yamcs.yamcsClient.createParameterSubscription({instance:this.yamcs.instance,processor:this.yamcs.processor,id:e,abortOnInvalid:!1,sendFromCache:!0,updateOnExpiration:!0,maxBytes:this.binaryPreview+1,action:"REPLACE"},i=>{i.mapping&&(this.idMapping=i.mapping,this.latestValues.clear()),this.processDelivery(i.values||[]),this.loading$.next(!1)}))}processDelivery(r){for(const e of r){const i=this.idMapping[e.numericId];i&&this.latestValues.set(i.name,e)}}disconnect(){this.syncSubscription?.unsubscribe(),this.dataSubscription?.cancel(),this.items$.complete(),this.totalSize$.complete(),this.loading$.complete()}}function zr(a,r){1&a&&t._UZ(0,"ya-dots")}function Kr(a,r){1&a&&(t.TgZ(0,"th",22),t._uU(1,"Name"),t.qZA())}const Xr=function(a){return["/telemetry/parameters",a]},Wr=function(a){return{c:a}};function ts(a,r){if(1&a&&(t.TgZ(0,"td",23)(1,"a",24),t._uU(2),t.qZA()()),2&a){const e=r.$implicit,i=t.oxw(2);t.xp6(1),t.Q6J("routerLink",t.VKq(3,Xr,e.parameter.qualifiedName))("queryParams",t.VKq(5,Wr,i.yamcs.context)),t.xp6(1),t.hij("",e.name," ")}}function es(a,r){1&a&&(t.TgZ(0,"th",25),t._uU(1,"Raw value"),t.qZA())}const $t=function(a){return{maxBytes:a}};function as(a,r){if(1&a&&(t.TgZ(0,"td",23),t._uU(1),t.ALo(2,"value"),t.qZA()),2&a){const e=r.$implicit,i=t.oxw(2);t.xp6(1),t.hij(" ",t.xi3(2,1,null==e.pval?null:e.pval.rawValue,t.VKq(4,$t,i.dataSource.binaryPreview))||"-"," ")}}function is(a,r){1&a&&(t.TgZ(0,"th",25),t._uU(1,"Value"),t.qZA())}function ns(a,r){if(1&a&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"units"),t.ALo(3,"parameterTypeForPath"),t.qZA()),2&a){const e=t.oxw(2).$implicit;let i;t.xp6(1),t.hij(" ",t.lcZ(2,1,null==(i=t.lcZ(3,3,e.parameter))?null:i.unitSet)," ")}}function rs(a,r){1&a&&(t.TgZ(0,"span"),t._uU(1,"\u2193"),t.qZA())}function ss(a,r){1&a&&(t.TgZ(0,"span"),t._uU(1,"\u2191"),t.qZA())}function os(a,r){if(1&a&&(t.TgZ(0,"ya-expirable",27),t._uU(1),t.ALo(2,"value"),t.YNc(3,ns,4,5,"span",1),t.YNc(4,rs,2,0,"span",1),t.YNc(5,ss,2,0,"span",1),t.qZA()),2&a){const e=t.oxw().$implicit,i=t.oxw(2);t.Q6J("pval",e.pval),t.xp6(1),t.hij(" ",t.xi3(2,5,null==e.pval?null:e.pval.engValue,t.VKq(8,$t,i.dataSource.binaryPreview))||"-"," "),t.xp6(2),t.Q6J("ngIf",null==e.parameter||null==e.parameter.type?null:e.parameter.type.unitSet),t.xp6(1),t.Q6J("ngIf","LOW"===(null==e.pval?null:e.pval.rangeCondition)),t.xp6(1),t.Q6J("ngIf","HIGH"===(null==e.pval?null:e.pval.rangeCondition))}}function ls(a,r){1&a&&(t.TgZ(0,"span"),t._uU(1,"-"),t.qZA())}function cs(a,r){if(1&a&&(t.TgZ(0,"td",23),t.YNc(1,os,6,10,"ya-expirable",26),t.YNc(2,ls,2,0,"span",1),t.qZA()),2&a){const e=r.$implicit;t.ekj("alert",(null==e.pval?null:e.pval.monitoringResult)&&"IN_LIMITS"!==(null==e.pval?null:e.pval.monitoringResult)),t.xp6(1),t.Q6J("ngIf",e.pval),t.xp6(1),t.Q6J("ngIf",!e.pval)}}function _s(a,r){1&a&&(t.TgZ(0,"th",22),t._uU(1,"Type"),t.qZA())}function ps(a,r){if(1&a&&(t.TgZ(0,"span",29),t._uU(1),t.qZA()),2&a){const e=r.ngIf;t.xp6(1),t.hij(" ",e," ")}}function ms(a,r){if(1&a&&(t.TgZ(0,"td",23),t.YNc(1,ps,2,1,"span",28),t.ALo(2,"parameterTypeForPath"),t.qZA()),2&a){const e=r.$implicit;t.oxw(2);const i=t.MAs(4);let n;t.xp6(1),t.Q6J("ngIf",null==(n=t.lcZ(2,2,e.parameter))?null:n.engType)("ngIfElse",i)}}function us(a,r){1&a&&(t.TgZ(0,"th",22),t._uU(1,"Data source"),t.qZA())}function gs(a,r){if(1&a&&(t.TgZ(0,"td",23),t._uU(1),t.ALo(2,"titlecase"),t.qZA()),2&a){const e=r.$implicit;t.xp6(1),t.Oqu(t.lcZ(2,1,null==e.parameter?null:e.parameter.dataSource)||"-")}}function ds(a,r){1&a&&(t.TgZ(0,"th",25),t._uU(1,"Description"),t.qZA())}function hs(a,r){if(1&a&&(t.TgZ(0,"td",23),t._uU(1),t.qZA()),2&a){const e=r.$implicit;t.xp6(1),t.hij(" ",e.parameter.shortDescription||"-"," ")}}function fs(a,r){1&a&&t._UZ(0,"th",30)}function xs(a,r){1&a&&t._UZ(0,"td",23)}function ys(a,r){1&a&&t._UZ(0,"tr",31)}function bs(a,r){1&a&&t._UZ(0,"tr",32)}function Ts(a,r){if(1&a&&(t.ynx(0),t.TgZ(1,"div",3),t._UZ(2,"ya-column-chooser",4,5),t.YNc(4,zr,1,0,"ya-dots",1),t.ALo(5,"async"),t.qZA(),t.TgZ(6,"table",6),t.ynx(7,7),t.YNc(8,Kr,2,0,"th",8),t.YNc(9,ts,3,7,"td",9),t.BQk(),t.ynx(10,10),t.YNc(11,es,2,0,"th",11),t.YNc(12,as,3,6,"td",12),t.BQk(),t.ynx(13,13),t.YNc(14,is,2,0,"th",11),t.YNc(15,cs,3,4,"td",14),t.BQk(),t.ynx(16,15),t.YNc(17,_s,2,0,"th",8),t.YNc(18,ms,3,4,"td",9),t.BQk(),t.ynx(19,16),t.YNc(20,us,2,0,"th",8),t.YNc(21,gs,3,3,"td",9),t.BQk(),t.ynx(22,17),t.YNc(23,ds,2,0,"th",11),t.YNc(24,hs,2,1,"td",9),t.BQk(),t.ynx(25,18),t.YNc(26,fs,1,0,"th",19),t.YNc(27,xs,1,0,"td",9),t.BQk(),t.YNc(28,ys,1,0,"tr",20),t.ALo(29,"async"),t.YNc(30,bs,1,0,"tr",21),t.ALo(31,"async"),t.qZA(),t.BQk()),2&a){const e=t.MAs(3),i=t.oxw();t.xp6(2),t.Q6J("columns",i.columns),t.xp6(2),t.Q6J("ngIf",t.lcZ(5,5,i.dataSource.loading$)),t.xp6(2),t.Q6J("dataSource",i.dataSource),t.xp6(22),t.Q6J("matHeaderRowDef",t.lcZ(29,7,e.displayedColumns$)),t.xp6(2),t.Q6J("matRowDefColumns",t.lcZ(31,9,e.displayedColumns$))}}function vs(a,r){1&a&&t._uU(0,"-")}let Rt=(()=>{class a{constructor(e,i,n){this.yamcs=i,this.synchronizer=n,this.plist$=new f.X(null),this.columns=Mt,this.dataSource=new jr(this.yamcs,this.synchronizer),e.paramMap.subscribe(s=>{const l=s.get("list");this.changeList(l)})}changeList(e){this.yamcs.yamcsClient.getParameterList(this.yamcs.instance,e).then(i=>{this.plist$.next(i),this.dataSource.loadParameters(i.match||[])})}ngOnDestroy(){this.dataSource?.disconnect()}static#t=this.\u0275fac=function(i){return new(i||a)(t.Y36(b.gz),t.Y36(o.C8),t.Y36(o.jF))};static#e=this.\u0275cmp=t.Xpm({type:a,selectors:[["ng-component"]],viewQuery:function(i,n){if(1&i&&t.Gf(o.b8,5),2&i){let s;t.iGM(s=t.CRH())&&(n.columnChooser=s.first)}},decls:5,vars:3,consts:[[1,"panel-content"],[4,"ngIf"],["dash",""],[1,"filter-bar"],["preferenceKey","tmParameters",3,"columns"],["columnChooser",""],["mat-table","",1,"ya-data-table","expand",3,"dataSource"],["matColumnDef","name"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","rawValue"],["mat-header-cell","","class","wrap200",4,"matHeaderCellDef"],["mat-cell","",4,"cdkCellDef"],["matColumnDef","engValue"],["mat-cell","",3,"alert",4,"matCellDef"],["matColumnDef","type"],["matColumnDef","dataSource"],["matColumnDef","shortDescription"],["matColumnDef","actions"],["mat-header-cell","","class","expand",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],[3,"routerLink","queryParams"],["mat-header-cell","",1,"wrap200"],[3,"pval",4,"ngIf"],[3,"pval"],["class","mono",4,"ngIf","ngIfElse"],[1,"mono"],["mat-header-cell","",1,"expand"],["mat-header-row",""],["mat-row",""]],template:function(i,n){1&i&&(t.TgZ(0,"div",0),t.YNc(1,Ts,32,11,"ng-container",1),t.ALo(2,"async"),t.qZA(),t.YNc(3,vs,1,0,"ng-template",null,2,t.W1O)),2&i&&(t.xp6(1),t.Q6J("ngIf",t.lcZ(2,1,n.plist$)))},dependencies:[g.O5,b.rH,Z.O_,p.BZ,p.fO,p.as,p.w1,p.Dz,p.nj,p.ge,p.ev,p.XQ,p.Gk,o.b8,o.Zy,o.g4,g.Ov,g.rS,o.Wt,o.HQ,o.VC],encapsulation:2,changeDetection:0})}return a})();const it=function(a){return{c:a}};function Zs(a,r){if(1&a&&(t.TgZ(0,"a",15)(1,"mat-icon"),t._uU(2,"add_circle_outline"),t.qZA(),t._uU(3," Create list "),t.qZA()),2&a){const e=t.oxw();t.Q6J("queryParams",t.VKq(1,it,e.yamcs.context))}}function Ps(a,r){1&a&&(t.TgZ(0,"th",16),t._uU(1,"Name"),t.qZA())}function ws(a,r){if(1&a&&(t.TgZ(0,"td",17)(1,"a",18),t._uU(2),t.qZA()()),2&a){const e=r.$implicit,i=t.oxw();t.xp6(1),t.Q6J("routerLink",e.id)("queryParams",t.VKq(3,it,i.yamcs.context)),t.xp6(1),t.Oqu(e.name)}}function As(a,r){1&a&&(t.TgZ(0,"th",16),t._uU(1,"Description"),t.qZA())}function Ss(a,r){if(1&a&&(t.TgZ(0,"td",19),t._uU(1),t.qZA()),2&a){const e=r.$implicit;t.xp6(1),t.Oqu(e.description||"-")}}function Cs(a,r){1&a&&t._UZ(0,"th",20)}const ks=function(a){return[a,"edit"]};function Us(a,r){if(1&a){const e=t.EpF();t.TgZ(0,"td",17)(1,"ya-more")(2,"a",21),t._uU(3," Edit list "),t.qZA(),t.TgZ(4,"button",22),t.NdJ("click",function(){const s=t.CHM(e).$implicit,l=t.oxw();return t.KtG(l.deleteList(s))}),t._uU(5," Delete list "),t.qZA()()()}if(2&a){const e=r.$implicit,i=t.oxw();t.xp6(2),t.Q6J("routerLink",t.VKq(2,ks,e.id))("queryParams",t.VKq(4,it,i.yamcs.context))}}function qs(a,r){1&a&&t._UZ(0,"tr",23)}function Ds(a,r){1&a&&t._UZ(0,"tr",24)}function Ns(a,r){1&a&&(t.TgZ(0,"ya-empty-message"),t._uU(1," No rows to display "),t.qZA())}let Ft=(()=>{class a{constructor(e,i,n,s,l,_){this.yamcs=e,this.authService=i,this.route=s,this.router=l,this.messageService=_,this.filterControl=new c.p4,this.displayedColumns=["name","description","actions"],this.dataSource=new p.by,n.setTitle("Parameter lists"),this.dataSource.filterPredicate=(m,u)=>m.name.toLowerCase().indexOf(u)>=0}ngAfterViewInit(){const e=this.route.snapshot.queryParamMap;e.has("filter")&&(this.filterControl.setValue(e.get("filter")),this.dataSource.filter=e.get("filter").toLowerCase()),this.filterControl.valueChanges.subscribe(()=>{this.updateURL(),this.dataSource.filter=(this.filterControl.value||"").toLowerCase()}),this.refresh()}mayManageParameterLists(){return this.authService.getUser().hasSystemPrivilege("ManageParameterLists")}refresh(){this.yamcs.yamcsClient.getParameterLists(this.yamcs.instance).then(e=>{this.dataSource.data=e}).catch(e=>this.messageService.showError(e))}updateURL(){this.router.navigate([],{replaceUrl:!0,relativeTo:this.route,queryParams:{filter:this.filterControl.value||null},queryParamsHandling:"merge"})}deleteList(e){confirm(`Are you sure you want to delete the list '${e.name}'`)&&this.yamcs.yamcsClient.deleteParameterList(this.yamcs.instance,e.id).then(()=>this.refresh()).catch(i=>this.messageService.showError(i))}static#t=this.\u0275fac=function(i){return new(i||a)(t.Y36(o.C8),t.Y36(D.e),t.Y36(C.Dx),t.Y36(b.gz),t.Y36(b.F0),t.Y36(o.ez))};static#e=this.\u0275cmp=t.Xpm({type:a,selectors:[["ng-component"]],decls:20,vars:6,consts:[["mat-button","","color","primary","routerLink","create",3,"queryParams",4,"ngIf"],[1,"panel-content"],[1,"filter-bar"],["placeholder","Filter lists",3,"formControl"],["mat-table","",1,"ya-data-table","expand",3,"dataSource"],["matColumnDef","name"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","","style","vertical-align: top",4,"matCellDef"],["matColumnDef","description"],["mat-cell","","class","wrap400","style","white-space: pre-wrap",4,"matCellDef"],["matColumnDef","actions"],["mat-header-cell","","class","expand",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],[4,"ngIf"],["mat-button","","color","primary","routerLink","create",3,"queryParams"],["mat-header-cell",""],["mat-cell","",2,"vertical-align","top"],[3,"routerLink","queryParams"],["mat-cell","",1,"wrap400",2,"white-space","pre-wrap"],["mat-header-cell","",1,"expand"],["mat-menu-item","",3,"routerLink","queryParams"],["mat-menu-item","",3,"click"],["mat-header-row",""],["mat-row",""]],template:function(i,n){1&i&&(t.TgZ(0,"app-instance-page")(1,"app-instance-toolbar"),t._uU(2," Parameter lists \xa0\xa0\xa0 "),t.YNc(3,Zs,4,3,"a",0),t.qZA(),t.TgZ(4,"div",1)(5,"div",2),t._UZ(6,"ya-search-filter",3),t.qZA(),t.TgZ(7,"table",4),t.ynx(8,5),t.YNc(9,Ps,2,0,"th",6),t.YNc(10,ws,3,5,"td",7),t.BQk(),t.ynx(11,8),t.YNc(12,As,2,0,"th",6),t.YNc(13,Ss,2,1,"td",9),t.BQk(),t.ynx(14,10),t.YNc(15,Cs,1,0,"th",11),t.YNc(16,Us,6,6,"td",7),t.BQk(),t.YNc(17,qs,1,0,"tr",12),t.YNc(18,Ds,1,0,"tr",13),t.qZA(),t.YNc(19,Ns,2,0,"ya-empty-message",14),t.qZA()()),2&i&&(t.xp6(3),t.Q6J("ngIf",n.mayManageParameterLists()),t.xp6(3),t.Q6J("formControl",n.filterControl),t.xp6(1),t.Q6J("dataSource",n.dataSource),t.xp6(10),t.Q6J("matHeaderRowDef",n.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",n.displayedColumns),t.xp6(1),t.Q6J("ngIf",!n.dataSource.data.length))},dependencies:[g.O5,c.JJ,c.oH,b.rH,w.zs,P.Hw,S.OP,p.BZ,p.fO,p.as,p.w1,p.Dz,p.nj,p.ge,p.ev,p.XQ,p.Gk,o.RR,o.cQ,o.cF,k.a,U.k],encapsulation:2,changeDetection:0})}return a})();class Is extends q.o2{constructor(r,e){super(),this.yamcs=r,this.qualifiedName=e,this.pageSize=100,this.alarms$=new f.X([]),this.loading$=new f.X(!1)}connect(r){return this.alarms$}isEmpty(){return 0===this.alarms$.value.length}loadAlarms(r){return this.loading$.next(!0),this.loadPage({...r,limit:this.pageSize+1}).then(e=>{this.loading$.next(!1),this.alarms$.next(e)})}hasMore(){return null!=this.offscreenRecord}loadPage(r){return this.yamcs.yamcsClient.getAlarmsForParameter(this.yamcs.instance,this.qualifiedName,r).then(e=>(this.offscreenRecord=e.length>this.pageSize?e.splice(e.length-1,1)[0]:null,e))}loadMoreData(r){this.offscreenRecord&&this.loadPage({...r,stop:this.offscreenRecord.triggerTime,limit:this.pageSize+1}).then(e=>{const i=this.alarms$.getValue().concat(e);this.alarms$.next(i)})}disconnect(r){this.alarms$.complete(),this.loading$.complete()}}var N=y(3304);function Qs(a,r){1&a&&(t.TgZ(0,"th",18),t._uU(1,"Severity"),t.qZA())}function Ls(a,r){if(1&a&&(t.TgZ(0,"td",19),t._UZ(1,"app-alarm-level",20),t.qZA()),2&a){const e=r.$implicit;t.xp6(1),t.Q6J("level",e.severity)("grayscale",!0)}}function Js(a,r){1&a&&(t.TgZ(0,"th",18),t._uU(1,"Start"),t.qZA())}function Ys(a,r){if(1&a&&(t.TgZ(0,"td",19),t._uU(1),t.ALo(2,"datetime"),t.qZA()),2&a){const e=r.$implicit;t.xp6(1),t.Oqu(t.lcZ(2,1,e.triggerTime)||"-")}}function Ms(a,r){1&a&&(t.TgZ(0,"th",18),t._uU(1,"Stop"),t.qZA())}function Os(a,r){if(1&a&&(t.TgZ(0,"td",19),t._uU(1),t.ALo(2,"datetime"),t.qZA()),2&a){const e=r.$implicit;t.xp6(1),t.hij(" ",t.lcZ(2,1,e.updateTime)||"-"," ")}}function $s(a,r){1&a&&(t.TgZ(0,"th",18),t._uU(1,"Trip value"),t.qZA())}function Rs(a,r){1&a&&(t.TgZ(0,"span"),t._uU(1,"\u2193"),t.qZA())}function Fs(a,r){1&a&&(t.TgZ(0,"span"),t._uU(1,"\u2191"),t.qZA())}function Vs(a,r){if(1&a&&(t.ynx(0),t._uU(1),t.ALo(2,"value"),t.YNc(3,Rs,2,0,"span",22),t.YNc(4,Fs,2,0,"span",22),t.BQk()),2&a){const e=r.ngIf;t.xp6(1),t.hij(" ",t.lcZ(2,3,e.triggerValue.engValue)," "),t.xp6(2),t.Q6J("ngIf","LOW"===e.triggerValue.rangeCondition),t.xp6(1),t.Q6J("ngIf","HIGH"===e.triggerValue.rangeCondition)}}function Hs(a,r){if(1&a&&(t.TgZ(0,"td",21),t.YNc(1,Vs,5,5,"ng-container",22),t.qZA()),2&a){const e=r.$implicit;t.xp6(1),t.Q6J("ngIf",e.parameterDetail)}}function Es(a,r){1&a&&(t.TgZ(0,"th",18),t._uU(1,"Duration"),t.qZA())}function Bs(a,r){if(1&a&&(t.ynx(0),t._uU(1),t.ALo(2,"duration"),t.BQk()),2&a){const e=t.oxw().$implicit,i=t.oxw(2);t.xp6(1),t.hij(" ",t.lcZ(2,1,i.durationFor(e))||"-"," ")}}function Gs(a,r){if(1&a&&(t.TgZ(0,"mat-icon",24),t._uU(1,"comment"),t.qZA()),2&a){const e=t.oxw(2).$implicit;t.Q6J("matTooltip",null==e.clearInfo?null:e.clearInfo.clearMessage)}}function js(a,r){if(1&a&&(t.ynx(0),t._uU(1),t.YNc(2,Gs,2,1,"mat-icon",23),t.BQk()),2&a){const e=t.oxw().$implicit;t.xp6(1),t.hij(" (cleared by ",null==e.clearInfo?null:e.clearInfo.clearedBy,") "),t.xp6(1),t.Q6J("ngIf",null==e.clearInfo?null:e.clearInfo.clearMessage)}}function zs(a,r){if(1&a&&(t.TgZ(0,"td",19),t.YNc(1,Bs,3,3,"ng-container",22),t.YNc(2,js,3,2,"ng-container",22),t.qZA()),2&a){const e=r.$implicit;t.xp6(1),t.Q6J("ngIf",e.updateTime),t.xp6(1),t.Q6J("ngIf",null==e.clearInfo?null:e.clearInfo.clearedBy)}}function Ks(a,r){1&a&&(t.TgZ(0,"th",25),t._uU(1,"Violations"),t.qZA())}function Xs(a,r){if(1&a&&(t.ynx(0),t._uU(1),t.ALo(2,"number"),t.ALo(3,"number"),t.BQk()),2&a){const e=t.oxw().$implicit;t.xp6(1),t.AsE(" ",t.lcZ(2,2,e.violations)," (",t.xi3(3,4,e.violations/e.count*100,"1.2-2"),"%) ")}}function Ws(a,r){if(1&a&&(t.TgZ(0,"td",26),t.YNc(1,Xs,4,7,"ng-container",27),t.qZA()),2&a){const e=r.$implicit;t.oxw(2);const i=t.MAs(2);t.xp6(1),t.Q6J("ngIf",e.violations)("ngIfElse",i)}}function to(a,r){1&a&&t._UZ(0,"th",28)}function eo(a,r){if(1&a){const e=t.EpF();t.TgZ(0,"td",19)(1,"ya-text-action",29),t.NdJ("click",function(){const s=t.CHM(e).$implicit,l=t.oxw(2);return t.KtG(l.showChart(s))}),t._uU(2," SHOW CHART "),t.qZA(),t.TgZ(3,"ya-text-action",30),t.NdJ("click",function(){const s=t.CHM(e).$implicit,l=t.oxw(2);return t.KtG(l.showData(s))}),t._uU(4," SHOW DATA "),t.qZA()()}}function ao(a,r){1&a&&t._UZ(0,"tr",31)}function io(a,r){1&a&&t._UZ(0,"tr",32)}function no(a,r){if(1&a&&(t.TgZ(0,"table",2),t.ynx(1,3),t.YNc(2,Qs,2,0,"th",4),t.YNc(3,Ls,2,2,"td",5),t.BQk(),t.ynx(4,6),t.YNc(5,Js,2,0,"th",4),t.YNc(6,Ys,3,3,"td",5),t.BQk(),t.ynx(7,7),t.YNc(8,Ms,2,0,"th",4),t.YNc(9,Os,3,3,"td",5),t.BQk(),t.ynx(10,8),t.YNc(11,$s,2,0,"th",4),t.YNc(12,Hs,2,1,"td",9),t.BQk(),t.ynx(13,10),t.YNc(14,Es,2,0,"th",4),t.YNc(15,zs,3,2,"td",5),t.BQk(),t.ynx(16,11),t.YNc(17,Ks,2,0,"th",12),t.YNc(18,Ws,2,2,"td",13),t.BQk(),t.ynx(19,14),t.YNc(20,to,1,0,"th",15),t.YNc(21,eo,5,0,"td",5),t.BQk(),t.YNc(22,ao,1,0,"tr",16),t.YNc(23,io,1,0,"tr",17),t.qZA()),2&a){const e=t.oxw();t.Q6J("dataSource",e.dataSource),t.xp6(22),t.Q6J("matHeaderRowDef",e.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",e.displayedColumns)}}function ro(a,r){1&a&&t._uU(0,"-")}let so=(()=>{class a{constructor(e,i){this.router=e,this.yamcs=i,this.displayedColumns=["severity","start","stop","duration","triggerValue","violations","actions"]}durationFor(e){if(e.updateTime)return o.P6.toDate(e.updateTime).getTime()-o.P6.toDate(e.triggerTime).getTime()}showChart(e){const i=e.triggerTime,n=e.updateTime||e.clearInfo?.clearTime;let s,l;n?(s=N.utc(i),l=N.utc(n)):(s=N.utc(i),l=N.utc(n).add(1,"hour")),this.router.navigate(["/telemetry/parameters",e.parameterDetail?.triggerValue.id.name,"chart"],{queryParams:{c:this.yamcs.context,interval:"CUSTOM",customStart:s.toISOString(),customStop:l.toISOString()}})}showData(e){const i=e.triggerTime,n=e.updateTime||e.clearInfo?.clearTime;let s,l;n?(s=N.utc(i),l=N.utc(n)):(s=N.utc(i),l=N.utc(n).add(1,"hour")),this.router.navigate(["/telemetry/parameters",e.parameterDetail?.triggerValue.id.name,"data"],{queryParams:{c:this.yamcs.context,interval:"CUSTOM",customStart:s.toISOString(),customStop:l.toISOString()}})}static#t=this.\u0275fac=function(i){return new(i||a)(t.Y36(b.F0),t.Y36(o.C8))};static#e=this.\u0275cmp=t.Xpm({type:a,selectors:[["app-parameter-alarms-table"]],inputs:{dataSource:"dataSource"},decls:3,vars:1,consts:[["mat-table","","class","ya-data-table expand",3,"dataSource",4,"ngIf"],["dash",""],["mat-table","",1,"ya-data-table","expand",3,"dataSource"],["matColumnDef","severity"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","start"],["matColumnDef","stop"],["matColumnDef","triggerValue"],["mat-cell","","class","wrap200",4,"matCellDef"],["matColumnDef","duration"],["matColumnDef","violations"],["mat-header-cell","","style","text-align: right",4,"matHeaderCellDef"],["mat-cell","","style","text-align: right",4,"matCellDef"],["matColumnDef","actions"],["mat-header-cell","","class","expand",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],[3,"level","grayscale"],["mat-cell","",1,"wrap200"],[4,"ngIf"],[3,"matTooltip",4,"ngIf"],[3,"matTooltip"],["mat-header-cell","",2,"text-align","right"],["mat-cell","",2,"text-align","right"],[4,"ngIf","ngIfElse"],["mat-header-cell","",1,"expand"],["icon","show_chart",3,"click"],["icon","view_headline",3,"click"],["mat-header-row",""],["mat-row",""]],template:function(i,n){1&i&&(t.YNc(0,no,24,3,"table",0),t.YNc(1,ro,1,0,"ng-template",null,1,t.W1O)),2&i&&t.Q6J("ngIf",n.dataSource)},dependencies:[g.O5,P.Hw,p.BZ,p.fO,p.as,p.w1,p.Dz,p.nj,p.ge,p.ev,p.XQ,p.Gk,X.gM,o.ll,Y.i,g.JJ,o.id,o.uG,o.VC],encapsulation:2,changeDetection:0})}return a})();function oo(a,r){if(1&a){const e=t.EpF();t.ynx(0),t._UZ(1,"ya-date-time-input",8)(2,"ya-date-time-input",9),t.TgZ(3,"button",10),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.applyCustomDates())}),t._uU(4,"Apply"),t.qZA(),t.BQk()}if(2&a){const e=t.oxw();t.xp6(3),t.Q6J("disabled",e.filter.invalid)}}function lo(a,r){if(1&a){const e=t.EpF();t.ynx(0),t.TgZ(1,"button",11),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.jumpToNow())}),t._uU(2," Jump to now "),t.qZA(),t.BQk()}}function co(a,r){1&a&&t._UZ(0,"ya-dots")}function _o(a,r){if(1&a&&(t.TgZ(0,"span"),t._uU(1," Showing data from "),t.TgZ(2,"b"),t._uU(3,"the last month"),t.qZA(),t._uU(4," ending at "),t.TgZ(5,"b"),t._uU(6),t.ALo(7,"datetime"),t.qZA(),t._uU(8," (Mission Time) "),t.qZA()),2&a){const e=t.oxw();t.xp6(6),t.Oqu(t.lcZ(7,1,e.validStop))}}function po(a,r){if(1&a&&(t.TgZ(0,"span"),t._uU(1," Showing data from "),t.TgZ(2,"b"),t._uU(3,"the last year"),t.qZA(),t._uU(4," ending at "),t.TgZ(5,"b"),t._uU(6),t.ALo(7,"datetime"),t.qZA(),t._uU(8," (Mission Time) "),t.qZA()),2&a){const e=t.oxw();t.xp6(6),t.Oqu(t.lcZ(7,1,e.validStop))}}function mo(a,r){1&a&&(t.TgZ(0,"span"),t._uU(1," Showing data from "),t.TgZ(2,"b"),t._uU(3,"all time"),t.qZA()())}function uo(a,r){if(1&a&&(t.TgZ(0,"span"),t._uU(1," Showing data from "),t.TgZ(2,"b"),t._uU(3),t.ALo(4,"datetime"),t.qZA(),t._uU(5," to "),t.TgZ(6,"b"),t._uU(7),t.ALo(8,"datetime"),t.qZA(),t._uU(9," (Mission Time) "),t.qZA()),2&a){const e=t.oxw();t.xp6(3),t.Oqu(t.lcZ(4,2,e.validStart)),t.xp6(4),t.Oqu(t.lcZ(8,4,e.validStop))}}function go(a,r){1&a&&(t.TgZ(0,"ya-empty-message"),t._uU(1," No records found matching current filter in the selected time range. "),t.qZA())}function ho(a,r){if(1&a){const e=t.EpF();t.TgZ(0,"mat-toolbar"),t._UZ(1,"span",12),t.TgZ(2,"button",10),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.loadMoreData())}),t._uU(3,"Load More"),t.qZA(),t._UZ(4,"span",12),t.qZA()}if(2&a){const e=t.oxw();t.xp6(2),t.Q6J("disabled",!e.dataSource.hasMore())}}const j="P1M";let Vt=(()=>{class a{constructor(e,i){this.yamcs=i,this.intervalOptions=[{id:"P1M",label:"Last Month"},{id:"P1Y",label:"Last Year"},{id:"NO_LIMIT",label:"No Limit"},{id:"CUSTOM",label:"Custom"}],this.filter=new c.nJ({interval:new c.p4(j),customStart:new c.p4(null),customStop:new c.p4(null)}),this.qualifiedName=e.parent.snapshot.paramMap.get("qualifiedName"),this.dataSource=new Is(i,this.qualifiedName),this.validStop=i.getMissionTime(),this.validStart=o.P6.subtractDuration(this.validStop,j),this.appliedInterval=j,this.loadData(),this.filter.get("interval").valueChanges.forEach(n=>{if("CUSTOM"===n){const s=this.validStart||this.yamcs.getMissionTime(),l=this.validStop||this.yamcs.getMissionTime();this.filter.get("customStart").setValue(o.P6.toISOString(s)),this.filter.get("customStop").setValue(o.P6.toISOString(l))}else"NO_LIMIT"===n?(this.validStart=null,this.validStop=null,this.appliedInterval=n,this.loadData()):(this.validStop=i.getMissionTime(),this.validStart=o.P6.subtractDuration(this.validStop,n),this.appliedInterval=n,this.loadData())})}jumpToNow(){const e=this.filter.value.interval;"NO_LIMIT"===e?this.filter.get("interval").setValue(j):(this.validStop=this.yamcs.getMissionTime(),this.validStart=o.P6.subtractDuration(this.validStop,e),this.loadData())}applyCustomDates(){this.validStart=o.P6.toDate(this.filter.value.customStart),this.validStop=o.P6.toDate(this.filter.value.customStop),this.appliedInterval="CUSTOM",this.loadData()}loadData(){const e={detail:!0};this.validStart&&(e.start=this.validStart.toISOString()),this.validStop&&(e.stop=this.validStop.toISOString()),this.dataSource.loadAlarms(e)}loadMoreData(){const e={detail:!0};this.validStart&&(e.start=this.validStart.toISOString()),this.dataSource.loadMoreData(e)}static#t=this.\u0275fac=function(i){return new(i||a)(t.Y36(b.gz),t.Y36(o.C8))};static#e=this.\u0275cmp=t.Xpm({type:a,selectors:[["ng-component"]],decls:17,vars:17,consts:[[1,"panel-content"],[3,"formGroup"],[1,"filter-bar"],["formControlName","interval","icon","access_time",3,"options"],[4,"ngIf"],[1,"table-status",3,"ngSwitch"],[4,"ngSwitchCase"],[3,"dataSource"],["formControlName","customStart"],["formControlName","customStop"],[1,"ya-button",3,"disabled","click"],[1,"ya-button",3,"click"],[2,"flex","1 1 auto"]],template:function(i,n){1&i&&(t.TgZ(0,"div",0)(1,"form",1)(2,"div",2),t._UZ(3,"ya-select",3),t.YNc(4,oo,5,1,"ng-container",4),t.YNc(5,lo,3,0,"ng-container",4),t.YNc(6,co,1,0,"ya-dots",4),t.ALo(7,"async"),t.qZA()(),t.TgZ(8,"div",5),t.YNc(9,_o,9,3,"span",6),t.YNc(10,po,9,3,"span",6),t.YNc(11,mo,4,0,"span",6),t.YNc(12,uo,10,6,"span",6),t.qZA(),t._UZ(13,"app-parameter-alarms-table",7),t.YNc(14,go,2,0,"ya-empty-message",4),t.YNc(15,ho,5,1,"mat-toolbar",4),t.ALo(16,"async"),t.qZA()),2&i&&(t.xp6(1),t.Q6J("formGroup",n.filter),t.xp6(2),t.Q6J("options",n.intervalOptions),t.xp6(1),t.Q6J("ngIf","CUSTOM"===n.filter.value.interval),t.xp6(1),t.Q6J("ngIf","CUSTOM"!==n.filter.value.interval),t.xp6(1),t.Q6J("ngIf",t.lcZ(7,13,n.dataSource.loading$)),t.xp6(2),t.Q6J("ngSwitch",n.appliedInterval),t.xp6(1),t.Q6J("ngSwitchCase","P1M"),t.xp6(1),t.Q6J("ngSwitchCase","P1Y"),t.xp6(1),t.Q6J("ngSwitchCase","NO_LIMIT"),t.xp6(1),t.Q6J("ngSwitchCase","CUSTOM"),t.xp6(1),t.Q6J("dataSource",n.dataSource),t.xp6(1),t.Q6J("ngIf",n.dataSource.isEmpty()),t.xp6(1),t.Q6J("ngIf",!t.lcZ(16,15,n.dataSource.loading$)&&!n.dataSource.isEmpty()))},dependencies:[g.O5,g.RF,g.n9,c._Y,c.JJ,c.JL,c.sg,c.u,at.Ye,o.t,o.Zy,o.RR,o.Hr,so,g.Ov,o.id],styles:[".table-status[_ngcontent-%COMP%]{background-color:#f7f7f7;height:24px;line-height:24px;font-size:12px;padding-left:6px}"],changeDetection:0})}return a})();class fo{constructor(r){this.watermarkObserver=r,this.dirty=!1,this.valueRange=[null,null],this.archiveSamples=[],this.bufferSize=500,this.bufferWatermark=400,this.pointer=0,this.alreadyWarned=!1,this.realtimeBuffer=Array(this.bufferSize).fill(void 0)}setArchiveData(r){this.archiveSamples=r,this.dirty=!0}setValueRange(r){this.valueRange=r}addRealtimeValue(r){this.pointer<this.bufferSize&&(this.realtimeBuffer[this.pointer]=r,this.pointer>=this.bufferWatermark&&this.watermarkObserver&&!this.alreadyWarned&&(this.watermarkObserver(),this.alreadyWarned=!0),this.pointer=this.pointer+1),this.dirty=!0}reset(){this.archiveSamples=[],this.realtimeBuffer.fill(void 0),this.pointer=0,this.alreadyWarned=!1,this.valueRange=[null,null],this.dirty=!0}snapshot(){const r=this.realtimeBuffer.filter(n=>void 0!==n);let e=null;r.length>0&&(e=r[0][0].getTime());const i=this.archiveSamples.filter(n=>null===e||n[0].getTime()<e).concat(r).sort((n,s)=>n[0].getTime()-s[0].getTime());return{valueRange:this.valueRange,samples:i}}}class xo{constructor(r,e){this.yamcs=r,this.loading$=new f.X(!1),this.data$=new f.X({valueRange:[null,null],samples:[]}),this.parameters$=new f.X([]),this.latestRealtimeValues=new Map,this.syncSubscription=e.sync(()=>{if(this.plotBuffer.dirty&&!this.loading$.getValue()){const i=this.plotBuffer.snapshot();this.data$.next({samples:i.samples,valueRange:i.valueRange}),this.plotBuffer.dirty=!1}}),this.plotBuffer=new fo(()=>{this.reloadVisibleRange()})}addParameter(...r){if(this.parameters$.next([...this.parameters$.value,...r]),this.realtimeSubscription){const e=r.map(i=>({name:i.qualifiedName}));this.addToRealtimeSubscription(e)}else this.connectRealtime()}removeParameter(r){const e=this.parameters$.value.filter(i=>i.qualifiedName!==r);this.parameters$.next(e)}reloadVisibleRange(){return this.updateWindow(this.visibleStart,this.visibleStop,[null,null])}updateWindowOnly(r,e){this.visibleStart=r,this.visibleStop=e}updateWindow(r,e,i){this.loading$.next(!0);const n=e.getTime()-r.getTime(),s=new Date(r.getTime()-n),l=new Date(e.getTime()+n),_=[];for(const u of this.parameters$.value)_.push(this.yamcs.yamcsClient.getParameterSamples(this.yamcs.instance,u.qualifiedName,{start:s.toISOString(),stop:l.toISOString(),count:6e3,fields:["time","n","avg","min","max"]}));const m=Promise.all(_);return this.lastLoadPromise=m,m.then(u=>{if(this.lastLoadPromise===m){this.loading$.next(!1),this.plotBuffer.reset(),this.latestRealtimeValues.clear(),this.visibleStart=r,this.visibleStop=e,this.minValue=void 0,this.maxValue=void 0;const h=[];for(let v=0;v<u.length;v++)h[v]=this.processSamples(u[v]);let x=this.mergeSeries(...h);this.plotBuffer.setArchiveData(x),this.plotBuffer.setValueRange(i),this.lastLoadPromise=null}})}connectRealtime(){const r=this.parameters$.value.map(e=>({name:e.qualifiedName}));this.realtimeSubscription=this.yamcs.yamcsClient.createParameterSubscription({instance:this.yamcs.instance,processor:this.yamcs.processor,id:r,sendFromCache:!1,updateOnExpiration:!0,abortOnInvalid:!0,action:"REPLACE"},e=>{e.mapping&&(this.idMapping={...this.idMapping,...e.mapping}),e.values&&e.values.length&&this.processRealtimeDelivery(e.values)})}addToRealtimeSubscription(r){this.realtimeSubscription.sendMessage({instance:this.yamcs.instance,processor:this.yamcs.processor,id:r,sendFromCache:!1,updateOnExpiration:!0,abortOnInvalid:!0,action:"ADD"})}processRealtimeDelivery(r){for(const s of r){let l=null;const _=o.P6.convertValueToNumber(s.engValue);null!==_&&("EXPIRED"===s.acquisitionStatus?l=null:"ACQUIRED"===s.acquisitionStatus&&(l=[_,_,_])),this.latestRealtimeValues.set(this.idMapping[s.numericId].name,l)}const e=new Date;e.setTime(Date.parse(r[0].generationTime));const n=[e,...this.parameters$.value.map(s=>this.latestRealtimeValues.get(s.qualifiedName)||null)];this.plotBuffer.addRealtimeValue(n)}disconnect(){this.data$.complete(),this.loading$.complete(),this.realtimeSubscription&&this.realtimeSubscription.cancel(),this.syncSubscription&&this.syncSubscription.unsubscribe()}processSamples(r){const e=[];for(const i of r){const n=new Date;if(n.setTime(Date.parse(i.time)),i.n>0){const s=i.avg,l=i.min,_=i.max;void 0===this.minValue?(this.minValue=l,this.maxValue=_):(this.minValue>l&&(this.minValue=l),this.maxValue<_&&(this.maxValue=_)),e.push([n,[l,s,_]])}else e.push([n,null])}return e}mergeSeries(...r){if(1===r.length)return r[0];let e=r[0];for(let i=1;i<r.length;i++){const n=[];let s=0,l=0,_=[],m=null;const u=e,h=r[i];for(;s<u.length||l<h.length;){const x=s<u.length?u[s]:null,v=l<h.length?h[l]:null;x&&v?x[0].getTime()===v[0].getTime()?(_=x.slice(1),m=v[1],n.push([x[0],..._,m]),s++,l++):x[0].getTime()<v[0].getTime()?(_=x.slice(1),n.push([x[0],..._,m]),s++):(m=v[1],n.push([v[0],..._,m]),l++):x?(_=x.slice(1),n.push([x[0],..._,m]),s++):v&&(m=v[1],n.push([v[0],..._,m]),l++)}e=n}return e}}var Ht=y(315),Et=y(3928),yo=y(3620),bo=y(4664),Bt=y(7398),Gt=y(4630),To=y(3680),vo=y(2018),Zo=y(5148);const Po=["palette"],wo=["thickness"];function Ao(a,r){if(1&a&&(t.TgZ(0,"mat-option",12),t.ALo(1,"memberPath"),t._uU(2),t.ALo(3,"memberPath"),t.qZA()),2&a){const e=r.$implicit;t.Q6J("value",t.lcZ(1,2,e)),t.xp6(2),t.hij(" ",t.lcZ(3,4,e)," ")}}let So=(()=>{class a{constructor(e,i,n,s){this.dialogRef=e,this.yamcs=i,this.data=n,this.memberPathPipe=s,this.parameter=new c.p4(null,[c.kI.required])}ngOnInit(){const e=this.data.exclude;this.filteredOptions=this.parameter.valueChanges.pipe((0,yo.b)(300),(0,bo.w)(i=>this.yamcs.yamcsClient.getParameters(this.yamcs.instance,{q:i,limit:10,searchMembers:!0})),(0,Bt.U)(i=>i.parameters||[]),(0,Bt.U)(i=>i.filter(n=>{for(const s of e){const l=this.memberPathPipe.transform(n);if(s.qualifiedName===l)return!1}return!0})))}select(){this.dialogRef.close({qualifiedName:this.parameter.value,color:this.palette.selectedColor,thickness:this.thickness.selectedThickness})}static#t=this.\u0275fac=function(i){return new(i||a)(t.Y36(d.so),t.Y36(o.C8),t.Y36(d.WI),t.Y36(o.en))};static#e=this.\u0275cmp=t.Xpm({type:a,selectors:[["app-compare-parameter-dialog"]],viewQuery:function(i,n){if(1&i&&(t.Gf(Po,7),t.Gf(wo,7)),2&i){let s;t.iGM(s=t.CRH())&&(n.palette=s.first),t.iGM(s=t.CRH())&&(n.thickness=s.first)}},decls:23,vars:7,consts:[[1,"mat-typography","ya-form"],["type","text",3,"formControl","matAutocomplete"],[1,"ya-autocomplete"],["auto",""],[3,"value",4,"ngFor","ngForOf"],[1,"mat-typography"],["palette",""],[3,"color"],["thickness",""],["align","end"],["mat-dialog-close","",1,"ya-button"],[1,"ya-button","primary",3,"disabled","click"],[3,"value"]],template:function(i,n){if(1&i&&(t.TgZ(0,"mat-dialog-content",0)(1,"label"),t._uU(2," Search parameter for comparison "),t._UZ(3,"input",1),t.TgZ(4,"mat-autocomplete",2,3),t.YNc(6,Ao,4,6,"mat-option",4),t.ALo(7,"async"),t.qZA()(),t._UZ(8,"br"),t.TgZ(9,"label",5),t._uU(10,"Color"),t.qZA(),t._UZ(11,"app-color-palette",null,6)(13,"br"),t.TgZ(14,"label",5),t._uU(15,"Thickness"),t.qZA(),t._UZ(16,"app-thickness",7,8),t.qZA(),t.TgZ(18,"mat-dialog-actions",9)(19,"button",10),t._uU(20,"CANCEL"),t.qZA(),t.TgZ(21,"button",11),t.NdJ("click",function(){return n.select()}),t._uU(22,"ADD"),t.qZA()()),2&i){const s=t.MAs(5),l=t.MAs(12);t.xp6(3),t.Q6J("formControl",n.parameter)("matAutocomplete",s),t.xp6(3),t.Q6J("ngForOf",t.lcZ(7,5,n.filteredOptions)),t.xp6(10),t.Q6J("color",l.selectedColor),t.xp6(5),t.Q6J("disabled",!n.parameter.valid)}},dependencies:[g.sg,c.Fj,c.JJ,c.oH,Gt.XC,To.ey,Gt.ZL,d.ZT,d.xY,d.H8,vo.V,Zo.z,g.Ov,o.en],encapsulation:2,changeDetection:0})}return a})(),Co=(()=>{class a{constructor(e,i,n){this.dialogRef=e,this.yamcs=n,this.form=new c.nJ({start:new c.p4(null,c.kI.required),stop:new c.p4(null,c.kI.required)});let s=i.start,l=i.stop;(!s||!l)&&(l=this.yamcs.getMissionTime(),s=o.P6.subtractDuration(l,"PT1H")),this.form.setValue({start:o.P6.toISOString(s),stop:o.P6.toISOString(l)})}select(){const e=o.P6.toDate(this.form.value.start),i=o.P6.toDate(this.form.value.stop);this.dialogRef.close({start:e,stop:i})}static#t=this.\u0275fac=function(i){return new(i||a)(t.Y36(d.so),t.Y36(d.WI),t.Y36(o.C8))};static#e=this.\u0275cmp=t.Xpm({type:a,selectors:[["app-select-range-dialog"]],decls:15,vars:2,consts:[["mat-dialog-title",""],[1,"mat-typography","ya-form"],[3,"formGroup"],["formControlName","start"],["formControlName","stop"],["align","end"],["mat-dialog-close","",1,"ya-button"],[1,"ya-button","primary",3,"disabled","click"]],template:function(i,n){1&i&&(t.TgZ(0,"h2",0),t._uU(1,"Select Range"),t.qZA(),t.TgZ(2,"mat-dialog-content",1)(3,"form",2)(4,"label"),t._uU(5," Start "),t._UZ(6,"ya-date-time-input",3),t.qZA(),t.TgZ(7,"label"),t._uU(8," Stop "),t._UZ(9,"ya-date-time-input",4),t.qZA()()(),t.TgZ(10,"mat-dialog-actions",5)(11,"button",6),t._uU(12,"CANCEL"),t.qZA(),t.TgZ(13,"button",7),t.NdJ("click",function(){return n.select()}),t._uU(14,"OK"),t.qZA()()),2&i&&(t.xp6(3),t.Q6J("formGroup",n.form),t.xp6(10),t.Q6J("disabled",!n.form.valid))},dependencies:[c._Y,c.JJ,c.JL,c.sg,c.u,d.ZT,d.uh,d.xY,d.H8,o.t],encapsulation:2})}return a})();function ko(a,r){1&a&&(t.TgZ(0,"span"),t._uU(1,"Date Range"),t.qZA())}function Uo(a,r){if(1&a&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"datetime"),t.ALo(3,"datetime"),t.qZA()),2&a){const e=t.oxw().ngIf,i=t.oxw().ngIf;t.xp6(1),t.AsE(" ",t.lcZ(2,2,i)," - ",t.lcZ(3,4,e)," ")}}function qo(a,r){if(1&a&&(t.ynx(0),t.YNc(1,Uo,4,6,"span",0),t.BQk()),2&a){const e=t.oxw(2).ngIf;t.xp6(1),t.Q6J("ngIf","CUSTOM"===e)}}function Do(a,r){if(1&a&&(t.ynx(0),t.YNc(1,qo,2,1,"ng-container",0),t.ALo(2,"async"),t.BQk()),2&a){const e=t.oxw(3);t.xp6(1),t.Q6J("ngIf",t.lcZ(2,1,e.customStop$))}}function No(a,r){if(1&a){const e=t.EpF();t.TgZ(0,"div",11)(1,"ya-text-action",12),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(2);return t.KtG(n.compareParameter())}),t._uU(2," Comparison "),t.qZA(),t._UZ(3,"span",10),t.TgZ(4,"ya-text-action",13),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(2);return t.KtG(n.chooseRange())}),t.YNc(5,ko,2,0,"span",0),t.YNc(6,Do,3,3,"ng-container",0),t.ALo(7,"async"),t.qZA(),t.TgZ(8,"ya-text-action",14),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(2);return t.KtG(n.loadLatest("PT1M"))}),t._uU(9," 1 minute "),t.qZA(),t.TgZ(10,"ya-text-action",14),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(2);return t.KtG(n.loadLatest("PT5M"))}),t._uU(11," 5 minutes "),t.qZA(),t.TgZ(12,"ya-text-action",14),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(2);return t.KtG(n.loadLatest("PT15M"))}),t._uU(13," 15 minutes "),t.qZA(),t.TgZ(14,"ya-text-action",14),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(2);return t.KtG(n.loadLatest("PT30M"))}),t._uU(15," 30 minutes "),t.qZA(),t.TgZ(16,"ya-text-action",14),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(2);return t.KtG(n.loadLatest("PT1H"))}),t._uU(17," 1 hour "),t.qZA(),t.TgZ(18,"ya-text-action",14),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(2);return t.KtG(n.loadLatest("PT6H"))}),t._uU(19," 6 hours "),t.qZA(),t.TgZ(20,"ya-text-action",14),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(2);return t.KtG(n.loadLatest("PT12H"))}),t._uU(21," 12 hours "),t.qZA(),t.TgZ(22,"ya-text-action",14),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(2);return t.KtG(n.loadLatest("P1D"))}),t._uU(23," 1 day "),t.qZA(),t.TgZ(24,"ya-text-action",14),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(2);return t.KtG(n.loadLatest("P2D"))}),t._uU(25," 2 days "),t.qZA(),t.TgZ(26,"ya-text-action",14),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(2);return t.KtG(n.loadLatest("P1W"))}),t._uU(27," 7 days "),t.qZA(),t.TgZ(28,"ya-text-action",14),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(2);return t.KtG(n.loadLatest("P2W"))}),t._uU(29," 14 days "),t.qZA(),t.TgZ(30,"ya-text-action",14),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(2);return t.KtG(n.loadLatest("P1M"))}),t._uU(31," 30 days "),t.qZA()()}if(2&a){const e=r.ngIf,i=t.oxw(2);t.xp6(4),t.Q6J("active","CUSTOM"===e),t.xp6(1),t.Q6J("ngIf","CUSTOM"!==e),t.xp6(1),t.Q6J("ngIf",t.lcZ(7,15,i.customStart$)),t.xp6(2),t.Q6J("active","PT1M"===e),t.xp6(2),t.Q6J("active","PT5M"===e),t.xp6(2),t.Q6J("active","PT15M"===e),t.xp6(2),t.Q6J("active","PT30M"===e),t.xp6(2),t.Q6J("active","PT1H"===e),t.xp6(2),t.Q6J("active","PT6H"===e),t.xp6(2),t.Q6J("active","PT12H"===e),t.xp6(2),t.Q6J("active","P1D"===e),t.xp6(2),t.Q6J("active","P2D"===e),t.xp6(2),t.Q6J("active","P1W"===e),t.xp6(2),t.Q6J("active","P2W"===e),t.xp6(2),t.Q6J("active","P1M"===e)}}function Io(a,r){1&a&&(t.TgZ(0,"span"),t._uU(1,"the last minute"),t.qZA())}function Qo(a,r){1&a&&(t.TgZ(0,"span"),t._uU(1,"the last 5 minutes"),t.qZA())}function Lo(a,r){1&a&&(t.TgZ(0,"span"),t._uU(1,"the last 15 minutes"),t.qZA())}function Jo(a,r){1&a&&(t.TgZ(0,"span"),t._uU(1,"the last 30 minutes"),t.qZA())}function Yo(a,r){1&a&&(t.TgZ(0,"span"),t._uU(1,"the last hour"),t.qZA())}function Mo(a,r){1&a&&(t.TgZ(0,"span"),t._uU(1,"the last 6 hours"),t.qZA())}function Oo(a,r){1&a&&(t.TgZ(0,"span"),t._uU(1,"the last 12 hours"),t.qZA())}function $o(a,r){1&a&&(t.TgZ(0,"span"),t._uU(1,"the last 24 hours"),t.qZA())}function Ro(a,r){1&a&&(t.TgZ(0,"span"),t._uU(1,"the last 2 days"),t.qZA())}function Fo(a,r){1&a&&(t.TgZ(0,"span"),t._uU(1,"the last week"),t.qZA())}function Vo(a,r){1&a&&(t.TgZ(0,"span"),t._uU(1,"the last 2 weeks"),t.qZA())}function Ho(a,r){1&a&&(t.TgZ(0,"span"),t._uU(1,"the last month"),t.qZA())}function Eo(a,r){1&a&&(t.TgZ(0,"span"),t._uU(1,"the selected range"),t.qZA())}function Bo(a,r){if(1&a&&(t.TgZ(0,"span",18),t._uU(1," There is no data for this chart in "),t.ynx(2,19),t.YNc(3,Io,2,0,"span",20),t.YNc(4,Qo,2,0,"span",20),t.YNc(5,Lo,2,0,"span",20),t.YNc(6,Jo,2,0,"span",20),t.YNc(7,Yo,2,0,"span",20),t.YNc(8,Mo,2,0,"span",20),t.YNc(9,Oo,2,0,"span",20),t.YNc(10,$o,2,0,"span",20),t.YNc(11,Ro,2,0,"span",20),t.YNc(12,Fo,2,0,"span",20),t.YNc(13,Vo,2,0,"span",20),t.YNc(14,Ho,2,0,"span",20),t.YNc(15,Eo,2,0,"span",21),t.BQk(),t.qZA()),2&a){const e=r.ngIf;t.xp6(2),t.Q6J("ngSwitch",e),t.xp6(1),t.Q6J("ngSwitchCase","PT1M"),t.xp6(1),t.Q6J("ngSwitchCase","PT5M"),t.xp6(1),t.Q6J("ngSwitchCase","PT15M"),t.xp6(1),t.Q6J("ngSwitchCase","PT30M"),t.xp6(1),t.Q6J("ngSwitchCase","PT1H"),t.xp6(1),t.Q6J("ngSwitchCase","PT6H"),t.xp6(1),t.Q6J("ngSwitchCase","PT12H"),t.xp6(1),t.Q6J("ngSwitchCase","P1D"),t.xp6(1),t.Q6J("ngSwitchCase","P2D"),t.xp6(1),t.Q6J("ngSwitchCase","P1W"),t.xp6(1),t.Q6J("ngSwitchCase","P2W"),t.xp6(1),t.Q6J("ngSwitchCase","P1M")}}function Go(a,r){if(1&a&&(t.TgZ(0,"div",16),t.YNc(1,Bo,16,13,"span",17),t.ALo(2,"async"),t.qZA()),2&a){const e=t.oxw(4);t.xp6(1),t.Q6J("ngIf",t.lcZ(2,1,e.range$))}}function jo(a,r){if(1&a&&(t.ynx(0),t.YNc(1,Go,3,3,"div",15),t.BQk()),2&a){const e=t.oxw().ngIf;t.xp6(1),t.Q6J("ngIf",0===e.samples.length)}}function zo(a,r){if(1&a&&(t.ynx(0),t.YNc(1,jo,2,1,"ng-container",0),t.ALo(2,"async"),t.BQk()),2&a){const e=t.oxw(2);t.xp6(1),t.Q6J("ngIf",!t.lcZ(2,1,e.dataSource.loading$))}}function Ko(a,r){if(1&a){const e=t.EpF();t.ynx(0),t.TgZ(1,"div",1),t.YNc(2,No,32,17,"div",2),t.ALo(3,"async"),t.qZA(),t.TgZ(4,"div",3)(5,"app-parameter-plot",4,5),t.NdJ("onVisibleRange",function(n){t.CHM(e);const s=t.oxw();return t.KtG(s.onVisibleRange(n))})("onManualRangeChange",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.onManualRangeChange())}),t._UZ(7,"app-parameter-series",6),t.qZA(),t.TgZ(8,"div",7)(9,"div",8)(10,"button",9),t.NdJ("click",function(){t.CHM(e);const n=t.MAs(6);return t.KtG(n.zoomIn())}),t.TgZ(11,"mat-icon"),t._uU(12,"add"),t.qZA()(),t._UZ(13,"span",10),t.TgZ(14,"button",9),t.NdJ("click",function(){t.CHM(e);const n=t.MAs(6);return t.KtG(n.zoomOut())}),t.TgZ(15,"mat-icon"),t._uU(16,"remove"),t.qZA()()()(),t.YNc(17,zo,3,3,"ng-container",0),t.ALo(18,"async"),t.qZA(),t.BQk()}if(2&a){const e=r.ngIf,i=t.oxw();t.xp6(2),t.Q6J("ngIf",t.lcZ(3,9,i.range$)),t.xp6(3),t.Q6J("xGrid",!0)("xAxisHeight",24)("dataSource",i.dataSource)("stop",i.missionTime)("removableSeries",!0),t.xp6(2),t.Q6J("parameter",e.qualifiedName)("grid",!0),t.xp6(10),t.Q6J("ngIf",t.lcZ(18,11,i.dataSource.data$))}}let jt=(()=>{class a{constructor(e,i,n,s,l){this.router=e,this.route=i,this.yamcs=n,this.dialog=s,this.synchronizer=l,this.range$=new f.X("PT15M"),this.customStart$=new f.X(null),this.customStop$=new f.X(null),this.missionTime=n.getMissionTime(),this.initializeOptions();const _=this.route.parent.snapshot.paramMap.get("qualifiedName");this.dataSource=new xo(this.yamcs,this.synchronizer),this.parameter$=this.yamcs.yamcsClient.getParameter(this.yamcs.instance,_),this.parameter$.then(m=>{if(m.qualifiedName=_,this.dataSource.addParameter(m),"CUSTOM"===this.range$.value)this.dataSource.updateWindow(this.customStart$.value,this.customStop$.value,[null,null]);else{const h=this.yamcs.getMissionTime(),x=o.P6.subtractDuration(h,this.range$.value);this.dataSource.updateWindow(x,h,[null,null])}this.timeSubscription=this.yamcs.time$.subscribe(()=>{if("CUSTOM"!==this.range$.value){const h=this.yamcs.getMissionTime(),x=o.P6.subtractDuration(h,this.range$.value);this.plot?.updateWindowOnly(x,h)}})})}ngAfterViewInit(){}initializeOptions(){const e=this.route.snapshot.queryParamMap;e.has("interval")&&(this.range$.next(e.get("interval")),"CUSTOM"===e.get("interval")&&(this.customStart$.next(new Date(e.get("customStart"))),this.customStop$.next(new Date(e.get("customStop"))))),this.updateURL()}onVisibleRange(e){this.customStart$.next(e[0]),this.customStop$.next(e[1])}onManualRangeChange(){this.range$.next("CUSTOM")}loadLatest(e){this.range$.next(e);const i=this.yamcs.getMissionTime(),n=o.P6.subtractDuration(i,e);this.updateURL(),this.dataSource.updateWindow(n,i,[null,null])}chooseRange(){const e=this.plot.getDateRange();e&&this.dialog.open(Co,{width:"400px",data:{start:e[0],stop:e[1]}}).afterClosed().subscribe(n=>{n&&(this.range$.next("CUSTOM"),this.customStart$.next(n.start),this.customStop$.next(n.stop),this.updateURL(),this.dataSource.updateWindow(n.start,n.stop,[null,null]))})}compareParameter(){this.dialog.open(So,{width:"600px",data:{exclude:this.plot.getParameters()}}).afterClosed().subscribe(i=>{i&&this.yamcs.yamcsClient.getParameter(this.yamcs.instance,i.qualifiedName).then(n=>{const s=new Et.z;s.parameter=i.qualifiedName,s.color=i.color,s.strokeWidth=i.thickness,n.qualifiedName=i.qualifiedName,this.plot.addParameter(n,s)})})}updateURL(){this.router.navigate([],{replaceUrl:!0,relativeTo:this.route,queryParams:{interval:this.range$.value,customStart:"CUSTOM"===this.range$.value?this.customStart$.value:null,customStop:"CUSTOM"===this.range$.value?this.customStop$.value:null},queryParamsHandling:"merge"})}ngOnDestroy(){this.timeSubscription&&this.timeSubscription.unsubscribe(),this.dataSource.disconnect()}static#t=this.\u0275fac=function(i){return new(i||a)(t.Y36(b.F0),t.Y36(b.gz),t.Y36(o.C8),t.Y36(d.uw),t.Y36(o.jF))};static#e=this.\u0275cmp=t.Xpm({type:a,selectors:[["ng-component"]],viewQuery:function(i,n){if(1&i&&t.Gf(Ht.G,5),2&i){let s;t.iGM(s=t.CRH())&&(n.plot=s.first)}},decls:2,vars:3,consts:[[4,"ngIf"],[2,"padding-left","12px","padding-right","12px","padding-top","12px"],["class","plot-top-actions",4,"ngIf"],[1,"plot-container"],["duration","",3,"xGrid","xAxisHeight","dataSource","stop","removableSeries","onVisibleRange","onManualRangeChange"],["plot",""],[3,"parameter","grid"],[1,"zoom-actions"],[1,"zoom-actions-inner","mat-elevation-z1"],["mat-button","",3,"click"],[1,"separator"],[1,"plot-top-actions"],["icon","add_circle_outline",3,"click"],["icon","date_range",3,"active","click"],[3,"active","click"],["class","no-data-message",4,"ngIf"],[1,"no-data-message"],["class","mat-caption","style","color: #777;",4,"ngIf"],[1,"mat-caption",2,"color","#777"],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"]],template:function(i,n){1&i&&(t.YNc(0,Ko,19,13,"ng-container",0),t.ALo(1,"async")),2&i&&t.Q6J("ngIf",t.lcZ(1,1,n.parameter$))},dependencies:[g.O5,g.RF,g.n9,g.ED,w.lW,P.Hw,o.ll,Ht.G,Et.z,g.Ov,o.id],styles:[".plot-container[_ngcontent-%COMP%]{border-top:1px solid rgba(0,0,0,.12);position:absolute;inset:48px 0 0}.zoom-actions[_ngcontent-%COMP%]{position:absolute;bottom:35px;left:0;right:0;margin:0 auto;text-align:center}.zoom-actions-inner[_ngcontent-%COMP%]{display:inline-block;background-color:#fafafa}.zoom-actions[_ngcontent-%COMP%]   .mat-button[_ngcontent-%COMP%]{line-height:inherit;min-width:0}.no-data-message[_ngcontent-%COMP%]{position:absolute;inset:50% 0 0;margin:0 auto;text-align:center;pointer-events:none}.plot-top-actions[_ngcontent-%COMP%]{height:24px;line-height:24px}.separator[_ngcontent-%COMP%]{border-right:1px solid rgba(0,0,0,.12)}"],changeDetection:0})}return a})(),Xo=(()=>{class a{constructor(e,i,n){this.dialogRef=e,this.yamcs=i,this.data=n,this.delimiterOptions=[{id:"COMMA",label:"Comma"},{id:"SEMICOLON",label:"Semicolon"},{id:"TAB",label:"Tab"}],this.downloadURL$=new f.X(null),this.form=new c.nJ({start:new c.p4(null),stop:new c.p4(null),delimiter:new c.p4(null,c.kI.required),interval:new c.NI(null)});let s=n.start,l=n.stop;(!s||!l)&&(l=i.getMissionTime(),s=o.P6.subtractDuration(l,"PT1H")),this.form.setValue({start:n.start?o.P6.toISOString(n.start):"",stop:n.stop?o.P6.toISOString(n.stop):"",delimiter:"TAB",interval:""}),this.formChangeSubscription=this.form.valueChanges.subscribe(()=>{this.updateURL()}),this.updateURL()}closeDialog(){this.dialogRef.close(!0)}updateURL(){if(this.form.valid){const e={parameters:this.data.parameter,delimiter:this.form.value.delimiter};this.form.value.start&&(e.start=o.P6.toISOString(this.form.value.start)),this.form.value.stop&&(e.stop=o.P6.toISOString(this.form.value.stop)),this.form.value.interval&&(e.interval=this.form.value.interval);const i=this.yamcs.yamcsClient.getParameterValuesDownloadURL(this.yamcs.instance,e);this.downloadURL$.next(i)}else this.downloadURL$.next(null)}ngOnDestroy(){this.formChangeSubscription?.unsubscribe()}static#t=this.\u0275fac=function(i){return new(i||a)(t.Y36(d.so),t.Y36(o.C8),t.Y36(d.WI))};static#e=this.\u0275cmp=t.Xpm({type:a,selectors:[["ng-component"]],decls:33,vars:7,consts:[["mat-dialog-title",""],[1,"mat-typography","ya-form"],[3,"formGroup"],[1,"hint"],["formControlName","start"],["formControlName","stop"],["formControlName","delimiter",3,"options"],["formControlName","interval","type","text",1,"ya-input"],["align","end"],["mat-dialog-close","",1,"ya-button"],[3,"link","primary","disabled","click"]],template:function(i,n){1&i&&(t.TgZ(0,"h2",0),t._uU(1,"Export parameter data"),t.qZA(),t.TgZ(2,"mat-dialog-content",1)(3,"form",2)(4,"label"),t._uU(5," Start "),t.TgZ(6,"span",3),t._uU(7,"(optional)"),t.qZA(),t._UZ(8,"ya-date-time-input",4),t.qZA(),t._UZ(9,"br"),t.TgZ(10,"label"),t._uU(11," Stop "),t.TgZ(12,"span",3),t._uU(13,"(optional)"),t.qZA(),t._UZ(14,"ya-date-time-input",5),t.qZA(),t._UZ(15,"br"),t.TgZ(16,"label"),t._uU(17," CSV column delimiter"),t._UZ(18,"br")(19,"ya-select",6),t.qZA(),t._UZ(20,"br"),t.TgZ(21,"label"),t._uU(22," Interval (ms) "),t.TgZ(23,"span",3),t._uU(24,"(optional)"),t.qZA(),t._UZ(25,"br")(26,"input",7),t.qZA()()(),t.TgZ(27,"mat-dialog-actions",8)(28,"button",9),t._uU(29,"CANCEL"),t.qZA(),t.TgZ(30,"ya-download-button",10),t.NdJ("click",function(){return n.closeDialog()}),t.ALo(31,"async"),t._uU(32," DOWNLOAD "),t.qZA()()),2&i&&(t.xp6(3),t.Q6J("formGroup",n.form),t.xp6(16),t.Q6J("options",n.delimiterOptions),t.xp6(11),t.Q6J("link",t.lcZ(31,5,n.downloadURL$))("primary",!0)("disabled",!n.form.valid))},dependencies:[c._Y,c.Fj,c.JJ,c.JL,c.sg,c.u,d.ZT,d.uh,d.xY,d.H8,o.t,o.NA,o.Hr,g.Ov],encapsulation:2,changeDetection:0})}return a})();class Wo extends q.o2{constructor(r,e){super(),this.yamcs=r,this.qualifiedName=e,this.pageSize=100,this.pvals$=new f.X([]),this.loading$=new f.X(!1)}connect(r){return this.pvals$}isEmpty(){return 0===this.pvals$.value.length}loadParameterValues(r){return this.loading$.next(!0),this.loadPage({...r,limit:this.pageSize+1}).then(e=>{this.pvals$.next(e)}).finally(()=>this.loading$.next(!1))}hasMore(){return null!=this.offscreenRecord}loadPage(r){return this.yamcs.yamcsClient.getParameterValues(this.yamcs.instance,this.qualifiedName,r).then(e=>(this.offscreenRecord=e.length>this.pageSize?e.splice(e.length-1,1)[0]:null,e))}loadMoreData(r){this.offscreenRecord&&this.loadPage({...r,stop:this.offscreenRecord.generationTime,limit:this.pageSize+1}).then(e=>{const i=this.pvals$.getValue().concat(e);this.pvals$.next(i)})}disconnect(r){this.pvals$.complete(),this.loading$.complete()}}function tl(a,r){1&a&&(t.TgZ(0,"th",16),t._uU(1,"Severity"),t.qZA())}function el(a,r){if(1&a&&t._UZ(0,"app-alarm-level",20),2&a){const e=t.oxw().$implicit;t.Q6J("level",e.monitoringResult)}}function al(a,r){1&a&&(t.TgZ(0,"span"),t._uU(1,"-"),t.qZA())}function il(a,r){if(1&a&&(t.TgZ(0,"td",17),t.YNc(1,el,1,1,"app-alarm-level",18),t.YNc(2,al,2,0,"span",19),t.qZA()),2&a){const e=r.$implicit;t.xp6(1),t.Q6J("ngIf",e.monitoringResult),t.xp6(1),t.Q6J("ngIf",!e.monitoringResult)}}function nl(a,r){1&a&&(t.TgZ(0,"th",16),t._uU(1,"Generation time"),t.qZA())}function rl(a,r){if(1&a&&(t.TgZ(0,"td",17),t._uU(1),t.ALo(2,"datetime"),t.qZA()),2&a){const e=r.$implicit;let i;t.xp6(1),t.Oqu(null!==(i=t.lcZ(2,1,e.generationTime))&&void 0!==i?i:"-")}}function sl(a,r){1&a&&(t.TgZ(0,"th",16),t._uU(1,"Reception time"),t.qZA())}function ol(a,r){if(1&a&&(t.TgZ(0,"td",17),t._uU(1),t.ALo(2,"datetime"),t.qZA()),2&a){const e=r.$implicit;let i;t.xp6(1),t.Oqu(null!==(i=t.lcZ(2,1,e.acquisitionTime))&&void 0!==i?i:"-")}}function ll(a,r){1&a&&(t.TgZ(0,"th",16),t._uU(1,"Raw"),t.qZA())}function cl(a,r){if(1&a&&(t.TgZ(0,"td",21),t._UZ(1,"ya-value",22),t.qZA()),2&a){const e=r.$implicit;t.xp6(1),t.Q6J("value",e.rawValue)}}function _l(a,r){1&a&&(t.TgZ(0,"th",16),t._uU(1,"Eng"),t.qZA())}function pl(a,r){if(1&a&&(t.TgZ(0,"td",21),t._UZ(1,"ya-value",22),t.qZA()),2&a){const e=r.$implicit;t.xp6(1),t.Q6J("value",e.engValue)}}function ml(a,r){1&a&&(t.TgZ(0,"th",16),t._uU(1,"Range condition"),t.qZA())}function ul(a,r){if(1&a&&(t.TgZ(0,"td",17),t._uU(1),t.qZA()),2&a){const e=r.$implicit;t.xp6(1),t.Oqu(e.rangeCondition||"-")}}function gl(a,r){1&a&&(t.TgZ(0,"th",16),t._uU(1,"Acquisition status"),t.qZA())}function dl(a,r){if(1&a&&(t.TgZ(0,"td",17),t._uU(1),t.qZA()),2&a){const e=r.$implicit;t.xp6(1),t.Oqu(e.acquisitionStatus||"-")}}function hl(a,r){1&a&&t._UZ(0,"th",23)}function fl(a,r){1&a&&t._UZ(0,"td",17)}function xl(a,r){1&a&&t._UZ(0,"tr",24)}function yl(a,r){if(1&a){const e=t.EpF();t.TgZ(0,"tr",25),t.NdJ("click",function(){const s=t.CHM(e).$implicit,l=t.oxw(2);return t.KtG(l.selectedValue.emit(s))}),t.ALo(1,"async"),t.qZA()}if(2&a){const e=r.$implicit,i=t.oxw(2);t.ekj("selected",t.lcZ(1,2,i.selectedValue)===e)}}function bl(a,r){if(1&a&&(t.TgZ(0,"table",1),t.ynx(1,2),t.YNc(2,tl,2,0,"th",3),t.YNc(3,il,3,2,"td",4),t.BQk(),t.ynx(4,5),t.YNc(5,nl,2,0,"th",3),t.YNc(6,rl,3,3,"td",4),t.BQk(),t.ynx(7,6),t.YNc(8,sl,2,0,"th",3),t.YNc(9,ol,3,3,"td",4),t.BQk(),t.ynx(10,7),t.YNc(11,ll,2,0,"th",3),t.YNc(12,cl,2,1,"td",8),t.BQk(),t.ynx(13,9),t.YNc(14,_l,2,0,"th",3),t.YNc(15,pl,2,1,"td",8),t.BQk(),t.ynx(16,10),t.YNc(17,ml,2,0,"th",3),t.YNc(18,ul,2,1,"td",4),t.BQk(),t.ynx(19,11),t.YNc(20,gl,2,0,"th",3),t.YNc(21,dl,2,1,"td",4),t.BQk(),t.ynx(22,12),t.YNc(23,hl,1,0,"th",13),t.YNc(24,fl,1,0,"td",4),t.BQk(),t.YNc(25,xl,1,0,"tr",14),t.YNc(26,yl,2,4,"tr",15),t.qZA()),2&a){const e=t.oxw();t.Q6J("dataSource",e.dataSource),t.xp6(25),t.Q6J("matHeaderRowDef",e.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",e.displayedColumns)}}let Tl=(()=>{class a{constructor(){this.selectedValue=new t.vpe,this.displayedColumns=["severity","generationTime","rawValue","engValue","rangeCondition","acquisitionStatus","actions"]}static#t=this.\u0275fac=function(i){return new(i||a)};static#e=this.\u0275cmp=t.Xpm({type:a,selectors:[["app-parameter-values-table"]],inputs:{dataSource:"dataSource"},outputs:{selectedValue:"selectedValue"},decls:1,vars:1,consts:[["mat-table","","class","ya-data-table expand",3,"dataSource",4,"ngIf"],["mat-table","",1,"ya-data-table","expand",3,"dataSource"],["matColumnDef","severity"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","generationTime"],["matColumnDef","receptionTime"],["matColumnDef","rawValue"],["mat-cell","","class","wrap200",4,"matCellDef"],["matColumnDef","engValue"],["matColumnDef","rangeCondition"],["matColumnDef","acquisitionStatus"],["matColumnDef","actions"],["mat-header-cell","","class","expand",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",3,"selected","click",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],[3,"level",4,"ngIf"],[4,"ngIf"],[3,"level"],["mat-cell","",1,"wrap200"],[3,"value"],["mat-header-cell","",1,"expand"],["mat-header-row",""],["mat-row","",3,"click"]],template:function(i,n){1&i&&t.YNc(0,bl,27,3,"table",0),2&i&&t.Q6J("ngIf",n.dataSource)},dependencies:[g.O5,p.BZ,p.fO,p.as,p.w1,p.Dz,p.nj,p.ge,p.ev,p.XQ,p.Gk,o.u$,Y.i,g.Ov,o.id],encapsulation:2,changeDetection:0})}return a})();function vl(a,r){if(1&a&&t._UZ(0,"app-alarm-level",21),2&a){const e=t.oxw().ngIf;t.Q6J("level",e.monitoringResult)}}function Zl(a,r){1&a&&(t.TgZ(0,"span"),t._uU(1,"-"),t.qZA())}function Pl(a,r){1&a&&t.GkF(0)}function wl(a,r){1&a&&t.GkF(0)}function Al(a,r){1&a&&t.GkF(0)}function Sl(a,r){1&a&&t.GkF(0)}const z=function(a){return{value:a}};function Cl(a,r){if(1&a&&(t.ynx(0),t.TgZ(1,"ya-detail-toolbar"),t._uU(2," Value Detail "),t.qZA(),t.TgZ(3,"div",16)(4,"div",17),t._uU(5,"Severity"),t.qZA(),t.TgZ(6,"div",18),t.YNc(7,vl,1,1,"app-alarm-level",19),t.YNc(8,Zl,2,0,"span",7),t.qZA(),t.TgZ(9,"div",17),t._uU(10,"Generation time"),t.qZA(),t.TgZ(11,"div",18),t._uU(12),t.ALo(13,"datetime"),t.qZA(),t.TgZ(14,"div",17),t._uU(15,"Valid for"),t.qZA(),t.TgZ(16,"div",18),t._uU(17),t.ALo(18,"millisDuration"),t.qZA(),t.TgZ(19,"div",17),t._uU(20," Raw value "),t.YNc(21,Pl,1,0,"ng-container",20),t.qZA(),t.TgZ(22,"div",18),t.YNc(23,wl,1,0,"ng-container",20),t.qZA(),t.TgZ(24,"div",17),t._uU(25," Engineering value "),t.YNc(26,Al,1,0,"ng-container",20),t.qZA(),t.TgZ(27,"div",18),t.YNc(28,Sl,1,0,"ng-container",20),t.qZA(),t.TgZ(29,"div",17),t._uU(30,"Range condition"),t.qZA(),t.TgZ(31,"div",18),t._uU(32),t.qZA(),t.TgZ(33,"div",17),t._uU(34,"Acquisition status"),t.qZA(),t.TgZ(35,"div",18),t._uU(36),t.qZA()(),t.BQk()),2&a){const e=r.ngIf;t.oxw();const i=t.MAs(31),n=t.MAs(33);t.xp6(7),t.Q6J("ngIf",e.monitoringResult),t.xp6(1),t.Q6J("ngIf",!e.monitoringResult),t.xp6(4),t.hij(" ",t.lcZ(13,14,e.generationTime)," "),t.xp6(5),t.hij(" ",t.lcZ(18,16,e.expireMillis)||"-"," "),t.xp6(4),t.Q6J("ngTemplateOutlet",i)("ngTemplateOutletContext",t.VKq(18,z,e.rawValue)),t.xp6(2),t.Q6J("ngTemplateOutlet",n)("ngTemplateOutletContext",t.VKq(20,z,e.rawValue)),t.xp6(3),t.Q6J("ngTemplateOutlet",i)("ngTemplateOutletContext",t.VKq(22,z,e.engValue)),t.xp6(2),t.Q6J("ngTemplateOutlet",n)("ngTemplateOutletContext",t.VKq(24,z,e.engValue)),t.xp6(4),t.hij(" ",e.rangeCondition||"-"," "),t.xp6(4),t.hij(" ",e.acquisitionStatus||"-"," ")}}function kl(a,r){1&a&&(t.TgZ(0,"ya-detail-toolbar"),t._uU(1," Select a value "),t.qZA())}function Ul(a,r){if(1&a){const e=t.EpF();t.ynx(0),t._UZ(1,"ya-date-time-input",22)(2,"ya-date-time-input",23),t.TgZ(3,"button",24),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.applyCustomDates())}),t._uU(4,"Apply"),t.qZA(),t.BQk()}if(2&a){const e=t.oxw();t.xp6(3),t.Q6J("disabled",e.filterForm.invalid)}}function ql(a,r){if(1&a){const e=t.EpF();t.ynx(0),t.TgZ(1,"button",25),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.jumpToNow())}),t._uU(2," Jump to now "),t.qZA(),t.BQk()}}function Dl(a,r){1&a&&t._UZ(0,"ya-dots")}function Nl(a,r){if(1&a&&(t.TgZ(0,"span"),t._uU(1," Showing data from "),t.TgZ(2,"b"),t._uU(3,"the last hour"),t.qZA(),t._uU(4," ending at "),t.TgZ(5,"b"),t._uU(6),t.ALo(7,"datetime"),t.qZA(),t._uU(8," (Mission Time) "),t.qZA()),2&a){const e=t.oxw();t.xp6(6),t.Oqu(t.lcZ(7,1,e.validStop))}}function Il(a,r){if(1&a&&(t.TgZ(0,"span"),t._uU(1," Showing data from "),t.TgZ(2,"b"),t._uU(3,"the last 6 hours"),t.qZA(),t._uU(4," ending at "),t.TgZ(5,"b"),t._uU(6),t.ALo(7,"datetime"),t.qZA(),t._uU(8," (Mission Time) "),t.qZA()),2&a){const e=t.oxw();t.xp6(6),t.Oqu(t.lcZ(7,1,e.validStop))}}function Ql(a,r){if(1&a&&(t.TgZ(0,"span"),t._uU(1," Showing data from "),t.TgZ(2,"b"),t._uU(3,"the last 24 hours"),t.qZA(),t._uU(4," ending at "),t.TgZ(5,"b"),t._uU(6),t.ALo(7,"datetime"),t.qZA(),t._uU(8," (Mission Time) "),t.qZA()),2&a){const e=t.oxw();t.xp6(6),t.Oqu(t.lcZ(7,1,e.validStop))}}function Ll(a,r){1&a&&(t.TgZ(0,"span"),t._uU(1," Showing data from "),t.TgZ(2,"b"),t._uU(3,"all time"),t.qZA()())}function Jl(a,r){if(1&a&&(t.TgZ(0,"span"),t._uU(1," Showing data from "),t.TgZ(2,"b"),t._uU(3),t.ALo(4,"datetime"),t.qZA(),t._uU(5," to "),t.TgZ(6,"b"),t._uU(7),t.ALo(8,"datetime"),t.qZA(),t._uU(9," (Mission Time) "),t.qZA()),2&a){const e=t.oxw();t.xp6(3),t.Oqu(t.lcZ(4,2,e.validStart)),t.xp6(4),t.Oqu(t.lcZ(8,4,e.validStop))}}function Yl(a,r){1&a&&(t.TgZ(0,"ya-empty-message"),t._uU(1," No records found matching current filter in the selected time range. "),t.qZA())}function Ml(a,r){if(1&a){const e=t.EpF();t.TgZ(0,"mat-toolbar"),t._UZ(1,"span",8),t.TgZ(2,"button",24),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.loadMoreData())}),t._uU(3,"Load More"),t.qZA(),t._UZ(4,"span",8),t.qZA()}if(2&a){const e=t.oxw();t.xp6(2),t.Q6J("disabled",!e.dataSource.hasMore())}}function Ol(a,r){if(1&a){const e=t.EpF();t.ynx(0),t.TgZ(1,"ya-more",27)(2,"button",28),t.NdJ("click",function(){t.CHM(e);const n=t.oxw().value,s=t.oxw();return t.KtG(s.copyHex(n.binaryValue))}),t._uU(3," Copy Hex "),t.qZA(),t.TgZ(4,"button",28),t.NdJ("click",function(){t.CHM(e);const n=t.oxw().value,s=t.oxw();return t.KtG(s.copyBinary(n.binaryValue))}),t._uU(5," Copy Binary "),t.qZA()(),t.BQk()}}function $l(a,r){if(1&a&&(t.ynx(0,26),t.YNc(1,Ol,6,0,"ng-container",11),t.BQk()),2&a){const e=r.value;t.Q6J("ngSwitch",null==e?null:e.type),t.xp6(1),t.Q6J("ngSwitchCase","BINARY")}}function Rl(a,r){if(1&a&&(t.ynx(0),t._UZ(1,"app-hex",30),t.BQk()),2&a){const e=t.oxw().value;t.xp6(1),t.Q6J("base64String",e.binaryValue)}}function Fl(a,r){if(1&a&&(t.ynx(0),t._UZ(1,"ya-value",31),t.BQk()),2&a){const e=t.oxw().value;t.xp6(1),t.Q6J("value",e)}}function Vl(a,r){if(1&a&&(t.ynx(0,26),t.YNc(1,Rl,2,1,"ng-container",11),t.YNc(2,Fl,2,1,"ng-container",29),t.BQk()),2&a){const e=r.value;t.Q6J("ngSwitch",null==e?null:e.type),t.xp6(1),t.Q6J("ngSwitchCase","BINARY")}}const J="PT1H";let zt=(()=>{class a{constructor(e,i,n,s,l){this.route=e,this.router=i,this.yamcs=n,this.dialog=s,this.clipboard=l,this.intervalOptions=[{id:"PT1H",label:"Last Hour"},{id:"PT6H",label:"Last 6 Hours"},{id:"P1D",label:"Last 24 Hours"},{id:"NO_LIMIT",label:"No Limit"},{id:"CUSTOM",label:"Custom"}],this.filterForm=new c.nJ({interval:new c.p4(J),customStart:new c.p4(null),customStop:new c.p4(null)}),this.downloadURL$=new f.X(null),this.qualifiedName=e.parent.snapshot.paramMap.get("qualifiedName"),this.dataSource=new Wo(n,this.qualifiedName),this.validStop=n.getMissionTime(),this.validStart=o.P6.subtractDuration(this.validStop,J),this.appliedInterval=J,this.initializeOptions(),this.loadData(),this.filterForm.get("interval").valueChanges.forEach(_=>{if("CUSTOM"===_){const m=this.validStart||this.yamcs.getMissionTime(),u=this.validStop||this.yamcs.getMissionTime();this.filterForm.get("customStart").setValue(o.P6.toISOString(m)),this.filterForm.get("customStop").setValue(o.P6.toISOString(u))}else"NO_LIMIT"===_?(this.validStart=null,this.validStop=null,this.appliedInterval=_,this.loadData()):(this.validStop=n.getMissionTime(),this.validStart=o.P6.subtractDuration(this.validStop,_),this.appliedInterval=_,this.loadData())})}initializeOptions(){const e=this.route.snapshot.queryParamMap;if(e.has("interval"))if(this.appliedInterval=e.get("interval"),this.filterForm.get("interval").setValue(this.appliedInterval),"CUSTOM"===this.appliedInterval){const i=e.get("customStart");this.filterForm.get("customStart").setValue(i),this.validStart=new Date(i);const n=e.get("customStop");this.filterForm.get("customStop").setValue(n),this.validStop=new Date(n)}else"NO_LIMIT"===this.appliedInterval?(this.validStart=null,this.validStop=null):(this.validStop=this.yamcs.getMissionTime(),this.validStart=o.P6.subtractDuration(this.validStop,this.appliedInterval));else this.appliedInterval=J,this.validStop=this.yamcs.getMissionTime(),this.validStart=o.P6.subtractDuration(this.validStop,J)}jumpToNow(){const e=this.filterForm.value.interval;"NO_LIMIT"===e?this.filterForm.get("interval").setValue(J):(this.validStop=this.yamcs.getMissionTime(),this.validStart=o.P6.subtractDuration(this.validStop,e),this.loadData())}applyCustomDates(){this.validStart=o.P6.toDate(this.filterForm.value.customStart),this.validStop=o.P6.toDate(this.filterForm.value.customStop),this.appliedInterval="CUSTOM",this.loadData()}loadData(){this.updateURL();const e={};if(this.validStart){const i=new Date(this.validStart.getTime());i.setUTCMilliseconds(this.validStart.getUTCMilliseconds()-1),e.start=i.toISOString()}this.validStop&&(e.stop=this.validStop.toISOString()),this.dataSource.loadParameterValues(e)}loadMoreData(){const e={};if(this.validStart){const i=new Date(this.validStart.getTime());i.setUTCMilliseconds(this.validStart.getUTCMilliseconds()-1),e.start=i.toISOString()}this.dataSource.loadMoreData(e)}copyHex(e){const i=o.P6.convertBase64ToHex(e);this.clipboard.copy(i)}copyBinary(e){const i=window.atob(e);this.clipboard.copy(i)}updateURL(){this.router.navigate([],{replaceUrl:!0,relativeTo:this.route,queryParams:{interval:this.appliedInterval,customStart:"CUSTOM"===this.appliedInterval?this.filterForm.value.customStart:null,customStop:"CUSTOM"===this.appliedInterval?this.filterForm.value.customStop:null},queryParamsHandling:"merge"})}exportParameterData(){this.dialog.open(Xo,{width:"400px",data:{parameter:this.qualifiedName,start:this.validStart,stop:this.validStop}})}static#t=this.\u0275fac=function(i){return new(i||a)(t.Y36(b.gz),t.Y36(b.F0),t.Y36(o.C8),t.Y36(d.uw),t.Y36(Ut.TU))};static#e=this.\u0275cmp=t.Xpm({type:a,selectors:[["ng-component"]],decls:34,vars:22,consts:[[4,"ngIf","ngIfElse"],["noSelection",""],[1,"table-wrapper"],[1,"panel-content"],[3,"formGroup"],[1,"filter-bar"],["icon","access_time","formControlName","interval",3,"options"],[4,"ngIf"],[2,"flex","1 1 auto"],[1,"ya-button","primary",2,"margin-right","0",3,"click"],[1,"table-status",3,"ngSwitch"],[4,"ngSwitchCase"],[3,"dataSource"],["table",""],["valueActionsTemplate",""],["valueTemplate",""],[2,"padding","0 16px"],[1,"block-title"],[1,"block"],[3,"level",4,"ngIf"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[3,"level"],["formControlName","customStart"],["formControlName","customStop"],[1,"ya-button",3,"disabled","click"],[1,"ya-button",3,"click"],[3,"ngSwitch"],["icon","more_horiz"],["mat-menu-item","",3,"click"],[4,"ngSwitchDefault"],[3,"base64String"],[3,"value"]],template:function(i,n){if(1&i&&(t.TgZ(0,"ya-detail-pane"),t.YNc(1,Cl,37,26,"ng-container",0),t.ALo(2,"async"),t.YNc(3,kl,2,0,"ng-template",null,1,t.W1O),t.qZA(),t.TgZ(5,"div",2)(6,"div",3)(7,"form",4)(8,"div",5),t._UZ(9,"ya-select",6),t.YNc(10,Ul,5,1,"ng-container",7),t.YNc(11,ql,3,0,"ng-container",7),t.YNc(12,Dl,1,0,"ya-dots",7),t.ALo(13,"async"),t._UZ(14,"div",8),t.TgZ(15,"button",9),t.NdJ("click",function(){return n.exportParameterData()}),t.TgZ(16,"mat-icon"),t._uU(17,"download"),t.qZA(),t._uU(18," Export CSV "),t.qZA()()(),t.TgZ(19,"div",10),t.YNc(20,Nl,9,3,"span",11),t.YNc(21,Il,9,3,"span",11),t.YNc(22,Ql,9,3,"span",11),t.YNc(23,Ll,4,0,"span",11),t.YNc(24,Jl,10,6,"span",11),t.qZA(),t._UZ(25,"app-parameter-values-table",12,13),t.YNc(27,Yl,2,0,"ya-empty-message",7),t.YNc(28,Ml,5,1,"mat-toolbar",7),t.ALo(29,"async"),t.qZA()(),t.YNc(30,$l,2,2,"ng-template",null,14,t.W1O),t.YNc(32,Vl,3,2,"ng-template",null,15,t.W1O)),2&i){const s=t.MAs(4),l=t.MAs(26);t.xp6(1),t.Q6J("ngIf",t.lcZ(2,16,l.selectedValue))("ngIfElse",s),t.xp6(6),t.Q6J("formGroup",n.filterForm),t.xp6(2),t.Q6J("options",n.intervalOptions),t.xp6(1),t.Q6J("ngIf","CUSTOM"===n.filterForm.value.interval),t.xp6(1),t.Q6J("ngIf","CUSTOM"!==n.filterForm.value.interval),t.xp6(1),t.Q6J("ngIf",t.lcZ(13,18,n.dataSource.loading$)),t.xp6(7),t.Q6J("ngSwitch",n.appliedInterval),t.xp6(1),t.Q6J("ngSwitchCase","PT1H"),t.xp6(1),t.Q6J("ngSwitchCase","PT6H"),t.xp6(1),t.Q6J("ngSwitchCase","P1D"),t.xp6(1),t.Q6J("ngSwitchCase","NO_LIMIT"),t.xp6(1),t.Q6J("ngSwitchCase","CUSTOM"),t.xp6(1),t.Q6J("dataSource",n.dataSource),t.xp6(2),t.Q6J("ngIf",n.dataSource.isEmpty()),t.xp6(1),t.Q6J("ngIf",!t.lcZ(29,20,n.dataSource.loading$)&&!n.dataSource.isEmpty())}},dependencies:[g.O5,g.tP,g.RF,g.n9,g.ED,c._Y,c.JJ,c.JL,c.sg,c.u,P.Hw,S.OP,at.Ye,o.t,o.J8,o.MD,o.Zy,o.RR,o.cQ,o.Hr,o.u$,Y.i,et.p,Tl,g.Ov,o.id,o.yA],styles:[".detail[_ngcontent-%COMP%]{background-color:#fcfcfc;float:right;height:100%;width:450px;overflow:auto;border-left:1px solid #d3d3d3;box-sizing:border-box}.table-wrapper[_ngcontent-%COMP%]{position:relative;overflow:auto;height:100%}.table-status[_ngcontent-%COMP%]{background-color:#f7f7f7;height:24px;line-height:24px;font-size:12px;padding-left:6px}.table-status[_ngcontent-%COMP%]   .message-zone[_ngcontent-%COMP%]{float:right;height:24px;line-height:24px;font-size:12px;padding-right:6px}"],changeDetection:0})}return a})();function Hl(a,r){if(1&a&&(t.TgZ(0,"option",10),t._uU(1),t.qZA()),2&a){const e=r.$implicit;t.Q6J("value",e.label),t.xp6(1),t.hij(" ",e.label,"")}}function El(a,r){if(1&a&&(t.TgZ(0,"label")(1,"div",4)(2,"div",5),t._uU(3),t.qZA()(),t._uU(4),t._UZ(5,"ya-errors",6),t.TgZ(6,"select",7)(7,"option",8),t._uU(8," -- select an option -- "),t.qZA(),t.YNc(9,Hl,2,2,"option",9),t.qZA()()),2&a){const e=t.oxw().ngIf,i=t.oxw();t.xp6(3),t.Oqu(null==i.parameter.type?null:i.parameter.type.engType),t.xp6(1),t.hij(" ",i.parameter.name," "),t.xp6(1),t.Q6J("controlName",e),t.xp6(1),t.Q6J("formControlName",e),t.xp6(3),t.Q6J("ngForOf",null==i.parameter.type?null:i.parameter.type.enumValue)}}function Bl(a,r){if(1&a&&(t.TgZ(0,"label"),t._uU(1),t._UZ(2,"ya-errors",6)(3,"br")(4,"input",11),t._uU(5," true"),t._UZ(6,"br")(7,"input",12),t._uU(8," false "),t.qZA()),2&a){const e=t.oxw().ngIf,i=t.oxw();t.xp6(1),t.hij(" ",i.parameter.name," "),t.xp6(1),t.Q6J("controlName",e),t.xp6(2),t.Q6J("formControlName",e),t.xp6(3),t.Q6J("formControlName",e)}}function Gl(a,r){if(1&a&&(t.TgZ(0,"label"),t._uU(1),t._UZ(2,"ya-errors",6)(3,"ya-date-time-input",7),t.qZA()),2&a){const e=t.oxw().ngIf,i=t.oxw();t.xp6(1),t.hij(" ",i.parameter.name," "),t.xp6(1),t.Q6J("controlName",e),t.xp6(1),t.Q6J("formControlName",e)}}function jl(a,r){if(1&a&&(t.TgZ(0,"label")(1,"div",4)(2,"div",5),t.ALo(3,"async"),t._uU(4),t.qZA()(),t._uU(5),t._UZ(6,"ya-errors",6,13)(8,"ya-binary-input",7),t.qZA()),2&a){const e=t.MAs(7),i=t.oxw().ngIf,n=t.oxw();t.xp6(2),t.ekj("error",t.lcZ(3,6,e.invalid$)),t.xp6(2),t.Oqu(null==n.parameter.type?null:n.parameter.type.engType),t.xp6(1),t.hij(" ",n.parameter.name," "),t.xp6(1),t.Q6J("controlName",i),t.xp6(2),t.Q6J("formControlName",i)}}function zl(a,r){if(1&a&&(t.ynx(0),t._UZ(1,"app-parameter-form",16)(2,"br"),t.BQk()),2&a){const e=r.$implicit,i=t.oxw(3);t.xp6(1),t.Q6J("parameter",e)("formGroup",i.formGroup)("parent",i.parent?i.parent+"."+i.parameter.name:i.parameter.name)}}function Kl(a,r){if(1&a&&(t.TgZ(0,"label")(1,"div",4)(2,"div",5),t._uU(3),t.qZA()(),t._uU(4),t.TgZ(5,"div",14),t.YNc(6,zl,3,3,"ng-container",15),t.qZA()()),2&a){const e=t.oxw(2);t.xp6(3),t.Oqu(null==e.parameter.type?null:e.parameter.type.engType),t.xp6(1),t.hij(" ",e.parameter.name," "),t.xp6(2),t.Q6J("ngForOf",null==e.parameter.type?null:e.parameter.type.member)}}function Xl(a,r){1&a&&(t.ynx(0),t._uU(1," Setting array values via this website is not yet supported. "),t.BQk())}function Wl(a,r){1&a&&(t.ynx(0),t._uU(1," Setting array values via this website is not yet supported. "),t.BQk())}function tc(a,r){1&a&&(t.ynx(0),t._uU(1," Setting array values via this website is not yet supported. "),t.BQk())}function ec(a,r){1&a&&(t.ynx(0),t._uU(1," Setting array values via this website is not yet supported. "),t.BQk())}function ac(a,r){1&a&&(t.ynx(0),t._uU(1," Setting array values via this website is not yet supported. "),t.BQk())}function ic(a,r){1&a&&(t.ynx(0),t._uU(1," Setting array values via this website is not yet supported. "),t.BQk())}function nc(a,r){1&a&&(t.ynx(0),t._uU(1," Setting array values via this website is not yet supported. "),t.BQk())}function rc(a,r){1&a&&(t.ynx(0),t._uU(1," Setting array values via this website is not yet supported. "),t.BQk())}function sc(a,r){1&a&&(t.ynx(0),t._uU(1," Setting array values via this website is not yet supported. "),t.BQk())}function oc(a,r){if(1&a&&(t.TgZ(0,"div",5),t._uU(1),t.ALo(2,"units"),t.qZA()),2&a){const e=t.oxw(3);t.xp6(1),t.hij(" ",t.lcZ(2,1,null==e.parameter.type?null:e.parameter.type.unitSet)," ")}}function lc(a,r){if(1&a&&(t.TgZ(0,"label")(1,"div",4),t.ALo(2,"async"),t.YNc(3,oc,3,3,"div",17),t.TgZ(4,"div",5),t._uU(5),t.qZA()(),t._uU(6),t._UZ(7,"ya-errors",6,13)(9,"input",18),t.qZA()),2&a){const e=t.MAs(8),i=t.oxw().ngIf,n=t.oxw();t.xp6(1),t.ekj("error",t.lcZ(2,7,e.invalid$)),t.xp6(2),t.Q6J("ngIf",null==n.parameter.type?null:n.parameter.type.unitSet),t.xp6(2),t.Oqu(null==n.parameter.type?null:n.parameter.type.engType),t.xp6(1),t.hij(" ",n.parameter.name," "),t.xp6(1),t.Q6J("controlName",i),t.xp6(2),t.Q6J("formControlName",i)}}function cc(a,r){if(1&a&&(t.ynx(0,1),t.YNc(1,El,10,5,"label",2),t.YNc(2,Bl,9,4,"label",2),t.YNc(3,Gl,4,3,"label",2),t.YNc(4,jl,9,8,"label",2),t.YNc(5,Kl,7,3,"label",2),t.YNc(6,Xl,2,0,"ng-container",2),t.YNc(7,Wl,2,0,"ng-container",2),t.YNc(8,tc,2,0,"ng-container",2),t.YNc(9,ec,2,0,"ng-container",2),t.YNc(10,ac,2,0,"ng-container",2),t.YNc(11,ic,2,0,"ng-container",2),t.YNc(12,nc,2,0,"ng-container",2),t.YNc(13,rc,2,0,"ng-container",2),t.YNc(14,sc,2,0,"ng-container",2),t.YNc(15,lc,10,9,"label",3),t.BQk()),2&a){const e=t.oxw();t.Q6J("formGroup",e.formGroup)("ngSwitch",null==e.parameter.type?null:e.parameter.type.engType),t.xp6(1),t.Q6J("ngSwitchCase","enumeration"),t.xp6(1),t.Q6J("ngSwitchCase","boolean"),t.xp6(1),t.Q6J("ngSwitchCase","time"),t.xp6(1),t.Q6J("ngSwitchCase","binary"),t.xp6(1),t.Q6J("ngSwitchCase","aggregate"),t.xp6(1),t.Q6J("ngSwitchCase","float[]"),t.xp6(1),t.Q6J("ngSwitchCase","double[]"),t.xp6(1),t.Q6J("ngSwitchCase","integer[]"),t.xp6(1),t.Q6J("ngSwitchCase","enumeration[]"),t.xp6(1),t.Q6J("ngSwitchCase","string[]"),t.xp6(1),t.Q6J("ngSwitchCase","boolean[]"),t.xp6(1),t.Q6J("ngSwitchCase","time[]"),t.xp6(1),t.Q6J("ngSwitchCase","binary[]"),t.xp6(1),t.Q6J("ngSwitchCase","aggregate[]")}}let _c=(()=>{class a{constructor(){this.controlName$=new f.X(null)}ngOnInit(){this.controlName$.next(this.parent?this.parent+"."+this.parameter.name:this.parameter.name)}static#t=this.\u0275fac=function(i){return new(i||a)};static#e=this.\u0275cmp=t.Xpm({type:a,selectors:[["app-parameter-form"]],inputs:{formGroup:"formGroup",parameter:"parameter",parent:"parent"},decls:2,vars:3,consts:[[3,"formGroup","ngSwitch",4,"ngIf"],[3,"formGroup","ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],[1,"meta"],[1,"item"],[3,"controlName"],[3,"formControlName"],["hidden","","disabled","","selected","","value",""],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["type","radio","value","true",3,"formControlName"],["type","radio","value","false",3,"formControlName"],["err",""],[1,"members"],[4,"ngFor","ngForOf"],[3,"parameter","formGroup","parent"],["class","item",4,"ngIf"],["type","text",3,"formControlName"]],template:function(i,n){1&i&&(t.YNc(0,cc,16,16,"ng-container",0),t.ALo(1,"async")),2&i&&t.Q6J("ngIf",t.lcZ(1,1,n.controlName$))},dependencies:[g.sg,g.O5,g.RF,g.n9,g.ED,c.YN,c.Kr,c.Fj,c.EJ,c._,c.JJ,c.JL,c.sg,c.u,o.ar,o.t,o.uZ,a,g.Ov,o.HQ],styles:[".meta[_ngcontent-%COMP%]{position:absolute;top:0;right:0;display:flex}.meta[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]{flex:none;background-color:#eee;font-weight:400;font-family:Roboto Mono,monospace;color:#000000a7;padding-left:2px;padding-right:2px;margin-left:10px}.meta.error[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]{background-color:#dc143c;color:#fff}.members[_ngcontent-%COMP%]{margin-top:5px;padding-top:5px;padding-left:10px}"],changeDetection:0})}return a})(),pc=(()=>{class a{constructor(e,i){this.dialogRef=e,this.data=i,this.form=new c.nJ({}),this.parameter=i.parameter;const n=this.getValidatorsForType(this.parameter.type);"aggregate"===this.parameter.type.engType?this.addMemberControls(this.parameter.name+".",this.parameter.type.member||[]):this.form.addControl(this.parameter.name,new c.p4(null,n))}addMemberControls(e,i){for(const n of i)if("aggregate"===n.type.engType)this.addMemberControls(e+n.name+".",n.type.member||[]);else{const s=e+n.name,l=this.getValidatorsForType(n.type);this.form.addControl(s,new c.p4("",l))}}getValidatorsForType(e){const i=[c.kI.required];return"integer"===e.engType?i.push(o.z2.requireInteger):"float"===e.engType&&i.push(o.z2.requireFloat),i}save(){const e=this.toValue("",this.parameter);this.dialogRef.close(e)}toValue(e,i){const n=this.form.value[e+i.name];switch(i.type.engType){case"boolean":return{type:"BOOLEAN",booleanValue:"true"===n};case"float":return{type:"FLOAT",floatValue:n};case"double":return{type:"DOUBLE",doubleValue:n};case"enumeration":case"string":return{type:"STRING",stringValue:n};case"integer":return{type:"SINT32",sint32Value:n};case"time":return{type:"TIMESTAMP",stringValue:o.P6.toISOString(n)};case"binary":return{type:"BINARY",binaryValue:o.P6.convertHexToBase64(n)};case"aggregate":const s=[],l=[];for(const _ of i.type.member||[])s.push(_.name),l.push(this.toValue(e+i.name+".",_));return{type:"AGGREGATE",aggregateValue:{name:s,value:l}};default:throw new Error(`Unexpected type: ${i.type.engType}`)}}static#t=this.\u0275fac=function(i){return new(i||a)(t.Y36(d.so),t.Y36(d.WI))};static#e=this.\u0275cmp=t.Xpm({type:a,selectors:[["app-set-parameter-dialog"]],decls:10,vars:4,consts:[["mat-dialog-title",""],[1,"mat-typography"],[1,"ya-form",3,"formGroup"],[3,"parameter","formGroup"],["align","end"],["mat-dialog-close","",1,"ya-button"],[1,"ya-button","primary",3,"disabled","click"]],template:function(i,n){1&i&&(t.TgZ(0,"h2",0),t._uU(1,"Set parameter value"),t.qZA(),t.TgZ(2,"mat-dialog-content",1)(3,"form",2),t._UZ(4,"app-parameter-form",3),t.qZA()(),t.TgZ(5,"mat-dialog-actions",4)(6,"button",5),t._uU(7,"CANCEL"),t.qZA(),t.TgZ(8,"button",6),t.NdJ("click",function(){return n.save()}),t._uU(9,"SAVE"),t.qZA()()),2&i&&(t.xp6(3),t.Q6J("formGroup",n.form),t.xp6(1),t.Q6J("parameter",n.parameter)("formGroup",n.form),t.xp6(4),t.Q6J("disabled",!n.form.valid))},dependencies:[c._Y,c.JL,c.sg,d.ZT,d.uh,d.xY,d.H8,_c],encapsulation:2})}return a})();const mc=function(a,r){return{c:a,system:r}};function uc(a,r){if(1&a&&(t.ynx(0),t.TgZ(1,"a",12),t._uU(2),t.qZA(),t._uU(3),t.ALo(4,"shortName"),t.ALo(5,"async"),t._UZ(6,"ya-title-copy",13),t.ALo(7,"async"),t.BQk()),2&a){const e=r.ngIf,i=t.oxw().ngIf,n=t.oxw();t.xp6(1),t.Q6J("queryParams",t.WLB(11,mc,n.yamcs.context,e)),t.xp6(1),t.hij(" ",e," "),t.xp6(1),t.AsE("/",t.lcZ(4,5,i.qualifiedName),"",t.lcZ(5,7,n.offset$)," "),t.xp6(3),t.Q6J("text",i.qualifiedName+(t.lcZ(7,9,n.offset$)||""))}}function gc(a,r){if(1&a){const e=t.EpF();t.TgZ(0,"button",14),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(2);return t.KtG(n.setParameter())}),t.TgZ(1,"mat-icon"),t._uU(2,"edit"),t.qZA(),t._uU(3," Set value "),t.qZA()}}const dc=function(a){return["/mdb/parameters",a]},$=function(a){return{c:a}};function hc(a,r){if(1&a&&(t.TgZ(0,"a",15)(1,"mat-icon"),t._uU(2,"auto_stories"),t.qZA(),t._uU(3," View in MDB "),t.qZA()),2&a){const e=t.oxw().ngIf,i=t.oxw();t.Q6J("routerLink",t.VKq(2,dc,e.qualifiedName))("queryParams",t.VKq(4,$,i.yamcs.context))}}function fc(a,r){if(1&a&&(t.TgZ(0,"a",16,17),t._uU(2," Chart "),t.qZA()),2&a){const e=t.MAs(1),i=t.oxw(2);t.Q6J("active",e.isActive)("queryParams",t.VKq(2,$,i.yamcs.context))}}function xc(a,r){if(1&a&&(t.TgZ(0,"a",18,19),t._uU(2," Alarm History "),t.qZA()),2&a){const e=t.MAs(1),i=t.oxw(2);t.Q6J("active",e.isActive)("queryParams",t.VKq(2,$,i.yamcs.context))}}function yc(a,r){if(1&a&&(t.TgZ(0,"a",20,21),t._uU(2," Historical Data "),t.qZA()),2&a){const e=t.MAs(1),i=t.oxw(2);t.Q6J("active",e.isActive)("queryParams",t.VKq(2,$,i.yamcs.context))}}function bc(a,r){if(1&a&&(t.TgZ(0,"app-instance-page")(1,"app-instance-toolbar"),t.YNc(2,uc,8,14,"ng-container",0),t.ALo(3,"spaceSystemName"),t._uU(4," \xa0\xa0\xa0 "),t.YNc(5,gc,4,0,"button",1),t.ALo(6,"async"),t.YNc(7,hc,4,6,"a",2),t.qZA(),t.TgZ(8,"nav",3,4)(10,"a",5,6),t._uU(12," Summary "),t.qZA(),t.YNc(13,fc,3,4,"a",7),t.YNc(14,xc,3,4,"a",8),t.YNc(15,yc,3,4,"a",9),t.qZA(),t.TgZ(16,"div",10)(17,"mat-tab-nav-panel",null,11),t._UZ(19,"router-outlet"),t.qZA()()()),2&a){const e=r.ngIf,i=t.MAs(9),n=t.MAs(11),s=t.MAs(18),l=t.oxw();t.xp6(2),t.Q6J("ngIf",t.lcZ(3,12,e.qualifiedName)),t.xp6(3),t.Q6J("ngIf",l.isWritable()&&l.maySetParameter()&&!t.lcZ(6,14,l.offset$)),t.xp6(2),t.Q6J("ngIf",l.mayReadMissionDatabase()),t.xp6(1),t.Q6J("mat-stretch-tabs",!1)("tabPanel",s),t.xp6(2),t.Q6J("active",n.isActive)("queryParams",t.VKq(16,$,l.yamcs.context)),t.xp6(3),t.Q6J("ngIf",l.config.tmArchive),t.xp6(1),t.Q6J("ngIf",l.mayReadAlarms()),t.xp6(1),t.Q6J("ngIf",l.config.tmArchive),t.xp6(1),t.ekj("noscroll",1===i.selectedIndex)}}let Kt=(()=>{class a{constructor(e,i,n,s,l,_,m,u,h){this.yamcs=i,this.authService=n,this.messageService=s,this.dialog=l,this.title=_,this.valuePipe=m,this.unitsPipe=u,this.parameter$=new f.X(null),this.offset$=new f.X(null),this.parameterValue$=new f.X(null),this.config=h.getConfig(),e.paramMap.subscribe(x=>{const v=x.get("qualifiedName");this.changeParameter(v)})}changeParameter(e){this.yamcs.yamcsClient.getParameter(this.yamcs.instance,e).then(i=>{this.parameter$.next(i),this.offset$.next(e!==i.qualifiedName?e.substring(i.qualifiedName.length):null),this.updateTitle()}).catch(i=>{this.messageService.showError(i)}),this.parameterValueSubscription&&this.parameterValueSubscription.cancel(),this.parameterValueSubscription=this.yamcs.yamcsClient.createParameterSubscription({instance:this.yamcs.instance,processor:this.yamcs.processor,id:[{name:e}],abortOnInvalid:!1,sendFromCache:!0,updateOnExpiration:!0,action:"REPLACE"},i=>{this.parameterValue$.next(i.values?i.values[0]:null),this.updateTitle()})}updateTitle(){const e=this.parameter$.getValue(),i=this.offset$.getValue();if(e){let n=e.name;i&&(n+=i);const s=this.parameterValue$.getValue();s&&(n+=": "+this.valuePipe.transform(s.engValue),e.type&&e.type.unitSet&&(n+=" "+this.unitsPipe.transform(e.type.unitSet)),s.rangeCondition&&"LOW"===s.rangeCondition?n+=" \u2193":s.rangeCondition&&"HIGH"===s.rangeCondition&&(n+=" \u2191")),this.title.setTitle(n)}}isWritable(){const e=this.parameter$.value;return!!e&&("LOCAL"===e.dataSource||"EXTERNAL1"===e.dataSource||"EXTERNAL2"===e.dataSource||"EXTERNAL3"===e.dataSource)}maySetParameter(){const e=this.parameter$.value;return!!e&&this.authService.getUser().hasObjectPrivilege("WriteParameter",e.qualifiedName)}mayReadAlarms(){return this.authService.getUser().hasSystemPrivilege("ReadAlarms")}mayReadMissionDatabase(){return this.authService.getUser().hasSystemPrivilege("GetMissionDatabase")}setParameter(){const e=this.parameter$.value;this.dialog.open(pc,{width:"400px",data:{parameter:this.parameter$.value}}).afterClosed().subscribe(n=>{n&&this.yamcs.yamcsClient.setParameterValue(this.yamcs.instance,this.yamcs.processor,e.qualifiedName,n).catch(s=>this.messageService.showError(s))})}ngOnDestroy(){this.parameterValueSubscription&&this.parameterValueSubscription.cancel()}static#t=this.\u0275fac=function(i){return new(i||a)(t.Y36(b.gz),t.Y36(o.C8),t.Y36(D.e),t.Y36(o.ez),t.Y36(d.uw),t.Y36(C.Dx),t.Y36(o.VC),t.Y36(o.HQ),t.Y36(o.E4))};static#e=this.\u0275cmp=t.Xpm({type:a,selectors:[["ng-component"]],decls:2,vars:3,consts:[[4,"ngIf"],["mat-button","","color","primary",3,"click",4,"ngIf"],["mat-button","","color","primary",3,"routerLink","queryParams",4,"ngIf"],["mat-tab-nav-bar","",1,"secondary",3,"mat-stretch-tabs","tabPanel"],["tabs",""],["mat-tab-link","","routerLink","summary","routerLinkActive","",3,"active","queryParams"],["rla","routerLinkActive"],["mat-tab-link","","routerLink","chart","routerLinkActive","",3,"active","queryParams",4,"ngIf"],["mat-tab-link","","routerLink","alarms","routerLinkActive","",3,"active","queryParams",4,"ngIf"],["mat-tab-link","","routerLink","data","routerLinkActive","",3,"active","queryParams",4,"ngIf"],[1,"tab-content-wrapper"],["tabPanel",""],["routerLink","/telemetry/parameters",1,"ya-link","ya-header-link",3,"queryParams"],[3,"text"],["mat-button","","color","primary",3,"click"],["mat-button","","color","primary",3,"routerLink","queryParams"],["mat-tab-link","","routerLink","chart","routerLinkActive","",3,"active","queryParams"],["rlb","routerLinkActive"],["mat-tab-link","","routerLink","alarms","routerLinkActive","",3,"active","queryParams"],["rlc","routerLinkActive"],["mat-tab-link","","routerLink","data","routerLinkActive","",3,"active","queryParams"],["rld","routerLinkActive"]],template:function(i,n){1&i&&(t.YNc(0,bc,20,18,"app-instance-page",0),t.ALo(1,"async")),2&i&&t.Q6J("ngIf",t.lcZ(1,1,n.parameter$))},dependencies:[g.O5,b.lC,b.rH,b.Od,w.zs,w.lW,P.Hw,L.BU,L.sW,L.Nj,o.GN,k.a,U.k,g.Ov,o.yk,o.BC],styles:[".tab-content-wrapper[_ngcontent-%COMP%]{position:absolute;inset:37px 0 0;overflow:auto}.tab-content-wrapper.noscroll[_ngcontent-%COMP%]{overflow:hidden}"],changeDetection:0})}return a})();var Tc=y(5192);const vc=["container"],A="http://www.w3.org/2000/svg";let Zc=(()=>{class a{ngOnChanges(){this.pval&&this.indicator&&this.redraw()}ngAfterViewInit(){const e=this.container.nativeElement,i=document.createElementNS(A,"rect");i.setAttribute("x","0"),i.setAttribute("y","0"),i.setAttribute("width","100"),i.setAttribute("height","50"),i.setAttribute("shape-rendering","crispEdges"),i.style.fill="#00ff00",e.appendChild(i),this.watchLowRange=document.createElementNS(A,"rect"),this.watchLowRange.setAttribute("x","0"),this.watchLowRange.setAttribute("y","0"),this.watchLowRange.setAttribute("width","0"),this.watchLowRange.setAttribute("height","50"),this.watchLowRange.setAttribute("shape-rendering","crispEdges"),this.watchLowRange.style.fill="#ffff98",e.appendChild(this.watchLowRange),this.watchHighRange=document.createElementNS(A,"rect"),this.watchHighRange.setAttribute("x","0"),this.watchHighRange.setAttribute("y","0"),this.watchHighRange.setAttribute("width","0"),this.watchHighRange.setAttribute("height","50"),this.watchHighRange.setAttribute("shape-rendering","crispEdges"),this.watchHighRange.style.fill="#ffff98",e.appendChild(this.watchHighRange),this.warningLowRange=document.createElementNS(A,"rect"),this.warningLowRange.setAttribute("x","0"),this.warningLowRange.setAttribute("y","0"),this.warningLowRange.setAttribute("width","0"),this.warningLowRange.setAttribute("height","50"),this.warningLowRange.setAttribute("shape-rendering","crispEdges"),this.warningLowRange.style.fill="#ffff00",e.appendChild(this.warningLowRange),this.warningHighRange=document.createElementNS(A,"rect"),this.warningHighRange.setAttribute("x","0"),this.warningHighRange.setAttribute("y","0"),this.warningHighRange.setAttribute("width","0"),this.warningHighRange.setAttribute("height","50"),this.warningHighRange.setAttribute("shape-rendering","crispEdges"),this.warningHighRange.style.fill="#ffff00",e.appendChild(this.warningHighRange),this.distressLowRange=document.createElementNS(A,"rect"),this.distressLowRange.setAttribute("x","0"),this.distressLowRange.setAttribute("y","0"),this.distressLowRange.setAttribute("width","0"),this.distressLowRange.setAttribute("height","50"),this.distressLowRange.setAttribute("shape-rendering","crispEdges"),this.distressLowRange.style.fill="#ff6600",e.appendChild(this.distressLowRange),this.distressHighRange=document.createElementNS(A,"rect"),this.distressHighRange.setAttribute("x","0"),this.distressHighRange.setAttribute("y","0"),this.distressHighRange.setAttribute("width","0"),this.distressHighRange.setAttribute("height","50"),this.distressHighRange.setAttribute("shape-rendering","crispEdges"),this.distressHighRange.style.fill="#ff6600",e.appendChild(this.distressHighRange),this.criticalLowRange=document.createElementNS(A,"rect"),this.criticalLowRange.setAttribute("x","0"),this.criticalLowRange.setAttribute("y","0"),this.criticalLowRange.setAttribute("width","0"),this.criticalLowRange.setAttribute("height","50"),this.criticalLowRange.setAttribute("shape-rendering","crispEdges"),this.criticalLowRange.style.fill="red",e.appendChild(this.criticalLowRange),this.criticalHighRange=document.createElementNS(A,"rect"),this.criticalHighRange.setAttribute("x","0"),this.criticalHighRange.setAttribute("y","0"),this.criticalHighRange.setAttribute("width","0"),this.criticalHighRange.setAttribute("height","50"),this.criticalHighRange.setAttribute("shape-rendering","crispEdges"),this.criticalHighRange.style.fill="red",e.appendChild(this.criticalHighRange),this.severeLowRange=document.createElementNS(A,"rect"),this.severeLowRange.setAttribute("x","0"),this.severeLowRange.setAttribute("y","0"),this.severeLowRange.setAttribute("width","0"),this.severeLowRange.setAttribute("height","50"),this.severeLowRange.setAttribute("shape-rendering","crispEdges"),this.severeLowRange.style.fill="#800000",e.appendChild(this.severeLowRange),this.severeHighRange=document.createElementNS(A,"rect"),this.severeHighRange.setAttribute("x","0"),this.severeHighRange.setAttribute("y","0"),this.severeHighRange.setAttribute("width","0"),this.severeHighRange.setAttribute("height","50"),this.severeHighRange.setAttribute("shape-rendering","crispEdges"),this.severeHighRange.style.fill="#800000",e.appendChild(this.severeHighRange),this.indicator=document.createElementNS(A,"polygon"),this.indicator.classList.add("indicator"),this.indicator.style.fill="black",this.indicator.style.visibility="hidden",e.appendChild(this.indicator),this.pval&&this.redraw()}redraw(){let e,i;const n=new Map;if(this.pval.alarmRange)for(const s of this.pval.alarmRange)n.set(s.level,s),void 0!==s.minInclusive&&(void 0===e||s.minInclusive<e)&&(e=s.minInclusive),void 0!==s.minExclusive&&(void 0===e||s.minExclusive<e)&&(e=s.minExclusive),void 0!==s.maxInclusive&&(void 0===i||s.maxInclusive>i)&&(i=s.maxInclusive),void 0!==s.maxExclusive&&(void 0===i||s.maxExclusive>i)&&(i=s.maxExclusive);if(this.criticalHighRange.setAttribute("width","0"),this.criticalLowRange.setAttribute("width","0"),this.indicator.style.visibility="hidden",void 0!==e&&void 0!==i&&e!==i){const s=e-(i-e)/5,l=i+(i-e)/5,_=100/(l-s),m=n.get("WATCH");if(m)if(m.minInclusive?this.watchLowRange.setAttribute("width",String((m.minInclusive-s)*_)):m.minExclusive&&this.watchLowRange.setAttribute("width",String((m.minExclusive-s)*_)),m.maxInclusive){const T=(m.maxInclusive-s)*_;this.watchHighRange.setAttribute("x",String(T)),this.watchHighRange.setAttribute("width",String(100-T))}else if(m.maxExclusive){const T=(m.maxExclusive-s)*_;this.watchHighRange.setAttribute("x",String(T)),this.watchHighRange.setAttribute("width",String(100-T))}const u=n.get("WARNING");if(u)if(u.minInclusive?this.warningLowRange.setAttribute("width",String((u.minInclusive-s)*_)):u.minExclusive&&this.warningLowRange.setAttribute("width",String((u.minExclusive-s)*_)),u.maxInclusive){const T=(u.maxInclusive-s)*_;this.warningHighRange.setAttribute("x",String(T)),this.warningHighRange.setAttribute("width",String(100-T))}else if(u.maxExclusive){const T=(u.maxExclusive-s)*_;this.warningHighRange.setAttribute("x",String(T)),this.warningHighRange.setAttribute("width",String(100-T))}const h=n.get("DISTRESS");if(h)if(h.minInclusive?this.distressLowRange.setAttribute("width",String((h.minInclusive-s)*_)):h.minExclusive&&this.distressLowRange.setAttribute("width",String((h.minExclusive-s)*_)),h.maxInclusive){const T=(h.maxInclusive-s)*_;this.distressHighRange.setAttribute("x",String(T)),this.distressHighRange.setAttribute("width",String(100-T))}else if(h.maxExclusive){const T=(h.maxExclusive-s)*_;this.distressHighRange.setAttribute("x",String(T)),this.distressHighRange.setAttribute("width",String(100-T))}const x=n.get("CRITICAL");if(x)if(x.minInclusive?this.criticalLowRange.setAttribute("width",String((x.minInclusive-s)*_)):x.minExclusive&&this.criticalLowRange.setAttribute("width",String((x.minExclusive-s)*_)),x.maxInclusive){const T=(x.maxInclusive-s)*_;this.criticalHighRange.setAttribute("x",String(T)),this.criticalHighRange.setAttribute("width",String(100-T))}else if(x.maxExclusive){const T=(x.maxExclusive-s)*_;this.criticalHighRange.setAttribute("x",String(T)),this.criticalHighRange.setAttribute("width",String(100-T))}const v=n.get("SEVERE");if(v)if(v.minInclusive?this.severeLowRange.setAttribute("width",String((v.minInclusive-s)*_)):v.minExclusive&&this.severeLowRange.setAttribute("width",String((v.minExclusive-s)*_)),v.maxInclusive){const T=(v.maxInclusive-s)*_;this.severeHighRange.setAttribute("x",String(T)),this.severeHighRange.setAttribute("width",String(100-T))}else if(v.maxExclusive){const T=(v.maxExclusive-s)*_;this.severeHighRange.setAttribute("x",String(T)),this.severeHighRange.setAttribute("width",String(100-T))}const R=this.getNumericValue(this.pval);if(void 0!==R){const rt=(Math.min(Math.max(R,s),l)-s)*_;this.indicator.setAttribute("points",`${rt},25 ${rt-3.5},100 ${rt+3.5},100`),this.indicator.style.visibility="visible"}else this.indicator.style.visibility="hidden"}}getNumericValue(e){const i=e.engValue;switch(i.type){case"FLOAT":return i.floatValue;case"DOUBLE":return i.doubleValue;case"UINT32":return i.uint32Value;case"SINT32":return i.sint32Value;case"UINT64":return i.uint64Value;case"SINT64":return i.sint64Value}}static#t=this.\u0275fac=function(i){return new(i||a)};static#e=this.\u0275cmp=t.Xpm({type:a,selectors:[["app-severity-meter"]],viewQuery:function(i,n){if(1&i&&t.Gf(vc,7),2&i){let s;t.iGM(s=t.CRH())&&(n.container=s.first)}},inputs:{pval:"pval"},features:[t.TTD],decls:2,vars:0,consts:[["width","100%","height","8px","viewBox","0 0 100 100","preserveAspectRatio","none",2,"overflow","visible"],["container",""]],template:function(i,n){1&i&&(t.O4$(),t._UZ(0,"svg",0,1))},encapsulation:2,changeDetection:0})}return a})();const Xt=function(a,r){return{c:a,filter:r}};function Pc(a,r){if(1&a&&(t.ynx(0),t.TgZ(1,"a",10),t._uU(2),t.qZA(),t.BQk()),2&a){const e=r.ngIf,i=t.oxw(2);t.xp6(1),t.Q6J("queryParams",t.WLB(2,Xt,i.yamcs.context,e)),t.xp6(1),t.hij(" ",e," ")}}function wc(a,r){if(1&a&&(t.ynx(0),t.TgZ(1,"dt"),t._uU(2),t.qZA(),t.TgZ(3,"dd"),t._uU(4),t.qZA(),t.BQk()),2&a){const e=r.$implicit;t.xp6(2),t.Oqu(e.namespace),t.xp6(2),t.Oqu(e.name)}}function Ac(a,r){if(1&a&&(t.TgZ(0,"span",11),t._uU(1),t.qZA()),2&a){const e=r.ngIf;t.xp6(1),t.hij(" ",e," ")}}function Sc(a,r){if(1&a&&(t.ynx(0),t.TgZ(1,"dt"),t._uU(2,"Signed"),t.qZA(),t.TgZ(3,"dd"),t._uU(4),t.qZA(),t.BQk()),2&a){const e=t.oxw().ngIf;let i;t.xp6(4),t.Oqu(null!==(i=e.signed)&&void 0!==i?i:"-")}}function Cc(a,r){if(1&a&&(t.ynx(0),t.YNc(1,Sc,5,1,"ng-container",2),t.BQk()),2&a){const e=r.ngIf;t.xp6(1),t.Q6J("ngIf",void 0!==e.signed)}}function kc(a,r){if(1&a&&(t.ynx(0),t.TgZ(1,"dt"),t._uU(2,"Description"),t.qZA(),t.TgZ(3,"dd"),t._UZ(4,"app-markdown",12),t.qZA(),t.BQk()),2&a){const e=t.oxw().ngIf;t.xp6(4),t.Q6J("text",e.longDescription)}}function Uc(a,r){if(1&a&&(t.ynx(0),t.TgZ(1,"dt"),t._uU(2,"Description"),t.qZA(),t.TgZ(3,"dd"),t._uU(4),t.qZA(),t.BQk()),2&a){const e=t.oxw().ngIf;t.xp6(4),t.hij(" ",e.shortDescription||"-"," ")}}function qc(a,r){if(1&a&&(t.ynx(0),t.YNc(1,kc,5,1,"ng-container",2),t.YNc(2,Uc,5,1,"ng-container",2),t.BQk()),2&a){const e=r.ngIf;t.xp6(1),t.Q6J("ngIf",e.longDescription),t.xp6(1),t.Q6J("ngIf",!e.longDescription)}}function Dc(a,r){if(1&a&&(t.TgZ(0,"dl",8)(1,"dt"),t._uU(2,"Entry"),t.qZA(),t.TgZ(3,"dd"),t._uU(4),t.ALo(5,"shortName"),t.qZA(),t.TgZ(6,"dt"),t._uU(7,"Space System"),t.qZA(),t.TgZ(8,"dd"),t.YNc(9,Pc,3,5,"ng-container",2),t.ALo(10,"spaceSystemName"),t.qZA(),t.YNc(11,wc,5,2,"ng-container",3),t.ALo(12,"async"),t.TgZ(13,"dt"),t._uU(14,"Type"),t.qZA(),t.TgZ(15,"dd"),t.YNc(16,Ac,2,1,"span",4),t.ALo(17,"async"),t.qZA(),t.YNc(18,Cc,2,1,"ng-container",2),t.ALo(19,"async"),t.TgZ(20,"dt"),t._uU(21,"Source"),t.qZA(),t.TgZ(22,"dd"),t._uU(23),t.ALo(24,"titlecase"),t.qZA(),t.YNc(25,qc,3,2,"ng-container",9),t.ALo(26,"async"),t.qZA()),2&a){const e=t.oxw(),i=t.MAs(23);let n,s;t.xp6(4),t.AsE(" ",t.lcZ(5,10,e.parameter.qualifiedName),"",e.offset," "),t.xp6(5),t.Q6J("ngIf",t.lcZ(10,12,e.parameter.qualifiedName)),t.xp6(2),t.Q6J("ngForOf",null==(n=t.lcZ(12,14,e.entry$))?null:n.alias),t.xp6(5),t.Q6J("ngIf",null==(s=t.lcZ(17,16,e.ptype$))?null:s.engType)("ngIfElse",i),t.xp6(2),t.Q6J("ngIf",t.lcZ(19,18,e.ptype$)),t.xp6(5),t.Oqu(t.lcZ(24,20,e.parameter.dataSource)||"-"),t.xp6(2),t.Q6J("ngIf",t.lcZ(26,22,e.entry$))("ngIfElse",i)}}const nt=function(a){return["/telemetry/parameters",a]},K=function(a){return{c:a}};function Nc(a,r){if(1&a&&(t.ynx(0),t.TgZ(1,"dt"),t._uU(2,"Host Parameter"),t.qZA(),t.TgZ(3,"dd")(4,"a",13),t._uU(5),t.ALo(6,"shortName"),t.qZA()(),t.BQk()),2&a){const e=t.oxw();t.xp6(4),t.Q6J("routerLink",t.VKq(5,nt,e.parameter.qualifiedName))("queryParams",t.VKq(7,K,e.yamcs.context)),t.xp6(1),t.hij(" ",t.lcZ(6,3,e.parameter.qualifiedName)," ")}}function Ic(a,r){if(1&a&&(t.ynx(0),t.TgZ(1,"dt"),t._uU(2,"Parameter"),t.qZA(),t.TgZ(3,"dd"),t._uU(4),t.ALo(5,"shortName"),t.qZA(),t.BQk()),2&a){const e=t.oxw();t.xp6(4),t.Oqu(t.lcZ(5,1,e.parameter.qualifiedName))}}function Qc(a,r){if(1&a&&(t.ynx(0),t.TgZ(1,"a",10),t._uU(2),t.qZA(),t.BQk()),2&a){const e=r.ngIf,i=t.oxw(2);t.xp6(1),t.Q6J("queryParams",t.WLB(2,Xt,i.yamcs.context,e)),t.xp6(1),t.hij(" ",e," ")}}function Lc(a,r){if(1&a&&(t.ynx(0),t.TgZ(1,"dt"),t._uU(2,"Space System"),t.qZA(),t.TgZ(3,"dd"),t.YNc(4,Qc,3,5,"ng-container",2),t.ALo(5,"spaceSystemName"),t.qZA(),t.BQk()),2&a){const e=t.oxw();t.xp6(4),t.Q6J("ngIf",t.lcZ(5,1,e.parameter.qualifiedName))}}function Jc(a,r){if(1&a&&(t.ynx(0),t.TgZ(1,"dt"),t._uU(2),t.qZA(),t.TgZ(3,"dd"),t._uU(4),t.qZA(),t.BQk()),2&a){const e=r.$implicit;t.xp6(2),t.Oqu(e.namespace),t.xp6(2),t.Oqu(e.name)}}function Yc(a,r){if(1&a&&(t.TgZ(0,"span",11),t._uU(1),t.qZA()),2&a){const e=r.ngIf;t.xp6(1),t.hij(" ",e," ")}}function Mc(a,r){if(1&a&&(t.ynx(0),t.TgZ(1,"dt"),t._uU(2,"Signed"),t.qZA(),t.TgZ(3,"dd"),t._uU(4),t.qZA(),t.BQk()),2&a){const e=t.oxw();t.xp6(4),t.Oqu(null==e.parameter.type?null:e.parameter.type.signed)}}function Oc(a,r){if(1&a&&(t.ynx(0),t.TgZ(1,"dt"),t._uU(2,"Source"),t.qZA(),t.TgZ(3,"dd"),t._uU(4),t.ALo(5,"titlecase"),t.qZA(),t.BQk()),2&a){const e=t.oxw();t.xp6(4),t.Oqu(t.lcZ(5,1,e.parameter.dataSource)||"-")}}function $c(a,r){if(1&a&&(t.ynx(0),t.TgZ(1,"dt"),t._uU(2,"Description"),t.qZA(),t.TgZ(3,"dd"),t._UZ(4,"app-markdown",12),t.qZA(),t.BQk()),2&a){const e=t.oxw();t.xp6(4),t.Q6J("text",e.parameter.longDescription)}}function Rc(a,r){if(1&a&&(t.ynx(0),t.TgZ(1,"dt"),t._uU(2,"Description"),t.qZA(),t.TgZ(3,"dd"),t._uU(4),t.qZA(),t.BQk()),2&a){const e=t.oxw();t.xp6(4),t.hij(" ",e.parameter.shortDescription||"-"," ")}}function Fc(a,r){if(1&a&&(t.TgZ(0,"span",11),t._uU(1),t.qZA()),2&a){const e=r.ngIf;t.xp6(1),t.hij(" ",e," ")}}function Vc(a,r){if(1&a&&(t.ynx(0),t._uU(1),t.ALo(2,"units"),t.BQk()),2&a){const e=r.ngIf;t.xp6(1),t.hij(" ",t.lcZ(2,1,e)," ")}}function Hc(a,r){if(1&a&&(t.ynx(0),t.TgZ(1,"td")(2,"a",20),t._uU(3),t.qZA()(),t.TgZ(4,"td"),t.YNc(5,Fc,2,1,"span",4),t.ALo(6,"entryForOffset"),t.qZA(),t.TgZ(7,"td"),t._uU(8),t.ALo(9,"entryForOffset"),t.qZA(),t.TgZ(10,"td")(11,"ya-expirable",21),t._uU(12),t.ALo(13,"value"),t.YNc(14,Vc,3,3,"ng-container",2),t.ALo(15,"entryForOffset"),t.qZA()(),t.BQk()),2&a){const e=r.ngIf,i=t.oxw(),n=i.$implicit,s=i.index,l=t.oxw(2).ngIf,_=t.oxw(),m=t.MAs(23);let u,h,x;t.xp6(2),t.Q6J("routerLink",t.VKq(20,nt,_.parameter.qualifiedName+e))("queryParams",t.VKq(22,K,_.yamcs.context)),t.xp6(1),t.Oqu(n),t.xp6(2),t.Q6J("ngIf",null==(u=t.xi3(6,9,_.parameter,e))||null==u.type?null:u.type.engType)("ngIfElse",m),t.xp6(3),t.Oqu((null==(h=t.xi3(9,12,_.parameter,e))?null:h.shortDescription)||"-"),t.xp6(3),t.Q6J("pval",_.pval),t.xp6(1),t.hij(" ",t.lcZ(13,15,l.aggregateValue.value[s])," "),t.xp6(2),t.Q6J("ngIf",null==(x=t.xi3(15,17,_.parameter,e))||null==x.type?null:x.type.unitSet)}}function Ec(a,r){if(1&a&&(t.TgZ(0,"tr"),t.YNc(1,Hc,16,24,"ng-container",2),t.qZA()),2&a){const e=r.$implicit,i=t.oxw(3);t.xp6(1),t.Q6J("ngIf",(i.offset||"")+"."+e)}}function Bc(a,r){if(1&a&&(t.TgZ(0,"table",19)(1,"tr")(2,"th"),t._uU(3,"Member"),t.qZA(),t.TgZ(4,"th"),t._uU(5,"Type"),t.qZA(),t.TgZ(6,"th"),t._uU(7,"Description"),t.qZA(),t.TgZ(8,"th"),t._uU(9,"Value"),t.qZA()(),t.YNc(10,Ec,2,1,"tr",3),t.qZA()),2&a){const e=t.oxw().ngIf;t.xp6(10),t.Q6J("ngForOf",e.aggregateValue.name)}}function Gc(a,r){if(1&a&&(t.TgZ(0,"tr")(1,"td")(2,"a",20),t._uU(3),t.qZA()(),t.TgZ(4,"td"),t._uU(5),t.ALo(6,"value"),t.qZA()()),2&a){const e=r.$implicit,i=r.index,n=t.oxw(3);t.xp6(2),t.Q6J("routerLink",t.VKq(6,nt,n.parameter.qualifiedName+(n.offset||"")+"["+i+"]"))("queryParams",t.VKq(8,K,n.yamcs.context)),t.xp6(1),t.Oqu(i),t.xp6(2),t.Oqu(t.lcZ(6,4,e))}}function jc(a,r){if(1&a&&(t.TgZ(0,"table",19)(1,"tr")(2,"th"),t._uU(3,"Index"),t.qZA(),t.TgZ(4,"th"),t._uU(5,"Value"),t.qZA()(),t.YNc(6,Gc,7,10,"tr",3),t.qZA()),2&a){const e=t.oxw().ngIf;t.xp6(6),t.Q6J("ngForOf",e.arrayValue)}}function zc(a,r){if(1&a&&(t.ynx(0),t._UZ(1,"app-alarm-level",24),t._uU(2,"\xa0 "),t.BQk()),2&a){const e=t.oxw(3);t.xp6(1),t.Q6J("level",e.pval.monitoringResult)}}function Kc(a,r){if(1&a&&(t.ynx(0),t._uU(1),t.ALo(2,"units"),t.BQk()),2&a){const e=r.ngIf;t.xp6(1),t.hij(" ",t.lcZ(2,1,e)," ")}}function Xc(a,r){if(1&a&&(t.TgZ(0,"span",22)(1,"ya-expirable",23),t.YNc(2,zc,3,1,"ng-container",2),t._uU(3),t.ALo(4,"value"),t.YNc(5,Kc,3,3,"ng-container",2),t.ALo(6,"parameterTypeForPath"),t.qZA()()),2&a){const e=t.oxw().ngIf,i=t.oxw();let n;t.xp6(1),t.Q6J("pval",i.pval),t.xp6(1),t.Q6J("ngIf",i.pval.monitoringResult),t.xp6(1),t.hij(" ",t.lcZ(4,4,e)," "),t.xp6(2),t.Q6J("ngIf",null==(n=t.lcZ(6,6,i.parameter))?null:n.unitSet)}}function Wc(a,r){if(1&a&&(t.ynx(0),t._UZ(1,"app-severity-meter",21),t.BQk()),2&a){const e=t.oxw(2);t.xp6(1),t.Q6J("pval",e.pval)}}function t_(a,r){if(1&a&&(t.ynx(0)(1,14),t.YNc(2,Bc,11,1,"table",15),t.YNc(3,jc,7,1,"table",15),t.YNc(4,Xc,7,8,"span",16),t._UZ(5,"br"),t.TgZ(6,"div",17),t.YNc(7,Wc,2,1,"ng-container",2),t._UZ(8,"br"),t.TgZ(9,"span",18),t._uU(10),t.ALo(11,"datetime"),t._UZ(12,"br"),t._uU(13),t.ALo(14,"value"),t._UZ(15,"br"),t.qZA()(),t.BQk()()),2&a){const e=r.ngIf,i=t.oxw();let n;t.xp6(1),t.Q6J("ngSwitch",e.type),t.xp6(1),t.Q6J("ngSwitchCase","AGGREGATE"),t.xp6(1),t.Q6J("ngSwitchCase","ARRAY"),t.xp6(4),t.Q6J("ngIf",i.pval.alarmRange),t.xp6(3),t.hij(" Generation time: ",t.lcZ(11,6,i.pval.generationTime),""),t.xp6(3),t.hij(" Raw value: ",null!==(n=t.lcZ(14,8,i.pval.rawValue))&&void 0!==n?n:"-","")}}function e_(a,r){1&a&&(t.TgZ(0,"span",25),t._uU(1,"---"),t.qZA())}function a_(a,r){1&a&&(t.ynx(0),t._uU(1,", "),t.BQk())}const i_=function(a){return["/mdb/parameters/",a]};function n_(a,r){if(1&a&&(t.ynx(0),t.YNc(1,a_,2,0,"ng-container",2),t.TgZ(2,"a",29),t._uU(3),t.qZA(),t._uU(4),t.ALo(5,"operator"),t.BQk()),2&a){const e=r.$implicit,i=r.first,n=t.oxw(4);t.xp6(1),t.Q6J("ngIf",!i),t.xp6(1),t.Q6J("routerLink",t.VKq(8,i_,e.parameter.qualifiedName))("queryParams",t.VKq(10,K,n.yamcs.context)),t.xp6(1),t.hij(" ",e.parameter.name," "),t.xp6(1),t.AsE(" ",t.lcZ(5,6,e.operator)," ",e.value," ")}}function r_(a,r){if(1&a&&(t.TgZ(0,"th"),t.YNc(1,n_,6,12,"ng-container",3),t.qZA()),2&a){const e=r.$implicit;t.xp6(1),t.Q6J("ngForOf",e.comparison)}}function s_(a,r){if(1&a&&(t.ynx(0),t._UZ(1,"app-alarm-level",30),t._uU(2),t.BQk()),2&a){const e=r.ngIf;t.xp6(1),t.Q6J("level",e)("grayscale",!0),t.xp6(1),t.hij(" ",e," ")}}function o_(a,r){1&a&&(t.TgZ(0,"span"),t._uU(1,"-"),t.qZA())}function l_(a,r){if(1&a&&(t.ynx(0),t._UZ(1,"app-alarm-level",30),t._uU(2),t.BQk()),2&a){const e=r.ngIf;t.xp6(1),t.Q6J("level",e)("grayscale",!0),t.xp6(1),t.hij(" ",e," ")}}function c_(a,r){1&a&&(t.TgZ(0,"span"),t._uU(1,"-"),t.qZA())}function __(a,r){if(1&a&&(t.TgZ(0,"td"),t.YNc(1,l_,3,3,"ng-container",2),t.YNc(2,c_,2,0,"span",2),t.qZA()),2&a){const e=r.$implicit,i=t.oxw().$implicit,n=t.oxw(3);t.xp6(1),t.Q6J("ngIf",n.getEnumerationAlarmLevel(e,i)),t.xp6(1),t.Q6J("ngIf",!n.getEnumerationAlarmLevel(e,i))}}function p_(a,r){if(1&a&&(t.TgZ(0,"tr")(1,"td",25),t._uU(2),t.qZA(),t.TgZ(3,"td",25),t._uU(4),t.qZA(),t.TgZ(5,"td"),t._uU(6),t.qZA(),t.TgZ(7,"td"),t.YNc(8,s_,3,3,"ng-container",2),t.YNc(9,o_,2,0,"span",2),t.qZA(),t.YNc(10,__,3,2,"td",3),t.qZA()),2&a){const e=r.$implicit,i=t.oxw(2).ngIf,n=t.oxw();t.xp6(2),t.Oqu(e.value),t.xp6(2),t.Oqu(e.label),t.xp6(2),t.Oqu(e.description||"-"),t.xp6(2),t.Q6J("ngIf",n.getDefaultAlarmLevel(i.type,e)),t.xp6(1),t.Q6J("ngIf",!n.getDefaultAlarmLevel(i.type,e)),t.xp6(1),t.Q6J("ngForOf",i.type.contextAlarm)}}function m_(a,r){if(1&a&&(t.ynx(0),t.TgZ(1,"div",5),t._UZ(2,"mat-divider"),t.qZA(),t.TgZ(3,"h4"),t._uU(4,"Enumeration"),t.qZA(),t.TgZ(5,"table",19)(6,"tr")(7,"th",26),t._uU(8,"Value"),t.qZA(),t.TgZ(9,"th",27),t._uU(10,"Label"),t.qZA(),t.TgZ(11,"th",28),t._uU(12,"Description"),t.qZA(),t.TgZ(13,"th"),t._uU(14,"Alarm Level (default)"),t.qZA(),t.YNc(15,r_,2,1,"th",3),t.qZA(),t.YNc(16,p_,11,6,"tr",3),t.qZA(),t.BQk()),2&a){const e=t.oxw().ngIf;t.xp6(15),t.Q6J("ngForOf",null==e.type?null:e.type.contextAlarm),t.xp6(1),t.Q6J("ngForOf",null==e.type?null:e.type.enumValue)}}function u_(a,r){if(1&a&&(t.ynx(0),t.YNc(1,m_,17,2,"ng-container",2),t.BQk()),2&a){const e=r.ngIf;t.xp6(1),t.Q6J("ngIf","enumeration"===(null==e.type?null:e.type.engType))}}function g_(a,r){1&a&&t._uU(0,"-")}let d_=(()=>{class a{constructor(e,i,n){this.yamcs=e,this.entryForOffsetPipe=i,this.parameterTypeForPathPipe=n,this.entry$=new f.X(null),this.ptype$=new f.X(null)}ngOnChanges(){if(this.parameter){if(this.offset){const e=this.entryForOffsetPipe.transform(this.parameter,this.offset);this.entry$.next(e)}else this.entry$.next(this.parameter);this.ptype$.next(this.parameterTypeForPathPipe.transform(this.parameter)||null)}else this.entry$.next(null),this.ptype$.next(null)}getDefaultAlarmLevel(e,i){if(e&&e.defaultAlarm){const n=e.defaultAlarm;if(n.enumerationAlarm)for(const s of n.enumerationAlarm)if(s.label===i.label)return s.level}}getEnumerationAlarmLevel(e,i){const n=e.alarm;for(const s of n.enumerationAlarm)if(s.label===i.label)return s.level}static#t=this.\u0275fac=function(i){return new(i||a)(t.Y36(o.C8),t.Y36(o.hw),t.Y36(o.Wt))};static#e=this.\u0275cmp=t.Xpm({type:a,selectors:[["app-parameter-detail"]],inputs:{parameter:"parameter",offset:"offset",pval:"pval"},features:[t.TTD],decls:24,vars:18,consts:[["class","dl-horizontal no-lead no-trail",4,"ngIf"],[1,"dl-horizontal","no-trail"],[4,"ngIf"],[4,"ngFor","ngForOf"],["class","mono",4,"ngIf","ngIfElse"],[1,"section-divider"],["style","white-space: nowrap",4,"ngIf"],["dash",""],[1,"dl-horizontal","no-lead","no-trail"],[4,"ngIf","ngIfElse"],["routerLink","/telemetry/parameters",1,"ya-link",3,"queryParams"],[1,"mono"],[3,"text"],[1,"ya-link",3,"routerLink","queryParams"],[3,"ngSwitch"],["yaDataTable","",4,"ngSwitchCase"],["class","pval",4,"ngSwitchDefault"],[1,"meter-size-constrainer"],[1,"subtext"],["yaDataTable",""],[3,"routerLink","queryParams"],[3,"pval"],[1,"pval"],[2,"white-space","nowrap",3,"pval"],[3,"level"],[2,"white-space","nowrap"],[2,"width","50px"],[2,"width","100px"],[2,"width","300px"],[1,"secundary",3,"routerLink","queryParams"],[3,"level","grayscale"]],template:function(i,n){if(1&i&&(t.YNc(0,Dc,27,24,"dl",0),t.TgZ(1,"dl",1),t.YNc(2,Nc,7,9,"ng-container",2),t.YNc(3,Ic,6,3,"ng-container",2),t.YNc(4,Lc,6,3,"ng-container",2),t.YNc(5,Jc,5,2,"ng-container",3),t.TgZ(6,"dt"),t._uU(7,"Type"),t.qZA(),t.TgZ(8,"dd"),t.YNc(9,Yc,2,1,"span",4),t.qZA(),t.YNc(10,Mc,5,1,"ng-container",2),t.YNc(11,Oc,6,3,"ng-container",2),t.YNc(12,$c,5,1,"ng-container",2),t.YNc(13,Rc,5,1,"ng-container",2),t.qZA(),t.TgZ(14,"div",5),t._UZ(15,"mat-divider"),t.qZA(),t.TgZ(16,"h4"),t._uU(17,"Current value"),t.qZA(),t.YNc(18,t_,16,10,"ng-container",2),t.YNc(19,e_,2,0,"span",6),t.YNc(20,u_,2,1,"ng-container",2),t.ALo(21,"async"),t.YNc(22,g_,1,0,"ng-template",null,7,t.W1O)),2&i){const s=t.MAs(23);t.Q6J("ngIf",n.offset),t.xp6(1),t.ekj("no-lead",!n.offset),t.xp6(1),t.Q6J("ngIf",n.offset),t.xp6(1),t.Q6J("ngIf",!n.offset),t.xp6(1),t.Q6J("ngIf",!n.offset),t.xp6(1),t.Q6J("ngForOf",n.parameter.alias),t.xp6(4),t.Q6J("ngIf",null==n.parameter.type?null:n.parameter.type.engType)("ngIfElse",s),t.xp6(1),t.Q6J("ngIf",void 0!==(null==n.parameter.type?null:n.parameter.type.signed)),t.xp6(1),t.Q6J("ngIf",!n.offset),t.xp6(1),t.Q6J("ngIf",n.parameter.longDescription),t.xp6(1),t.Q6J("ngIf",!n.parameter.longDescription),t.xp6(5),t.Q6J("ngIf",null==n.pval?null:n.pval.engValue),t.xp6(1),t.Q6J("ngIf",!(null!=n.pval&&n.pval.engValue)),t.xp6(1),t.Q6J("ngIf",t.lcZ(21,16,n.entry$))}},dependencies:[g.sg,g.O5,g.RF,g.n9,g.ED,b.rH,o.Gj,M.d,o.g4,Y.i,Tc.U,Zc,g.Ov,g.rS,o.id,o.hw,o.N3,o.Wt,o.yk,o.BC,o.HQ,o.VC],styles:[".meter-size-constrainer[_ngcontent-%COMP%]{display:inline-block;width:160px;position:relative}.dl-horizontal[_ngcontent-%COMP%]   dt[_ngcontent-%COMP%]{text-align:left}span.pval[_ngcontent-%COMP%]{font-size:16px;line-height:20px;margin:-8px 0 16px;bottom:-5px;color:#000000fc;font-weight:400}.subtext[_ngcontent-%COMP%]{font-size:smaller;white-space:nowrap}.pval-frame[_ngcontent-%COMP%]{display:inline-block;min-width:412px;border:1px solid #e7e7e7;border-radius:2px;box-shadow:0 1px 3px #0000001f}.pval-frame[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{border-bottom:1px solid #d3d3d3;height:64px;line-height:64px;padding-left:24px;position:relative}.pval-frame[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .action[_ngcontent-%COMP%]{position:absolute;top:0;right:0}.pval-frame[_ngcontent-%COMP%]   .body[_ngcontent-%COMP%]{padding:24px}.mat-icon.unchecked[_ngcontent-%COMP%]{visibility:hidden}"],changeDetection:0})}return a})();function h_(a,r){if(1&a&&(t.ynx(0),t._UZ(1,"app-parameter-detail",2),t.ALo(2,"async"),t.ALo(3,"async"),t.BQk()),2&a){const e=r.ngIf,i=t.oxw();t.xp6(1),t.Q6J("parameter",e)("offset",t.lcZ(2,3,i.offset$))("pval",t.lcZ(3,5,i.pval$))}}const f_=[{path:"",canActivate:[bt.r,Za._],canActivateChild:[bt.q],runGuardsAndResolvers:"always",component:Pa.K,children:[{path:"",pathMatch:"full",redirectTo:"home"},{path:"displays",pathMatch:"full",redirectTo:"displays/browse"},{path:"displays/browse",component:St,children:[{path:"**",component:wt}]},{path:"displays/files",component:At,children:[{path:"**",component:vt,canDeactivate:[a=>(0,t.f3M)(Pt).canDeactivate(a)]}]},{path:"packets",children:[{path:"",pathMatch:"full",component:qt},{path:":pname/:gentime/:seqno",component:kt}]},{path:"parameters",pathMatch:"full",component:Ot},{path:"parameters/:qualifiedName",component:Kt,children:[{path:"",pathMatch:"full",redirectTo:"summary"},{path:"summary",component:(()=>{class a{constructor(e,i,n){this.yamcs=i,this.synchronizer=n,this.parameter$=new f.X(null),this.offset$=new f.X(null),this.parameterValue$=new f.X(null),this.dirty=!1,this.pval$=new f.X(null),e.parent.paramMap.subscribe(s=>{const l=s.get("qualifiedName");this.changeParameter(l)}),this.syncSubscription=this.synchronizer.syncFast(()=>{this.dirty&&(this.pval$.next(this.parameterValue$.value),this.dirty=!1)})}changeParameter(e){this.yamcs.yamcsClient.getParameter(this.yamcs.instance,e).then(i=>{this.parameter$.next(i),this.offset$.next(e!==i.qualifiedName?e.substring(i.qualifiedName.length):null),this.parameterValueSubscription&&this.parameterValueSubscription.cancel(),this.parameterValue$.next(null),this.pval$.next(null),this.parameterValueSubscription=this.yamcs.yamcsClient.createParameterSubscription({instance:this.yamcs.instance,processor:this.yamcs.processor,id:[{name:e}],abortOnInvalid:!1,sendFromCache:!0,updateOnExpiration:!0,action:"REPLACE"},n=>{this.parameterValue$.next(n.values?n.values[0]:null),null==this.pval$.value?this.pval$.next(this.parameterValue$.value):this.dirty=!0})})}ngOnDestroy(){this.parameterValueSubscription?.cancel(),this.syncSubscription?.unsubscribe()}static#t=this.\u0275fac=function(i){return new(i||a)(t.Y36(b.gz),t.Y36(o.C8),t.Y36(o.jF))};static#e=this.\u0275cmp=t.Xpm({type:a,selectors:[["ng-component"]],decls:3,vars:3,consts:[[1,"panel-content"],[4,"ngIf"],[3,"parameter","offset","pval"]],template:function(i,n){1&i&&(t.TgZ(0,"div",0),t.YNc(1,h_,4,7,"ng-container",1),t.ALo(2,"async"),t.qZA()),2&i&&(t.xp6(1),t.Q6J("ngIf",t.lcZ(2,1,n.parameter$)))},dependencies:[g.O5,d_,g.Ov],encapsulation:2,changeDetection:0})}return a})()},{path:"chart",component:jt},{path:"data",component:zt},{path:"alarms",component:Vt}]},{path:"parameter-lists",pathMatch:"full",component:Ft},{path:"parameter-lists/create",pathMatch:"full",component:Dt},{path:"parameter-lists/:list",component:Qt,children:[{path:"",pathMatch:"full",redirectTo:"realtime"},{path:"realtime",component:Rt},{path:"data",component:It}]},{path:"parameter-lists/:list/edit",pathMatch:"full",component:Nt}]}];let x_=(()=>{class a{static#t=this.\u0275fac=function(i){return new(i||a)};static#e=this.\u0275mod=t.oAB({type:a});static#a=this.\u0275inj=t.cJS({providers:[Pt],imports:[b.Bz.forChild(f_),b.Bz]})}return a})(),y_=(()=>{class a{static#t=this.\u0275fac=function(i){return new(i||a)};static#e=this.\u0275mod=t.oAB({type:a});static#a=this.\u0275inj=t.cJS({imports:[te.m,x_]})}return a})()}}]);