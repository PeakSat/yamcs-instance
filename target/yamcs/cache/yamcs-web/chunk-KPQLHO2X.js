import{c as uo}from"./chunk-EW7XVIEW.js";import{a as it}from"./chunk-6N63TQXK.js";import{a as so}from"./chunk-2OT6OSOP.js";import{a as po}from"./chunk-P3QPVXNS.js";import{a as Ji}from"./chunk-EFG5VZTT.js";import{a as Ki}from"./chunk-6BUZTTN5.js";import"./chunk-ISJZ4IJQ.js";import{b as be,d as Te,e as Cn,f as co}from"./chunk-FTOGDGWN.js";import{$a as Vn,Aa as m,Ab as Ue,Ac as Fi,B as pt,Ba as F,Bb as W,Bc as Gn,Bd as Xe,Be as Wi,C as Ht,Ca as S,Cb as jt,Cc as Yn,Cd as Ri,D as yi,Da as fn,Db as $,Dc as Wn,Dd as Bi,E as vi,Eb as ie,Ec as zn,Ed as Hi,F as w,Fa as de,Fb as Qt,Fc as gt,Fd as Xn,Ga as k,Gb as ft,Gc as at,Gd as Zn,H as qt,Ha as Tt,Hb as Ut,Hc as rt,Hd as Ze,Ia as ce,Ib as j,Ic as Oi,J as An,Ja as vt,Jb as re,Jc as Pi,Jd as It,K as b,Kb as Ei,Kd as je,Ke as zi,L as T,La as h,Lb as Gt,Le as Zt,Ma as g,Mb as _e,Mc as Be,Md as zt,Na as Ve,Nb as ne,Ne as lo,Oa as On,Ob as nt,Od as ee,Oe as Pt,P as fi,Pb as St,Pd as eo,Pe as mo,Qb as Z,Qc as Dt,Qd as Jt,Rb as Bn,Rc as Vi,Rd as to,Re as U,Sa as wt,Sb as Hn,Sc as ge,Sd as yt,Tb as qn,Tc as Ie,Td as io,U as Rt,Ub as Di,Uc as Ae,Ue as ei,V as _i,Vb as jn,Ve as D,Wa as Pn,Wb as _n,Wc as Fe,We as tt,X as s,Xa as Si,Xb as Mi,Xc as xe,Xe as hn,Y as y,Yb as Ge,Yd as et,Ye as gn,Zc as ye,_a as Q,_b as oe,_c as He,_d as At,a as ae,aa as u,ad as qe,b as pn,ba as Fn,bc as Ye,bd as ve,be as Ft,c as un,ca as p,da as st,db as bi,dc as _t,dd as Se,e as P,ea as R,eb as Nn,ec as Ct,ed as Ke,ee as no,fb as Ti,fc as ht,fe as qi,g as kn,ga as _,ha as G,hc as Qn,i as En,ia as H,ib as we,ic as Ii,id as Ni,ie as Ot,ja as q,jb as $n,jd as $i,je as ji,ka as r,kb as Ln,kd as Li,ke as oo,la as l,lb as Rn,le as Qi,ma as f,mb as Ne,mc as Ee,md as Jn,me as Ui,na as M,nb as kt,nc as Ai,ne as Gi,o as Dn,oa as I,ob as ke,oc as Et,od as ct,oe as Kt,p as Mn,pb as $e,pc as We,pd as Mt,qa as A,qb as wi,qc as Ce,qd as xt,qe as ao,ra as v,rc as ze,rd as Kn,s as In,sa as d,sc as Je,sd as Yt,tc as he,td as Wt,te as Pe,uc as Re,vb as ki,vc as De,vd as lt,ve as Yi,wa as z,wb as ut,wc as Me,xa as J,xb as Le,y as se,ya as K,yd as O,ye as ro,z as Bt,za as B,zb as pe,zc as Un,zd as Oe,ze as Xt}from"./chunk-YLFXKKOP.js";var fo=(e,i)=>Ht(Xo).canActivate(e,i);var Xo=(()=>{let i=class i{constructor(t,o){this.authService=t,this.router=o}canActivate(t,o){return this.authService.getUser().hasSystemPrivilege("ControlCommandQueue")?!0:(this.router.navigate(["/403"],{queryParams:{page:o.url}}),!1)}canActivateChild(t,o){return this.canActivate(t,o)}};i.\u0275fac=function(o){return new(o||i)(pt(tt),pt(ke))},i.\u0275prov=Bt({token:i,factory:i.\u0275fac,providedIn:"root"});let e=i;return e})();var ea=()=>({matrixParams:"exact",paths:"exact",queryParams:"ignored"}),_o=e=>({c:e}),Xi=(()=>{let i=class i{constructor(t){this.yamcs=t}};i.\u0275fac=function(o){return new(o||i)(y(U))},i.\u0275cmp=w({type:i,selectors:[["app-clearances-page-tabs"]],standalone:!0,features:[k],decls:10,vars:12,consts:[["rla","routerLinkActive"],["rlb","routerLinkActive"],["tabPanel",""],["mat-tab-nav-bar","",1,"secondary",3,"mat-stretch-tabs","tabPanel"],["mat-tab-link","","routerLink","/commanding/clearances","routerLinkActive","",3,"routerLinkActiveOptions","active","queryParams"],["mat-tab-link","","routerLink","/commanding/clearances/log","routerLinkActive","",3,"active","queryParams"]],template:function(o,a){if(o&1&&(r(0,"nav",3)(1,"a",4,0),m(3," Clearances "),l(),r(4,"a",5,1),m(6," Action log "),l()(),r(7,"mat-tab-nav-panel",null,2),f(9,"router-outlet"),l()),o&2){let c=B(2),C=B(5),x=B(8);p("mat-stretch-tabs",!1)("tabPanel",x),s(),p("routerLinkActiveOptions",Tt(7,ea))("active",c.isActive)("queryParams",ce(8,_o,a.yamcs.context)),s(3),p("active",C.isActive)("queryParams",ce(10,_o,a.yamcs.context))}},dependencies:[D,kt,$e,wi,Ni,Li,$i],styles:[".mat-mdc-tab-link[_ngcontent-%COMP%]{height:36px;min-width:0;font-size:13px}"],changeDetection:0});let e=i;return e})();var ta=["intervalSelect"];function ia(e,i){if(e&1){let n=A();f(0,"ya-date-time-input",16)(1,"ya-date-time-input",17),r(2,"button",18),v("click",function(){b(n);let o=d();return T(o.applyCustomDates())}),m(3," Apply "),l()}if(e&2){let n=d();s(2),p("disabled",n.filterForm.invalid)}}function na(e,i){if(e&1){let n=A();r(0,"button",19),v("click",function(){b(n);let o=d();return T(o.jumpToNow())}),m(1,"Jump to now"),l()}}function oa(e,i){e&1&&(r(0,"th",20),m(1,"Time"),l())}function aa(e,i){if(e&1&&(r(0,"td",21),m(1),h(2,"datetime"),l()),e&2){let n=i.$implicit;s(),F(g(2,1,n.time))}}function ra(e,i){e&1&&(r(0,"th",20),m(1,"User"),l())}function la(e,i){if(e&1&&(r(0,"td",21),m(1),l()),e&2){let n=i.$implicit;s(),F(n.user||"-")}}function ma(e,i){e&1&&(r(0,"th",20),m(1,"Action"),l())}function sa(e,i){if(e&1&&(r(0,"td",21),f(1,"span",22),h(2,"actionLogFormat"),l()),e&2){let n=i.$implicit;s(),p("innerHTML",g(2,1,n.summary)||"-",Rt)}}function ca(e,i){e&1&&f(0,"th",23)}function da(e,i){e&1&&f(0,"td",21)}function pa(e,i){e&1&&f(0,"tr",24)}function ua(e,i){e&1&&f(0,"tr",25)}var Co=(()=>{let i=class i{constructor(t,o,a,c,C){this.yamcs=t,this.messageService=o,this.router=a,this.route=c,this.filterForm=new ft({filter:new j,interval:new j("NO_LIMIT"),customStart:new j(null),customStop:new j(null)}),this.displayedColumns=["time","user","summary","actions"],this.intervalOptions=[{id:"PT1H",label:"Last hour"},{id:"PT6H",label:"Last 6 hours"},{id:"P1D",label:"Last 24 hours"},{id:"NO_LIMIT",label:"No limit"},{id:"CUSTOM",label:"Custom",group:!0}],this.dataSource=new Ke,C.setTitle("Clearances"),this.initializeOptions(),this.loadData(),this.filterForm.get("interval").valueChanges.forEach(x=>{if(x==="CUSTOM"){let E=new Date,V=this.validStart||E,N=this.validStop||E;this.filterForm.get("customStart").setValue(O.toISOString(V)),this.filterForm.get("customStop").setValue(O.toISOString(N))}else x==="NO_LIMIT"?(this.validStart=null,this.validStop=null,this.appliedInterval=x,this.loadData()):(this.validStop=new Date,this.validStart=O.subtractDuration(this.validStop,x),this.appliedInterval=x,this.loadData())})}initializeOptions(){let t=this.route.snapshot.queryParamMap;if(t.has("filter")&&(this.filter=t.get("filter")||"",this.filterForm.get("filter").setValue(this.filter)),t.has("interval"))if(this.appliedInterval=t.get("interval"),this.filterForm.get("interval").setValue(this.appliedInterval),this.appliedInterval==="CUSTOM"){let o=t.get("customStart");this.filterForm.get("customStart").setValue(o),this.validStart=O.toDate(o);let a=t.get("customStop");this.filterForm.get("customStop").setValue(a),this.validStop=O.toDate(a)}else this.appliedInterval==="NO_LIMIT"?(this.validStart=null,this.validStop=null):(this.validStop=new Date,this.validStart=O.subtractDuration(this.validStop,this.appliedInterval));else this.appliedInterval="NO_LIMIT",this.validStop=null,this.validStart=null}jumpToNow(){this.filterForm.get("interval").setValue("NO_LIMIT")}applyCustomDates(){this.validStart=O.toDate(this.filterForm.value.customStart),this.validStop=O.toDate(this.filterForm.value.customStop),this.appliedInterval="CUSTOM",this.loadData()}loadData(){this.updateURL();let t={service:"ClearanceApi"};this.validStart&&(t.start=this.validStart.toISOString()),this.validStop&&(t.stop=this.validStop.toISOString()),this.filter&&(t.q=this.filter),this.yamcs.yamcsClient.getAuditRecords("_global",t).then(o=>this.dataSource.data=o.records||[]).catch(o=>this.messageService.showError(o))}updateURL(){this.router.navigate([],{replaceUrl:!0,relativeTo:this.route,queryParams:{filter:this.filter||null,interval:this.appliedInterval,customStart:this.appliedInterval==="CUSTOM"?this.filterForm.value.customStart:null,customStop:this.appliedInterval==="CUSTOM"?this.filterForm.value.customStop:null},queryParamsHandling:"merge"})}};i.\u0275fac=function(o){return new(o||i)(y(U),y(et),y(ke),y(Ne),y(we))},i.\u0275cmp=w({type:i,selectors:[["app-clearances-action-log-tab"]],viewQuery:function(o,a){if(o&1&&z(ta,5),o&2){let c;J(c=K())&&(a.intervalSelect=c.first)}},standalone:!0,features:[k],decls:26,vars:7,consts:[["intervalSelect",""],[1,"panel-content"],[2,"margin-top","16px",3,"formGroup"],[1,"filter-bar"],["icon","access_time","formControlName","interval",3,"options"],[1,"ya-button"],["mat-table","",1,"ya-data-table","expand",3,"dataSource"],["matColumnDef","time"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","user"],["matColumnDef","summary"],["matColumnDef","actions"],["mat-header-cell","","class","expand",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["formControlName","customStart"],["formControlName","customStop"],[1,"ya-button",3,"click","disabled"],[1,"ya-button",3,"click"],["mat-header-cell",""],["mat-cell",""],[3,"innerHTML"],["mat-header-cell","",1,"expand"],["mat-header-row",""],["mat-row",""]],template:function(o,a){o&1&&(r(0,"app-instance-page")(1,"app-instance-toolbar"),m(2," Clearances "),l(),r(3,"div",1),f(4,"app-clearances-page-tabs"),r(5,"form",2)(6,"div",3),f(7,"ya-select",4,0),u(9,ia,4,1)(10,na,2,0,"button",5),l()(),r(11,"table",6),M(12,7),u(13,oa,2,0,"th",8)(14,aa,3,3,"td",9),I(),M(15,10),u(16,ra,2,0,"th",8)(17,la,2,1,"td",9),I(),M(18,11),u(19,ma,2,0,"th",8)(20,sa,3,3,"td",9),I(),M(21,12),u(22,ca,1,0,"th",13)(23,da,1,0,"td",9),I(),u(24,pa,1,0,"tr",14)(25,ua,1,0,"tr",15),l()()()),o&2&&(s(5),p("formGroup",a.filterForm),s(2),p("options",a.intervalOptions),s(2),_(a.filterForm.value.interval==="CUSTOM"?9:-1),s(),_(a.filterForm.value.interval!=="CUSTOM"?10:-1),s(),p("dataSource",a.dataSource),s(13),p("matHeaderRowDef",a.displayedColumns),s(),p("matRowDefColumns",a.displayedColumns))},dependencies:[Xi,Te,be,D,re,$,ie,ne,Z,ge,Ae,He,Fe,Ie,qe,xe,ye,ve,Se,Xe,Ze,Gi,Pe],encapsulation:2,changeDetection:0});let e=i;return e})();var ho=(e,i)=>Ht(fa).canActivate(e,i);var fa=(()=>{let i=class i{constructor(t,o){this.router=o,this.config=t.getConfig()}canActivate(t,o){return this.config.commandClearanceEnabled}canActivateChild(t,o){return this.canActivate(t,o)}};i.\u0275fac=function(o){return new(o||i)(pt(Oe),pt(ke))},i.\u0275prov=Bt({token:i,factory:i.\u0275fac,providedIn:"root"});let e=i;return e})();var go=(()=>{let i=class i{constructor(t,o,a){if(this.dialogRef=t,this.data=a,this.form=o.group({level:new j(null,[W.required])}),a.clearance){let c=a.clearance;this.form.setValue({level:c.level||"DISABLED"})}}confirm(){this.dialogRef.close({level:this.form.value.level==="DISABLED"?void 0:this.form.value.level})}};i.\u0275fac=function(o){return new(o||i)(y(Ce),y(Ge),y(ze))},i.\u0275cmp=w({type:i,selectors:[["app-change-level-dialog"]],standalone:!0,features:[k],decls:31,vars:8,consts:[["mat-dialog-title",""],[1,"ya-form",3,"formGroup"],["type","radio","formControlName","level","value","DISABLED"],[2,"font-weight","normal"],["type","radio","formControlName","level","value","NONE"],["level","NONE",3,"grayscale"],["type","radio","formControlName","level","value","WATCH"],["level","WATCH",3,"grayscale"],["type","radio","formControlName","level","value","WARNING"],["level","WARNING",3,"grayscale"],["type","radio","formControlName","level","value","DISTRESS"],["level","DISTRESS",3,"grayscale"],["type","radio","formControlName","level","value","CRITICAL"],["level","CRITICAL",3,"grayscale"],["type","radio","formControlName","level","value","SEVERE"],["level","SEVERE",3,"grayscale"],["align","end"],["mat-dialog-close","",1,"ya-button"],[1,"ya-button","primary",3,"click","disabled"]],template:function(o,a){o&1&&(r(0,"h2",0),m(1,"Command clearance"),l(),r(2,"mat-dialog-content")(3,"form",1)(4,"label"),f(5,"input",2),r(6,"span",3),m(7,"No clearance"),l()(),r(8,"label"),f(9,"input",4)(10,"app-significance-level",5),l(),r(11,"label"),f(12,"input",6)(13,"app-significance-level",7),l(),r(14,"label"),f(15,"input",8)(16,"app-significance-level",9),l(),r(17,"label"),f(18,"input",10)(19,"app-significance-level",11),l(),r(20,"label"),f(21,"input",12)(22,"app-significance-level",13),l(),r(23,"label"),f(24,"input",14)(25,"app-significance-level",15),l()()(),r(26,"mat-dialog-actions",16)(27,"button",17),m(28,"CANCEL"),l(),r(29,"button",18),v("click",function(){return a.confirm()}),m(30," SAVE CHANGES "),l()()),o&2&&(s(3),p("formGroup",a.form),s(7),p("grayscale",!0),s(3),p("grayscale",!0),s(3),p("grayscale",!0),s(3),p("grayscale",!0),s(3),p("grayscale",!0),s(3),p("grayscale",!0),s(4),p("disabled",!a.form.valid))},dependencies:[D,re,pe,Gt,$,ie,ne,Z,he,Re,Me,De,it],styles:["[_ngcontent-%COMP%]:focus{outline:none}"]});let e=i;return e})();function Ca(e,i){if(e&1){let n=A();r(0,"th",18)(1,"input",19),v("change",function(o){b(n);let a=d(2);return T(o?a.masterToggle():null)}),l()()}if(e&2){let n=d(2);s(),p("checked",n.selection.hasValue()&&n.isAllSelected())}}function ha(e,i){if(e&1){let n=A();r(0,"td",20)(1,"input",21),v("click",function(o){return b(n),T(o.stopPropagation())})("change",function(o){let a=b(n).$implicit,c=d(2);return T(o?c.selection.toggle(a):null)}),l()()}if(e&2){let n=i.$implicit,t=d(2);s(),p("checked",t.selection.isSelected(n))}}function ga(e,i){e&1&&(r(0,"th",22),m(1,"Username"),l())}function xa(e,i){if(e&1&&(r(0,"td",23),m(1),l()),e&2){let n=i.$implicit;s(),S(" ",n.username," ")}}function ya(e,i){e&1&&(r(0,"th",22),m(1,"May Command"),l())}function va(e,i){if(e&1&&(r(0,"td",23),m(1),l()),e&2){let n=i.$implicit;s(),S(" ",n.hasCommandPrivileges?"Yes":"-"," ")}}function Sa(e,i){e&1&&(r(0,"th",22),m(1,"Clearance Level"),l())}function ba(e,i){e&1&&m(0," No clearance ")}function Ta(e,i){if(e&1&&f(0,"app-significance-level",24),e&2){let n=d().$implicit;p("level",n.level)("grayscale",!0)}}function wa(e,i){if(e&1&&(r(0,"td",23),u(1,ba,1,0)(2,Ta,1,2,"app-significance-level",24),l()),e&2){let n=i.$implicit;s(),_(n.level?2:1)}}function ka(e,i){e&1&&(r(0,"th",22),m(1,"Issued"),l())}function Ea(e,i){if(e&1&&m(0),e&2){let n=d().$implicit;S(" by ",n.issuedBy," ")}}function Da(e,i){if(e&1&&(r(0,"td",23),m(1),h(2,"datetime"),u(3,Ea,1,1),l()),e&2){let n=i.$implicit;s(),S(" ",g(2,2,n.issueTime)||"-"," "),s(2),_(n.issuedBy?3:-1)}}function Ma(e,i){e&1&&f(0,"th",25)}function Ia(e,i){e&1&&f(0,"td",26)}function Aa(e,i){e&1&&f(0,"tr",27)}function Fa(e,i){if(e&1){let n=A();r(0,"tr",28),v("click",function(){let o=b(n).$implicit,a=d(2);return T(a.toggleOne(o))}),l()}if(e&2){let n=i.$implicit,t=d(2);R("selected",t.selection.isSelected(n))}}function Oa(e,i){if(e&1&&(r(0,"table",2),M(1,4),u(2,Ca,2,1,"th",5)(3,ha,2,1,"td",6),I(),M(4,7),u(5,ga,2,0,"th",8)(6,xa,2,1,"td",9),I(),M(7,10),u(8,ya,2,0,"th",8)(9,va,2,1,"td",9),I(),M(10,11),u(11,Sa,2,0,"th",8)(12,wa,3,1,"td",9),I(),M(13,12),u(14,ka,2,0,"th",8)(15,Da,4,4,"td",9),I(),M(16,13),u(17,Ma,1,0,"th",14)(18,Ia,1,0,"td",15),I(),u(19,Aa,1,0,"tr",16)(20,Fa,1,2,"tr",17),l()),e&2){let n=d();p("dataSource",n.dataSource),s(19),p("matHeaderRowDef",n.displayedColumns),s(),p("matRowDefColumns",n.displayedColumns)}}var xo=(()=>{let i=class i{constructor(t,o,a){this.yamcs=t,this.dialog=a,this.displayedColumns=["select","username","hasCommandPrivileges","level","issued","actions"],this.dataSource=new Ke,this.selection=new ut(!0,[]),o.setTitle("Clearances"),this.refresh()}ngAfterViewInit(){this.dataSource.sort=this.sort,this.dataSource.paginator=this.paginator}isAllSelected(){let t=this.selection.selected.length,o=this.dataSource.filteredData.length;return t===o&&o>0}masterToggle(){this.isAllSelected()?this.selection.clear():this.dataSource.filteredData.forEach(t=>this.selection.select(t))}toggleOne(t){(!this.selection.isSelected(t)||this.selection.selected.length>1)&&this.selection.clear(),this.selection.toggle(t)}refresh(){this.selection.clear(),this.yamcs.yamcsClient.getClearances().then(t=>{this.dataSource.data=t.clearances||[]})}isGroupChangeLevelEnabled(){return!this.selection.isEmpty()}openChangeLevelDialog(){let t;this.selection.selected.length===1&&(t=this.selection.selected[0]),this.dialog.open(go,{data:{clearance:t},width:"400px"}).afterClosed().subscribe(a=>{if(a){let c=[];if(a.level)for(let C of this.selection.selected)c.push(this.yamcs.yamcsClient.changeClearance(C.username,{level:a.level}));else for(let C of this.selection.selected)c.push(this.yamcs.yamcsClient.deleteClearance(C.username));c.length&&Promise.all(c).then(()=>this.refresh())}})}};i.\u0275fac=function(o){return new(o||i)(y(U),y(we),y(Je))},i.\u0275cmp=w({type:i,selectors:[["ng-component"]],viewQuery:function(o,a){if(o&1&&(z(Dt,5),z(Be,5)),o&2){let c;J(c=K())&&(a.sort=c.first),J(c=K())&&(a.paginator=c.first)}},standalone:!0,features:[k],decls:17,vars:5,consts:[["mat-button","","color","primary",3,"click","disabled"],[1,"panel-content"],["mat-table","","matSort","","matSortActive","username","matSortDirection","asc","matSortDisableClear","",1,"ya-data-table","expand",2,"margin-top","16px",3,"dataSource"],[3,"pageSize","hidePageSize","showFirstLastButtons"],["cdkColumnDef","select"],["mat-header-cell","","class","checkbox",4,"cdkHeaderCellDef"],["mat-cell","","class","checkbox",4,"cdkCellDef"],["matColumnDef","username"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","hasCommandPrivileges"],["matColumnDef","level"],["matColumnDef","issued"],["matColumnDef","actions"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","","class","expand",4,"matCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",3,"selected","click",4,"matRowDef","matRowDefColumns"],["mat-header-cell","",1,"checkbox"],["type","checkbox",3,"change","checked"],["mat-cell","",1,"checkbox"],["type","checkbox",3,"click","change","checked"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],[3,"level","grayscale"],["mat-header-cell",""],["mat-cell","",1,"expand"],["mat-header-row",""],["mat-row","",3,"click"]],template:function(o,a){o&1&&(r(0,"app-instance-page")(1,"app-instance-toolbar"),m(2," Clearances "),r(3,"ya-help")(4,"p"),m(5," Clearances allow central control over the level of commands that users are able to send. "),l(),r(6,"p"),m(7," Clearance works in addition to regular permission checks. So if a user does anyway not have authorization to send certain commands, giving this user clearance will not change this fact. "),l()(),m(8," \xA0\xA0\xA0 "),r(9,"button",0),v("click",function(){return a.openChangeLevelDialog()}),r(10,"mat-icon"),m(11,"how_to_reg"),l(),m(12," Change level "),l()(),r(13,"div",1),f(14,"app-clearances-page-tabs"),u(15,Oa,21,3,"table",2),f(16,"mat-paginator",3),l()()),o&2&&(s(9),p("disabled",!a.isGroupChangeLevelEnabled()),s(6),_(a.dataSource?15:-1),s(),p("pageSize",100)("hidePageSize",!0)("showFirstLastButtons",!0))},dependencies:[Xi,Te,be,D,gt,at,rt,ht,oe,Be,Dt,Vi,ge,Ae,He,Fe,Ie,qe,xe,ye,ve,Se,ee,Pe,it],encapsulation:2,changeDetection:0});let e=i;return e})();function Pa(e,i){if(e&1&&(r(0,"mat-icon",1),m(1,"schedule"),l()),e&2){let n=d(2);p("matTooltip",n.ack.name+": Scheduled")}}function Va(e,i){if(e&1&&(r(0,"mat-icon",2),m(1,"check_circle_outline"),l()),e&2){let n=d(2);p("matTooltip",n.ack.name+": OK")}}function Na(e,i){if(e&1&&(r(0,"mat-icon",1),m(1,"lens"),l()),e&2){let n=d(2);p("matTooltip",n.ack.name+": PENDING")}}function $a(e,i){if(e&1&&(r(0,"mat-icon",3),m(1,"block"),l()),e&2){let n=d(2);p("matTooltip",n.ack.name+": CANCELLED")}}function La(e,i){if(e&1&&(r(0,"mat-icon",3),m(1,"block"),l()),e&2){let n=d(2);p("matTooltip",n.ack.name+": DISABLED")}}function Ra(e,i){if(e&1&&(r(0,"mat-icon",4),m(1,"highlight_off"),l()),e&2){let n=d(2);p("matTooltip",n.ack.name+": TIMEOUT")}}function Ba(e,i){if(e&1&&(r(0,"mat-icon",4),m(1,"highlight_off"),l()),e&2){let n=d(2);p("matTooltip",n.ack.name+": "+n.ack.status+" ("+n.ack.message+")")}}function Ha(e,i){if(e&1&&u(0,Pa,2,1,"mat-icon",1)(1,Va,2,1,"mat-icon",2)(2,Na,2,1,"mat-icon",1)(3,$a,2,1,"mat-icon",3)(4,La,2,1,"mat-icon",3)(5,Ra,2,1,"mat-icon",4)(6,Ba,2,1,"mat-icon",4),e&2){let n,t=d();_((n=t.ack.status)==="SCHEDULED"?0:n==="OK"?1:n==="PENDING"?2:n==="CANCELLED"?3:n==="DISABLED"?4:n==="TIMEOUT"?5:6)}}function qa(e,i){e&1&&(r(0,"mat-icon",0),m(1,"lens"),l()),e&2&&p("matTooltip","Unknown")}var ii=(()=>{let i=class i{};i.\u0275fac=function(o){return new(o||i)},i.\u0275cmp=w({type:i,selectors:[["app-acknowledgment-icon"]],inputs:{ack:"ack"},standalone:!0,features:[k],decls:2,vars:2,consts:[[1,"down","icon16",3,"matTooltip"],[1,"icon16","down",3,"matTooltip"],[1,"icon16",2,"color","#00c752",3,"matTooltip"],[1,"icon16",2,"color","lightgrey",3,"matTooltip"],[1,"icon16",2,"color","red",3,"matTooltip"]],template:function(o,a){o&1&&u(0,Ha,7,1)(1,qa,2,1,"mat-icon",0),o&2&&(_(a.ack?0:-1),s(),_(a.ack?-1:1))},dependencies:[D,oe,Ee],styles:["[_nghost-%COMP%]{line-height:0;font-size:0}"],changeDetection:0});let e=i;return e})();var ja=(e,i)=>i.name;function Qa(e,i){if(e&1&&(r(0,"tr")(1,"td",1),m(2),l(),r(3,"td",2),f(4,"ya-value",3),l()()),e&2){let n=i.$implicit;s(2),F(n.name),s(2),p("value",n.value)}}var Zi=(()=>{let i=class i{constructor(){this.nomargin=!1}};i.\u0275fac=function(o){return new(o||i)},i.\u0275cmp=w({type:i,selectors:[["app-command-arguments"]],hostVars:2,hostBindings:function(o,a){o&2&&R("nomargin",a.nomargin)},inputs:{command:"command",nomargin:"nomargin"},standalone:!0,features:[k],decls:3,vars:0,consts:[[1,"args"],["width","1",1,"key"],[1,"value"],[3,"value"]],template:function(o,a){o&1&&(r(0,"table",0),H(1,Qa,5,2,"tr",null,ja),l()),o&2&&(s(),q(a.command.userAssignments))},dependencies:[D,ji],styles:[".args[_ngcontent-%COMP%]{margin:0 0 0 10px}.args[_ngcontent-%COMP%]   .key[_ngcontent-%COMP%]{min-width:80px;white-space:nowrap;vertical-align:top}.args[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{color:gray;padding-left:10px}.nomargin[_nghost-%COMP%]   .args[_ngcontent-%COMP%], .nomargin[_nghost-%COMP%]   .args[_ngcontent-%COMP%]   td.key[_ngcontent-%COMP%]:first-child{margin-left:0!important;padding-left:0!important}.nomargin[_nghost-%COMP%]   .args[_ngcontent-%COMP%]{border-spacing:0}"],changeDetection:0});let e=i;return e})();var Ua=(e,i)=>i.name;function Ga(e,i){if(e&1&&(r(0,"td",0)(1,"div",4),f(2,"app-acknowledgment-icon",5),l()()),e&2){let n=d().$implicit;s(2),p("ack",n)}}function Ya(e,i){e&1&&(r(0,"span"),m(1,"-"),l())}function Wa(e,i){e&1&&(r(0,"span"),m(1,"-"),l())}function za(e,i){if(e&1&&(r(0,"span",3),h(1,"datetime"),m(2),h(3,"deltaWith"),l()),e&2){let n=d().$implicit,t=d();p("matTooltip",g(1,2,n.time)),s(2),S(" ",Ve(3,4,n.time,t.command.generationTime)," ")}}function Ja(e,i){if(e&1&&(r(0,"tr"),u(1,Ga,3,1,"td",0),r(2,"td",1),m(3),l(),r(4,"td",2),m(5),l(),r(6,"td"),u(7,Ya,2,0,"span")(8,Wa,2,0,"span")(9,za,4,7,"span",3),l()()),e&2){let n,t=i.$implicit,o=d();s(),_(o.showIcons?1:-1),s(2),F(t.name),s(2),F(t.status),s(2),_((n=t.status)==="SCHEDULED"?7:n==="PENDING"?8:9)}}var en=(()=>{let i=class i{constructor(){this.inline=!1,this.showIcons=!0}};i.\u0275fac=function(o){return new(o||i)},i.\u0275cmp=w({type:i,selectors:[["app-extra-acknowledgments-table"]],inputs:{command:"command",inline:"inline",showIcons:"showIcons"},standalone:!0,features:[k],decls:3,vars:0,consts:[[2,"width","16px"],[2,"width","150px"],[2,"width","70px"],[3,"matTooltip"],[2,"display","flex","align-items","center"],[3,"ack"]],template:function(o,a){o&1&&(r(0,"table"),H(1,Ja,10,4,"tr",null,Ua),l()),o&2&&(s(),q(a.command.extraAcks))},dependencies:[ii,D,Ee,Pe,Yi],styles:["table[_ngcontent-%COMP%]{width:auto}table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{border:none;padding:0}table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:not(:first-child){padding-left:10px}table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{font-size:12px;line-height:16px}table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{color:#000000a7}"],changeDetection:0});let e=i;return e})();var Ka=/yamcs<([^>]+)>_/g,yo=(()=>{let i=class i{transform(t){if(!t||!t.startsWith("yamcs<"))return t;let o,a=[];for(;o=Ka.exec(t);)a.push(o[1]);return a.length?a[a.length-1]:t}};i.\u0275fac=function(o){return new(o||i)},i.\u0275pipe=qt({name:"cascadingPrefix",type:i,pure:!0,standalone:!0});let e=i;return e})();function Xa(e,i){e&1&&(r(0,"mat-icon",0),m(1,"cached "),l())}function Za(e,i){e&1&&(r(0,"mat-icon",1),m(1,"lens"),l())}var tn=(()=>{let i=class i{};i.\u0275fac=function(o){return new(o||i)},i.\u0275cmp=w({type:i,selectors:[["app-transmission-constraints-icon"]],inputs:{command:"command"},standalone:!0,features:[k],decls:2,vars:1,consts:[["matTooltip","Checking transmission constraints",1,"down","icon16","spin"],[1,"down","icon16"]],template:function(o,a){if(o&1&&u(0,Xa,2,0,"mat-icon",0)(1,Za,2,0,"mat-icon",1),o&2){let c;_((c=a.command.transmissionConstraints==null?null:a.command.transmissionConstraints.status)==="PENDING"?0:1)}},dependencies:[D,oe,Ee],styles:["[_nghost-%COMP%]{line-height:0;font-size:0}.spin[_ngcontent-%COMP%]{animation:yspin 2s infinite linear}"],changeDetection:0});let e=i;return e})();function er(e,i){if(e&1&&(r(0,"td",0)(1,"div",4),f(2,"app-acknowledgment-icon",5),l()()),e&2){let n=d(2);s(2),p("ack",n.command.queued)}}function tr(e,i){if(e&1&&f(0,"app-transmission-constraints-icon",6),e&2){let n=d(3);p("command",n.command)}}function ir(e,i){if(e&1&&f(0,"app-acknowledgment-icon",5),e&2){let n=d(3);p("ack",n.command.released)}}function nr(e,i){if(e&1&&(r(0,"td")(1,"div",4),u(2,tr,1,1,"app-transmission-constraints-icon",6)(3,ir,1,1,"app-acknowledgment-icon",5),l()()),e&2){let n=d(2);s(2),_(n.command.released?-1:2),s(),_(n.command.released?3:-1)}}function or(e,i){if(e&1&&(r(0,"td")(1,"div",4),f(2,"app-acknowledgment-icon",5),l()()),e&2){let n=d(2);s(2),p("ack",n.command.sent)}}function ar(e,i){if(e&1&&(r(0,"table")(1,"tr"),u(2,er,3,1,"td",0),r(3,"td",1),m(4,"Queued"),l(),r(5,"td",2),m(6),l(),r(7,"td")(8,"span",3),h(9,"datetime"),m(10),h(11,"deltaWith"),l()()(),r(12,"tr"),u(13,nr,4,2,"td"),r(14,"td"),m(15,"Released"),l(),r(16,"td"),m(17),l(),r(18,"td")(19,"span",3),h(20,"datetime"),m(21),h(22,"deltaWith"),l()()(),r(23,"tr"),u(24,or,3,1,"td"),r(25,"td"),m(26,"Sent"),l(),r(27,"td"),m(28),l(),r(29,"td")(30,"span",3),h(31,"datetime"),m(32),h(33,"deltaWith"),l()()()()),e&2){let n=d();s(2),_(n.showIcons?2:-1),s(4),F((n.command.queued==null?null:n.command.queued.status)||"-"),s(2),p("matTooltip",g(9,12,n.command.queued==null?null:n.command.queued.time)),s(2),S(" ",Ve(11,14,n.command.queued==null?null:n.command.queued.time,n.command.generationTime)||"-"," "),s(3),_(n.showIcons?13:-1),s(4),S(" ",(n.command.released==null?null:n.command.released.status)||(n.command.transmissionConstraints==null?null:n.command.transmissionConstraints.status)||"-"," "),s(2),p("matTooltip",g(20,17,n.command.released==null?null:n.command.released.time)),s(2),S(" ",Ve(22,19,n.command.released==null?null:n.command.released.time,n.command.generationTime)||"-"," "),s(3),_(n.showIcons?24:-1),s(4),F((n.command.sent==null?null:n.command.sent.status)||"-"),s(2),p("matTooltip",g(31,22,n.command.sent==null?null:n.command.sent.time)),s(2),S(" ",Ve(33,24,n.command.sent==null?null:n.command.sent.time,n.command.generationTime)||"-"," ")}}var nn=(()=>{let i=class i{constructor(){this.inline=!1,this.showIcons=!0}};i.\u0275fac=function(o){return new(o||i)},i.\u0275cmp=w({type:i,selectors:[["app-yamcs-acknowledgments-table"]],inputs:{command:"command",inline:"inline",showIcons:"showIcons"},standalone:!0,features:[k],decls:1,vars:1,consts:[[2,"width","16px"],[2,"width","150px"],[2,"width","70px"],[3,"matTooltip"],[2,"display","flex","align-items","center"],[3,"ack"],[3,"command"]],template:function(o,a){o&1&&u(0,ar,34,27,"table"),o&2&&_(a.command?0:-1)},dependencies:[ii,D,Ee,Pe,Yi,tn],styles:["table[_ngcontent-%COMP%]{width:auto}table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{border:none;padding:0}table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:not(:first-child){padding-left:10px}table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{font-size:12px;line-height:16px}table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{color:#000000a7}"],changeDetection:0});let e=i;return e})();var lr=(e,i)=>i.key,mr=(e,i)=>i.name;function sr(e,i){if(e&1){let n=A();r(0,"div",2),m(1," Unprocessed binary "),r(2,"ya-more",7)(3,"button",8),v("click",function(){b(n);let o=d();return T(o.copyHex(o.command.unprocessedBinary))}),m(4,"Copy Hex"),l(),r(5,"button",8),v("click",function(){b(n);let o=d();return T(o.copyBinary(o.command.unprocessedBinary))}),m(6,"Copy Binary"),l()()(),r(7,"div",9),f(8,"app-hex",10),l(),r(9,"div",11)(10,"pre"),m(11),h(12,"hexDump"),l()()}if(e&2){let n=d();s(8),p("base64String",n.command.unprocessedBinary),s(3),F(g(12,2,n.command.unprocessedBinary)||"-")}}function cr(e,i){if(e&1){let n=A();r(0,"div",2),m(1," Binary "),r(2,"ya-more",7)(3,"button",8),v("click",function(){b(n);let o=d();return T(o.copyHex(o.command.binary))}),m(4,"Copy Hex"),l(),r(5,"button",8),v("click",function(){b(n);let o=d();return T(o.copyBinary(o.command.binary))}),m(6,"Copy Binary"),l()()(),r(7,"div",9),f(8,"app-hex",10),l(),r(9,"div",11)(10,"pre"),m(11),h(12,"hexDump"),l()()}if(e&2){let n=d();s(8),p("base64String",n.command.binary),s(3),F(g(12,2,n.command.binary)||"-")}}function dr(e,i){if(e&1&&m(0),e&2){let n=d();S(" @",n.command.origin," ")}}function pr(e,i){if(e&1&&(r(0,"div",2),m(1,"Queue"),l(),r(2,"div",1),m(3),l()),e&2){let n=d();s(3),S(" ",n.command.queue||"-"," ")}}function ur(e,i){if(e&1&&(f(0,"mat-divider",5),r(1,"div",0),m(2,"Comment"),l(),r(3,"div",1),m(4),l()),e&2){let n=d();s(4),S(" ",n.command.comment," ")}}function fr(e,i){if(e&1){let n=A();r(0,"ya-more",7)(1,"button",8),v("click",function(){b(n);let o=d().$implicit,a=d(2);return T(a.copyHex(o.value.binaryValue))}),m(2,"Copy Hex"),l(),r(3,"button",8),v("click",function(){b(n);let o=d().$implicit,a=d(2);return T(a.copyBinary(o.value.binaryValue))}),m(4,"Copy Binary"),l()()}}function _r(e,i){if(e&1&&(r(0,"div",9),f(1,"app-hex",10),l(),r(2,"div",11)(3,"pre"),m(4),h(5,"hexDump"),l()()),e&2){let n=d().$implicit;s(),p("base64String",n.value.binaryValue),s(3),F(g(5,2,n.value.binaryValue)||"-")}}function Cr(e,i){if(e&1&&(r(0,"div",1),m(1),h(2,"value"),l()),e&2){let n=d().$implicit;s(),S(" ",g(2,1,n.value)," ")}}function hr(e,i){if(e&1&&(r(0,"div",2),m(1),u(2,fr,5,0,"ya-more",7),l(),u(3,_r,6,4)(4,Cr,3,3,"div",1)),e&2){let n,t=i.$implicit,o=i.$index;R("first",o===0),s(),S(" ",t.name," "),s(),_(t.value.type==="BINARY"?2:-1),s(),_((n=t.value.type)==="BINARY"?3:4)}}function gr(e,i){if(e&1&&(f(0,"mat-divider",5),H(1,hr,5,5,null,null,mr)),e&2){let n=d();s(),q(n.command.extra)}}function xr(e,i){if(e&1&&(r(0,"div",2),m(1,"Extra acknowledgments"),l(),r(2,"div",1),f(3,"app-extra-acknowledgments-table",6),l()),e&2){let n=d();s(3),p("command",n.command)("showIcons",n.showIcons)}}function yr(e,i){if(e&1){let n=A();r(0,"ya-more",7)(1,"button",8),v("click",function(){b(n);let o=d(),a=d();return T(a.copyHex(o.binaryValue))}),m(2,"Copy Hex"),l(),r(3,"button",8),v("click",function(){b(n);let o=d(),a=d();return T(a.copyBinary(o.binaryValue))}),m(4,"Copy Binary"),l()()}}function vr(e,i){if(e&1&&(r(0,"div",9),f(1,"app-hex",10),l(),r(2,"div",11)(3,"pre"),m(4),h(5,"hexDump"),l()()),e&2){let n=d();s(),p("base64String",n.binaryValue),s(3),F(g(5,2,n.binaryValue)||"-")}}function Sr(e,i){if(e&1&&(r(0,"div",1)(1,"pre",12),m(2),l()()),e&2){let n=d();s(2),F(n.stringValue)}}function br(e,i){if(e&1&&(r(0,"div",1),m(1),h(2,"value"),l()),e&2){let n=d();s(),S(" ",g(2,1,n)," ")}}function Tr(e,i){if(e&1&&(f(0,"mat-divider",5),r(1,"div",0),m(2," Return value "),u(3,yr,5,0,"ya-more",7),l(),u(4,vr,6,4)(5,Sr,3,1,"div",1)(6,br,3,3,"div",1)),e&2){let n,t=i;s(3),_(t.type==="BINARY"?3:-1),s(),_((n=t.type)==="BINARY"?4:n==="STRING"?5:6)}}function wr(e,i){e&1&&m(0," SUCCESS ")}function kr(e,i){if(e&1&&m(0),e&2){let n=d();S(" FAILURE: ",n.command.completed==null?null:n.command.completed.message," ")}}function Er(e,i){e&1&&m(0," - ")}function Dr(e,i){if(e&1&&(r(0,"div",2),m(1),h(2,"cascadingPrefix"),l(),r(3,"div",1),f(4,"app-extra-acknowledgments-table",6),l()),e&2){let n=d().$implicit,t=d();s(),S("",g(2,3,n.key)," extra acknowledgments"),s(3),p("command",n.value)("showIcons",t.showIcons)}}function Mr(e,i){e&1&&m(0," SUCCESS ")}function Ir(e,i){if(e&1&&m(0),e&2){let n=d().$implicit;S(" FAILURE: ",n.value.completed==null?null:n.value.completed.message," ")}}function Ar(e,i){e&1&&m(0," - ")}function Fr(e,i){if(e&1&&(f(0,"mat-divider",5),r(1,"div",0),m(2),h(3,"cascadingPrefix"),l(),r(4,"div",1),f(5,"app-yamcs-acknowledgments-table",6),l(),u(6,Dr,5,5),r(7,"div",2),m(8),h(9,"cascadingPrefix"),l(),r(10,"div",1),u(11,Mr,1,0)(12,Ir,1,1)(13,Ar,1,0),l()),e&2){let n=i.$implicit,t=d();s(2),S(" ",g(3,8,n.key)," acknowledgments "),s(3),p("command",n.value)("showIcons",t.showIcons),s(),_(n.value.extraAcks.length?6:-1),s(2),S("",g(9,10,n.key)," completion"),s(3),_((n.value.completed==null?null:n.value.completed.status)==="OK"?11:-1),s(),_((n.value.completed==null?null:n.value.completed.status)==="NOK"?12:-1),s(),_(n.value.completed?-1:13)}}var $t=(()=>{let i=class i{constructor(t){this.clipboard=t,this.showIcons=!0}copyHex(t){let o=O.convertBase64ToHex(t);this.clipboard.copy(o)}copyBinary(t){let o=window.atob(t);this.clipboard.copy(o)}};i.\u0275fac=function(o){return new(o||i)(y(Fi))},i.\u0275cmp=w({type:i,selectors:[["app-command-detail2"]],inputs:{command:"command",showIcons:"showIcons"},standalone:!0,features:[k],decls:41,vars:22,consts:[[1,"block-title",2,"padding-top","0"],[1,"block"],[1,"block-title"],[1,"block","command-text"],[3,"command"],[2,"margin-top","1em","margin-bottom","1em"],[3,"command","showIcons"],["icon","more_horiz"],["mat-menu-item","",3,"click"],[1,"block","no-print",2,"margin-top","4px"],[3,"base64String"],[1,"block","print-only"],[2,"margin","0","line-height","1em"]],template:function(o,a){if(o&1&&(r(0,"div",0),m(1,"ID"),l(),r(2,"div",1),m(3),l(),r(4,"div",2),m(5,"Command"),l(),r(6,"div",3),m(7),f(8,"app-command-arguments",4),l(),u(9,sr,13,4)(10,cr,13,4),f(11,"mat-divider",5),r(12,"div",0),m(13,"Time"),l(),r(14,"div",1),m(15),h(16,"datetime"),l(),r(17,"div",2),m(18,"Issuer"),l(),r(19,"div",1),m(20),u(21,dr,1,1),l(),u(22,pr,4,1)(23,ur,5,1)(24,gr,3,0),f(25,"mat-divider",5),r(26,"div",0),m(27,"Yamcs acknowledgments"),l(),r(28,"div",1),f(29,"app-yamcs-acknowledgments-table",6),l(),u(30,xr,4,2)(31,Tr,7,2),r(32,"div",2),m(33,"Completion"),l(),r(34,"div",1),u(35,wr,1,0)(36,kr,1,1)(37,Er,1,0),l(),H(38,Fr,14,12,null,null,lr),h(40,"keyvalue")),o&2){let c;s(3),S(" ",a.command.id,`
`),s(4),S(" ",a.command.commandName," "),s(),p("command",a.command),s(),_(a.command.unprocessedBinary&&a.command.unprocessedBinary!==a.command.binary?9:-1),s(),_(a.command.binary?10:-1),s(5),S(" ",g(16,18,a.command.generationTime),`
`),s(5),S(" ",a.command.username," "),s(),_(a.command.origin?21:-1),s(),_(a.command.queue?22:-1),s(),_(a.command.comment?23:-1),s(),_(a.command.extra.length?24:-1),s(5),p("command",a.command)("showIcons",a.showIcons),s(),_(a.command.extraAcks.length?30:-1),s(),_((c=a.command.completed==null?null:a.command.completed.returnValue)?31:-1,c),s(4),_((a.command.completed==null?null:a.command.completed.status)==="OK"?35:-1),s(),_((a.command.completed==null?null:a.command.completed.status)==="NOK"?36:-1),s(),_(a.command.completed?-1:37),s(),q(g(40,20,a.command.cascadedRecordsByPrefix))}},dependencies:[yo,Zi,en,Ki,D,bi,We,Ye,At,Pe,Wi,Ot,nn],styles:[".block-title.first[_ngcontent-%COMP%]{padding-top:0}"],changeDetection:0});let e=i;return e})();function Or(e,i){if(e&1&&f(0,"app-command-detail2",0)(1,"div",1),e&2){let n=i.$implicit;p("command",n)("showIcons",!1)}}var vo=(()=>{let i=class i{};i.\u0275fac=function(o){return new(o||i)},i.\u0275cmp=w({type:i,selectors:[["app-command-history-printable"]],inputs:{pageTitle:"pageTitle",data:"data"},standalone:!0,features:[k],decls:2,vars:0,consts:[[3,"command","showIcons"],[2,"page-break-after","always"]],template:function(o,a){o&1&&H(0,Or,2,2,null,null,G),o&2&&q(a.data)},dependencies:[$t,D],encapsulation:2,changeDetection:0});let e=i;return e})();var So=(()=>{let i=class i{constructor(t,o,a){this.dialogRef=t,this.yamcs=o,this.data=a,this.delimiterOptions=[{id:"COMMA",label:"Comma"},{id:"SEMICOLON",label:"Semicolon"},{id:"TAB",label:"Tab"}],this.downloadURL$=new P(null),this.form=new ft({start:new j(null),stop:new j(null),delimiter:new j(null,W.required)}),this.form.setValue({start:a.start?O.toISOString(a.start):"",stop:a.stop?O.toISOString(a.stop):"",delimiter:"TAB"}),this.formChangeSubscription=this.form.valueChanges.subscribe(()=>{this.updateURL()}),this.updateURL()}closeDialog(){this.dialogRef.close(!0)}updateURL(){if(this.form.valid){let t={delimiter:this.form.value.delimiter};this.form.value.start&&(t.start=O.toISOString(this.form.value.start)),this.form.value.stop&&(t.stop=O.toISOString(this.form.value.stop));let o=this.yamcs.yamcsClient.getCommandsDownloadURL(this.yamcs.instance,t);this.downloadURL$.next(o)}else this.downloadURL$.next(null)}ngOnDestroy(){this.formChangeSubscription?.unsubscribe()}};i.\u0275fac=function(o){return new(o||i)(y(Ce),y(U),y(ze))},i.\u0275cmp=w({type:i,selectors:[["ng-component"]],standalone:!0,features:[k],decls:22,vars:7,consts:[["mat-dialog-title",""],[1,"ya-form"],[3,"formGroup"],["formControlName","start"],["formControlName","stop"],["formControlName","delimiter",3,"options"],["align","end"],["mat-dialog-close","",1,"ya-button"],[3,"click","link","primary","disabled"]],template:function(o,a){o&1&&(r(0,"h2",0),m(1,"Export commands"),l(),r(2,"mat-dialog-content",1)(3,"form",2)(4,"label"),m(5," Start "),f(6,"ya-date-time-input",3),l(),f(7,"br"),r(8,"label"),m(9," Stop "),f(10,"ya-date-time-input",4),l(),f(11,"br"),r(12,"label"),m(13," CSV column delimiter"),f(14,"br")(15,"ya-select",5),l()()(),r(16,"mat-dialog-actions",6)(17,"button",7),m(18,"CANCEL"),l(),r(19,"ya-download-button",8),h(20,"async"),v("click",function(){return a.closeDialog()}),m(21," DOWNLOAD "),l()()),o&2&&(s(3),p("formGroup",a.form),s(12),p("options",a.delimiterOptions),s(4),p("link",g(20,5,a.downloadURL$))("primary",!0)("disabled",!a.form.valid))},dependencies:[D,Q,re,$,ie,ne,Z,he,Re,Me,De,Xe,Xn,Ze],encapsulation:2});let e=i;return e})();var bo=(()=>{let i=class i{constructor(t){this.yamcs=t}transform(t){if(!t)return null;let o=this.yamcs.instance;return this.yamcs.yamcsClient.getCommandDownloadURL(o,t.id)}};i.\u0275fac=function(o){return new(o||i)(y(U,16))},i.\u0275pipe=qt({name:"commandDownloadLink",type:i,pure:!0,standalone:!0});let e=i;return e})();var on=class{constructor(i){this.watermarkObserver=i,this.dirty=!1,this.archiveRecords=[],this.bufferSize=500,this.bufferWatermark=400,this.pointer=0,this.alreadyWarned=!1,this.realtimeBuffer=Array(this.bufferSize).fill(void 0)}addArchiveData(i){this.archiveRecords=this.archiveRecords.concat(i),this.dirty=!0}addRealtimeCommand(i){this.pointer<this.bufferSize&&(this.realtimeBuffer[this.pointer]=i,this.pointer>=this.bufferWatermark&&this.watermarkObserver&&!this.alreadyWarned&&(this.alreadyWarned=!0,this.watermarkObserver()),this.pointer=this.pointer+1),this.dirty=!0}reset(){this.archiveRecords=[],this.realtimeBuffer.fill(void 0),this.pointer=0,this.alreadyWarned=!1,this.dirty=!0}snapshot(){let i=this.archiveRecords;return this.realtimeBuffer.map(n=>{if(!n)return;let t=i.findIndex(o=>o.id==n.id);t===-1?i.push(new ct(n)):i[t]=i[t].mergeEntry(n)}),i.sort((n,t)=>{let o=-n.generationTime.localeCompare(t.generationTime);return o===0&&(o=-n.origin.localeCompare(t.origin)),o!==0?o:t.sequenceNumber-n.sequenceNumber}),i}compact(i){let n=this.snapshot();n.length=Math.min(i,n.length),this.reset(),this.archiveRecords=n,this.dirty=!0}};var an=class extends ki{constructor(i,n){super(),this.yamcs=i,this.pageSize=100,this.blockHasMore=!1,this.records$=new P([]),this.loading$=new P(!1),this.streaming$=new P(!1),this.namespaces$=new P([]),this.syncSubscription=n.sync(()=>{this.buffer.dirty&&!this.loading$.getValue()&&(this.emitCommands(),this.buffer.dirty=!1)}),this.buffer=new on(()=>{this.blockHasMore=!0,this.buffer.compact(500)})}connect(){return this.records$}emitCommands(){this.records$.next(this.buffer.snapshot())}loadEntries(i){return this.loading$.next(!0),this.loadPage(pn(ae({},i),{limit:this.pageSize})).then(n=>{this.buffer.reset(),this.blockHasMore=!1,this.buffer.addArchiveData(n.map(t=>new ct(t))),this.emitCommands()}).finally(()=>{this.loading$.next(!1)})}hasMore(){return!!this.continuationToken&&!this.blockHasMore}async loadPage(i){return this.yamcs.yamcsClient.getCommandHistoryEntries(this.yamcs.instance,i).then(n=>{this.continuationToken=n.continuationToken;var t=n.entry||[];for(let o of t)this.updateNamespaces(o);return t})}async loadMoreData(i){if(this.continuationToken)return this.loadPage(pn(ae({},i),{next:this.continuationToken,limit:this.pageSize})).then(n=>{let t=n.map(o=>new ct(o));this.buffer.addArchiveData(t),this.emitCommands()})}startStreaming(){this.streaming$.next(!0),this.realtimeSubscription=this.yamcs.yamcsClient.createCommandSubscription({instance:this.yamcs.instance,processor:this.yamcs.processor},i=>{this.loading$.getValue()||(this.updateNamespaces(i),this.buffer.addRealtimeCommand(i))})}updateNamespaces(i){let n=this.namespaces$.value;if(i.aliases)for(let t in i.aliases)n.indexOf(t)===-1&&(n.push(t),n.sort(),this.namespaces$.next([...n]))}stopStreaming(){this.realtimeSubscription?.cancel(),this.streaming$.next(!1)}disconnect(){this.syncSubscription?.unsubscribe(),this.records$.complete(),this.loading$.complete(),this.streaming$.complete(),this.namespaces$.complete()}isEmpty(){return!this.records$.getValue().length}};var Pr=["intervalSelect"],To=(e,i)=>({c:e,template:i}),Vr=()=>["detail"],Nr=e=>["/commanding/history",e],$r=e=>({c:e});function Lr(e,i){if(e&1){let n=A();r(0,"button",10),v("click",function(){b(n);let o=d();return T(o.startStreaming())}),r(1,"mat-icon"),m(2,"play_arrow"),l(),m(3," Start streaming "),l()}}function Rr(e,i){if(e&1){let n=A();r(0,"button",11),v("click",function(){b(n);let o=d();return T(o.stopStreaming())}),r(1,"mat-icon"),m(2,"pause"),l(),m(3," Stop streaming "),l()}}function Br(e,i){if(e&1&&(f(0,"br")(1,"mat-divider")(2,"br"),r(3,"button",14),m(4," Resend "),l()),e&2){let n=d(),t=d();s(3),p("routerLink","/commanding/send"+(n==null?null:n.commandName))("queryParams",vt(2,To,t.yamcs.context,n==null?null:n.id))}}function Hr(e,i){if(e&1&&(r(0,"ya-detail-toolbar"),m(1," Command Detail "),l(),r(2,"div",12),f(3,"app-command-detail2",13),u(4,Br,5,5),r(5,"p"),m(6,"\xA0"),l()()),e&2){let n=d();s(3),p("command",i),s(),_(n.showResend()?4:-1)}}function qr(e,i){e&1&&(r(0,"ya-detail-toolbar"),m(1," Select a command "),l())}function jr(e,i){if(e&1&&(r(0,"button",20),h(1,"async"),r(2,"mat-icon"),m(3,"download"),l(),m(4," Export \u25BE "),l()),e&2){let n;d();let t=B(9),o=d();p("matMenuTriggerFor",t)("disabled",!((n=g(1,2,o.dataSource.records$))!=null&&n.length))}}function Qr(e,i){if(e&1){let n=A();f(0,"ya-date-time-input",65)(1,"ya-date-time-input",66),r(2,"button",64),v("click",function(){b(n);let o=d(2);return T(o.applyCustomDates())}),m(3," Apply "),l()}if(e&2){let n=d(2);s(2),p("disabled",n.filterForm.invalid)}}function Ur(e,i){if(e&1){let n=A();r(0,"button",67),v("click",function(){b(n);let o=d(2);return T(o.jumpToNow())}),m(1,"Jump to now"),l()}}function Gr(e,i){e&1&&f(0,"ya-dots")}function Yr(e,i){e&1&&(r(0,"div",27),m(1," Listening for commands "),f(2,"ya-dots",68),l())}function Wr(e,i){if(e&1&&(r(0,"span"),m(1," Showing entries from "),r(2,"b"),m(3,"the last hour"),l(),m(4," ending at "),r(5,"b"),m(6),h(7,"datetime"),l(),m(8," (Mission Time) "),l()),e&2){let n=d(2);s(6),F(g(7,1,n.validStop))}}function zr(e,i){if(e&1&&(r(0,"span"),m(1," Showing entries from "),r(2,"b"),m(3,"the last 6 hours"),l(),m(4," ending at "),r(5,"b"),m(6),h(7,"datetime"),l(),m(8," (Mission Time) "),l()),e&2){let n=d(2);s(6),F(g(7,1,n.validStop))}}function Jr(e,i){if(e&1&&(r(0,"span"),m(1," Showing entries from "),r(2,"b"),m(3,"the last 24 hours"),l(),m(4," ending at "),r(5,"b"),m(6),h(7,"datetime"),l(),m(8," (Mission Time) "),l()),e&2){let n=d(2);s(6),F(g(7,1,n.validStop))}}function Kr(e,i){e&1&&(r(0,"span"),m(1," Showing entries from "),r(2,"b"),m(3,"all time"),l()())}function Xr(e,i){if(e&1&&(r(0,"span"),m(1," Showing entries from "),r(2,"b"),m(3),h(4,"datetime"),l(),m(5," to "),r(6,"b"),m(7),h(8,"datetime"),l(),m(9," (Mission Time) "),l()),e&2){let n=d(2);s(3),F(g(4,2,n.validStart)),s(4),F(g(8,4,n.validStop))}}function Zr(e,i){e&1&&(r(0,"th",69),m(1,"ID"),l())}function el(e,i){if(e&1&&(r(0,"td",70)(1,"a",71),m(2),l()()),e&2){let n=i.$implicit,t=d(2);s(),p("routerLink",ce(3,Nr,n.id))("queryParams",ce(5,$r,t.yamcs.context)),s(),F(n.id)}}function tl(e,i){e&1&&(r(0,"th",69),m(1,"Time"),l())}function il(e,i){if(e&1&&(r(0,"td",70),m(1),h(2,"datetime"),l()),e&2){let n=i.$implicit;s(),S(" ",g(2,1,n.generationTime)," ")}}function nl(e,i){e&1&&(r(0,"th",72)(1,"mat-icon",73),m(2,"comment"),l()())}function ol(e,i){if(e&1&&(r(0,"mat-icon",75),m(1,"comment"),l()),e&2){let n=d().$implicit;p("matTooltip",n.comment)}}function al(e,i){e&1&&m(0," - ")}function rl(e,i){if(e&1&&(r(0,"td",74),u(1,ol,2,1,"mat-icon",75)(2,al,1,0),l()),e&2){let n=i.$implicit;s(),_(n.comment?1:-1),s(),_(n.comment?-1:2)}}function ll(e,i){e&1&&(r(0,"th",69),m(1,"Command"),l())}function ml(e,i){if(e&1&&(r(0,"td",70),f(1,"ya-highlight",76),l()),e&2){let n=i.$implicit,t=d(2);s(),p("text",n.commandName)("term",t.filterForm.value.filter)}}function sl(e,i){if(e&1&&(r(0,"th",69),m(1),l()),e&2){let n=d().$implicit;s(),S(" ",n.label," ")}}function cl(e,i){if(e&1&&f(0,"ya-highlight",76),e&2){let n=d(4);p("text",i)("term",n.filterForm.value.filter)}}function dl(e,i){e&1&&m(0," - ")}function pl(e,i){if(e&1&&(r(0,"td",70),u(1,cl,1,2,"ya-highlight",76),h(2,"alias"),u(3,dl,1,0),l()),e&2){let n,t=i.$implicit,o=d().$implicit;s(),_((n=Ve(2,1,t,o.id))?1:3,n)}}function ul(e,i){if(e&1&&(M(0,41),u(1,sl,2,1,"th",34)(2,pl,4,4,"td",35),I()),e&2){let n=i.$implicit;p("matColumnDef",n.id)}}function fl(e,i){e&1&&(r(0,"th",69),m(1,"Issuer"),l())}function _l(e,i){if(e&1&&(r(0,"span"),m(1),l()),e&2){let n=d().$implicit;s(),S("@",n.origin,"")}}function Cl(e,i){if(e&1&&(r(0,"td",70),m(1),u(2,_l,2,1,"span"),l()),e&2){let n=i.$implicit;s(),S(" ",n.username," "),s(),_(n.origin?2:-1)}}function hl(e,i){e&1&&(r(0,"th",69),m(1,"Queue"),l())}function gl(e,i){if(e&1&&(r(0,"td",70),m(1),l()),e&2){let n=i.$implicit;s(),S(" ",n.queue||"-"," ")}}function xl(e,i){e&1&&(r(0,"th",69),m(1,"Sequence number"),l())}function yl(e,i){if(e&1&&(r(0,"td",70),m(1),l()),e&2){let n=i.$implicit;s(),S(" ",n.sequenceNumber," ")}}function vl(e,i){e&1&&(r(0,"th",77),m(1," Q "),l())}function Sl(e,i){if(e&1&&(r(0,"td",78)(1,"div",79),f(2,"app-acknowledgment-icon",80),l()()),e&2){let n=i.$implicit;s(2),p("ack",n.queued)}}function bl(e,i){e&1&&(r(0,"th",81),m(1," R "),l())}function Tl(e,i){if(e&1&&f(0,"app-transmission-constraints-icon",13),e&2){let n=d().$implicit;p("command",n)}}function wl(e,i){if(e&1&&f(0,"app-acknowledgment-icon",80),e&2){let n=d().$implicit;p("ack",n.released)}}function kl(e,i){if(e&1&&(r(0,"td",78)(1,"div",79),u(2,Tl,1,1,"app-transmission-constraints-icon",13)(3,wl,1,1,"app-acknowledgment-icon",80),l()()),e&2){let n=i.$implicit;s(2),_(n.released?-1:2),s(),_(n.released?3:-1)}}function El(e,i){e&1&&(r(0,"th",82),m(1," S "),l())}function Dl(e,i){if(e&1&&(r(0,"td",78)(1,"div",79),f(2,"app-acknowledgment-icon",80),l()()),e&2){let n=i.$implicit;s(2),p("ack",n.sent)}}function Ml(e,i){e&1&&(r(0,"th",83),m(1,"Acks"),l())}function Il(e,i){if(e&1&&f(0,"app-acknowledgment-icon",80),e&2){let n=i.$implicit;p("ack",n)}}function Al(e,i){e&1&&m(0," - ")}function Fl(e,i){if(e&1&&(r(0,"td",84)(1,"div",79),H(2,Il,1,1,"app-acknowledgment-icon",80,G),l(),u(4,Al,1,0),l()),e&2){let n=i.$implicit;s(2),q(n.extraAcks),s(2),_(n.extraAcks.length?-1:4)}}function Ol(e,i){e&1&&(r(0,"th",85),m(1,"Completion"),l())}function Pl(e,i){e&1&&m(0," SUCCESS ")}function Vl(e,i){if(e&1&&(r(0,"span",87),m(1," FAILURE "),l()),e&2){let n=d().$implicit;p("matTooltip",n.completed==null?null:n.completed.message)}}function Nl(e,i){e&1&&m(0," - ")}function $l(e,i){if(e&1&&(r(0,"td",86),u(1,Pl,1,0)(2,Vl,2,1,"span",87)(3,Nl,1,0),l()),e&2){let n=i.$implicit;s(),_((n.completed==null?null:n.completed.status)==="OK"?1:-1),s(),_((n.completed==null?null:n.completed.status)==="NOK"?2:-1),s(),_(n.completed?-1:3)}}function Ll(e,i){e&1&&f(0,"th",88)}function Rl(e,i){if(e&1&&(r(0,"button",90),m(1," Resend "),l(),f(2,"mat-divider")),e&2){let n=d().$implicit,t=d(2);p("routerLink","/commanding/send"+n.commandName)("queryParams",vt(2,To,t.yamcs.context,n.id))}}function Bl(e,i){if(e&1&&(f(0,"mat-divider"),r(1,"ya-download-menu-item",91),h(2,"commandDownloadLink"),m(3," Download "),l()),e&2){let n=d().$implicit;s(),p("link",g(2,1,n))}}function Hl(e,i){if(e&1){let n=A();r(0,"td",70)(1,"ya-more"),u(2,Rl,3,5),r(3,"button",89),v("click",function(){let o=b(n).$implicit,a=d(2);return T(a.copyHex(o))}),m(4,"Copy Hex"),l(),r(5,"button",89),v("click",function(){let o=b(n).$implicit,a=d(2);return T(a.copyBinary(o))}),m(6,"Copy Binary"),l(),u(7,Bl,4,3),l()()}if(e&2){let n=d(2);s(2),_(n.showResend()?2:-1),s(5),_(n.showCommandExports()?7:-1)}}function ql(e,i){if(e&1&&f(0,"app-command-arguments",96),e&2){let n=d(2).$implicit;p("command",n)("nomargin",!0)}}function jl(e,i){e&1&&m(0," - ")}function Ql(e,i){if(e&1&&(r(0,"div",93)(1,"div",94),m(2,"Arguments"),l(),r(3,"div",95),u(4,ql,1,2,"app-command-arguments",96)(5,jl,1,0),l()()),e&2){let n=d().$implicit;s(4),_(n.userAssignments.length?4:-1),s(),_(n.userAssignments.length?-1:5)}}function Ul(e,i){if(e&1&&(r(0,"div",97),f(1,"app-hex",98),l(),r(2,"div",99)(3,"pre",100),m(4),h(5,"hexDump"),l()()),e&2){let n=d();s(),p("base64String",n.binaryValue),s(3),F(g(5,2,n.binaryValue)||"-")}}function Gl(e,i){if(e&1&&(r(0,"div",95)(1,"pre",101),m(2),l()()),e&2){let n=d();s(2),F(n.stringValue)}}function Yl(e,i){if(e&1&&(r(0,"div",95),m(1),h(2,"value"),l()),e&2){let n=d();s(),S(" ",g(2,1,n)," ")}}function Wl(e,i){if(e&1&&u(0,Ul,6,4)(1,Gl,3,1,"div",95)(2,Yl,3,3,"div",95),e&2){let n;_((n=i.type)==="BINARY"?0:n==="STRING"?1:2)}}function zl(e,i){e&1&&m(0," - ")}function Jl(e,i){if(e&1&&(r(0,"div")(1,"div",94),m(2,"Return value"),l(),u(3,Wl,3,1)(4,zl,1,0),l()),e&2){let n,t=d().$implicit;s(3),_((n=t.completed==null?null:t.completed.returnValue)?3:-1,n),s(),_(t.completed!=null&&t.completed.returnValue?-1:4)}}function Kl(e,i){if(e&1&&(r(0,"td",70),h(1,"async"),r(2,"div",92),u(3,Ql,6,2,"div",93)(4,Jl,5,2,"div"),f(5,"div",19),l()()),e&2){let n;d();let t=B(5),o=B(27),a=B(31);Fn("colspan",(n=g(1,3,t.displayedColumns$))==null?null:n.length),s(3),_(o.checked?3:-1),s(),_(a.checked?4:-1)}}function Xl(e,i){e&1&&f(0,"tr",102)}function Zl(e,i){if(e&1){let n=A();r(0,"tr",103),h(1,"async"),v("click",function(){let o=b(n).$implicit,a=d(2);return T(a.selectRecord(o))}),l()}if(e&2){let n=i.$implicit;d();let t=B(27),o=B(31),a=d();R("expanded",t.checked||o.checked)("selected",g(1,8,a.selectedRecord$)===n)("success",(n.completed==null?null:n.completed.status)==="OK")("failed",(n.completed==null?null:n.completed.status)==="NOK")}}function em(e,i){if(e&1){let n=A();r(0,"tr",104),v("click",function(){let o=b(n).$implicit,a=d(2);return T(a.selectRecord(o))}),l()}if(e&2){d();let n=B(27),t=B(31);R("expanded",n.checked||t.checked)}}function tm(e,i){if(e&1){let n=A();r(0,"div",9)(1,"form",15)(2,"div",16),f(3,"ya-search-filter",17)(4,"ya-column-chooser",18,0)(6,"div",19),u(7,jr,5,4,"button",20),r(8,"mat-menu",21,1)(10,"button",22),v("click",function(){b(n);let o=d();return T(o.printReport())}),m(11," Printer-friendly "),l(),r(12,"button",23),v("click",function(){b(n);let o=d();return T(o.exportCsv())}),m(13," CSV format "),l()()(),r(14,"div",16),f(15,"ya-select",24)(16,"ya-select",25,2),u(18,Qr,4,1)(19,Ur,2,0,"button",26)(20,Gr,1,0,"ya-dots"),h(21,"async"),u(22,Yr,3,0,"div",27),h(23,"async"),l()(),r(24,"div",28)(25,"div",29)(26,"ya-table-toggle",30,3),m(28,"Arguments"),l(),m(29," \xA0\xA0 "),r(30,"ya-table-toggle",31,4),m(32,"Return value"),l()(),u(33,Wr,9,3,"span")(34,zr,9,3,"span")(35,Jr,9,3,"span")(36,Kr,4,0,"span")(37,Xr,10,6,"span"),l(),r(38,"table",32),M(39,33),u(40,Zr,2,0,"th",34)(41,el,3,7,"td",35),I(),M(42,36),u(43,tl,2,0,"th",34)(44,il,3,3,"td",35),I(),M(45,37),u(46,nl,3,0,"th",38)(47,rl,3,2,"td",39),I(),M(48,40),u(49,ll,2,0,"th",34)(50,ml,2,2,"td",35),I(),H(51,ul,3,1,"ng-container",41,G),h(53,"async"),M(54,42),u(55,fl,2,0,"th",34)(56,Cl,3,2,"td",35),I(),M(57,43),u(58,hl,2,0,"th",34)(59,gl,2,1,"td",35),I(),M(60,44),u(61,xl,2,0,"th",34)(62,yl,2,1,"td",35),I(),M(63,45),u(64,vl,2,0,"th",46)(65,Sl,3,1,"td",47),I(),M(66,48),u(67,bl,2,0,"th",49)(68,kl,4,2,"td",47),I(),M(69,50),u(70,El,2,0,"th",51)(71,Dl,3,1,"td",47),I(),M(72,52),u(73,Ml,2,0,"th",53)(74,Fl,5,1,"td",54),I(),M(75,55),u(76,Ol,2,0,"th",56)(77,$l,4,3,"td",57),I(),M(78,58),u(79,Ll,1,0,"th",59)(80,Hl,8,2,"td",35),I(),M(81,60),u(82,Kl,6,5,"td",35),I(),u(83,Xl,1,0,"tr",61),h(84,"async"),u(85,Zl,2,10,"tr",62),h(86,"async"),u(87,em,1,2,"tr",63),l(),r(88,"mat-toolbar"),f(89,"span",19),r(90,"button",64),v("click",function(){b(n);let o=d();return T(o.loadMoreData())}),m(91," Load More "),l(),f(92,"span",19),l()()}if(e&2){let n,t=B(5),o=d();s(),p("formGroup",o.filterForm),s(3),p("columns",o.columns),s(3),_(o.showCommandExports()?7:-1),s(8),p("options",o.queueOptions),s(),p("options",o.intervalOptions),s(2),_(o.filterForm.value.interval==="CUSTOM"?18:-1),s(),_(o.filterForm.value.interval!=="CUSTOM"?19:-1),s(),_(g(21,15,o.dataSource.loading$)?20:-1),s(2),_(g(23,17,o.dataSource.streaming$)?22:-1),s(11),_((n=o.appliedInterval)==="PT1H"?33:n==="PT6H"?34:n==="P1D"?35:n==="NO_LIMIT"?36:n==="CUSTOM"?37:-1),s(5),p("dataSource",o.dataSource),s(13),q(g(53,19,o.aliasColumns$)),s(32),p("matHeaderRowDef",g(84,21,t.displayedColumns$)),s(2),p("matRowDefColumns",g(86,23,t.displayedColumns$)),s(2),p("matRowDefColumns",Tt(25,Vr)),s(3),p("disabled",!o.dataSource.hasMore())}}var gi="PT1H",wo=(()=>{let i=class i{constructor(t,o,a,c,C,x,E,V,N,te,fe){this.yamcs=t,this.messageService=c,this.router=C,this.route=x,this.printService=E,this.clipboard=te,this.dialog=fe,this.selectedRecord$=new P(null),this.filterForm=new ft({filter:new j,queue:new j("ANY"),interval:new j(gi),customStart:new j(null),customStop:new j(null)}),this.columns=[{id:"commandId",label:"ID",alwaysVisible:!0},{id:"generationTime",label:"Time",alwaysVisible:!0},{id:"comment",label:"Comment",visible:!0},{id:"command",label:"Command",alwaysVisible:!0},{id:"issuer",label:"Issuer"},{id:"queue",label:"Queue"},{id:"queued",label:"Queued",visible:!0},{id:"released",label:"Released",visible:!0},{id:"sent",label:"Sent",visible:!0},{id:"acknowledgments",label:"Extra acknowledgments",visible:!0},{id:"completion",label:"Completion",visible:!0},{id:"actions",label:"",alwaysVisible:!0}],this.aliasColumns$=new P([]),this.intervalOptions=[{id:"PT1H",label:"Last hour"},{id:"PT6H",label:"Last 6 hours"},{id:"P1D",label:"Last 24 hours"},{id:"NO_LIMIT",label:"No limit"},{id:"CUSTOM",label:"Custom",group:!0}],this.subscriptions=[],this.config=o.getConfig(),this.user=a.getUser(),V.setTitle("Command history"),this.dataSource=new an(this.yamcs,N),this.queueOptions=[{id:"ANY",label:"Any queue"}];for(let X of this.config.queueNames)this.queueOptions.push({id:X,label:X});this.initializeOptions(),this.loadData(),this.filterForm.get("filter").valueChanges.pipe(Mn(400)).forEach(X=>{this.filter=X,this.loadData()}),this.filterForm.get("queue").valueChanges.forEach(X=>{this.queue=X!=="ANY"?X:null,this.loadData()}),this.filterForm.get("interval").valueChanges.forEach(X=>{if(X==="CUSTOM"){let me=this.validStart||this.yamcs.getMissionTime(),dt=this.validStop||this.yamcs.getMissionTime();this.filterForm.get("customStart").setValue(O.toISOString(me)),this.filterForm.get("customStop").setValue(O.toISOString(dt))}else X==="NO_LIMIT"?(this.validStart=null,this.validStop=null,this.appliedInterval=X,this.loadData()):(this.validStop=t.getMissionTime(),this.validStart=O.subtractDuration(this.validStop,X),this.appliedInterval=X,this.loadData())})}ngAfterViewInit(){this.subscriptions.push(this.dataSource.namespaces$.subscribe(t=>{for(let c of this.aliasColumns$.value){let C=this.columns.indexOf(c);C!==-1&&this.columns.splice(C,1)}let o=[];for(let c of t){let C={id:c,label:c,alwaysVisible:!0};o.push(C)}let a=this.columns.findIndex(c=>c.id==="command");this.columns.splice(a+1,0,...o),this.aliasColumns$.next(o),this.columnChooser.recalculate(this.columns)}))}initializeOptions(){let t=this.route.snapshot.queryParamMap;if(t.has("filter")&&(this.filter=t.get("filter")||"",this.filterForm.get("filter").setValue(this.filter)),t.has("queue")&&(this.queue=t.get("queue"),this.filterForm.get("queue").setValue(this.queue)),t.has("interval"))if(this.appliedInterval=t.get("interval"),this.filterForm.get("interval").setValue(this.appliedInterval),this.appliedInterval==="CUSTOM"){let o=t.get("customStart");this.filterForm.get("customStart").setValue(o),this.validStart=new Date(o);let a=t.get("customStop");this.filterForm.get("customStop").setValue(a),this.validStop=new Date(a)}else this.appliedInterval==="NO_LIMIT"?(this.validStart=null,this.validStop=null):(this.validStop=this.yamcs.getMissionTime(),this.validStart=O.subtractDuration(this.validStop,this.appliedInterval));else this.appliedInterval=gi,this.validStop=this.yamcs.getMissionTime(),this.validStart=O.subtractDuration(this.validStop,gi)}jumpToNow(){let t=this.filterForm.value.interval;t==="NO_LIMIT"?this.filterForm.get("interval").setValue(gi):t==="CUSTOM"?this.filterForm.get("interval").setValue(gi):(this.validStop=this.yamcs.getMissionTime(),this.validStart=O.subtractDuration(this.validStop,t),this.loadData())}startStreaming(){this.filterForm.get("interval").setValue("NO_LIMIT"),this.dataSource.startStreaming()}stopStreaming(){this.dataSource.stopStreaming()}applyCustomDates(){this.validStart=O.toDate(this.filterForm.value.customStart),this.validStop=O.toDate(this.filterForm.value.customStop),this.appliedInterval="CUSTOM",this.loadData()}loadData(){this.updateURL();let t={};this.validStart&&(t.start=this.validStart.toISOString()),this.validStop&&(t.stop=this.validStop.toISOString()),this.filter&&(t.q=this.filter),this.queue&&(t.queue=this.queue),this.dataSource.loadEntries(t).catch(o=>this.messageService.showError(o))}loadMoreData(){let t={};this.validStart&&(t.start=this.validStart.toISOString()),this.filter&&(t.q=this.filter),this.queue&&(t.queue=this.queue),this.dataSource.loadMoreData(t).catch(o=>this.messageService.showError(o))}showResend(){return this.config.tc&&this.user.hasAnyObjectPrivilegeOfType("Command")}showCommandExports(){return this.config.commandExports}updateURL(){this.router.navigate([],{replaceUrl:!0,relativeTo:this.route,queryParams:{filter:this.filter||null,queue:this.queue||null,interval:this.appliedInterval,customStart:this.appliedInterval==="CUSTOM"?this.filterForm.value.customStart:null,customStop:this.appliedInterval==="CUSTOM"?this.filterForm.value.customStop:null},queryParamsHandling:"merge"})}copyHex(t){let o=O.convertBase64ToHex(t.binary);this.clipboard.copy(o)}copyBinary(t){let o=window.atob(t.binary);this.clipboard.copy(o)}selectRecord(t){this.selectedRecord$.next(t)}printReport(){let t=this.dataSource.records$.value.slice().reverse();this.printService.printComponent(vo,"Command Report",t)}exportCsv(){this.dialog.open(So,{width:"400px",data:{start:this.validStart,stop:this.validStop,q:this.filter}})}ngOnDestroy(){this.subscriptions.forEach(t=>t.unsubscribe())}};i.\u0275fac=function(o){return new(o||i)(y(U),y(Oe),y(tt),y(et),y(ke),y(Ne),y(mo),y(we),y(ei),y(Fi),y(Je))},i.\u0275cmp=w({type:i,selectors:[["ng-component"]],viewQuery:function(o,a){if(o&1&&(z(Pr,5),z(lt,5)),o&2){let c;J(c=K())&&(a.intervalSelect=c.first),J(c=K())&&(a.columnChooser=c.first)}},standalone:!0,features:[k],decls:16,vars:10,consts:[["columnChooser",""],["exportMenu","matMenu"],["intervalSelect",""],["args",""],["rv",""],["mat-button","","color","primary"],["mat-button","","matTooltip","Pause streaming commands","color","primary"],["mat-button","","matTooltip","Jump to now","color","primary",1,"icon",3,"click"],[1,"table-wrapper"],[1,"panel-content"],["mat-button","","color","primary",3,"click"],["mat-button","","matTooltip","Pause streaming commands","color","primary",3,"click"],[2,"padding","0 16px"],[3,"command"],[1,"ya-button",3,"routerLink","queryParams"],[3,"formGroup"],[1,"filter-bar"],["formControlName","filter","placeholder","Filter by text search"],["preferenceKey","cmdhist",3,"columns"],[2,"flex","1 1 auto"],[1,"ya-button","primary",2,"margin-right","0",3,"matMenuTriggerFor","disabled"],["overlapTrigger","false","xPosition","before",1,"ya-menu"],["mat-menu-item","","matTooltip","Print preview with one page per command","matTooltipPosition","right",3,"click"],["mat-menu-item","","matTooltip","Command table, one row per command","matTooltipPosition","right",3,"click"],["formControlName","queue",3,"options"],["icon","access_time","formControlName","interval",3,"options"],[1,"ya-button"],[2,"text-align","right","flex","1 1 150px"],[1,"table-status"],[1,"toggles"],["preferenceKey","cmdhist.arguments"],["preferenceKey","cmdhist.returnValue"],["mat-table","","multiTemplateDataRows","",1,"ya-data-table","expand","nohover",3,"dataSource"],["matColumnDef","commandId"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","generationTime"],["matColumnDef","comment"],["mat-header-cell","","class","iconcol",4,"matHeaderCellDef"],["mat-cell","","class","iconcol",4,"matCellDef"],["matColumnDef","command"],[3,"matColumnDef"],["matColumnDef","issuer"],["matColumnDef","queue"],["matColumnDef","sequenceNumber"],["matColumnDef","queued"],["mat-header-cell","","class","iconcol dense","style","text-align: center","matTooltip","Command queued",4,"matHeaderCellDef"],["mat-cell","","class","iconcol dense","style","text-align: center",4,"matCellDef"],["matColumnDef","released"],["mat-header-cell","","class","iconcol dense","style","text-align: center","matTooltip","Command released",4,"matHeaderCellDef"],["matColumnDef","sent"],["mat-header-cell","","class","iconcol dense","style","text-align: center","matTooltip","Command sent",4,"matHeaderCellDef"],["matColumnDef","acknowledgments"],["mat-header-cell","","class","dense",4,"matHeaderCellDef"],["mat-cell","","class","dense",4,"matCellDef"],["matColumnDef","completion"],["mat-header-cell","","style","padding-left: 8px",4,"matHeaderCellDef"],["mat-cell","","class","completion","style","text-align: center; padding-left: 8px",4,"matCellDef"],["matColumnDef","actions"],["mat-header-cell","","class","expand",4,"matHeaderCellDef"],["matColumnDef","detail"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","","class","item-row",3,"expanded","selected","success","failed","click",4,"matRowDef","matRowDefColumns"],["mat-row","","class","item-detail",3,"expanded","click",4,"matRowDef","matRowDefColumns"],[1,"ya-button",3,"click","disabled"],["formControlName","customStart"],["formControlName","customStop"],[1,"ya-button",3,"click"],["fontSize","16px","color","#1b61b9"],["mat-header-cell",""],["mat-cell",""],[3,"routerLink","queryParams"],["mat-header-cell","",1,"iconcol"],["matTooltip","Comment",1,"icon16"],["mat-cell","",1,"iconcol"],[1,"icon16",3,"matTooltip"],[3,"text","term"],["mat-header-cell","","matTooltip","Command queued",1,"iconcol","dense",2,"text-align","center"],["mat-cell","",1,"iconcol","dense",2,"text-align","center"],[2,"display","flex","align-items","center"],[3,"ack"],["mat-header-cell","","matTooltip","Command released",1,"iconcol","dense",2,"text-align","center"],["mat-header-cell","","matTooltip","Command sent",1,"iconcol","dense",2,"text-align","center"],["mat-header-cell","",1,"dense"],["mat-cell","",1,"dense"],["mat-header-cell","",2,"padding-left","8px"],["mat-cell","",1,"completion",2,"text-align","center","padding-left","8px"],[3,"matTooltip"],["mat-header-cell","",1,"expand"],["mat-menu-item","",3,"click"],["mat-menu-item","",3,"routerLink","queryParams"],[3,"link"],[2,"display","flex"],[2,"min-width","300px"],[1,"block-title",2,"padding-top","0"],[1,"block"],[3,"command","nomargin"],[1,"block","no-print",2,"margin-top","4px"],[3,"base64String"],[1,"block","print-only"],[2,"margin","0","line-height","1em"],[2,"margin","0","margin-top","4px","line-height","1em"],["mat-header-row",""],["mat-row","",1,"item-row",3,"click"],["mat-row","",1,"item-detail",3,"click"]],template:function(o,a){if(o&1&&(r(0,"app-instance-page")(1,"app-instance-toolbar"),m(2," Command history \xA0\xA0\xA0 "),u(3,Lr,4,0,"button",5),h(4,"async"),u(5,Rr,4,0,"button",6),h(6,"async"),r(7,"button",7),v("click",function(){return a.jumpToNow()}),r(8,"mat-icon"),m(9,"refresh"),l()()(),r(10,"ya-detail-pane"),u(11,Hr,7,2),h(12,"async"),u(13,qr,2,0,"ya-detail-toolbar"),l(),r(14,"div",8),u(15,tm,93,26,"div",9),l()()),o&2){let c;s(3),_(g(4,4,a.dataSource.streaming$)?-1:3),s(2),_(g(6,6,a.dataSource.streaming$)?5:-1),s(6),_((c=g(12,8,a.selectedRecord$))?11:13,c),s(4),_(a.dataSource?15:-1)}},dependencies:[ii,Zi,$t,bo,Ki,Te,be,D,Q,re,$,ie,ne,Z,$e,ht,oe,We,_t,Ye,Ct,ge,Ae,He,Fe,Ie,qe,xe,ye,ve,Se,Et,Ee,lt,Xe,Ri,Bi,Hi,Zn,Jt,At,Ft,Ze,no,Kt,Pe,Wi,Ot,tn],styles:[".table-wrapper[_ngcontent-%COMP%]{position:relative;overflow:auto;height:100%}.table-status[_ngcontent-%COMP%]{background-color:var(--y-background-color);height:24px;line-height:24px;font-size:12px;padding-left:6px}.table-status[_ngcontent-%COMP%]   .toggles[_ngcontent-%COMP%]{float:right;height:24px;line-height:24px;font-size:12px;padding-right:6px}.mat-mdc-row[_ngcontent-%COMP%]{cursor:pointer}tr.failed[_ngcontent-%COMP%]   td[_ngcontent-%COMP%], tr.failed[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:red}tr.success[_ngcontent-%COMP%]   td.completion[_ngcontent-%COMP%]{background-color:#e6ffed;color:#00c752}tr.failed[_ngcontent-%COMP%]   td.completion[_ngcontent-%COMP%]{background-color:#ffeef0;color:red}th.dense[_ngcontent-%COMP%], td.dense[_ngcontent-%COMP%]{width:1px;white-space:nowrap;padding-left:12px;padding-right:12px}tr.item-row.expanded[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{border-bottom:none}tr.item-detail[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding-left:40px!important}tr.item-detail[_ngcontent-%COMP%]:not(.expanded){display:none}"],changeDetection:0});let e=i;return e})();var im=e=>({c:e});function nm(e,i){if(e&1&&(r(0,"app-instance-page")(1,"app-instance-toolbar")(2,"a",0)(3,"mat-icon"),m(4,"arrow_back"),l()(),m(5),l(),r(6,"div",1),f(7,"app-command-detail2",2),l()()),e&2){let n=i,t=d();s(2),p("queryParams",ce(3,im,t.yamcs.context)),s(3),S(" Command history / ",n.id," "),s(2),p("command",n)}}var ko=(()=>{let i=class i{constructor(t,o){this.yamcs=o,this.command$=new P(null);let a=t.snapshot.paramMap.get("commandId");o.yamcsClient.getCommandHistoryEntry(o.instance,a).then(c=>{this.mergeEntry(c),this.commandSubscription=o.yamcsClient.createCommandSubscription({instance:o.instance,processor:o.processor,ignorePastCommands:!1},C=>{C.id===a&&this.mergeEntry(C)})})}mergeEntry(t){let o=this.command$.value;if(o){let a=o.mergeEntry(t);this.command$.next(a)}else this.command$.next(new ct(t))}ngOnDestroy(){this.commandSubscription?.cancel()}};i.\u0275fac=function(o){return new(o||i)(y(Ne),y(U))},i.\u0275cmp=w({type:i,selectors:[["ng-component"]],standalone:!0,features:[k],decls:2,vars:3,consts:[["mat-icon-button","","routerLink","..","color","primary",3,"queryParams"],[1,"panel-content"],[3,"command"]],template:function(o,a){if(o&1&&(u(0,nm,8,5,"app-instance-page"),h(1,"async")),o&2){let c;_((c=g(1,1,a.command$))?0:-1,c)}},dependencies:[$t,Te,be,D,Q,$e,Ii,oe],encapsulation:2,changeDetection:0});let e=i;return e})();var ai=(()=>{let i=class i{};i.\u0275fac=function(o){return new(o||i)},i.\u0275cmp=w({type:i,selectors:[["app-send-command-wizard-step"]],inputs:{step:"step"},standalone:!0,features:[k],decls:11,vars:6,consts:[[1,"sub"]],template:function(o,a){o&1&&(r(0,"mat-toolbar",0)(1,"mat-toolbar-row")(2,"span")(3,"span"),m(4,"1. Select command"),l(),m(5," \xA0\xA0\xA0\xA0\xA0\xA0\xA0 "),r(6,"span"),m(7,"2. Configure command"),l(),m(8," \xA0\xA0\xA0\xA0\xA0\xA0\xA0 "),r(9,"span"),m(10,"3. View report"),l()()()()),o&2&&(s(3),R("active",a.step==1),s(3),R("active",a.step==2),s(3),R("active",a.step==3))},dependencies:[D,Et,Ai],styles:["span[_ngcontent-%COMP%]{cursor:default}span[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{opacity:.3}span[_ngcontent-%COMP%]   span.active[_ngcontent-%COMP%]{opacity:1}mat-toolbar.sub[_ngcontent-%COMP%]{border-bottom:1px solid #d3d3d3;background-color:#fff;font-size:12px}.mat-toolbar-row[_ngcontent-%COMP%]{height:32px;padding:0 24px}.mat-toolbar-multiple-rows[_ngcontent-%COMP%]{min-height:32px}"],changeDetection:0});let e=i;return e})();var om=e=>({c:e}),am=(e,i)=>({c:e,template:i});function rm(e,i){if(e&1&&(r(0,"div",1),f(1,"app-command-detail2",2),M(2),f(3,"br")(4,"mat-divider")(5,"br"),r(6,"button",3),m(7," Send another command "),l(),m(8," \xA0\xA0 "),r(9,"button",4),m(10," Resend this command "),l(),I(),l()),e&2){let n=i,t=d();s(),p("command",n),s(5),p("queryParams",ce(4,om,t.yamcs.context)),s(3),p("routerLink","/commanding/send"+n.commandName)("queryParams",vt(6,am,t.yamcs.context,n.id))}}var Eo=(()=>{let i=class i{constructor(t,o){this.yamcs=t,this.title=o,this.qualifiedName=fi.required({alias:"command"}),this.commandId=fi.required(),this.command$=new P(null)}ngOnInit(){this.title.setTitle(this.qualifiedName());let t=this.commandId();this.commandSubscription=this.yamcs.yamcsClient.createCommandSubscription({instance:this.yamcs.instance,processor:this.yamcs.processor,ignorePastCommands:!1},o=>{o.id===t&&this.mergeEntry(o,!1)}),this.commandSubscription.addReplyListener(()=>{this.yamcs.yamcsClient.getCommandHistoryEntry(this.yamcs.instance,t).then(o=>{this.mergeEntry(o,!0)})})}mergeEntry(t,o){let a=this.command$.value;if(a){let c=a.mergeEntry(t,o);this.command$.next(c)}else this.command$.next(new ct(t))}ngOnDestroy(){this.commandSubscription?.cancel()}};i.\u0275fac=function(o){return new(o||i)(y(U),y(we))},i.\u0275cmp=w({type:i,selectors:[["ng-component"]],inputs:{qualifiedName:[1,"command","qualifiedName"],commandId:[1,"commandId"]},standalone:!0,features:[k],decls:6,vars:3,consts:[["step","3"],[1,"panel-content"],[3,"command"],["routerLink","/commanding/send",1,"ya-button",3,"queryParams"],[1,"ya-button",3,"routerLink","queryParams"]],template:function(o,a){if(o&1&&(r(0,"app-instance-page")(1,"app-instance-toolbar"),m(2," Send a command "),l(),f(3,"app-send-command-wizard-step",0),u(4,rm,11,9,"div",1),h(5,"async"),l()),o&2){let c;s(4),_((c=g(5,1,a.command$))?4:-1,c)}},dependencies:[$t,Te,be,ai,D,Q,$e,We],encapsulation:2,changeDetection:0});let e=i;return e})();var rn=(()=>{let i=class i{constructor(t,o){this.yamcs=t,this.synchronizer=o,this.result$=new P(null),this.dirty=!1}ngOnInit(){let o=new uo().compile("="+this.expression),a=o.getPVNames();if(a.length){let c=a.map(x=>({name:x})),C;this.subscription=this.yamcs.yamcsClient.createParameterSubscription({instance:this.yamcs.instance,processor:this.yamcs.processor,id:c,abortOnInvalid:!0,sendFromCache:!0,updateOnExpiration:!0,action:"REPLACE"},x=>{x.mapping&&(C=ae(ae({},C),x.mapping));for(let E of x.values||[])if(E.engValue){let V=C[E.numericId];o.updateDataSource(V.name,{value:O.convertValue(E.engValue),acquisitionStatus:E.acquisitionStatus})}if(this.result$.value===null){let E=o.execute();this.result$.next(E)}else this.dirty=!0})}else{let c=o.execute();this.result$.next(c)}this.syncSubscription=this.synchronizer.sync(()=>{if(this.dirty){let c=o.execute();this.result$.next(c),this.dirty=!1}})}ngOnDestroy(){this.subscription?.cancel(),this.syncSubscription?.unsubscribe()}};i.\u0275fac=function(o){return new(o||i)(y(U),y(ei))},i.\u0275cmp=w({type:i,selectors:[["app-live-expression"]],inputs:{expression:"expression"},standalone:!0,features:[k],decls:2,vars:3,template:function(o,a){o&1&&(m(0),h(1,"async")),o&2&&F(g(1,1,a.result$))},dependencies:[Q],encapsulation:2,changeDetection:0});let e=i;return e})();function lm(e,i){if(e&1&&(r(0,"div",3),m(1," bytes: "),f(2,"ya-interval",6),l()),e&2){let n=d();s(2),p("left",n.type.minBytes)("right",n.type.maxBytes)("singleValueIfEqual",!0)}}function mm(e,i){if(e&1&&(r(0,"ya-help"),m(1),l()),e&2){let n=d();s(),S(" ",n.description," ")}}var ri=(()=>{let i=class i{constructor(){this.formControl=new j,this.validators=[],this.onChange=t=>{},this.subscriptions=[]}ngOnInit(){this.subscriptions.push(this.formControl.valueChanges.subscribe(()=>{let t=this.formControl.value;this.onChange(t)})),this.index===void 0?this.controlName=this.name:this.controlName=String(this.index),this.type.minBytes!==0&&this.validators.push(W.required),this.validators.push(xt.requireHex),this.type.minBytes!==void 0&&this.validators.push(xt.minHexLengthValidator(this.type.minBytes)),this.type.maxBytes!==void 0&&this.validators.push(xt.maxHexLengthValidator(this.type.maxBytes))}get label(){return this.index!==void 0?O.unflattenIndex(this.index,this.dimensions).map(o=>"["+o+"]").join(""):this.name}writeValue(t){this.formControl.setValue(t)}registerOnChange(t){this.onChange=t}registerOnTouched(t){}validate(t){for(let o of this.validators){let a=o(t);if(a)return a}return null}ngOnDestroy(){this.subscriptions.forEach(t=>t.unsubscribe())}};i.\u0275fac=function(o){return new(o||i)},i.\u0275cmp=w({type:i,selectors:[["app-binary-argument"]],inputs:{name:"name",description:"description",type:"type",index:"index",dimensions:"dimensions"},standalone:!0,features:[de([{provide:Le,useExisting:se(()=>i),multi:!0},{provide:Ue,useExisting:se(()=>i),multi:!0}]),k],decls:12,vars:14,consts:[["err",""],[1,"label"],[1,"meta"],[1,"item"],[3,"controlName"],[3,"formControl"],[3,"left","right","singleValueIfEqual"]],template:function(o,a){if(o&1&&(r(0,"div",1)(1,"div",2),h(2,"async"),u(3,lm,3,3,"div",3),r(4,"div",3),h(5,"async"),m(6),l()(),m(7),u(8,mm,2,1,"ya-help"),f(9,"ya-errors",4,0)(11,"ya-binary-input",5),l()),o&2){let c=B(10);s(),R("error",g(2,10,c.invalid$)),s(2),_(a.type.minBytes!==void 0||a.type.maxBytes!==void 0?3:-1),s(),R("error",g(5,12,c.invalid$)),s(2),F(a.type.engType),s(),S(" ",a.label," "),s(),_(a.description?8:-1),s(),p("controlName",a.controlName),s(2),p("formControl",a.formControl)}},dependencies:[D,Q,$,_e,Kn,je,ee,yt],styles:[".meta[_ngcontent-%COMP%]{position:absolute;top:0;right:0;display:flex}.meta[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]{flex:none;background-color:#eee;font-weight:400;font-family:Roboto Mono,monospace;color:#000000a7;padding-left:2px;padding-right:2px;margin-left:10px}.meta.error[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]{background-color:#dc143c;color:#fff}.members[_ngcontent-%COMP%], .entries[_ngcontent-%COMP%]{margin-top:5px;padding-top:5px;padding-left:10px;border-left:1px solid rgba(0,0,0,.1)}.meta[_ngcontent-%COMP%]   .item.menu[_ngcontent-%COMP%]:hover{background-color:#009e97;color:#fff;cursor:pointer}",".ng-invalid[_nghost-%COMP%]:not(.ng-pristine)     input{border-color:#dc143c!important}.label[_ngcontent-%COMP%]{position:relative}"],changeDetection:0});let e=i;return e})();function sm(e,i){if(e&1&&(r(0,"div",3),f(1,"ya-interval",8),l()),e&2){let n=d();s(),p("left",n.type.rangeMin)("right",n.type.rangeMax)}}function cm(e,i){if(e&1&&(r(0,"div",3),m(1),h(2,"units"),l()),e&2){let n=d();s(),S(" ",g(2,1,n.type.unitSet)," ")}}function dm(e,i){e&1&&(r(0,"div",3),m(1,"unsigned"),l())}function pm(e,i){if(e&1&&(r(0,"ya-help"),m(1),l()),e&2){let n=d();s(),S(" ",n.description," ")}}var li=(()=>{let i=class i{constructor(){this.validators=[],this.onChange=t=>{},this.subscriptions=[],this.formGroup=new Qt({enabled:new Ut(null)})}ngOnInit(){this.subscriptions.push(this.formGroup.valueChanges.subscribe(()=>{let t=this.formGroup.get("enabled").value;this.onChange(t)})),this.index===void 0?this.controlName=this.name:this.controlName=String(this.index),this.validators.push(W.required)}get label(){return this.index!==void 0?O.unflattenIndex(this.index,this.dimensions).map(o=>"["+o+"]").join(""):this.name}writeValue(t){t==="true"?this.formGroup.setValue({enabled:"true"}):t==="false"&&this.formGroup.setValue({enabled:"false"})}registerOnChange(t){this.onChange=t}registerOnTouched(t){}validate(t){for(let o of this.validators){let a=o(t);if(a)return a}return null}ngOnDestroy(){this.subscriptions.forEach(t=>t.unsubscribe())}};i.\u0275fac=function(o){return new(o||i)},i.\u0275cmp=w({type:i,selectors:[["app-boolean-argument"]],inputs:{name:"name",description:"description",type:"type",index:"index",dimensions:"dimensions"},standalone:!0,features:[de([{provide:Le,useExisting:se(()=>i),multi:!0},{provide:Ue,useExisting:se(()=>i),multi:!0}]),k],decls:18,vars:14,consts:[["err",""],[1,"label"],[1,"meta"],[1,"item"],[3,"controlName"],[3,"formGroup"],["type","radio","formControlName","enabled","value","true"],["type","radio","formControlName","enabled","value","false"],[3,"left","right"]],template:function(o,a){if(o&1&&(r(0,"div",1)(1,"div",2),h(2,"async"),u(3,sm,2,2,"div",3)(4,cm,3,3,"div",3)(5,dm,2,0,"div",3),r(6,"div",3),m(7),l()(),m(8),u(9,pm,2,1,"ya-help"),f(10,"ya-errors",4,0)(12,"br"),M(13,5),f(14,"input",6),m(15),f(16,"input",7),m(17),I(),l()),o&2){let c=B(11);s(),R("error",g(2,12,c.invalid$)),s(2),_(a.type.rangeMin!==void 0||a.type.rangeMax!==void 0?3:-1),s(),_(a.type.unitSet?4:-1),s(),_(a.type.signed===!1?5:-1),s(2),F(a.type.engType),s(),S(" ",a.label," "),s(),_(a.description?9:-1),s(),p("controlName",a.controlName),s(3),p("formGroup",a.formGroup),s(2),S(" ",a.type.oneStringValue," "),s(2),S(" ",a.type.zeroStringValue," ")}},dependencies:[D,Q,pe,Gt,$,ie,ne,Z,je,ee,yt,Pt],styles:[".meta[_ngcontent-%COMP%]{position:absolute;top:0;right:0;display:flex}.meta[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]{flex:none;background-color:#eee;font-weight:400;font-family:Roboto Mono,monospace;color:#000000a7;padding-left:2px;padding-right:2px;margin-left:10px}.meta.error[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]{background-color:#dc143c;color:#fff}.members[_ngcontent-%COMP%], .entries[_ngcontent-%COMP%]{margin-top:5px;padding-top:5px;padding-left:10px;border-left:1px solid rgba(0,0,0,.1)}.meta[_ngcontent-%COMP%]   .item.menu[_ngcontent-%COMP%]:hover{background-color:#009e97;color:#fff;cursor:pointer}",".ng-invalid[_nghost-%COMP%]:not(.ng-pristine)     input{border-color:#dc143c!important}.label[_ngcontent-%COMP%]{position:relative}"],changeDetection:0});let e=i;return e})();function um(e,i){e&1&&(r(0,"th",17),m(1,"Value"),l())}function fm(e,i){if(e&1&&(r(0,"td",18),m(1),l()),e&2){let n=i.$implicit;s(),S(" ",n.value," ")}}function _m(e,i){e&1&&(r(0,"th",17),m(1,"Label"),l())}function Cm(e,i){if(e&1&&(r(0,"td",18)(1,"strong"),m(2),l()()),e&2){let n=i.$implicit;s(2),F(n.label)}}function hm(e,i){e&1&&(r(0,"th",17),m(1,"Hex value"),l())}function gm(e,i){if(e&1&&(r(0,"td",18),m(1),l()),e&2){let n=i.$implicit,t=d();s(),S(" ",t.toHex(n.value)," ")}}function xm(e,i){e&1&&f(0,"tr",19)}function ym(e,i){if(e&1){let n=A();r(0,"tr",20),v("click",function(){let o=b(n).$implicit,a=d();return T(a.selection.toggle(o))}),l()}if(e&2){let n=i.$implicit,t=d();R("selected",t.selection.isSelected(n))}}var Do=(()=>{let i=class i{constructor(t,o){this.dialogRef=t,this.data=o,this.filterControl=new j,this.dataSource=new Ke([]),this.selection=new ut,this.displayedColumns=["name","value"];let a=o.type,c=a.dataEncoding?.encoding==="UNSIGNED";this.dataSource.filterPredicate=(C,x)=>{let{label:E,value:V}=C;return E.toLowerCase().indexOf(x)>=0||String(V).indexOf(x)>=0||c&&Number(V).toString(16).indexOf(x)>=0},this.dataSource.data=a.enumValue||[],c&&this.displayedColumns.push("hex")}ngAfterViewInit(){this.filterControl.valueChanges.subscribe(()=>{let t=this.filterControl.value||"";this.dataSource.filter=t.toLowerCase()}),this.dataSource.paginator=this.paginator}selectNext(){let t=this.dataSource.filteredData,o=0;if(this.selection.hasValue()){let a=this.selection.selected[0];t.indexOf(a)!==-1&&(o=Math.min(t.indexOf(a)+1,t.length-1))}this.selection.select(t[o])}selectPrevious(){let t=this.dataSource.filteredData,o=0;if(this.selection.hasValue()){let a=this.selection.selected[0];t.indexOf(a)!==-1&&(o=Math.max(t.indexOf(a)-1,0))}this.selection.select(t[o])}toHex(t){return Number(t).toString(16)}applySelection(){let t=this.selection.selected;t.length&&this.dialogRef.close(t[0])}};i.\u0275fac=function(o){return new(o||i)(y(Ce),y(ze))},i.\u0275cmp=w({type:i,selectors:[["app-select-enumeration-dialog"]],viewQuery:function(o,a){if(o&1&&z(Be,7),o&2){let c;J(c=K())&&(a.paginator=c.first)}},standalone:!0,features:[k],decls:25,vars:8,consts:[["mat-dialog-title",""],[1,"filter-bar"],["width","100%",3,"onArrowDown","onArrowUp","onEnter","formControl"],[1,"scrollpane"],["mat-table","",1,"ya-data-table",2,"width","100%",3,"dataSource"],["cdkColumnDef","value"],["mat-header-cell","",4,"cdkHeaderCellDef"],["mat-cell","",4,"cdkCellDef"],["cdkColumnDef","name"],["cdkColumnDef","hex"],["mat-header-row","",4,"cdkHeaderRowDef"],["mat-row","",3,"selected","click",4,"cdkRowDef","cdkRowDefColumns"],["align","end"],[3,"pageSize","hidePageSize","showFirstLastButtons"],[2,"flex","1 1 auto"],["mat-dialog-close","",1,"ya-button"],[1,"ya-button","primary",3,"click","disabled"],["mat-header-cell",""],["mat-cell",""],["mat-header-row",""],["mat-row","",3,"click"]],template:function(o,a){o&1&&(r(0,"h2",0),m(1,"Select enumeration state"),l(),r(2,"mat-dialog-content")(3,"div",1)(4,"ya-search-filter",2),v("onArrowDown",function(){return a.selectNext()})("onArrowUp",function(){return a.selectPrevious()})("onEnter",function(){return a.applySelection()}),l()(),r(5,"div",3)(6,"table",4),M(7,5),u(8,um,2,0,"th",6)(9,fm,2,1,"td",7),I(),M(10,8),u(11,_m,2,0,"th",6)(12,Cm,3,1,"td",7),I(),M(13,9),u(14,hm,2,0,"th",6)(15,gm,2,1,"td",7),I(),u(16,xm,1,0,"tr",10)(17,ym,1,2,"tr",11),l()()(),r(18,"mat-dialog-actions",12),f(19,"mat-paginator",13)(20,"div",14),r(21,"button",15),m(22,"CANCEL"),l(),r(23,"button",16),v("click",function(){return a.applySelection()}),m(24," SELECT "),l()()),o&2&&(s(4),p("formControl",a.filterControl),s(2),p("dataSource",a.dataSource),s(10),p("cdkHeaderRowDef",a.displayedColumns),s(),p("cdkRowDefColumns",a.displayedColumns),s(2),p("pageSize",100)("hidePageSize",!0)("showFirstLastButtons",!0),s(4),p("disabled",a.selection.isEmpty()))},dependencies:[D,$,_e,Pi,gt,at,rt,Oi,he,Re,Me,De,Be,ge,xe,ye,ve,Se,Ft],styles:["td[_ngcontent-%COMP%]{cursor:pointer}.scrollpane[_ngcontent-%COMP%]{overflow:auto;height:200px}.filter-bar[_ngcontent-%COMP%]{display:block}"],changeDetection:0});let e=i;return e})();function vm(e,i){if(e&1&&(r(0,"ya-help"),m(1),l()),e&2){let n=d();s(),S(" ",n.description," ")}}var mi=(()=>{let i=class i{constructor(t){this.dialog=t,this.formControl=new j,this.selectOptions$=new P([]),this.validators=[],this.onChange=o=>{},this.subscriptions=[]}ngOnInit(){this.subscriptions.push(this.formControl.valueChanges.subscribe(()=>{let o=this.formControl.value;this.onChange(o)})),this.index===void 0?this.controlName=this.name:this.controlName=String(this.index);let t=[];for(let o of this.type.enumValue||[])t.push({id:o.label,label:o.label});this.selectOptions$.next(t),this.validators.push(W.required)}get label(){return this.index!==void 0?O.unflattenIndex(this.index,this.dimensions).map(o=>"["+o+"]").join(""):this.name}writeValue(t){this.formControl.setValue(t)}registerOnChange(t){this.onChange=t}registerOnTouched(t){}openSelectEnumerationDialog(){this.dialog.open(Do,{width:"600px",data:{type:this.type},panelClass:["no-padding-dialog"]}).afterClosed().subscribe(t=>{t&&this.writeValue(t.label)})}validate(t){for(let o of this.validators){let a=o(t);if(a)return a}return null}ngOnDestroy(){this.subscriptions.forEach(t=>t.unsubscribe())}};i.\u0275fac=function(o){return new(o||i)(y(Je))},i.\u0275cmp=w({type:i,selectors:[["app-enumeration-argument"]],inputs:{name:"name",description:"description",type:"type",index:"index",dimensions:"dimensions"},standalone:!0,features:[de([{provide:Le,useExisting:se(()=>i),multi:!0},{provide:Ue,useExisting:se(()=>i),multi:!0}]),k],decls:16,vars:12,consts:[["err",""],[1,"label"],[1,"meta"],[1,"item"],[3,"controlName"],[1,"control-group"],[3,"formControl","options"],["matTooltip","Lookup enumeration state",1,"ya-button",3,"click"]],template:function(o,a){if(o&1){let c=A();r(0,"div",1)(1,"div",2),h(2,"async"),r(3,"div",3),m(4),l()(),m(5),u(6,vm,2,1,"ya-help"),f(7,"ya-errors",4,0),r(9,"div",5),f(10,"ya-select",6),h(11,"async"),m(12,"\xA0 "),r(13,"button",7),v("click",function(){return b(c),T(a.openSelectEnumerationDialog())}),r(14,"mat-icon"),m(15,"search"),l()()()()}if(o&2){let c=B(8);s(),R("error",g(2,8,c.invalid$)),s(3),F(a.type.engType),s(),S(" ",a.label," "),s(),_(a.description?6:-1),s(),p("controlName",a.controlName),s(3),p("formControl",a.formControl)("options",g(11,10,a.selectOptions$))}},dependencies:[D,Q,$,_e,oe,Ee,je,ee,Ze],styles:[".meta[_ngcontent-%COMP%]{position:absolute;top:0;right:0;display:flex}.meta[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]{flex:none;background-color:#eee;font-weight:400;font-family:Roboto Mono,monospace;color:#000000a7;padding-left:2px;padding-right:2px;margin-left:10px}.meta.error[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]{background-color:#dc143c;color:#fff}.members[_ngcontent-%COMP%], .entries[_ngcontent-%COMP%]{margin-top:5px;padding-top:5px;padding-left:10px;border-left:1px solid rgba(0,0,0,.1)}.meta[_ngcontent-%COMP%]   .item.menu[_ngcontent-%COMP%]:hover{background-color:#009e97;color:#fff;cursor:pointer}",".label[_ngcontent-%COMP%]{position:relative}"],changeDetection:0});let e=i;return e})();function Sm(e,i){if(e&1&&(r(0,"div",3),f(1,"ya-interval",6),l()),e&2){let n=d();s(),p("left",n.type.rangeMin)("right",n.type.rangeMax)}}function bm(e,i){if(e&1&&(r(0,"div",3),m(1),h(2,"units"),l()),e&2){let n=d();s(),S(" ",g(2,1,n.type.unitSet)," ")}}function Tm(e,i){e&1&&(r(0,"div",3),m(1,"unsigned"),l())}function wm(e,i){if(e&1&&(r(0,"ya-help"),m(1),l()),e&2){let n=d();s(),S(" ",n.description," ")}}var si=(()=>{let i=class i{constructor(){this.formControl=new j,this.validators=[],this.onChange=t=>{},this.subscriptions=[]}ngOnInit(){this.subscriptions.push(this.formControl.valueChanges.subscribe(()=>{let t=this.formControl.value;this.onChange(t)})),this.index===void 0?this.controlName=this.name:this.controlName=String(this.index),this.validators.push(W.required),this.validators.push(xt.requireFloat),this.type.signed===!1&&this.validators.push(xt.requireUnsigned),this.type.rangeMax!==void 0&&this.validators.push(W.max(this.type.rangeMax)),this.type.rangeMin!==void 0&&this.validators.push(W.min(this.type.rangeMin))}get label(){return this.index!==void 0?O.unflattenIndex(this.index,this.dimensions).map(o=>"["+o+"]").join(""):this.name}writeValue(t){this.formControl.setValue(t)}registerOnChange(t){this.onChange=t}registerOnTouched(t){}validate(t){for(let o of this.validators){let a=o(t);if(a)return a}return null}ngOnDestroy(){this.subscriptions.forEach(t=>t.unsubscribe())}};i.\u0275fac=function(o){return new(o||i)},i.\u0275cmp=w({type:i,selectors:[["app-float-argument"]],inputs:{name:"name",description:"description",type:"type",index:"index",dimensions:"dimensions"},standalone:!0,features:[de([{provide:Le,useExisting:se(()=>i),multi:!0},{provide:Ue,useExisting:se(()=>i),multi:!0}]),k],decls:13,vars:12,consts:[["err",""],[1,"label"],[1,"meta"],[1,"item"],[3,"controlName"],["type","text","autocomplete","off",3,"formControl"],[3,"left","right"]],template:function(o,a){if(o&1&&(r(0,"div",1)(1,"div",2),h(2,"async"),u(3,Sm,2,2,"div",3)(4,bm,3,3,"div",3)(5,Tm,2,0,"div",3),r(6,"div",3),m(7),l()(),m(8),u(9,wm,2,1,"ya-help"),f(10,"ya-errors",4,0)(12,"input",5),l()),o&2){let c=B(11);s(),R("error",g(2,10,c.invalid$)),s(2),_(a.type.rangeMin!==void 0||a.type.rangeMax!==void 0?3:-1),s(),_(a.type.unitSet?4:-1),s(),_(a.type.signed===!1?5:-1),s(2),F(a.type.engType),s(),S(" ",a.label," "),s(),_(a.description?9:-1),s(),p("controlName",a.controlName),s(2),p("formControl",a.formControl)}},dependencies:[D,Q,pe,$,_e,je,ee,yt,Pt],styles:[".meta[_ngcontent-%COMP%]{position:absolute;top:0;right:0;display:flex}.meta[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]{flex:none;background-color:#eee;font-weight:400;font-family:Roboto Mono,monospace;color:#000000a7;padding-left:2px;padding-right:2px;margin-left:10px}.meta.error[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]{background-color:#dc143c;color:#fff}.members[_ngcontent-%COMP%], .entries[_ngcontent-%COMP%]{margin-top:5px;padding-top:5px;padding-left:10px;border-left:1px solid rgba(0,0,0,.1)}.meta[_ngcontent-%COMP%]   .item.menu[_ngcontent-%COMP%]:hover{background-color:#009e97;color:#fff;cursor:pointer}",".ng-invalid[_nghost-%COMP%]:not(.ng-pristine)     input{border-color:#dc143c!important}.label[_ngcontent-%COMP%]{position:relative}"],changeDetection:0});let e=i;return e})();function km(e,i){if(e&1&&(r(0,"div",4),f(1,"ya-interval",11),l()),e&2){let n=d();s(),p("left",n.type.rangeMin)("right",n.type.rangeMax)}}function Em(e,i){if(e&1&&(r(0,"div",4),m(1),h(2,"units"),l()),e&2){let n=d();s(),S(" ",g(2,1,n.type.unitSet)," ")}}function Dm(e,i){e&1&&(r(0,"div",4),m(1,"unsigned"),l())}function Mm(e,i){if(e&1){let n=A();r(0,"div",12),v("click",function(o){return b(n),T(o.stopPropagation())}),m(1," \u2630 "),l()}if(e&2){d();let n=B(9);p("matMenuTriggerFor",n)}}function Im(e,i){if(e&1&&(r(0,"ya-help"),m(1),l()),e&2){let n=d();s(),S(" ",n.description," ")}}function Am(e,i){if(e&1&&f(0,"input",9),e&2){let n=d();p("formControl",n.formControl)}}function Fm(e,i){if(e&1&&f(0,"ya-hex-integer-input",10),e&2){let n=d();p("formControl",n.formControl)}}var ci=(()=>{let i=class i{constructor(){this.formControl=new j,this.validators=[],this.onChange=t=>{},this.subscriptions=[],this.hexToggle$=new P(!1)}ngOnInit(){this.subscriptions.push(this.formControl.valueChanges.subscribe(()=>{let t=this.formControl.value;t!==null&&this.hexToggle$.value&&(t=String(t)),this.onChange(t)})),this.index===void 0?this.controlName=this.name:this.controlName=String(this.index),this.validators.push(W.required),this.validators.push(xt.requireInteger),this.type.signed===!1&&this.validators.push(xt.requireUnsigned),this.type.rangeMax!==void 0&&this.validators.push(W.max(this.type.rangeMax)),this.type.rangeMin!==void 0&&this.validators.push(W.min(this.type.rangeMin))}get label(){return this.index!==void 0?O.unflattenIndex(this.index,this.dimensions).map(o=>"["+o+"]").join(""):this.name}writeValue(t){this.formControl.setValue(t)}registerOnChange(t){this.onChange=t}registerOnTouched(t){}setDisabledState(t){}validate(t){for(let o of this.validators){let a=o(t);if(a)return a}return null}ngOnDestroy(){this.subscriptions.forEach(t=>t.unsubscribe())}};i.\u0275fac=function(o){return new(o||i)},i.\u0275cmp=w({type:i,selectors:[["app-integer-argument"]],inputs:{name:"name",description:"description",type:"type",index:"index",dimensions:"dimensions"},standalone:!0,features:[de([{provide:Le,useExisting:se(()=>i),multi:!0},{provide:Ue,useExisting:se(()=>i),multi:!0}]),k],decls:29,vars:26,consts:[["argMenu","matMenu"],["err",""],[1,"label"],[1,"meta"],[1,"item"],[1,"ya-menu"],["mat-menu-item","",3,"click"],["matTooltip","Input options",1,"item","menu",3,"matMenuTriggerFor"],[3,"controlName"],["type","text","autocomplete","off",3,"formControl"],[3,"formControl"],[3,"left","right"],["matTooltip","Input options",1,"item","menu",3,"click","matMenuTriggerFor"]],template:function(o,a){if(o&1){let c=A();r(0,"div",2)(1,"div",3),h(2,"async"),u(3,km,2,2,"div",4)(4,Em,3,3,"div",4)(5,Dm,2,0,"div",4),r(6,"div",4),m(7),l(),r(8,"mat-menu",5,0)(10,"button",6),v("click",function(){return b(c),T(a.hexToggle$.next(!0))}),r(11,"mat-icon"),h(12,"async"),m(13,"check"),l(),m(14," Hex input "),l(),r(15,"button",6),v("click",function(){return b(c),T(a.hexToggle$.next(!1))}),r(16,"mat-icon"),h(17,"async"),m(18,"check"),l(),m(19," Decimal input "),l()(),u(20,Mm,2,1,"div",7),l(),m(21),u(22,Im,2,1,"ya-help"),f(23,"ya-errors",8,1),u(25,Am,1,1,"input",9),h(26,"async"),u(27,Fm,1,1,"ya-hex-integer-input",10),h(28,"async"),l()}if(o&2){let c=B(24);s(),R("error",g(2,16,c.invalid$)),s(2),_(a.type.rangeMin!==void 0||a.type.rangeMax!==void 0?3:-1),s(),_(a.type.unitSet?4:-1),s(),_(a.type.signed===!1?5:-1),s(2),F(a.type.engType),s(4),st("visibility",g(12,18,a.hexToggle$)?"visible":"hidden"),s(5),st("visibility",g(17,20,a.hexToggle$)?"hidden":"visible"),s(4),_(a.type.signed===!1?20:-1),s(),S(" ",a.label," "),s(),_(a.description?22:-1),s(),p("controlName",a.controlName),s(2),_(g(26,22,a.hexToggle$)?-1:25),s(2),_(g(28,24,a.hexToggle$)?27:-1)}},dependencies:[D,Q,pe,$,_e,oe,_t,Ye,Ct,Ee,je,ee,eo,yt,Pt],styles:[".meta[_ngcontent-%COMP%]{position:absolute;top:0;right:0;display:flex}.meta[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]{flex:none;background-color:#eee;font-weight:400;font-family:Roboto Mono,monospace;color:#000000a7;padding-left:2px;padding-right:2px;margin-left:10px}.meta.error[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]{background-color:#dc143c;color:#fff}.members[_ngcontent-%COMP%], .entries[_ngcontent-%COMP%]{margin-top:5px;padding-top:5px;padding-left:10px;border-left:1px solid rgba(0,0,0,.1)}.meta[_ngcontent-%COMP%]   .item.menu[_ngcontent-%COMP%]:hover{background-color:#009e97;color:#fff;cursor:pointer}",".ng-invalid[_nghost-%COMP%]:not(.ng-pristine)     input{border-color:#dc143c!important}.label[_ngcontent-%COMP%]{position:relative}"],changeDetection:0});let e=i;return e})();function Om(e,i){if(e&1&&(r(0,"div",3),m(1," chars: "),f(2,"ya-interval",6),l()),e&2){let n=d();s(2),p("left",n.type.minChars)("right",n.type.maxChars)("singleValueIfEqual",!0)}}function Pm(e,i){if(e&1&&(r(0,"div",3),m(1),h(2,"units"),l()),e&2){let n=d();s(),S(" ",g(2,1,n.type.unitSet)," ")}}function Vm(e,i){if(e&1&&(r(0,"ya-help"),m(1),l()),e&2){let n=d();s(),S(" ",n.description," ")}}var di=(()=>{let i=class i{constructor(){this.formControl=new j,this.validators=[],this.onChange=t=>{},this.subscriptions=[]}ngOnInit(){this.subscriptions.push(this.formControl.valueChanges.subscribe(()=>{let t=this.formControl.value;this.onChange(t)})),this.index===void 0?this.controlName=this.name:this.controlName=String(this.index),this.type.minChars!==void 0&&this.type.minChars!==0&&this.validators.push(W.required),this.type.minChars!==void 0&&this.validators.push(W.minLength(this.type.minChars)),this.type.maxChars!==void 0&&this.validators.push(W.maxLength(this.type.maxChars))}get label(){return this.index!==void 0?O.unflattenIndex(this.index,this.dimensions).map(o=>"["+o+"]").join(""):this.name}writeValue(t){this.formControl.setValue(t)}registerOnChange(t){this.onChange=t}registerOnTouched(t){}validate(t){for(let o of this.validators){let a=o(t);if(a)return a}return null}ngOnDestroy(){this.subscriptions.forEach(t=>t.unsubscribe())}};i.\u0275fac=function(o){return new(o||i)},i.\u0275cmp=w({type:i,selectors:[["app-string-argument"]],inputs:{name:"name",description:"description",type:"type",index:"index",dimensions:"dimensions"},standalone:!0,features:[de([{provide:Le,useExisting:se(()=>i),multi:!0},{provide:Ue,useExisting:se(()=>i),multi:!0}]),k],decls:12,vars:11,consts:[["err",""],[1,"label"],[1,"meta"],[1,"item"],[3,"controlName"],["type","text","autocomplete","off",3,"formControl"],[3,"left","right","singleValueIfEqual"]],template:function(o,a){if(o&1&&(r(0,"div",1)(1,"div",2),h(2,"async"),u(3,Om,3,3,"div",3)(4,Pm,3,3,"div",3),r(5,"div",3),m(6),l()(),m(7),u(8,Vm,2,1,"ya-help"),f(9,"ya-errors",4,0)(11,"input",5),l()),o&2){let c=B(10);s(),R("error",g(2,9,c.invalid$)),s(2),_(a.type.minChars!==void 0||a.type.maxChars!==void 0?3:-1),s(),_(a.type.unitSet?4:-1),s(2),F(a.type.engType),s(),S(" ",a.label," "),s(),_(a.description?8:-1),s(),p("controlName",a.controlName),s(2),p("formControl",a.formControl)}},dependencies:[D,Q,pe,$,_e,je,ee,yt,Pt],styles:[".meta[_ngcontent-%COMP%]{position:absolute;top:0;right:0;display:flex}.meta[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]{flex:none;background-color:#eee;font-weight:400;font-family:Roboto Mono,monospace;color:#000000a7;padding-left:2px;padding-right:2px;margin-left:10px}.meta.error[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]{background-color:#dc143c;color:#fff}.members[_ngcontent-%COMP%], .entries[_ngcontent-%COMP%]{margin-top:5px;padding-top:5px;padding-left:10px;border-left:1px solid rgba(0,0,0,.1)}.meta[_ngcontent-%COMP%]   .item.menu[_ngcontent-%COMP%]:hover{background-color:#009e97;color:#fff;cursor:pointer}",".ng-invalid[_nghost-%COMP%]:not(.ng-pristine)     input{border-color:#dc143c!important}.label[_ngcontent-%COMP%]{position:relative}"],changeDetection:0});let e=i;return e})();function Nm(e,i){if(e&1&&(r(0,"ya-help"),m(1),l()),e&2){let n=d();s(),S(" ",n.description," ")}}var pi=(()=>{let i=class i{constructor(){this.formControl=new j,this.validators=[],this.onChange=t=>{},this.subscriptions=[]}ngOnInit(){this.subscriptions.push(this.formControl.valueChanges.subscribe(()=>{let t=this.formControl.value;this.onChange(t)})),this.index===void 0?this.controlName=this.name:this.controlName=String(this.index),this.validators.push(W.required)}get label(){return this.index!==void 0?O.unflattenIndex(this.index,this.dimensions).map(o=>"["+o+"]").join(""):this.name}writeValue(t){this.formControl.setValue(t)}registerOnChange(t){this.onChange=t}registerOnTouched(t){}validate(t){for(let o of this.validators){let a=o(t);if(a)return a}return this.formControl.errors}ngOnDestroy(){this.subscriptions.forEach(t=>t.unsubscribe())}};i.\u0275fac=function(o){return new(o||i)},i.\u0275cmp=w({type:i,selectors:[["app-time-argument"]],inputs:{name:"name",description:"description",type:"type",index:"index",dimensions:"dimensions"},standalone:!0,features:[de([{provide:Le,useExisting:se(()=>i),multi:!0},{provide:Ue,useExisting:se(()=>i),multi:!0}]),k],decls:10,vars:10,consts:[["err",""],[1,"label"],[1,"meta"],[1,"item"],[3,"controlName"],[3,"formControl","showMillis"]],template:function(o,a){if(o&1&&(r(0,"div",1)(1,"div",2),h(2,"async"),r(3,"div",3),m(4),l()(),m(5),u(6,Nm,2,1,"ya-help"),f(7,"ya-errors",4,0)(9,"ya-date-time-input",5),l()),o&2){let c=B(8);s(),R("error",g(2,8,c.invalid$)),s(3),F(a.type.engType),s(),S(" ",a.label," "),s(),_(a.description?6:-1),s(),p("controlName",a.controlName),s(2),p("formControl",a.formControl)("showMillis",!0)}},dependencies:[D,Q,$,_e,Xe,je,ee],styles:[".meta[_ngcontent-%COMP%]{position:absolute;top:0;right:0;display:flex}.meta[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]{flex:none;background-color:#eee;font-weight:400;font-family:Roboto Mono,monospace;color:#000000a7;padding-left:2px;padding-right:2px;margin-left:10px}.meta.error[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]{background-color:#dc143c;color:#fff}.members[_ngcontent-%COMP%], .entries[_ngcontent-%COMP%]{margin-top:5px;padding-top:5px;padding-left:10px;border-left:1px solid rgba(0,0,0,.1)}.meta[_ngcontent-%COMP%]   .item.menu[_ngcontent-%COMP%]:hover{background-color:#009e97;color:#fff;cursor:pointer}",".ng-invalid[_nghost-%COMP%]:not(.ng-pristine)     input{border-color:#dc143c!important}.label[_ngcontent-%COMP%]{position:relative}"],changeDetection:0});let e=i;return e})();function $m(e,i){if(e&1&&(r(0,"ya-help"),m(1),l()),e&2){let n=d();s(),S(" ",n.description," ")}}function Lm(e,i){if(e&1&&f(0,"app-aggregate-argument",6),e&2){let n=d().$index,t=d();p("name",t.name)("type",t.type.elementType)("index",n)("dimensions",t.ownDimensions)("initialValue",t.entryInitialValues[n])}}function Rm(e,i){if(e&1&&f(0,"app-binary-argument",7),e&2){let n=d().$index,t=d();p("name",t.name)("type",t.type.elementType)("index",n)("dimensions",t.ownDimensions)("formControlName",n)}}function Bm(e,i){if(e&1&&f(0,"app-boolean-argument",7),e&2){let n=d().$index,t=d();p("name",t.name)("type",t.type.elementType)("index",n)("dimensions",t.ownDimensions)("formControlName",n)}}function Hm(e,i){if(e&1&&f(0,"app-enumeration-argument",7),e&2){let n=d().$index,t=d();p("name",t.name)("type",t.type.elementType)("index",n)("dimensions",t.ownDimensions)("formControlName",n)}}function qm(e,i){if(e&1&&f(0,"app-float-argument",7),e&2){let n=d().$index,t=d();p("name",t.name)("type",t.type.elementType)("index",n)("dimensions",t.ownDimensions)("formControlName",n)}}function jm(e,i){if(e&1&&f(0,"app-integer-argument",7),e&2){let n=d().$index,t=d();p("name",t.name)("type",t.type.elementType)("index",n)("dimensions",t.ownDimensions)("formControlName",n)}}function Qm(e,i){if(e&1&&f(0,"app-string-argument",7),e&2){let n=d().$index,t=d();p("name",t.name)("type",t.type.elementType)("index",n)("dimensions",t.ownDimensions)("formControlName",n)}}function Um(e,i){if(e&1&&f(0,"app-time-argument",7),e&2){let n=d().$index,t=d();p("name",t.name)("type",t.type.elementType)("index",n)("dimensions",t.ownDimensions)("formControlName",n)}}function Gm(e,i){if(e&1&&f(0,"app-array-argument",6),e&2){let n=d().$index,t=d();p("name",n)("type",t.type.elementType)("index",n)("dimensions",t.ownDimensions)("initialValue",t.entryInitialValues[n])}}function Ym(e,i){if(e&1&&(u(0,Lm,1,5,"app-aggregate-argument",6)(1,Rm,1,5,"app-binary-argument",7)(2,Bm,1,5,"app-boolean-argument",7)(3,Hm,1,5,"app-enumeration-argument",7)(4,qm,1,5,"app-float-argument",7)(5,jm,1,5,"app-integer-argument",7)(6,Qm,1,5,"app-string-argument",7)(7,Um,1,5,"app-time-argument",7)(8,Gm,1,5,"app-array-argument",6),f(9,"br")),e&2){let n,t=d();_((n=t.type.elementType.engType)==="aggregate"?0:n==="binary"?1:n==="boolean"?2:n==="enumeration"?3:n==="float"?4:n==="integer"?5:n==="string"?6:n==="time"?7:n===(t.type.elementType.engType.endsWith("[]")?t.type.elementType.engType:"")?8:-1)}}var ln=(()=>{let i=class i{constructor(t,o,a){this.formGroupName=t,this.yamcs=o,this.formArrayName=a,this.ownDimensions=[],this.engType$=new P(null),this.arrayLength$=new P(0),this.formArray=new _n([]),this.entryInitialValues=[],this.subscriptions=[],this.pvalCache={},this.topLevelForm.valueChanges.subscribe(()=>{this.updateOwnDimensions(),this.formArray.updateValueAndValidity({onlySelf:!0})}),this.topLevelForm.statusChanges.subscribe(()=>{this.updateOwnDimensions(),this.formArray.updateValueAndValidity({onlySelf:!0})})}get topLevelForm(){return this.formGroupName.formDirective}ngOnInit(){this.formGroupName.control.addControl(this.name,this.formArray),this.updateOwnDimensions();let o=this.type.dimensions.filter(c=>c.parameter!==void 0).map(c=>c.parameter.qualifiedName);if(o=[...new Set(o)],o.length){let c=o.map(x=>({name:x})),C;this.parameterSubscription=this.yamcs.yamcsClient.createParameterSubscription({instance:this.yamcs.instance,processor:this.yamcs.processor,id:c,abortOnInvalid:!1,sendFromCache:!0,updateOnExpiration:!1,action:"REPLACE"},x=>{x.mapping&&(C=ae(ae({},C),x.mapping));for(let E of x.values||[])if(E.engValue){let V=C[E.numericId];this.pvalCache[V.name]=O.convertValue(E.engValue),this.updateOwnDimensions()}})}this.formArray.addValidators(()=>{for(let c=0;c<this.ownDimensions.length;c++){let C=this.ownDimensions[c],x=this.type.dimensions[c];if(C!==void 0&&C<0)return{invalidDimension:{dimension:C}};if(x.argument){if(C===void 0)return{argumentRequired:{name:x.argument}}}else if(x.parameter&&C===void 0)return{parameterRequired:{qualifiedName:x.parameter.qualifiedName,name:x.parameter.name}}}return null}),this.formArray.updateValueAndValidity(),this.initialValue?.length===this.arrayLength$.value&&(this.entryInitialValues=[...this.initialValue]);let a=!0;this.subscriptions.push(this.arrayLength$.pipe(In()).subscribe(c=>{this.formArray.clear();for(let C=0;C<c;C++)if(!this.type.elementType.engType.endsWith("[]")&&this.type.elementType.engType!=="aggregate"){let x=a?this.entryInitialValues[C]??"":"";this.formArray.setControl(C,new Ut(x))}else this.type.elementType.engType==="aggregate"?this.formArray.setControl(C,new ft({})):this.formArray.setControl(C,new _n([]))})),a=!1}get label(){return this.index!==void 0?O.unflattenIndex(this.index,this.dimensions).map(o=>"["+o+"]").join(""):this.name}updateEngType(){let t=this.type.elementType.engType;t.endsWith("[]")&&(t="array");for(let o of this.ownDimensions)t+=o!==void 0?`[${o}]`:"[?]";this.engType$.next(t)}updateOwnDimensions(){let{dimensions:t}=this.type;if(t){let o=[];for(let c of t)if(c.fixedValue!==void 0)o.push(Number(c.fixedValue));else if(c.argument){let C=this.findClosestControl(c.argument);if(C?.valid&&C.value!==""){let x=Number(C.value);if(isNaN(x))o.push(void 0);else{let E=x*Number(c.slope);E+=Number(c.intercept),o.push(E)}}else o.push(void 0)}else if(c.parameter){let C=this.pvalCache[c.parameter.qualifiedName];if(C!==void 0){let x=Number(C);if(isNaN(x))o.push(void 0);else{let E=x*Number(c.slope);E+=Number(c.intercept),o.push(E)}}else o.push(void 0)}else o.push(void 0);this.ownDimensions=o,this.updateEngType();let a=1;for(let c of this.ownDimensions)if(c===void 0){a=0;break}else a*=c;this.arrayLength$.next(a)}}findClosestControl(t){let o=this.formGroupName.control;for(;o&&o!==this.topLevelForm.control;){if(o instanceof Qt&&t in o.controls)return o.controls[t];o=o.parent}}ngOnDestroy(){this.parameterSubscription?.cancel(),this.subscriptions.forEach(t=>t.unsubscribe())}};i.\u0275fac=function(o){return new(o||i)(y(nt),y(U),y(St,8))},i.\u0275cmp=w({type:i,selectors:[["app-array-argument"]],inputs:{name:"name",description:"description",type:"type",index:"index",dimensions:"dimensions",initialValue:"initialValue"},standalone:!0,features:[de([],[{provide:jt,useFactory:(t,o)=>t||o,deps:[[new vi,new yi,St],nt]}]),k],decls:13,vars:11,consts:[["err",""],[1,"label"],[3,"controlName"],[1,"meta"],[1,"item"],[1,"entries",3,"formArrayName"],[3,"name","type","index","dimensions","initialValue"],[3,"name","type","index","dimensions","formControlName"]],template:function(o,a){if(o&1&&(r(0,"div",1),m(1),u(2,$m,2,1,"ya-help"),f(3,"ya-errors",2,0),r(5,"div",3),h(6,"async"),r(7,"div",4),m(8),h(9,"async"),l()(),r(10,"div",5),H(11,Ym,10,1,"br",null,G),l()()),o&2){let c=B(4);s(),S(" ",a.label," "),s(),_(a.description?2:-1),s(),p("controlName",a.name),s(2),R("error",g(6,7,c.invalid$)),s(3),F(g(9,9,a.engType$)),s(2),p("formArrayName",a.name),s(),q(a.formArray.controls)}},dependencies:[i,mn,ri,li,mi,si,ci,D,Q,$,ie,Z,St,je,ee,di,pi],styles:[".meta[_ngcontent-%COMP%]{position:absolute;top:0;right:0;display:flex}.meta[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]{flex:none;background-color:#eee;font-weight:400;font-family:Roboto Mono,monospace;color:#000000a7;padding-left:2px;padding-right:2px;margin-left:10px}.meta.error[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]{background-color:#dc143c;color:#fff}.members[_ngcontent-%COMP%], .entries[_ngcontent-%COMP%]{margin-top:5px;padding-top:5px;padding-left:10px;border-left:1px solid rgba(0,0,0,.1)}.meta[_ngcontent-%COMP%]   .item.menu[_ngcontent-%COMP%]:hover{background-color:#009e97;color:#fff;cursor:pointer}",".label[_ngcontent-%COMP%]{position:relative}"],changeDetection:0});let e=i;return e})();function Wm(e,i){if(e&1&&(r(0,"ya-help"),m(1),l()),e&2){let n=d();s(),S(" ",n.description," ")}}function zm(e,i){if(e&1&&f(0,"app-aggregate-argument",5),e&2){let n=d(),t=n.$implicit,o=n.$index,a=d();p("name",t.name)("type",t.type)("description",t.shortDescription)("initialValue",a.memberInitialValues[o])}}function Jm(e,i){if(e&1&&f(0,"app-binary-argument",6),e&2){let n=d().$implicit;p("name",n.name)("type",n.type)("description",n.shortDescription)("formControlName",n.name)}}function Km(e,i){if(e&1&&f(0,"app-boolean-argument",6),e&2){let n=d().$implicit;p("name",n.name)("type",n.type)("description",n.shortDescription)("formControlName",n.name)}}function Xm(e,i){if(e&1&&f(0,"app-enumeration-argument",6),e&2){let n=d().$implicit;p("name",n.name)("type",n.type)("description",n.shortDescription)("formControlName",n.name)}}function Zm(e,i){if(e&1&&f(0,"app-float-argument",6),e&2){let n=d().$implicit;p("name",n.name)("type",n.type)("description",n.shortDescription)("formControlName",n.name)}}function es(e,i){if(e&1&&f(0,"app-integer-argument",6),e&2){let n=d().$implicit;p("name",n.name)("type",n.type)("description",n.shortDescription)("formControlName",n.name)}}function ts(e,i){if(e&1&&f(0,"app-string-argument",6),e&2){let n=d().$implicit;p("name",n.name)("type",n.type)("description",n.shortDescription)("formControlName",n.name)}}function is(e,i){if(e&1&&f(0,"app-time-argument",6),e&2){let n=d().$implicit;p("name",n.name)("type",n.type)("description",n.shortDescription)("formControlName",n.name)}}function ns(e,i){if(e&1&&f(0,"app-array-argument",5),e&2){let n=d(),t=n.$implicit,o=n.$index,a=d();p("name",t.name)("type",t.type)("description",t.shortDescription)("initialValue",a.memberInitialValues[o])}}function os(e,i){if(e&1&&(r(0,"div"),u(1,zm,1,4,"app-aggregate-argument",5)(2,Jm,1,4,"app-binary-argument",6)(3,Km,1,4,"app-boolean-argument",6)(4,Xm,1,4,"app-enumeration-argument",6)(5,Zm,1,4,"app-float-argument",6)(6,es,1,4,"app-integer-argument",6)(7,ts,1,4,"app-string-argument",6)(8,is,1,4,"app-time-argument",6)(9,ns,1,4,"app-array-argument",5),l()),e&2){let n,t=i.$implicit,o=i.$index;st("padding-top",o===0?0:5,"px"),s(),_((n=t.type.engType)==="aggregate"?1:n==="binary"?2:n==="boolean"?3:n==="enumeration"?4:n==="float"?5:n==="integer"?6:n==="string"?7:n==="time"?8:n===(t.type.engType.endsWith("[]")?t.type.engType:"")?9:-1)}}var mn=(()=>{let i=class i{constructor(t,o){this.formGroupName=t,this.formArrayName=o,this.memberInitialValues=[]}ngOnInit(){let t=this.formGroupName.control,o;if(this.index===void 0)this.controlName=this.name,o=new Qt({}),t.setControl(this.name,o);else{this.controlName=String(this.index);let a=Number(this.index);o=t.controls[this.name].at(a)}for(let a of this.type.member||[]){let c;if(a.type.engType==="aggregate")c={},this.initialValue&&this.initialValue.hasOwnProperty(a.name)&&(c=this.initialValue[a.name]);else if(a.type.engType.endsWith("[]"))c=[],this.initialValue&&this.initialValue.hasOwnProperty(a.name)&&(c=this.initialValue[a.name]);else{c=a.initialValue??"",this.initialValue&&this.initialValue.hasOwnProperty(a.name)&&(c=this.initialValue[a.name]);let C=new j(c);o.setControl(a.name,C)}this.memberInitialValues.push(c)}}get label(){return this.index===void 0?this.name:O.unflattenIndex(this.index,this.dimensions).map(o=>"["+o+"]").join("")}};i.\u0275fac=function(o){return new(o||i)(y(nt),y(St,8))},i.\u0275cmp=w({type:i,selectors:[["app-aggregate-argument"]],inputs:{name:"name",description:"description",type:"type",index:"index",dimensions:"dimensions",initialValue:"initialValue"},standalone:!0,features:[de([],[{provide:jt,useFactory:(t,o)=>t||o,deps:[[new vi,new yi,St],nt]}]),k],decls:9,vars:3,consts:[[1,"label"],[1,"meta"],[1,"item"],[1,"members",3,"formGroupName"],[3,"paddingTop"],[3,"name","type","description","initialValue"],[3,"name","type","description","formControlName"]],template:function(o,a){o&1&&(r(0,"div",0)(1,"div",1)(2,"div",2),m(3,"aggregate"),l()(),m(4),u(5,Wm,2,1,"ya-help"),r(6,"div",3),H(7,os,10,3,"div",4,G),l()()),o&2&&(s(4),S(" ",a.label," "),s(),_(a.description?5:-1),s(),p("formGroupName",a.controlName),s(),q(a.type.member))},dependencies:[i,ln,ri,li,mi,si,ci,D,$,ie,Z,nt,ee,di,pi],styles:[".meta[_ngcontent-%COMP%]{position:absolute;top:0;right:0;display:flex}.meta[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]{flex:none;background-color:#eee;font-weight:400;font-family:Roboto Mono,monospace;color:#000000a7;padding-left:2px;padding-right:2px;margin-left:10px}.meta.error[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]{background-color:#dc143c;color:#fff}.members[_ngcontent-%COMP%], .entries[_ngcontent-%COMP%]{margin-top:5px;padding-top:5px;padding-left:10px;border-left:1px solid rgba(0,0,0,.1)}.meta[_ngcontent-%COMP%]   .item.menu[_ngcontent-%COMP%]:hover{background-color:#009e97;color:#fff;cursor:pointer}",".label[_ngcontent-%COMP%]{position:relative}"],changeDetection:0});let e=i;return e})();function as(e,i){if(e&1&&f(0,"app-aggregate-argument",0),e&2){let n=d();p("name",n.name)("description",n.description)("type",n.type)("initialValue",n.parsedInitialValue)}}function rs(e,i){if(e&1&&f(0,"app-binary-argument",1),e&2){let n=d();p("name",n.name)("description",n.description)("type",n.type)("formControlName",n.name)}}function ls(e,i){if(e&1&&f(0,"app-boolean-argument",1),e&2){let n=d();p("name",n.name)("description",n.description)("type",n.type)("formControlName",n.name)}}function ms(e,i){if(e&1&&f(0,"app-enumeration-argument",1),e&2){let n=d();p("name",n.name)("description",n.description)("type",n.type)("formControlName",n.name)}}function ss(e,i){if(e&1&&f(0,"app-float-argument",1),e&2){let n=d();p("name",n.name)("description",n.description)("type",n.type)("formControlName",n.name)}}function cs(e,i){if(e&1&&f(0,"app-integer-argument",1),e&2){let n=d();p("name",n.name)("description",n.description)("type",n.type)("formControlName",n.name)}}function ds(e,i){if(e&1&&f(0,"app-string-argument",1),e&2){let n=d();p("name",n.name)("description",n.description)("type",n.type)("formControlName",n.name)}}function ps(e,i){if(e&1&&f(0,"app-time-argument",1),e&2){let n=d();p("name",n.name)("description",n.description)("type",n.type)("formControlName",n.name)}}function us(e,i){if(e&1&&f(0,"app-array-argument",0),e&2){let n=d();p("name",n.name)("description",n.description)("type",n.type)("initialValue",n.parsedInitialValue)}}function Lt(e){switch(e.type){case"BOOLEAN":return""+e.booleanValue;case"FLOAT":return""+e.floatValue;case"DOUBLE":return""+e.doubleValue;case"UINT32":return""+e.uint32Value;case"SINT32":return""+e.sint32Value;case"BINARY":return O.convertBase64ToHex(e.binaryValue);case"ENUMERATED":case"STRING":case"TIMESTAMP":return e.stringValue;case"UINT64":return""+e.uint64Value;case"SINT64":return""+e.sint64Value;case"AGGREGATE":let{name:i,value:n}=e.aggregateValue,t={};for(let o=0;o<i.length;o++)t[i[o]]=Lt(n[o]);return t;case"ARRAY":return e.arrayValue.map(o=>Lt(o))}}function vn(e){if(Array.isArray(e))return e.map(i=>vn(i));if(typeof e=="object"){let i={};for(let n in e)i[n]=vn(e[n]);return i}else return""+e}var Mo=(()=>{let i=class i{ngOnInit(){if(this.initialValue&&(this.type.engType==="AGGREGATE"||this.type.engType==="ARRAY"?this.parsedInitialValue=vn(JSON.parse(this.initialValue)):this.type.engType==="BOOLEAN"?this.parsedInitialValue=""+(this.initialValue===this.type.oneStringValue):this.parsedInitialValue=this.initialValue),this.templateProvider){let t=this.templateProvider.getAssignment(this.name);t?.type==="AGGREGATE"?this.parsedInitialValue=ae(ae({},this.parsedInitialValue||{}),Lt(t)):t?.type==="ARRAY"&&(this.parsedInitialValue=Lt(t))}}};i.\u0275fac=function(o){return new(o||i)},i.\u0275cmp=w({type:i,selectors:[["app-argument"]],inputs:{name:"name",description:"description",type:"type",initialValue:"initialValue",templateProvider:"templateProvider"},standalone:!0,features:[de([],[{provide:jt,useExisting:nt}]),k],decls:9,vars:1,consts:[[3,"name","description","type","initialValue"],[3,"name","description","type","formControlName"]],template:function(o,a){if(o&1&&u(0,as,1,4,"app-aggregate-argument",0)(1,rs,1,4,"app-binary-argument",1)(2,ls,1,4,"app-boolean-argument",1)(3,ms,1,4,"app-enumeration-argument",1)(4,ss,1,4,"app-float-argument",1)(5,cs,1,4,"app-integer-argument",1)(6,ds,1,4,"app-string-argument",1)(7,ps,1,4,"app-time-argument",1)(8,us,1,4,"app-array-argument",0),o&2){let c;_((c=a.type.engType)==="aggregate"?0:c==="binary"?1:c==="boolean"?2:c==="enumeration"?3:c==="float"?4:c==="integer"?5:c==="string"?6:c==="time"?7:c===(a.type.engType.endsWith("[]")?a.type.engType:"")?8:-1)}},dependencies:[mn,ln,ri,li,mi,si,ci,D,$,Z,di,pi],encapsulation:2,changeDetection:0});let e=i;return e})();function fs(e,i){e&1&&f(0,"br")}function _s(e,i){if(e&1&&(u(0,fs,1,0,"br"),f(1,"app-argument",2)),e&2){let n=i.$implicit,t=i.$index,o=d();_(t!==0?0:-1),s(),p("name",n.name)("description",n.description)("type",n.type)("initialValue",n.initialValue)("templateProvider",o.templateProvider)}}function Cs(e,i){e&1&&f(0,"br",6)}function hs(e,i){if(e&1&&(u(0,Cs,1,0,"br",6),f(1,"app-argument",3)),e&2){let n=i.$implicit,t=i.$index,o=d();_(t!==0||o.arguments.length?0:-1),s(),p("name",n.name)("description",n.description)("type",n.type)("initialValue",n.initialValue)("templateProvider",o.templateProvider)}}function gs(e,i){e&1&&f(0,"br")}function xs(e,i){e&1&&m(0," argument ")}function ys(e,i){e&1&&m(0," arguments ")}function vs(e,i){if(e&1){let n=A();u(0,gs,1,0,"br"),r(1,"ya-text-action",8),v("click",function(){b(n);let o=d(2);return T(o.showAll$.next(!0))}),m(2),u(3,xs,1,0)(4,ys,1,0),m(5," with defaults "),l()}if(e&2){let n=d(2);_(n.arguments.length?0:-1),s(2),S(" Show ",n.argumentsWithInitial.length," "),s(),_(n.argumentsWithInitial.length===1?3:4)}}function Ss(e,i){if(e&1&&(u(0,vs,6,3,"ya-text-action",7),h(1,"async")),e&2){let n=d();_(n.argumentsWithInitial.length&&!g(1,1,n.showAll$)?0:-1)}}function bs(e,i){if(e&1&&(r(0,"ya-help",10),f(1,"div",13),l()),e&2){let n=d(2).$implicit;p("dialogTitle",n.verboseName||n.id),s(),p("innerHTML",n.help,Rt)}}function Ts(e,i){if(e&1&&(r(0,"div",9),m(1),u(2,bs,2,2,"ya-help",10),f(3,"br")(4,"input",11),m(5," true "),f(6,"input",12),m(7," false "),l()),e&2){let n=d().$implicit;s(),S(" ",n.verboseName||n.id," "),s(),_(n.help?2:-1),s(2),p("formControlName","extra__"+n.id),s(2),p("formControlName","extra__"+n.id)}}function ws(e,i){if(e&1&&(r(0,"ya-help",10),f(1,"div",13),l()),e&2){let n=d(2).$implicit;p("dialogTitle",n.verboseName||n.id),s(),p("innerHTML",n.help,Rt)}}function ks(e,i){if(e&1&&(r(0,"div",9),m(1),u(2,ws,2,2,"ya-help",10),f(3,"input",14),l()),e&2){let n=d().$implicit;s(),S(" ",n.verboseName||n.id," "),s(),_(n.help?2:-1),s(),p("formControlName","extra__"+n.id)}}function Es(e,i){if(e&1&&(u(0,Ts,8,4,"div",9)(1,ks,4,3,"div",9),f(2,"br")),e&2){let n,t=i.$implicit;_((n=t.type)==="BOOLEAN"?0:1)}}function Ds(e,i){if(e&1&&H(0,Es,3,1,"br",null,G),e&2){let n=d();q(n.commandOptions)}}var sn=(()=>{let i=class i{constructor(t,o,a){this.arguments=[],this.argumentsWithInitial=[],this.showAll$=new P(!1),this.hasArguments$=new P(!1),this.form=a.group({args:a.group({})}),this.user=o.getUser(),this.commandOptions=t.getCommandOptions(),this.form.addControl("comment",new Ut(""));for(let c of this.commandOptions)this.form.addControl("extra__"+c.id,new j(""));this.config=t.getConfig(),this.showAll$.next(!this.config.collapseInitializedArguments)}get argsGroup(){return this.form.get("args")}ngOnChanges(){this.arguments=[],this.argumentsWithInitial=[],this.showAll$.next(!this.config.collapseInitializedArguments);for(let C in this.argsGroup.controls)this.argsGroup.removeControl(C);this.form.reset();let t=this.templateProvider?.getComment()||"";if(this.form.controls.comment.setValue(t),!this.command)return;if(this.templateProvider&&this.showCommandOptions())for(let C of this.config.commandOptions||[]){let x=this.templateProvider.getOption(C.id,C.type);x!==void 0&&this.form.controls["extra__"+C.id].setValue(Lt(x))}let o=[],a=this.command;for(;a;)o.unshift(a),a=a.baseCommand;let c=new Map;for(let C of o){if(C.argument)for(let x of C.argument){if(this.templateProvider){let V=this.templateProvider.getAssignment(x.name);if(V!==void 0){let N=Lt(V),te=x.initialValue;x.type.engType==="boolean"&&te!==void 0&&(te=""+(x.type.oneStringValue===te)),N===te?this.argumentsWithInitial.push(x):this.arguments.push(x);continue}}let E=x.initialValue!==void 0;if(E&&x.type.engType==="aggregate"){let V=JSON.parse(x.initialValue);E=this.isAggregateFullyInitialized(x,V)}E?this.argumentsWithInitial.push(x):this.arguments.push(x)}if(C.argumentAssignment)for(let x of C.argumentAssignment)c.set(x.name,x.value)}this.arguments=this.arguments.filter(C=>!c.has(C.name)),this.argumentsWithInitial=this.argumentsWithInitial.filter(C=>!c.has(C.name));for(let C of this.arguments)this.addControl(C,this.templateProvider);for(let C of this.argumentsWithInitial)this.addControl(C,this.templateProvider);this.hasArguments$.next(this.arguments.length>0||this.argumentsWithInitial.length>0)}getAssignments(){let t={};for(let o of[...this.arguments,...this.argumentsWithInitial])if(o.type.engType==="aggregate"){let a=this.argsGroup.get(o.name);t[o.name]=this.getMemberAssignments(a,o.type)}else if(o.type.engType.endsWith("[]")){let a=this.argsGroup.get(o.name);t[o.name]=this.getArrayAssignment(a,o.type.elementType)}else{let a=this.argsGroup.controls[o.name];(!this.isArgumentWithInitialValue(o.name)||a.dirty)&&(o.type.engType==="boolean"?t[o.name]=this.argsGroup.value[o.name]==="true":t[o.name]=String(this.argsGroup.value[o.name]))}return t}getMemberAssignments(t,o){let a={};for(let c of o.member||[])if(c.type.engType==="aggregate"){let C=t.get(c.name);a[c.name]=this.getMemberAssignments(C,c.type)}else if(c.type.engType.endsWith("[]")){let C=t.get(c.name);a[c.name]=this.getArrayAssignment(C,c.type.elementType)}else if(c.type.engType==="boolean"){let C=t.get(c.name);a[c.name]=C.value==="true"}else{let C=t.get(c.name);a[c.name]=C.value}return a}getArrayAssignment(t,o){let a=[];for(let c of t.controls)if(o.engType==="aggregate"){let C=c;a.push(this.getMemberAssignments(C,o))}else if(o.engType.endsWith("[]")){let C=c;a.push(this.getArrayAssignment(C,o))}else o.engType==="boolean"?a.push(c.value==="true"):a.push(c.value);return a}getComment(){return this.form.value.comment||void 0}getExtraOptions(t=!1){let o={};for(let a in this.form.controls)if(a.startsWith("extra__")){let c=this.form.controls[a];if(c.value!==null){let C=a.replace("extra__","");t?o[C]=this.toStructValue(C,c.value):o[C]=this.toYamcsValue(C,c.value)}}return o}toStructValue(t,o){let a;for(let c of this.commandOptions)c.id===t&&(a=c);switch(a.type){case"BOOLEAN":return o==="true";case"NUMBER":return Number(o);default:return String(o)}}toYamcsValue(t,o){let a;for(let c of this.commandOptions)c.id===t&&(a=c);switch(a.type){case"BOOLEAN":return o==="true"?{type:"BOOLEAN",booleanValue:!0}:{type:"BOOLEAN",booleanValue:!1};case"NUMBER":return{type:"SINT32",sint32Value:Number(o)};default:return{type:"STRING",stringValue:String(o)}}}showCommandOptions(){return this.user.hasSystemPrivilege("CommandOptions")}addControl(t,o){if(t.type.engType!=="aggregate"){if(!t.type.engType.endsWith("[]")){let a;if(t.type.engType==="boolean"&&t.initialValue?a=""+(t.initialValue===t.type.oneStringValue):a=t.initialValue,o){let c=o.getAssignment(t.name);c!==void 0&&(a=Lt(c))}a===void 0&&(a=""),this.argsGroup.addControl(t.name,new j(a))}}}isArgumentWithInitialValue(t){for(let o of this.argumentsWithInitial)if(o.name===t)return!0;return!1}isAggregateFullyInitialized(t,o){for(let a of t.type.member||[]){if(!o.hasOwnProperty(a.name)&&t.initialValue===void 0)return!1;if(a.type.engType==="aggregate"){let c=o[a.name];if(!this.isAggregateFullyInitialized(a,c))return!1}}return!0}};i.\u0275fac=function(o){return new(o||i)(y(Oe),y(tt),y(Mi))},i.\u0275cmp=w({type:i,selectors:[["app-command-form"]],inputs:{command:"command",templateProvider:"templateProvider"},standalone:!0,features:[An,k],decls:18,vars:7,consts:[[1,"ya-form",3,"formGroup"],["formGroupName","args"],[3,"name","description","type","initialValue","templateProvider"],[1,"hasInitial",3,"name","description","type","initialValue","templateProvider"],[1,"hint"],["formControlName","comment","rows","3",2,"width","100%","resize","none"],[1,"hasInitial"],["icon","double_arrow"],["icon","double_arrow",3,"click"],[1,"label"],[3,"dialogTitle"],["type","radio","value","true",3,"formControlName"],["type","radio","value","false",3,"formControlName"],[3,"innerHTML"],["type","text",3,"formControlName"]],template:function(o,a){o&1&&(r(0,"form",0),h(1,"async"),M(2,1),H(3,_s,2,6,"app-argument",2,G),H(5,hs,2,6,"app-argument",3,G),u(7,Ss,2,3),I(),r(8,"p"),m(9,"\xA0"),l(),r(10,"h3"),m(11,"Options"),l(),u(12,Ds,2,0),r(13,"label"),m(14," Comment "),r(15,"span",4),m(16,"(optional)"),l(),f(17,"textarea",5),l()()),o&2&&(R("showAll",g(1,5,a.showAll$)),p("formGroup",a.form),s(3),q(a.arguments),s(2),q(a.argumentsWithInitial),s(2),_(a.config.collapseInitializedArguments?7:-1),s(5),_(a.showCommandOptions()?12:-1))},dependencies:[Mo,D,Q,re,pe,Gt,$,ie,ne,Z,nt,ee,zt],styles:[".hasInitial[_ngcontent-%COMP%]{display:none}.showAll[_ngcontent-%COMP%]   .hasInitial[_ngcontent-%COMP%]{display:block}"],changeDetection:0});let e=i;return e})();var Io=(()=>{let i=class i{constructor(t,o){this.dialogRef=t,this.form=o.group({executionTime:["",[W.required]],tags:[[],[]]})}schedule(){this.dialogRef.close(this.form.value)}};i.\u0275fac=function(o){return new(o||i)(y(Ce),y(Ge))},i.\u0275cmp=w({type:i,selectors:[["app-schedule-command-dialog"]],standalone:!0,features:[k],decls:26,vars:3,consts:[["mat-dialog-title",""],[1,"hint"],[1,"ya-form",3,"formGroup"],[1,"label"],["formControlName","executionTime",3,"showMillis"],[1,"half-break"],["dialogTitle","Timeline Tags"],["formControlName","tags"],["align","end"],[2,"flex","1 1 auto"],["mat-dialog-close","",1,"ya-button"],[1,"ya-button","primary",3,"click","disabled"]],template:function(o,a){o&1&&(r(0,"h2",0),m(1,"Send later"),l(),r(2,"mat-dialog-content")(3,"div",1)(4,"p"),m(5,"This command will be submitted to the Yamcs Timeline, for execution at a later time."),l()(),r(6,"form",2)(7,"div",3),m(8," Execution time"),f(9,"br")(10,"ya-date-time-input",4),l(),f(11,"hr",5),r(12,"div",3),m(13," Timeline tags "),r(14,"span",1),m(15,"(optional)"),l(),r(16,"ya-help",6),m(17," Tags allow to categorise items per band. Bands only show items for which one of the tags is matching. "),l(),f(18,"br")(19,"ya-tag-select",7),l()()(),r(20,"mat-dialog-actions",8),f(21,"div",9),r(22,"button",10),m(23,"CANCEL"),l(),r(24,"button",11),v("click",function(){return a.schedule()}),m(25,"SCHEDULE"),l()()),o&2&&(s(6),p("formGroup",a.form),s(4),p("showMillis",!0),s(14),p("disabled",!a.form.valid))},dependencies:[D,re,$,ie,ne,Z,he,Re,Me,De,Xe,ee,qi],encapsulation:2,changeDetection:0});let e=i;return e})();var Ms=["commandForm"];function Is(e,i){if(e&1&&(r(0,"dt"),m(1),l(),r(2,"dd"),m(3),l()),e&2){let n=i.$implicit;s(),F(n.namespace),s(2),F(n.name)}}function As(e,i){if(e&1&&(r(0,"dt"),m(1,"Description"),l(),r(2,"dd"),f(3,"app-markdown",11),l()),e&2){let n=d(2);s(3),p("text",n.longDescription)}}function Fs(e,i){if(e&1&&(r(0,"dt"),m(1,"Description"),l(),r(2,"dd"),m(3),l()),e&2){let n=d(2);s(3),S(" ",n.shortDescription||"-"," ")}}function Os(e,i){if(e&1&&u(0,As,4,1)(1,Fs,4,1),e&2){let n=d();_(n.longDescription?0:-1),s(),_(n.longDescription?-1:1)}}function Ps(e,i){if(e&1&&(f(0,"app-significance-level",12),m(1)),e&2){let n=i;p("level",n.consequenceLevel),s(),S(" \xA0\xA0",n.reasonForWarning," ")}}function Vs(e,i){e&1&&m(0," - ")}function Ns(e,i){if(e&1&&(r(0,"dl",5)(1,"dt"),m(2,"Command"),l(),r(3,"dd"),m(4),h(5,"shortName"),l(),r(6,"dt"),m(7,"System"),l(),r(8,"dd"),m(9),h(10,"spaceSystemName"),l(),H(11,Is,4,2,null,null,G),u(13,Os,2,2),r(14,"dt"),m(15,"Significance"),l(),r(16,"dd"),u(17,Ps,2,2)(18,Vs,1,0),l()()),e&2){let n,t=i;s(4),F(g(5,4,t.qualifiedName)),s(5),F(g(10,6,t.qualifiedName)||"-"),s(2),q(t.alias),s(2),_(t.longDescription||t.shortDescription?13:-1),s(4),_((n=t==null?null:t.effectiveSignificance)?17:18,n)}}function $s(e,i){e&1&&(r(0,"ya-warning-message"),m(1," You're not cleared to send this command "),l())}function Ls(e,i){e&1&&(r(0,"span",14),m(1," satisfied "),l())}function Rs(e,i){e&1&&(r(0,"span",15),m(1," not satisfied "),l())}function Bs(e,i){if(e&1&&(r(0,"tr")(1,"td"),m(2),l(),r(3,"td"),m(4),l(),r(5,"td"),u(6,Ls,2,0,"span",14),h(7,"async"),u(8,Rs,2,0,"span",15),h(9,"async"),f(10,"app-live-expression",16,1),l()()),e&2){let n=i.$implicit,t=B(11);s(2),F(n.expression),s(2),F(n.timeout||"-"),s(2),_(g(7,7,t.result$)===!0?6:-1),s(2),_(g(9,9,t.result$)===!1?8:-1),s(2),st("display","none"),p("expression",n.expression)}}function Hs(e,i){if(e&1&&(r(0,"p"),m(1,"\xA0"),l(),r(2,"h3"),m(3,"Constraints"),l(),r(4,"table",13)(5,"tr")(6,"th"),m(7,"Constraint"),l(),r(8,"th"),m(9,"Timeout"),l(),r(10,"th"),m(11,"Live Evaluation"),l()(),H(12,Bs,12,11,"tr",null,G),l()),e&2){let n=d();s(12),q(n.constraint)}}function qs(e,i){e&1&&u(0,Hs,14,0),e&2&&_(i.constraint?0:-1)}function js(e,i){e&1&&(r(0,"p"),m(1,"\xA0"),l(),r(2,"h3"),m(3,"Arguments"),l())}function Qs(e,i){if(e&1&&(r(0,"mat-slide-toggle",9),m(1," Arm "),l()),e&2){let n=d();p("formControl",n.armControl)}}function Us(e,i){if(e&1){let n=A();m(0," \xA0 "),f(1,"ya-icon-action",17),h(2,"async"),h(3,"async"),r(4,"mat-menu",18,2)(6,"button",19),v("click",function(){b(n);let o=d();return T(o.sendCommand())}),m(7,"Send now"),l(),r(8,"button",19),v("click",function(){b(n);let o=d();return T(o.openScheduleCommandDialog())}),m(9,"Send later..."),l()()}if(e&2){let n=B(5),t=d(),o=B(14);s(),p("matMenuTriggerFor",t.config.twoStageCommanding&&!t.armControl.value||!g(2,4,t.cleared$)||!o.form.valid?null:n)("padding",!1)("disabled",t.config.twoStageCommanding&&!t.armControl.value||!g(3,6,t.cleared$)||!o.form.valid),s(3),p("overlapTrigger",!1)}}var Ao=(()=>{let i=class i{constructor(t,o,a,c,C,x,E,V,N,te){this.route=t,this.router=o,this.title=a,this.messageService=c,this.yamcs=C,this.location=x,this.authService=V,this.changeDetection=N,this.dialog=te,this.qualifiedName=fi.required({alias:"command"}),this.command$=new P(null),this.templateProvider$=new P(null),this.cleared$=new P(!0),this.armControl=new j,this.config=E.getConfig()}ngOnInit(){this.title.setTitle(`Send a command: ${this.qualifiedName()}`);let t=[this.yamcs.yamcsClient.getCommand(this.yamcs.instance,this.qualifiedName())],o=this.route.snapshot.queryParamMap.get("template");if(o){let a=this.yamcs.yamcsClient.getCommandHistoryEntry(this.yamcs.instance,o);t.push(a)}Promise.all(t).then(a=>{let c=a[0],C;a.length>1&&(C=a[1]),this.command$.next(c),C?this.templateProvider$.next(new Sn(C)):this.templateProvider$.next(null),this.config.commandClearanceEnabled&&(this.connectionInfoSubscription=this.yamcs.clearance$.subscribe(x=>{let E=c.effectiveSignificance;this.cleared$.next(this.isCleared(x,E?.consequenceLevel))}))})}ngAfterViewInit(){this.config.twoStageCommanding&&(this.commandForm.form.valueChanges.subscribe(()=>{this.armControl.setValue(!1)}),this.commandForm.form.statusChanges.subscribe(()=>{this.commandForm.form.valid?this.armControl.enable():this.armControl.disable()})),this.commandForm.hasArguments$.subscribe(t=>{this.changeDetection.detectChanges()})}goBack(){this.location.back()}sendCommand(){this.armControl.setValue(!1);let t=this.commandForm.getAssignments(),o=this.commandForm.getComment(),a=this.commandForm.getExtraOptions(),c=this.qualifiedName();this.yamcs.yamcsClient.issueCommand(this.yamcs.instance,this.yamcs.processor,c,{args:t,comment:o,extra:a}).then(C=>{this.router.navigate(["/commanding/send"+c,"-","report",C.id],{queryParams:{c:this.yamcs.context}})}).catch(C=>{this.messageService.showError(C)})}showSchedule(){let t=this.yamcs.connectionInfo$.value?.instance?.capabilities||[];return t.indexOf("timeline")!==-1&&t.indexOf("activities")!==-1&&this.authService.getUser().hasSystemPrivilege("ControlTimeline")}openScheduleCommandDialog(){this.dialog.open(Io,{width:"600px"}).afterClosed().subscribe(t=>{if(t){this.armControl.setValue(!1);let o=this.qualifiedName(),a=this.commandForm.getAssignments(),c=this.commandForm.getExtraOptions(!0),C={type:"ACTIVITY",duration:"0s",name:o,start:t.executionTime,tags:t.tags,activityDefinition:{type:"COMMAND",args:{processor:this.yamcs.processor,command:o,args:a,extra:c}}};this.yamcs.yamcsClient.createTimelineItem(this.yamcs.instance,C).then(()=>{this.messageService.showInfo("Command scheduled"),this.router.navigateByUrl(`/commanding/send?c=${this.yamcs.context}`)}).catch(x=>this.messageService.showError(x))}})}isCleared(t,o){if(!t)return!1;switch(t.level){case"SEVERE":if(o==="SEVERE")return!0;case"CRITICAL":if(o==="CRITICAL")return!0;case"DISTRESS":if(o==="DISTRESS")return!0;case"WARNING":if(o==="WARNING")return!0;case"WATCH":if(o==="WATCH")return!0;case"NONE":if(o==="NONE"||!o)return!0}return!1}ngOnDestroy(){this.connectionInfoSubscription?.unsubscribe()}};i.\u0275fac=function(o){return new(o||i)(y(Ne),y(ke),y(we),y(et),y(U),y(Pn),y(Oe),y(tt),y(wt),y(Je))},i.\u0275cmp=w({type:i,selectors:[["ng-component"]],viewQuery:function(o,a){if(o&1&&z(Ms,5),o&2){let c;J(c=K())&&(a.commandForm=c.first)}},inputs:{qualifiedName:[1,"command","qualifiedName"]},standalone:!0,features:[k],decls:30,vars:23,consts:[["commandForm",""],["expr",""],["sendMenu","matMenu"],["step","2"],[1,"form-content"],[1,"dl-horizontal","no-lead","no-trail"],[3,"command","templateProvider"],[1,"ya-button",3,"click"],[2,"flex","1 1 auto"],["color","primary",3,"formControl"],[1,"ya-button","primary",3,"click","disabled"],[3,"text"],[3,"level"],["yaDataTable",""],[1,"evaluation","valid"],[1,"evaluation","invalid"],[3,"expression"],["icon","arrow_drop_down",2,"line-height","12px",3,"matMenuTriggerFor","padding","disabled"],[1,"ya-menu",3,"overlapTrigger"],["mat-menu-item","",3,"click"]],template:function(o,a){if(o&1){let c=A();r(0,"app-instance-page")(1,"app-instance-toolbar"),m(2," Send a command "),l(),f(3,"app-send-command-wizard-step",3),r(4,"div",4),u(5,Ns,19,8,"dl",5),h(6,"async"),u(7,$s,2,0,"ya-warning-message"),h(8,"async"),u(9,qs,1,1),h(10,"async"),u(11,js,4,0),h(12,"async"),f(13,"app-command-form",6,0),h(15,"async"),h(16,"async"),r(17,"p"),m(18,"\xA0"),l(),r(19,"mat-toolbar")(20,"button",7),v("click",function(){return b(c),T(a.goBack())}),m(21,"Cancel"),l(),f(22,"span",8),u(23,Qs,2,1,"mat-slide-toggle",9),r(24,"button",10),h(25,"async"),v("click",function(){return b(c),T(a.sendCommand())}),r(26,"mat-icon"),m(27,"send"),l(),m(28," Send "),l(),u(29,Us,10,8),l()()()}if(o&2){let c,C,x=B(14);s(5),_((c=g(6,9,a.command$))?5:-1,c),s(2),_(g(8,11,a.cleared$)?-1:7),s(2),_((C=g(10,13,a.command$))?9:-1,C),s(2),_(g(12,15,x.hasArguments$)?11:-1),s(2),p("command",g(15,17,a.command$))("templateProvider",g(16,19,a.templateProvider$)),s(10),_(a.config.twoStageCommanding?23:-1),s(),p("disabled",a.config.twoStageCommanding&&!a.armControl.value||!g(25,21,a.cleared$)||!x.form.valid),s(5),_(a.showSchedule()?29:-1)}},dependencies:[sn,Te,be,rn,Ji,ai,D,Q,$,_e,Qi,oe,_t,Ye,Ct,Un,Et,to,oo,zi,Zt,it],styles:[".evaluation[_ngcontent-%COMP%]{font-family:Roboto Mono,monospace;background-color:#ffeef0;color:red;padding-left:2px;padding-right:2px}.evaluation.valid[_ngcontent-%COMP%]{background-color:#e6ffed;color:#00c752}"],changeDetection:0});let e=i;return e})(),Sn=class{constructor(i){this.entry=i}getAssignment(i){if(this.entry.assignments){for(let n of this.entry.assignments)if(n.name===i)return n.value}}getOption(i,n){for(let t of this.entry.attr||[])if(t.name===i)switch(n){case"BOOLEAN":return this.getBooleanOption(t.value);case"NUMBER":return this.getNumberOption(t.value);case"STRING":return this.getStringOption(t.value)}}getBooleanOption(i){if(i.type==="BOOLEAN")return i}getNumberOption(i){switch(i.type){case"SINT32":case"UINT32":case"SINT64":case"UINT64":return i}}getStringOption(i){if(i.type==="STRING")return i}getComment(){}};var ui=class extends ki{constructor(i){super(),this.yamcs=i,this.items$=new P([]),this.totalSize$=new P(0),this.loading$=new P(!1)}connect(){return this.items$}loadCommands(i){return this.loading$.next(!0),this.yamcs.yamcsClient.getCommands(this.yamcs.instance,i).then(n=>{this.loading$.next(!1),this.totalSize$.next(n.totalSize);let t=[];for(let o of n.systems||[])t.push({name:o.qualifiedName,system:o});for(let o of n.commands||[])t.push({name:o.qualifiedName,command:o});this.items$.next(t)})}getAliasNamespaces(){let i=[];for(let n of this.items$.value)if(n.command?.alias)for(let t of n.command.alias)t.namespace&&i.indexOf(t.namespace)===-1&&i.push(t.namespace);return i.sort()}disconnect(){this.items$.complete(),this.totalSize$.complete(),this.loading$.complete()}};var Gs=["top"],Fo=e=>({c:e}),Ys=(e,i)=>({c:e,system:i});function Ws(e,i){if(e&1&&f(0,"ya-breadcrumb",11),e&2){let n=i.$implicit;p("link",n.route)("queryParams",n.queryParams)("label",n.name)}}function zs(e,i){if(e&1&&(r(0,"div",4)(1,"ya-breadcrumb-trail"),f(2,"ya-breadcrumb",10),H(3,Ws,1,3,"ya-breadcrumb",11,G),l()()),e&2){let n=d(),t=d(2);s(2),p("queryParams",ce(1,Fo,t.yamcs.context)),s(),q(n)}}function Js(e,i){e&1&&u(0,zs,5,3,"div",4),e&2&&_(i.length?0:-1)}function Ks(e,i){e&1&&(r(0,"th",25),m(1,"Significance"),l())}function Xs(e,i){e&1&&f(0,"app-significance-level",27),e&2&&p("level",i.consequenceLevel)}function Zs(e,i){e&1&&m(0," - ")}function ec(e,i){if(e&1&&(r(0,"td",26),u(1,Xs,1,1,"app-significance-level",27)(2,Zs,1,0),l()),e&2){let n,t=i.$implicit;s(),_((n=t.command==null?null:t.command.effectiveSignificance)?1:2,n)}}function tc(e,i){e&1&&(r(0,"th",25),m(1,"Name"),l())}function ic(e,i){if(e&1&&(r(0,"mat-icon",29),m(1,"folder"),l(),r(2,"a",30),m(3),h(4,"filename"),l()),e&2){let n=d().$implicit,t=d(3);s(2),p("queryParams",vt(4,Ys,t.yamcs.context,n.name)),s(),S("",g(4,2,n.name),"/ ")}}function nc(e,i){if(e&1&&f(0,"ya-highlight",32),e&2){let n=d(2).$implicit,t=d(3);p("text",n.command.qualifiedName)("term",t.filterControl.value)}}function oc(e,i){if(e&1&&(f(0,"ya-highlight",32),h(1,"slice")),e&2){let n=d(2).$implicit,t=d(3);p("text",Ve(1,2,n.command.qualifiedName,t.system.length+1))("term",t.filterControl.value)}}function ac(e,i){if(e&1&&(r(0,"mat-icon",29),m(1,"rss_feed"),l(),r(2,"a",31),u(3,nc,1,2,"ya-highlight",32)(4,oc,2,5,"ya-highlight",32),l()),e&2){let n=d().$implicit,t=d(3);s(2),p("routerLink","/commanding/send"+n.command.qualifiedName)("queryParams",ce(4,Fo,t.yamcs.context)),s(),_(t.system?-1:3),s(),_(t.system?4:-1)}}function rc(e,i){if(e&1&&(r(0,"td",28),u(1,ic,5,7)(2,ac,5,6),l()),e&2){let n=i.$implicit;s(),_(n.system?1:-1),s(),_(n.command?2:-1)}}function lc(e,i){e&1&&(r(0,"th",25),m(1,"Description"),l())}function mc(e,i){if(e&1&&m(0),e&2){let n=d().$implicit;S(" ",n.system.shortDescription||"-"," ")}}function sc(e,i){if(e&1&&f(0,"ya-highlight",32),e&2){let n=d(5);p("text",i)("term",n.filterControl.value)}}function cc(e,i){e&1&&m(0," - ")}function dc(e,i){if(e&1&&u(0,sc,1,2,"ya-highlight",32)(1,cc,1,0),e&2){let n,t=d().$implicit;_((n=t.command==null?null:t.command.shortDescription)?0:1,n)}}function pc(e,i){if(e&1&&(r(0,"td",33),u(1,mc,1,1)(2,dc,2,1),l()),e&2){let n=i.$implicit;s(),_(n.system?1:-1),s(),_(n.command?2:-1)}}function uc(e,i){if(e&1&&(r(0,"th",25),m(1),l()),e&2){let n=d().$implicit;s(),S(" ",n.label," ")}}function fc(e,i){if(e&1&&f(0,"ya-highlight",32),e&2){let n=d(5);p("text",i)("term",n.filterControl.value)}}function _c(e,i){e&1&&m(0," - ")}function Cc(e,i){if(e&1&&(r(0,"td",26),u(1,fc,1,2,"ya-highlight",32),h(2,"alias"),u(3,_c,1,0),l()),e&2){let n,t=i.$implicit,o=d().$implicit;s(),_((n=Ve(2,1,t.command,o.id))?1:3,n)}}function hc(e,i){if(e&1&&(M(0,20),u(1,uc,2,1,"th",13)(2,Cc,4,4,"td",14),I()),e&2){let n=i.$implicit;p("matColumnDef",n.id)}}function gc(e,i){e&1&&f(0,"th",34)}function xc(e,i){e&1&&f(0,"td",26)}function yc(e,i){e&1&&f(0,"tr",35)}function vc(e,i){if(e&1&&f(0,"tr",36),e&2){let n=i.$implicit,t=d(3);R("selected",t.selection.isSelected(n))}}function Sc(e,i){if(e&1&&(r(0,"table",7),M(1,12),u(2,Ks,2,0,"th",13)(3,ec,3,1,"td",14),I(),M(4,15),u(5,tc,2,0,"th",16)(6,rc,3,2,"td",17),I(),M(7,18),u(8,lc,2,0,"th",13)(9,pc,3,2,"td",19),I(),H(10,hc,3,1,"ng-container",20,G),h(12,"async"),M(13,21),u(14,gc,1,0,"th",22)(15,xc,1,0,"td",14),I(),u(16,yc,1,0,"tr",23),h(17,"async"),u(18,vc,1,2,"tr",24),h(19,"async"),l()),e&2){d();let n=B(7),t=d();p("dataSource",t.dataSource),s(10),q(g(12,3,t.aliasColumns$)),s(6),p("matHeaderRowDef",g(17,5,n.displayedColumns$)),s(2),p("matRowDefColumns",g(19,7,n.displayedColumns$))}}function bc(e,i){e&1&&m(0," replay ")}function Tc(e,i){if(e&1&&(r(0,"ya-empty-message",9)(1,"p"),m(2," You are connected to the "),u(3,bc,1,0),m(4," processor "),r(5,"strong"),m(6),l(),m(7,". "),l(),r(8,"p"),m(9,"This processor does not support commanding."),l()()),e&2){let n=d();s(3),_(n.processor!=null&&n.processor.replay?3:-1),s(3),F(n.processor==null?null:n.processor.name)}}function wc(e,i){if(e&1){let n=A();r(0,"div",3)(1,"div"),u(2,Js,1,1),h(3,"async"),r(4,"div",4)(5,"ya-search-filter",5),v("onArrowDown",function(){b(n);let o=d();return T(o.selectNext())})("onArrowUp",function(){b(n);let o=d();return T(o.selectPrevious())})("onEnter",function(){b(n);let o=d();return T(o.applySelection())}),l(),f(6,"ya-column-chooser",6,1),l(),u(8,Sc,20,9,"table",7),f(9,"mat-paginator",8),h(10,"async"),l(),u(11,Tc,10,2,"ya-empty-message",9),l()}if(e&2){let n,t=i,o=d();s(),R("noDisplay",!(t.processor!=null&&t.processor.hasCommanding)),s(),_((n=g(3,11,o.breadcrumb$))?2:-1,n),s(3),p("formControl",o.filterControl),s(),p("columns",o.columns),s(2),_(o.dataSource?8:-1),s(),p("pageSize",o.pageSize)("hidePageSize",!0)("showFirstLastButtons",!0)("length",g(10,13,o.dataSource.totalSize$)),s(2),_(t.processor!=null&&t.processor.hasCommanding?-1:11)}}var Oo=(()=>{let i=class i{constructor(t,o,a,c){this.yamcs=o,this.route=a,this.router=c,this.pageSize=100,this.system=null,this.breadcrumb$=new P([]),this.filterControl=new j,this.columns=[{id:"name",label:"Name",alwaysVisible:!0},{id:"significance",label:"Significance",visible:!0},{id:"shortDescription",label:"Description"},{id:"actions",label:"",alwaysVisible:!0}],this.aliasColumns$=new P([]),this.selection=new ut(!1),t.setTitle("Send a command"),this.connectionInfo$=o.connectionInfo$,this.dataSource=new ui(o)}ngAfterViewInit(){this.filterControl.setValue(this.route.snapshot.queryParamMap.get("filter")),this.changeSystem(this.route.snapshot.queryParamMap),this.queryParamMapSubscription=this.route.queryParamMap.subscribe(t=>{t.get("system")!==this.system&&this.changeSystem(t)}),this.filterControl.valueChanges.subscribe(()=>{this.paginator.pageIndex=0,this.updateDataSource()}),this.paginator.page.subscribe(()=>{this.updateDataSource(),this.top.nativeElement.scrollIntoView()})}changeSystem(t){this.system=t.get("system"),this.updateBrowsePath(),t.has("page")?this.paginator.pageIndex=Number(t.get("page")):this.paginator.pageIndex=0,this.updateDataSource()}updateDataSource(){this.updateURL();let t={system:this.system||"/",noAbstract:!0,details:!0,pos:this.paginator.pageIndex*this.pageSize,limit:this.pageSize,fields:["name","qualifiedName","alias","effectiveSignificance","shortDescription"]},o=this.filterControl.value;o&&(t.q=o.toLowerCase()),this.dataSource.loadCommands(t).then(()=>{this.selection.clear(),this.updateBrowsePath();for(let c of this.aliasColumns$.value){let C=this.columns.indexOf(c);C!==-1&&this.columns.splice(C,1)}let a=[];for(let c of this.dataSource.getAliasNamespaces()){let C={id:c,label:c,alwaysVisible:!0};a.push(C)}this.columns.splice(1,0,...a),this.aliasColumns$.next(a),this.columnChooser.recalculate(this.columns)})}updateURL(){let t=this.filterControl.value;this.router.navigate([],{replaceUrl:!0,relativeTo:this.route,queryParams:{page:this.paginator.pageIndex||null,filter:t||null,system:this.system||null},queryParamsHandling:"merge"})}updateBrowsePath(){let t=[],o="";if(this.system)for(let a of this.system.slice(1).split("/"))o+="/"+a,t.push({name:a,route:"/commanding/send",queryParams:{system:o,c:this.yamcs.context}});this.breadcrumb$.next(t)}selectNext(){let t=this.dataSource.items$.value,o=0;if(this.selection.hasValue()){let a=this.selection.selected[0];t.indexOf(a)!==-1&&(o=Math.min(t.indexOf(a)+1,t.length-1))}this.selection.select(t[o])}selectPrevious(){let t=this.dataSource.items$.value,o=0;if(this.selection.hasValue()){let a=this.selection.selected[0];t.indexOf(a)!==-1&&(o=Math.max(t.indexOf(a)-1,0))}this.selection.select(t[o])}applySelection(){if(this.selection.hasValue()){let t=this.selection.selected[0],o=this.dataSource.items$.value;t.command&&o.indexOf(t)!==-1&&this.router.navigate(["/commanding/send"+t.command?.qualifiedName],{queryParams:{c:this.yamcs.context}})}}ngOnDestroy(){this.queryParamMapSubscription?.unsubscribe()}};i.\u0275fac=function(o){return new(o||i)(y(we),y(U),y(Ne),y(ke))},i.\u0275cmp=w({type:i,selectors:[["ng-component"]],viewQuery:function(o,a){if(o&1&&(z(Gs,7),z(Be,5),z(lt,5)),o&2){let c;J(c=K())&&(a.top=c.first),J(c=K())&&(a.paginator=c.first),J(c=K())&&(a.columnChooser=c.first)}},standalone:!0,features:[k],decls:8,vars:3,consts:[["top",""],["columnChooser",""],["step","1"],[1,"panel-content"],[1,"filter-bar"],["placeholder","Search by name","icon","search",3,"onArrowDown","onArrowUp","onEnter","formControl"],["preferenceKey","sendCommand",3,"columns"],["mat-table","",1,"ya-data-table","expand",3,"dataSource"],[3,"pageSize","hidePageSize","showFirstLastButtons","length"],["headerTitle","Send a command"],["link","/commanding/send","icon","account_tree",3,"queryParams"],[3,"link","queryParams","label"],["matColumnDef","significance"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["cdkColumnDef","name"],["mat-header-cell","",4,"cdkHeaderCellDef"],["mat-cell","","class","primary-td",4,"matCellDef"],["matColumnDef","shortDescription"],["mat-cell","","class","wrap400",4,"matCellDef"],[3,"matColumnDef"],["matColumnDef","actions"],["mat-header-cell","","class","expand",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",3,"selected",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],[3,"level"],["mat-cell","",1,"primary-td"],[1,"icon12",2,"vertical-align","middle"],["routerLink","/commanding/send",3,"queryParams"],[3,"routerLink","queryParams"],[3,"text","term"],["mat-cell","",1,"wrap400"],["mat-header-cell","",1,"expand"],["mat-header-row",""],["mat-row",""]],template:function(o,a){if(o&1&&(r(0,"app-instance-page")(1,"app-instance-toolbar"),m(2," Send a command "),l(),f(3,"span",null,0)(5,"app-send-command-wizard-step",2),u(6,wc,12,15,"div",3),h(7,"async"),l()),o&2){let c;s(6),_((c=g(7,1,a.connectionInfo$))?6:-1,c)}},dependencies:[Te,be,ai,D,Q,Ti,$,_e,$e,at,rt,oe,Be,ge,Ae,He,Fe,Ie,qe,xe,ye,ve,Se,Wt,Yt,lt,It,Jt,Ft,Kt,Xt,it],styles:[".pullRight[_ngcontent-%COMP%]{float:right}.primary-td[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{margin-right:7px}"],changeDetection:0});let e=i;return e})();function kc(e,i){e&1&&(r(0,"th",17),m(1,"Time"),l())}function Ec(e,i){if(e&1&&(r(0,"td",18),m(1),h(2,"datetime"),l()),e&2){let n=i.$implicit;s(),S(" ",g(2,1,n.generationTime)," ")}}function Dc(e,i){e&1&&(r(0,"th",19)(1,"mat-icon",20),m(2,"comment"),l()())}function Mc(e,i){if(e&1&&(r(0,"mat-icon",22),m(1,"comment"),l()),e&2){let n=d().$implicit;p("matTooltip",n.comment)}}function Ic(e,i){e&1&&m(0," - ")}function Ac(e,i){if(e&1&&(r(0,"td",21),u(1,Mc,2,1,"mat-icon",22)(2,Ic,1,0),l()),e&2){let n=i.$implicit;s(),_(n.comment?1:-1),s(),_(n.comment?-1:2)}}function Fc(e,i){e&1&&(r(0,"th",17),m(1,"Command"),l())}function Oc(e,i){if(e&1&&(r(0,"td",18),m(1),l()),e&2){let n=i.$implicit;s(),S(" ",n.commandName||"-"," ")}}function Pc(e,i){e&1&&(r(0,"th",17),m(1,"Queue"),l())}function Vc(e,i){if(e&1&&(r(0,"td",18),m(1),l()),e&2){let n=i.$implicit;s(),S(" ",n.queueName||"-"," ")}}function Nc(e,i){e&1&&(r(0,"th",17),m(1,"Issuer"),l())}function $c(e,i){if(e&1&&(r(0,"span"),m(1),l()),e&2){let n=d().$implicit;s(),S("@",n.origin,"")}}function Lc(e,i){if(e&1&&(r(0,"td",18),m(1),u(2,$c,2,1,"span"),l()),e&2){let n=i.$implicit;s(),S(" ",n.username," "),s(),_(n.origin?2:-1)}}function Rc(e,i){e&1&&(r(0,"th",17),m(1,"Source"),l())}function Bc(e,i){if(e&1&&(r(0,"td",18),m(1),l()),e&2){let n=i.$implicit;s(),S(" ",n.origin||"-"," ")}}function Hc(e,i){e&1&&(r(0,"th",23),m(1,"Command"),l())}function qc(e,i){if(e&1&&(r(0,"tr")(1,"td",25),m(2),l(),r(3,"td",26),m(4),h(5,"value"),l()()),e&2){let n=d().$implicit;s(2),F(n.name),s(2),F(g(5,2,n.value))}}function jc(e,i){if(e&1&&u(0,qc,6,4,"tr"),e&2){let n=i.$implicit;_(n.userInput?0:-1)}}function Qc(e,i){if(e&1&&(r(0,"td",18),m(1),r(2,"table",24),H(3,jc,1,1,null,null,G),l()()),e&2){let n=i.$implicit;s(),S(" ",n.commandName," "),s(2),q(n.assignments)}}function Uc(e,i){e&1&&(r(0,"th",27),m(1,"Actions"),l())}function Gc(e,i){e&1&&(r(0,"span",28)(1,"mat-icon",29),m(2,"cached"),l(),m(3," Checking transmission constraints "),l())}function Yc(e,i){if(e&1){let n=A();r(0,"ya-text-action",30),v("click",function(){b(n);let o=d().$implicit,a=d(2);return T(a.acceptEntry(o))}),m(1,"ACCEPT"),l(),r(2,"ya-text-action",31),v("click",function(){b(n);let o=d().$implicit,a=d(2);return T(a.rejectEntry(o))}),m(3,"REJECT"),l()}if(e&2){let n=d().$implicit;p("disabled",n.pendingTransmissionConstraints),s(2),p("disabled",n.pendingTransmissionConstraints)}}function Wc(e,i){if(e&1&&(r(0,"td",18),u(1,Gc,4,0,"span",28)(2,Yc,4,2),l()),e&2){let n=i.$implicit;s(),_(n.pendingTransmissionConstraints?1:-1),s(),_(n.pendingTransmissionConstraints?-1:2)}}function zc(e,i){e&1&&f(0,"tr",32)}function Jc(e,i){e&1&&f(0,"tr",33)}function Kc(e,i){if(e&1&&(r(0,"table",0),M(1,1),u(2,kc,2,0,"th",2)(3,Ec,3,3,"td",3),I(),M(4,4),u(5,Dc,3,0,"th",5)(6,Ac,3,2,"td",6),I(),M(7,7),u(8,Fc,2,0,"th",2)(9,Oc,2,1,"td",3),I(),M(10,8),u(11,Pc,2,0,"th",2)(12,Vc,2,1,"td",3),I(),M(13,9),u(14,Nc,2,0,"th",2)(15,Lc,3,2,"td",3),I(),M(16,10),u(17,Rc,2,0,"th",2)(18,Bc,2,1,"td",3),I(),M(19,11),u(20,Hc,2,0,"th",12)(21,Qc,5,1,"td",3),I(),M(22,13),u(23,Uc,2,0,"th",14)(24,Wc,3,2,"td",3),I(),u(25,zc,1,0,"tr",15)(26,Jc,1,0,"tr",16),l()),e&2){let n=d();p("dataSource",n.dataSource),s(25),p("matHeaderRowDef",n.displayedColumns),s(),p("matRowDefColumns",n.displayedColumns)}}var Po=(()=>{let i=class i{constructor(t){this.yamcs=t,this.dataSource=new Ke,this.displayedColumns=["generationTime","comment","source","queueName","issuer","actions"]}ngAfterViewInit(){this.dataSource.sort=this.sort,this.cqueues$.subscribe(t=>{let o=[];for(let a of t)a.entries&&o.push(...a.entries);this.dataSource.data=o})}acceptEntry(t){confirm(`Are you sure you want to accept this command?

 ${t.commandName}`)&&this.yamcs.yamcsClient.acceptCommand(t.instance,t.processorName,t.queueName,t.id)}rejectEntry(t){confirm(`Are you sure you want to reject this command?

 ${t.commandName}`)&&this.yamcs.yamcsClient.rejectCommand(t.instance,t.processorName,t.queueName,t.id)}};i.\u0275fac=function(o){return new(o||i)(y(U))},i.\u0275cmp=w({type:i,selectors:[["app-queued-commands-table"]],viewQuery:function(o,a){if(o&1&&z(Dt,5),o&2){let c;J(c=K())&&(a.sort=c.first)}},inputs:{cqueues$:"cqueues$"},standalone:!0,features:[k],decls:1,vars:1,consts:[["mat-table","","matSort","","matSortActive","generationTime","matSortDirection","asc","matSortDisableClear","",1,"ya-data-table","expand",3,"dataSource"],["matColumnDef","generationTime"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","comment"],["mat-header-cell","","style","text-align: center",4,"matHeaderCellDef"],["mat-cell","","style","text-align: center",4,"matCellDef"],["matColumnDef","commandName"],["matColumnDef","queueName"],["matColumnDef","issuer"],["matColumnDef","origin"],["matColumnDef","source"],["mat-header-cell","","mat-sort-header","","style","width: 350px",4,"matHeaderCellDef"],["matColumnDef","actions"],["mat-header-cell","","class","expand",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],["mat-header-cell","",2,"text-align","center"],["matTooltip","Comment"],["mat-cell","",2,"text-align","center"],[3,"matTooltip"],["mat-header-cell","","mat-sort-header","",2,"width","350px"],[1,"args"],["width","1",1,"key"],[1,"value"],["mat-header-cell","",1,"expand"],[2,"color","#999"],[1,"icon16","spin",2,"vertical-align","middle"],["icon","check",3,"click","disabled"],["icon","close",3,"click","disabled"],["mat-header-row",""],["mat-row",""]],template:function(o,a){o&1&&u(0,Kc,27,3,"table",0),o&2&&_(a.dataSource?0:-1)},dependencies:[D,oe,Dt,Vi,ge,Ae,He,Fe,Ie,qe,xe,ye,ve,Se,Ee,zt,Pe,Ot],styles:[".args[_ngcontent-%COMP%]{margin:0 0 0 10px}.args[_ngcontent-%COMP%]   .key[_ngcontent-%COMP%]{min-width:120px;white-space:nowrap}.args[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{color:gray;padding-left:10px}.args[_ngcontent-%COMP%]   td[_ngcontent-%COMP%], .args[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{border:none;font-size:10px;line-height:12px;font-family:Roboto Mono,monospace}"],changeDetection:0});let e=i;return e})();function Xc(e,i){if(e&1&&f(0,"app-queued-commands-table",1),e&2){let n=d();p("cqueues$",n.cqueues$)}}function Zc(e,i){e&1&&m(0,` All queues are empty.
`)}function ed(e,i){e&1&&m(0," All queues are empty. ")}var Vo=(()=>{let i=class i{constructor(t){this.cqueues$=new P([]),this.hasEntries$=new P(!1),this.cqueueByName={},t.yamcsClient.getCommandQueues(t.instance,t.processor).then(o=>{for(let a of o)this.cqueueByName[a.name]=a;this.emitChange()}),this.queueEventSubscription=t.yamcsClient.createQueueEventsSubscription({instance:t.instance,processor:t.processor},o=>{let a=this.cqueueByName[o.data.queueName];if(a){if(o.type==="COMMAND_ADDED")a.entries=a.entries||[],a.entries.push(o.data);else if(o.type==="COMMAND_UPDATED"){let c=(a.entries||[]).findIndex(C=>C.id===o.data.id);c!==-1&&(a.entries[c]=o.data)}else if(o.type==="COMMAND_REJECTED")a.entries=a.entries||[],a.entries=a.entries.filter(c=>c.id!==o.data.id);else if(o.type==="COMMAND_SENT")a.entries=a.entries||[],a.entries=a.entries.filter(c=>c.id!==o.data.id);else throw new Error(`Unexpected queue event ${o.type}`);this.emitChange()}else console.warn("Received an event for an unknown queue",o)})}emitChange(){this.cqueues$.next(Object.values(this.cqueueByName));let t=!1;for(let o of this.cqueues$.getValue())if(o.entries&&o.entries.length){t=!0;break}this.hasEntries$.next(t)}ngOnDestroy(){this.queueEventSubscription?.cancel()}};i.\u0275fac=function(o){return new(o||i)(y(U))},i.\u0275cmp=w({type:i,selectors:[["ng-component"]],standalone:!0,features:[k],decls:5,vars:3,consts:[["empty",""],[3,"cqueues$"]],template:function(o,a){o&1&&(u(0,Xc,1,1,"app-queued-commands-table",1),h(1,"async"),u(2,Zc,1,0)(3,ed,1,0,"ng-template",null,0,On)),o&2&&_(g(1,1,a.hasEntries$)?0:2)},dependencies:[D,Q,Po],encapsulation:2,changeDetection:0});let e=i;return e})();var td=["intervalSelect"];function id(e,i){if(e&1){let n=A();f(0,"ya-date-time-input",15)(1,"ya-date-time-input",16),r(2,"button",17),v("click",function(){b(n);let o=d();return T(o.applyCustomDates())}),m(3," Apply "),l()}if(e&2){let n=d();s(2),p("disabled",n.filterForm.invalid)}}function nd(e,i){if(e&1){let n=A();r(0,"button",18),v("click",function(){b(n);let o=d();return T(o.jumpToNow())}),m(1,"Jump to now"),l()}}function od(e,i){e&1&&(r(0,"th",19),m(1,"Time"),l())}function ad(e,i){if(e&1&&(r(0,"td",20),m(1),h(2,"datetime"),l()),e&2){let n=i.$implicit;s(),F(g(2,1,n.time))}}function rd(e,i){e&1&&(r(0,"th",19),m(1,"User"),l())}function ld(e,i){if(e&1&&(r(0,"td",20),m(1),l()),e&2){let n=i.$implicit;s(),F(n.user||"-")}}function md(e,i){e&1&&(r(0,"th",19),m(1,"Action"),l())}function sd(e,i){if(e&1&&(r(0,"td",20),f(1,"span",21),h(2,"actionLogFormat"),l()),e&2){let n=i.$implicit;s(),p("innerHTML",g(2,1,n.summary)||"-",Rt)}}function cd(e,i){e&1&&f(0,"th",22)}function dd(e,i){e&1&&f(0,"td",20)}function pd(e,i){e&1&&f(0,"tr",23)}function ud(e,i){e&1&&f(0,"tr",24)}var No=(()=>{let i=class i{constructor(t,o,a,c){this.yamcs=t,this.messageService=o,this.router=a,this.route=c,this.filterForm=new ft({filter:new j,interval:new j("NO_LIMIT"),customStart:new j(null),customStop:new j(null)}),this.displayedColumns=["time","user","summary","actions"],this.intervalOptions=[{id:"PT1H",label:"Last hour"},{id:"PT6H",label:"Last 6 hours"},{id:"P1D",label:"Last 24 hours"},{id:"NO_LIMIT",label:"No limit"},{id:"CUSTOM",label:"Custom",group:!0}],this.dataSource=new Ke,this.initializeOptions(),this.loadData(),this.filterForm.get("interval").valueChanges.forEach(C=>{if(C==="CUSTOM"){let x=new Date,E=this.validStart||x,V=this.validStop||x;this.filterForm.get("customStart").setValue(O.toISOString(E)),this.filterForm.get("customStop").setValue(O.toISOString(V))}else C==="NO_LIMIT"?(this.validStart=null,this.validStop=null,this.appliedInterval=C,this.loadData()):(this.validStop=new Date,this.validStart=O.subtractDuration(this.validStop,C),this.appliedInterval=C,this.loadData())})}initializeOptions(){let t=this.route.snapshot.queryParamMap;if(t.has("filter")&&(this.filter=t.get("filter")||"",this.filterForm.get("filter").setValue(this.filter)),t.has("interval"))if(this.appliedInterval=t.get("interval"),this.filterForm.get("interval").setValue(this.appliedInterval),this.appliedInterval==="CUSTOM"){let o=t.get("customStart");this.filterForm.get("customStart").setValue(o),this.validStart=O.toDate(o);let a=t.get("customStop");this.filterForm.get("customStop").setValue(a),this.validStop=O.toDate(a)}else this.appliedInterval==="NO_LIMIT"?(this.validStart=null,this.validStop=null):(this.validStop=new Date,this.validStart=O.subtractDuration(this.validStop,this.appliedInterval));else this.appliedInterval="NO_LIMIT",this.validStop=null,this.validStart=null}jumpToNow(){this.filterForm.get("interval").setValue("NO_LIMIT")}applyCustomDates(){this.validStart=O.toDate(this.filterForm.value.customStart),this.validStop=O.toDate(this.filterForm.value.customStop),this.appliedInterval="CUSTOM",this.loadData()}loadData(){this.updateURL();let t={service:"QueuesApi"};this.validStart&&(t.start=this.validStart.toISOString()),this.validStop&&(t.stop=this.validStop.toISOString()),this.filter&&(t.q=this.filter),this.yamcs.yamcsClient.getAuditRecords(this.yamcs.instance,t).then(o=>this.dataSource.data=o.records||[]).catch(o=>this.messageService.showError(o))}updateURL(){this.router.navigate([],{replaceUrl:!0,relativeTo:this.route,queryParams:{filter:this.filter||null,interval:this.appliedInterval,customStart:this.appliedInterval==="CUSTOM"?this.filterForm.value.customStart:null,customStop:this.appliedInterval==="CUSTOM"?this.filterForm.value.customStop:null},queryParamsHandling:"merge"})}};i.\u0275fac=function(o){return new(o||i)(y(U),y(et),y(ke),y(Ne))},i.\u0275cmp=w({type:i,selectors:[["app-queues-action-log-tab"]],viewQuery:function(o,a){if(o&1&&z(td,5),o&2){let c;J(c=K())&&(a.intervalSelect=c.first)}},standalone:!0,features:[k],decls:21,vars:7,consts:[["intervalSelect",""],[3,"formGroup"],[1,"filter-bar"],["icon","access_time","formControlName","interval",3,"options"],[1,"ya-button"],["mat-table","",1,"ya-data-table","expand",3,"dataSource"],["matColumnDef","time"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","user"],["matColumnDef","summary"],["matColumnDef","actions"],["mat-header-cell","","class","expand",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["formControlName","customStart"],["formControlName","customStop"],[1,"ya-button",3,"click","disabled"],[1,"ya-button",3,"click"],["mat-header-cell",""],["mat-cell",""],[3,"innerHTML"],["mat-header-cell","",1,"expand"],["mat-header-row",""],["mat-row",""]],template:function(o,a){o&1&&(r(0,"form",1)(1,"div",2),f(2,"ya-select",3,0),u(4,id,4,1)(5,nd,2,0,"button",4),l()(),r(6,"table",5),M(7,6),u(8,od,2,0,"th",7)(9,ad,3,3,"td",8),I(),M(10,9),u(11,rd,2,0,"th",7)(12,ld,2,1,"td",8),I(),M(13,10),u(14,md,2,0,"th",7)(15,sd,3,3,"td",8),I(),M(16,11),u(17,cd,1,0,"th",12)(18,dd,1,0,"td",8),I(),u(19,pd,1,0,"tr",13)(20,ud,1,0,"tr",14),l()),o&2&&(p("formGroup",a.filterForm),s(2),p("options",a.intervalOptions),s(2),_(a.filterForm.value.interval==="CUSTOM"?4:-1),s(),_(a.filterForm.value.interval!=="CUSTOM"?5:-1),s(),p("dataSource",a.dataSource),s(13),p("matHeaderRowDef",a.displayedColumns),s(),p("matRowDefColumns",a.displayedColumns))},dependencies:[D,re,$,ie,ne,Z,ge,Ae,He,Fe,Ie,qe,xe,ye,ve,Se,Xe,Ze,Gi,Pe],encapsulation:2,changeDetection:0});let e=i;return e})();var $o=e=>({c:e}),fd=(e,i)=>({c:e,queue:i});function _d(e,i){if(e&1){let n=A();r(0,"th",32)(1,"input",33),v("change",function(o){b(n);let a=d(3);return T(o?a.masterToggle():null)}),l()()}if(e&2){let n=d(3);s(),p("checked",n.selection.hasValue()&&n.isAllSelected())}}function Cd(e,i){if(e&1){let n=A();r(0,"td",34)(1,"input",35),v("click",function(o){return b(n),T(o.stopPropagation())})("change",function(o){let a=b(n).$implicit,c=d(3);return T(o?c.selection.toggle(a):null)}),l()()}if(e&2){let n=i.$implicit,t=d(3);s(),p("checked",t.selection.isSelected(n))}}function hd(e,i){e&1&&(r(0,"th",36),m(1,"#"),l())}function gd(e,i){if(e&1&&(r(0,"td",37),m(1),l()),e&2){let n=i.$implicit;s(),S(" ",n.order," ")}}function xd(e,i){e&1&&(r(0,"th",36),m(1,"Queue"),l())}function yd(e,i){if(e&1&&(r(0,"td",37),m(1),l()),e&2){let n=i.$implicit;s(),S(" ",n.name," ")}}function vd(e,i){e&1&&(r(0,"th",36),m(1,"Issuer"),l())}function Sd(e,i){if(e&1&&(r(0,"ya-label",38),m(1),l()),e&2){let n=i.$implicit;s(),F(n)}}function bd(e,i){if(e&1&&(r(0,"ya-label",39),m(1),l()),e&2){let n=i.$implicit;s(),F(n)}}function Td(e,i){e&1&&m(0," any ")}function wd(e,i){if(e&1&&(r(0,"td",37),H(1,Sd,2,1,"ya-label",38,G),H(3,bd,2,1,"ya-label",39,G),u(5,Td,1,0),l()),e&2){let n=i.$implicit;s(),q(n.groups),s(2),q(n.users),s(2),_(!n.groups&&!n.users?5:-1)}}function kd(e,i){e&1&&(r(0,"th",36),m(1,"Min.\xA0level"),l())}function Ed(e,i){if(e&1&&(r(0,"td",37),f(1,"app-significance-level",40),l()),e&2){let n=i.$implicit;s(),p("level",n.minLevel)("grayscale",!0)}}function Dd(e,i){e&1&&(r(0,"th",36),m(1,"Name\xA0patterns"),l())}function Md(e,i){e&1&&m(0," any ")}function Id(e,i){if(e&1&&(m(0),f(1,"br")),e&2){let n=i.$implicit;S(" ",n,"")}}function Ad(e,i){if(e&1&&(r(0,"td",37),u(1,Md,1,0),H(2,Id,2,1,"br",null,G),l()),e&2){let n=i.$implicit;s(),_(n.tcPatterns?-1:1),s(),q(n.tcPatterns)}}function Fd(e,i){e&1&&(r(0,"th",36),m(1,"Action"),l())}function Od(e,i){e&1&&(r(0,"span"),m(1," ACCEPT "),l())}function Pd(e,i){if(e&1&&(r(0,"span"),h(1,"async"),m(2," HOLD "),l()),e&2){let n=d(4);st("visibility",g(1,2,n.visibility$)?"visible":"hidden")}}function Vd(e,i){e&1&&(r(0,"span"),m(1," REJECT "),l())}function Nd(e,i){if(e&1&&(r(0,"td",37),u(1,Od,2,0,"span")(2,Pd,3,4,"span",41)(3,Vd,2,0,"span"),l()),e&2){let n=i.$implicit;s(),_(n.state==="ENABLED"?1:-1),s(),_(n.state==="BLOCKED"?2:-1),s(),_(n.state==="DISABLED"?3:-1)}}function $d(e,i){e&1&&(r(0,"th",36),m(1,"Pending"),l())}function Ld(e,i){if(e&1&&(r(0,"td",42),m(1),h(2,"number"),l()),e&2){let n=i.$implicit;s(),S(" ",g(2,1,(n.entries==null?null:n.entries.length)||0)," ")}}function Rd(e,i){e&1&&f(0,"th",43)}function Bd(e,i){if(e&1){let n=A();r(0,"td",37)(1,"ya-more")(2,"button",8),v("click",function(){let o=b(n).$implicit,a=d(3);return T(a.enableQueue(o))}),r(3,"mat-icon"),m(4,"check"),l(),m(5," Accept mode "),l(),r(6,"button",8),v("click",function(){let o=b(n).$implicit,a=d(3);return T(a.blockQueue(o))}),r(7,"mat-icon"),m(8,"pause"),l(),m(9," Hold mode "),l(),r(10,"button",8),v("click",function(){let o=b(n).$implicit,a=d(3);return T(a.disableQueue(o))}),r(11,"mat-icon"),m(12,"close"),l(),m(13," Reject mode "),l(),f(14,"mat-divider"),r(15,"a",44),m(16," View command history "),l()()()}if(e&2){let n=i.$implicit,t=d(3);s(15),p("queryParams",vt(1,fd,t.yamcs.context,n.name))}}function Hd(e,i){e&1&&f(0,"tr",45)}function qd(e,i){if(e&1){let n=A();r(0,"tr",46),v("click",function(){let o=b(n).$implicit,a=d(3);return T(a.toggleOne(o))}),l()}if(e&2){let n=i.$implicit,t=d(3);R("selected",t.selection.isSelected(n))}}function jd(e,i){if(e&1&&(r(0,"table",10),M(1,15),u(2,_d,2,1,"th",16)(3,Cd,2,1,"td",17),I(),M(4,18),u(5,hd,2,0,"th",19)(6,gd,2,1,"td",20),I(),M(7,21),u(8,xd,2,0,"th",19)(9,yd,2,1,"td",20),I(),M(10,22),u(11,vd,2,0,"th",19)(12,wd,6,1,"td",20),I(),M(13,23),u(14,kd,2,0,"th",19)(15,Ed,2,2,"td",20),I(),M(16,24),u(17,Dd,2,0,"th",19)(18,Ad,4,1,"td",20),I(),M(19,25),u(20,Fd,2,0,"th",19)(21,Nd,4,3,"td",20),I(),M(22,26),u(23,$d,2,0,"th",19)(24,Ld,3,3,"td",27),I(),M(25,28),u(26,Rd,1,0,"th",29)(27,Bd,17,4,"td",20),I(),u(28,Hd,1,0,"tr",30)(29,qd,1,2,"tr",31),l()),e&2){let n=d(2);p("dataSource",n.dataSource)("trackBy",n.tableTrackerFn),s(28),p("matHeaderRowDef",n.displayedColumns),s(),p("matRowDefColumns",n.displayedColumns)}}function Qd(e,i){if(e&1&&(u(0,jd,30,4,"table",10),r(1,"p"),m(2,"\xA0"),l(),r(3,"nav",11)(4,"a",12,1),m(6," Pending "),l(),r(7,"a",13,2),m(9," Action log "),l()(),r(10,"div",14)(11,"mat-tab-nav-panel",null,3),f(13,"router-outlet"),l()()),e&2){let n=B(5),t=B(8),o=B(12),a=d();_(a.dataSource?0:-1),s(3),p("mat-stretch-tabs",!1)("tabPanel",o),s(),p("active",n.isActive)("queryParams",ce(7,$o,a.yamcs.context)),s(3),p("active",t.isActive)("queryParams",ce(9,$o,a.yamcs.context))}}function Ud(e,i){e&1&&m(0," replay ")}function Gd(e,i){if(e&1&&(r(0,"ya-empty-message",47)(1,"p"),m(2," You are connected to the "),u(3,Ud,1,0),m(4," processor "),r(5,"strong"),m(6),l(),m(7,". "),l(),r(8,"p"),m(9,"This processor does not support commanding."),l()()),e&2){let n=i;s(3),_(n.processor!=null&&n.processor.replay?3:-1),s(3),F(n.processor==null?null:n.processor.name)}}function Yd(e,i){if(e&1&&(u(0,Gd,10,2,"ya-empty-message",47),h(1,"async")),e&2){let n,t=d();_((n=g(1,1,t.connectionInfo$))?0:-1,n)}}var Lo=(()=>{let i=class i{constructor(t,o,a,c,C){this.yamcs=t,this.changeDetection=c,this.cqueues$=new P([]),this.dataSource=new Ke,this.selection=new Jn((x,E)=>E.name,!0,[]),this.tableTrackerFn=(x,E)=>E.name,this.displayedColumns=["select","order","name","issuer","level","patterns","action","pending","actions"],this.visibility$=new P(!0),this.cqueueByName={},o.setTitle("Queues"),this.connectionInfo$=t.connectionInfo$,t.yamcsClient.getCommandQueues(t.instance,t.processor).then(x=>{for(let E of x)this.cqueueByName[E.name]=E;this.emitChange()}).catch(x=>a.showError(x)),this.syncSubscription=C.syncFast(()=>{this.visibility$.next(!this.visibility$.value)}),this.queueSubscription=t.yamcsClient.createQueueStatisticsSubscription({instance:t.instance,processor:t.processor},x=>{let E=this.cqueueByName[x.name];E&&(x.entries=E.entries,this.cqueueByName[x.name]=x,this.emitChange())}),this.queueEventSubscription=t.yamcsClient.createQueueEventsSubscription({instance:t.instance,processor:t.processor},x=>{let E=this.cqueueByName[x.data.queueName];if(E){if(x.type==="COMMAND_ADDED")E.entries=E.entries||[],E.entries.push(x.data);else if(x.type==="COMMAND_UPDATED"){let V=(E.entries||[]).findIndex(N=>N.id===x.data.id);V!==-1&&(E.entries[V]=x.data)}else if(x.type==="COMMAND_REJECTED")E.entries=E.entries||[],E.entries=E.entries.filter(V=>V.id!==x.data.id);else if(x.type==="COMMAND_SENT")E.entries=E.entries||[],E.entries=E.entries.filter(V=>V.id!==x.data.id);else throw new Error(`Unexpected queue event ${x.type}`);this.emitChange()}else console.warn("Received an event for an unknown queue",x)})}ngAfterViewInit(){this.cqueues$.subscribe(t=>{this.dataSource.data=t,this.selection.matchNewValues(t),this.changeDetection.detectChanges()})}isAllSelected(){let t=this.selection.selected.length,o=this.dataSource.filteredData.length;return t===o&&o>0}masterToggle(){this.isAllSelected()?this.selection.clear():this.dataSource.filteredData.forEach(t=>this.selection.select(t))}toggleOne(t){(!this.selection.isSelected(t)||this.selection.selected.length>1)&&this.selection.clear(),this.selection.toggle(t)}enableSelectedQueues(){for(let t of this.selection.selected)this.enableQueue(t)}enableQueue(t){let o=t.entries?.length||0,a=`Are you sure you want to change the '${t.name}' queue's action to ACCEPT?

`;o===1?a+=`There is ${o} queued command that will be accepted immediately.`:a+=`There are ${o} queued commands that will be accepted immediately.`,!(o&&!confirm(a))&&this.yamcs.yamcsClient.enableCommandQueue(t.instance,t.processorName,t.name)}disableSelectedQueues(){for(let t of this.selection.selected)this.disableQueue(t)}disableQueue(t){let o=t.entries?.length||0,a=`Are you sure you want to change the '${t.name}' queue's action to REJECT?

`;o===1?a+=`There is ${o} queued command that will be rejected immediately.`:a+=`There are ${o} queued commands that will be rejected immediately.`,!(o&&!confirm(a))&&this.yamcs.yamcsClient.disableCommandQueue(t.instance,t.processorName,t.name)}blockSelectedQueues(){for(let t of this.selection.selected)this.blockQueue(t)}blockQueue(t){this.yamcs.yamcsClient.blockCommandQueue(t.instance,t.processorName,t.name)}emitChange(){this.cqueues$.next(Object.values(this.cqueueByName))}ngOnDestroy(){this.syncSubscription?.unsubscribe(),this.queueSubscription?.cancel(),this.queueEventSubscription?.cancel()}};i.\u0275fac=function(o){return new(o||i)(y(U),y(we),y(et),y(wt),y(ei))},i.\u0275cmp=w({type:i,selectors:[["ng-component"]],standalone:!0,features:[k],decls:47,vars:5,consts:[["actionMenu","matMenu"],["rla","routerLinkActive"],["rlb","routerLinkActive"],["tabPanel",""],["yaSimpleTable","",2,"width","100%"],["width","1"],["mat-button","","color","primary",3,"matMenuTriggerFor","disabled"],[1,"ya-menu"],["mat-menu-item","",3,"click"],[1,"panel-content"],["mat-table","",1,"ya-data-table","expand",3,"dataSource","trackBy"],["mat-tab-nav-bar","",1,"secondary",3,"mat-stretch-tabs","tabPanel"],["mat-tab-link","","routerLink","/commanding/queues/pending","routerLinkActive","",3,"active","queryParams"],["mat-tab-link","","routerLink","/commanding/queues/log","routerLinkActive","",3,"active","queryParams"],[2,"margin-top","16px"],["cdkColumnDef","select"],["mat-header-cell","","class","checkbox",4,"cdkHeaderCellDef"],["mat-cell","","class","checkbox",4,"cdkCellDef"],["matColumnDef","order"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","name"],["matColumnDef","issuer"],["matColumnDef","level"],["matColumnDef","patterns"],["matColumnDef","action"],["matColumnDef","pending"],["mat-cell","","style","text-align: center",4,"matCellDef"],["matColumnDef","actions"],["mat-header-cell","","class","expand",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",3,"selected","click",4,"matRowDef","matRowDefColumns"],["mat-header-cell","",1,"checkbox"],["type","checkbox",3,"change","checked"],["mat-cell","",1,"checkbox"],["type","checkbox",3,"click","change","checked"],["mat-header-cell",""],["mat-cell",""],["icon","people"],["icon","person"],[3,"level","grayscale"],[3,"visibility"],["mat-cell","",2,"text-align","center"],["mat-header-cell","",1,"expand"],["mat-menu-item","","routerLink","/commanding/history",3,"queryParams"],["mat-header-row",""],["mat-row","",3,"click"],["headerTitle","Queues"]],template:function(o,a){if(o&1){let c=A();r(0,"app-instance-page")(1,"app-instance-toolbar"),m(2," Queues "),r(3,"ya-help")(4,"p"),m(5," A queue is a temporary holding location for issued commands that are waiting to enter the next stage of processing. "),l(),r(6,"p"),m(7,"Queues are an ordered list. Issued commands are offered to the first matching queue."),l(),r(8,"p"),m(9,"A queue can perform these actions:"),l(),r(10,"table",4)(11,"tr")(12,"th",5),m(13,"ACCEPT"),l(),r(14,"td"),m(15,"The queue accepts and releases commands."),l()(),r(16,"tr")(17,"th"),m(18,"HOLD"),l(),r(19,"td"),m(20," The queue accepts commands but does not release them. These commands may be released manually, or automatically as soon as the queue action changes to ACCEPT. "),l()(),r(21,"tr")(22,"th"),m(23,"REJECT"),l(),r(24,"td"),m(25,"The queue does not accept commands. Matching commands fail immediately."),l()()()(),m(26," \xA0\xA0\xA0 "),r(27,"button",6),m(28," Change action \u25BE "),l(),r(29,"mat-menu",7,0)(31,"button",8),v("click",function(){return b(c),T(a.enableSelectedQueues())}),r(32,"mat-icon"),m(33,"check"),l(),m(34," ACCEPT "),l(),r(35,"button",8),v("click",function(){return b(c),T(a.blockSelectedQueues())}),r(36,"mat-icon"),m(37,"pause"),l(),m(38," HOLD "),l(),r(39,"button",8),v("click",function(){return b(c),T(a.disableSelectedQueues())}),r(40,"mat-icon"),m(41,"close"),l(),m(42," REJECT "),l()()(),r(43,"div",9),u(44,Qd,14,11),h(45,"async"),u(46,Yd,2,3),l()()}if(o&2){let c,C=B(30);s(27),p("matMenuTriggerFor",C)("disabled",a.selection.isEmpty()),s(17),_(!((c=g(45,3,a.connectionInfo$))==null||c.processor==null)&&c.processor.hasCommanding?44:46)}},dependencies:[Te,be,D,Q,Nn,kt,$e,wi,Ui,gt,at,rt,ht,oe,We,_t,Ye,Ct,ge,Ae,He,Fe,Ie,qe,xe,ye,ve,Se,Ni,Li,$i,It,ee,io,At,it],encapsulation:2,changeDetection:0});let e=i;return e})();var Ro=(()=>{let i=class i{constructor(t){this.dialogRef=t}confirmDiscard(){this.dialogRef.close(!0)}};i.\u0275fac=function(o){return new(o||i)(y(Ce))},i.\u0275cmp=w({type:i,selectors:[["app-stack-file-page-dirty-dialog"]],standalone:!0,features:[k],decls:10,vars:0,consts:[["align","end"],["mat-dialog-close","",1,"ya-button"],[1,"ya-button","primary",3,"click"]],template:function(o,a){o&1&&(r(0,"mat-dialog-content")(1,"h3"),m(2,"Close without saving?"),l(),r(3,"p"),m(4,"You have unsaved changes, close without saving?"),l()(),r(5,"mat-dialog-actions",0)(6,"button",1),m(7,"CANCEL"),l(),r(8,"button",2),v("click",function(){return a.confirmDiscard()}),m(9,"OK"),l()())},dependencies:[D,he,Me,De],encapsulation:2});let e=i;return e})();var Bo=e=>Ht(bn).canDeactivate(e),bn=(()=>{let i=class i{constructor(t,o,a){this.dialog=t,this.authService=o,this.dialogOpen$=new P(!1),this.bucket=a.getStackBucket()}canDeactivate(t){return this.dialogOpen$.value?new un(o=>{this.dialogRef.afterClosed().subscribe({next:a=>{o.next(a===!0),o.complete()},error:()=>{o.next(!1),o.complete()}})}):t.hasPendingChanges()&&this.mayManageStacks()?new un(o=>{this.dialogOpen$.next(!0),this.dialogRef=this.dialog.open(Ro,{width:"400px"}),this.dialogRef.afterClosed().subscribe({next:a=>{this.dialogOpen$.next(!1),o.next(a===!0),o.complete()},error:()=>{this.dialogOpen$.next(!1),o.next(!1),o.complete()}})}):kn(!0)}mayManageStacks(){let t=this.authService.getUser();return t.hasObjectPrivilege("ManageBucket",this.bucket)||t.hasSystemPrivilege("ManageAnyBucket")}};i.\u0275fac=function(o){return new(o||i)(pt(Je),pt(tt),pt(Oe))},i.\u0275prov=Bt({token:i,factory:i.\u0275fac});let e=i;return e})();var Ho=(()=>{let i=class i{transform(t){return t?t==="CommandComplete"?"Completed":t.replace("Acknowledge_",""):null}};i.\u0275fac=function(o){return new(o||i)},i.\u0275pipe=qt({name:"acknowledgmentName",type:i,pure:!0,standalone:!0});let e=i;return e})();function Wd(e,i){if(e&1&&(r(0,"tr")(1,"th"),m(2),l(),r(3,"td"),m(4),l()()),e&2){let n=i.$implicit;s(2),F(n.name),s(2),F(n.description||"-")}}function zd(e,i){if(e&1&&(r(0,"p"),m(1,"\xA0"),l(),r(2,"p"),m(3,"Verifiers:"),l(),r(4,"table",1),H(5,Wd,5,2,"tr",null,G),l()),e&2){let n=d();s(5),q(n.verifiers)}}function Jd(e,i){if(e&1&&(r(0,"tr")(1,"th"),m(2),l(),r(3,"td"),m(4),l()()),e&2){let n=i.$implicit;s(2),F(n.name.replace("Acknowledge_","")),s(2),F(n.description||"-")}}function Kd(e,i){if(e&1&&(r(0,"p"),m(1,"\xA0"),l(),r(2,"p"),m(3,"Extra acknowledgments:"),l(),r(4,"table",1),H(5,Jd,5,2,"tr",null,G),l()),e&2){let n=d();s(5),q(n.extra)}}var cn=(()=>{let i=class i{constructor(){this.verifiers=[],this.extra=[]}};i.\u0275fac=function(o){return new(o||i)},i.\u0275cmp=w({type:i,selectors:[["app-advance-ack-help"]],inputs:{verifiers:"verifiers",extra:"extra"},standalone:!0,features:[k],decls:29,vars:2,consts:[["dialogTitle","Await acknowledgement success","dialogWidth","800px"],["yaSimpleTable","",2,"width","100%"],["width","1"]],template:function(o,a){o&1&&(r(0,"ya-help",0)(1,"p"),m(2," Configure the acknowledgment which is required to be successful before advancing to the next command in the stack. "),l(),r(3,"table",1)(4,"tr")(5,"th",2),m(6,"Queued"),l(),r(7,"td"),m(8,"The command was accepted into a Yamcs queue."),l()(),r(9,"tr")(10,"th"),m(11,"Released"),l(),r(12,"td"),m(13,"The command was released from its assigned Yamcs queue."),l()(),r(14,"tr")(15,"th"),m(16,"Sent"),l(),r(17,"td"),m(18,"The command was processed by a Yamcs link."),l()(),r(19,"tr")(20,"th"),m(21,"Completed"),l(),r(22,"td")(23,"p"),m(24,"The command completed successfully."),l(),r(25,"p"),m(26," This requires the configuration of a success verifier in the Mission Database specification. "),l()()()(),u(27,zd,7,0)(28,Kd,7,0),l()),o&2&&(s(27),_(a.verifiers.length?27:-1),s(),_(a.extra.length?28:-1))},dependencies:[D,Ui,ee],encapsulation:2,changeDetection:0});let e=i;return e})();var Xd=["top"],Zd=["searchFilter"];function ep(e,i){if(e&1){let n=A();r(0,"ya-breadcrumb",10),v("click",function(){let o=b(n).$implicit,a=d(3);return T(a.changeSystem(o.system))}),l()}if(e&2){let n=i.$implicit;p("action",!0)("label",n.name)}}function tp(e,i){if(e&1){let n=A();r(0,"div",3)(1,"ya-breadcrumb-trail")(2,"ya-breadcrumb",8),v("click",function(){b(n);let o=d(2);return T(o.changeSystem(""))}),l(),H(3,ep,1,2,"ya-breadcrumb",9,G),l()()}if(e&2){let n=d();s(2),p("action",!0),s(),q(n)}}function ip(e,i){e&1&&u(0,tp,5,1,"div",3),e&2&&_(i.length?0:-1)}function np(e,i){e&1&&(r(0,"th",24),m(1,"Name"),l())}function op(e,i){if(e&1){let n=A();r(0,"mat-icon",26),m(1,"folder"),l(),r(2,"a",27),v("click",function(){b(n);let o=d().$implicit,a=d(2);return T(a.selectRow(o))}),m(3),h(4,"filename"),l()}if(e&2){let n=d().$implicit;s(3),S("",g(4,1,n.name),"/")}}function ap(e,i){if(e&1&&f(0,"ya-highlight",28),e&2){let n=d(2).$implicit,t=d(2);p("text",n.command.qualifiedName)("term",t.filterControl.value)}}function rp(e,i){if(e&1&&(f(0,"ya-highlight",28),h(1,"slice")),e&2){let n=d(2).$implicit,t=d(2);p("text",Ve(1,2,n.command.qualifiedName,t.system.length+1))("term",t.filterControl.value)}}function lp(e,i){if(e&1){let n=A();r(0,"mat-icon",26),m(1,"rss_feed"),l(),r(2,"a",27),v("click",function(){b(n);let o=d().$implicit,a=d(2);return T(a.selectRow(o))}),u(3,ap,1,2,"ya-highlight",28)(4,rp,2,5,"ya-highlight",28),l()}if(e&2){let n=d(3);s(3),_(n.system?-1:3),s(),_(n.system?4:-1)}}function mp(e,i){if(e&1&&(r(0,"td",25),u(1,op,5,3)(2,lp,5,2),l()),e&2){let n=i.$implicit;s(),_(n.system?1:-1),s(),_(n.command?2:-1)}}function sp(e,i){e&1&&(r(0,"th",24),m(1,"Description"),l())}function cp(e,i){if(e&1&&m(0),e&2){let n=d().$implicit;S(" ",n.system.shortDescription||"-"," ")}}function dp(e,i){if(e&1&&f(0,"ya-highlight",28),e&2){let n=d(4);p("text",i)("term",n.filterControl.value)}}function pp(e,i){e&1&&m(0," - ")}function up(e,i){if(e&1&&u(0,dp,1,2,"ya-highlight",28)(1,pp,1,0),e&2){let n,t=d().$implicit;_((n=t.command.shortDescription)?0:1,n)}}function fp(e,i){if(e&1&&(r(0,"td",29),u(1,cp,1,1)(2,up,2,1),l()),e&2){let n=i.$implicit;s(),_(n.system?1:-1),s(),_(n.command?2:-1)}}function _p(e,i){e&1&&(r(0,"th",24),m(1,"Significance"),l())}function Cp(e,i){e&1&&f(0,"app-significance-level",31),e&2&&p("level",i.consequenceLevel)}function hp(e,i){e&1&&m(0," - ")}function gp(e,i){if(e&1&&(r(0,"td",30),u(1,Cp,1,1,"app-significance-level",31)(2,hp,1,0),l()),e&2){let n,t=i.$implicit;s(),_((n=t.command==null?null:t.command.effectiveSignificance)?1:2,n)}}function xp(e,i){if(e&1&&(r(0,"th",24),m(1),l()),e&2){let n=d().$implicit;s(),S(" ",n.label," ")}}function yp(e,i){if(e&1&&f(0,"ya-highlight",28),e&2){let n=d(4);p("text",i)("term",n.filterControl.value)}}function vp(e,i){e&1&&m(0," - ")}function Sp(e,i){if(e&1&&(r(0,"td",30),u(1,yp,1,2,"ya-highlight",28),h(2,"alias"),u(3,vp,1,0),l()),e&2){let n,t=i.$implicit,o=d().$implicit;s(),_((n=Ve(2,1,t.command,o.id))?1:3,n)}}function bp(e,i){if(e&1&&(M(0,18),u(1,xp,2,1,"th",32)(2,Sp,4,4,"td",21),I()),e&2){let n=i.$implicit;p("matColumnDef",n.id)}}function Tp(e,i){e&1&&f(0,"th",33)}function wp(e,i){e&1&&f(0,"td",30)}function kp(e,i){e&1&&f(0,"tr",34)}function Ep(e,i){if(e&1&&f(0,"tr",35),e&2){let n=i.$implicit,t=d(2);R("selected",t.selection.isSelected(n))}}function Dp(e,i){if(e&1&&(r(0,"table",6),M(1,11),u(2,np,2,0,"th",12)(3,mp,3,2,"td",13),I(),M(4,14),u(5,sp,2,0,"th",12)(6,fp,3,2,"td",15),I(),M(7,16),u(8,_p,2,0,"th",12)(9,gp,3,1,"td",17),I(),H(10,bp,3,1,"ng-container",18,G),h(12,"async"),M(13,19),u(14,Tp,1,0,"th",20)(15,wp,1,0,"td",21),I(),u(16,kp,1,0,"tr",22),h(17,"async"),u(18,Ep,1,2,"tr",23),h(19,"async"),l()),e&2){let n=d(),t=B(8);p("dataSource",n.dataSource),s(10),q(g(12,3,n.aliasColumns$)),s(6),p("matHeaderRowDef",g(17,5,t.displayedColumns$)),s(2),p("matRowDefColumns",g(19,7,t.displayedColumns$))}}var qo=(()=>{let i=class i{constructor(t,o){this.yamcs=t,this.changeDetection=o,this.pageSize=100,this.system=null,this.breadcrumb$=new P([]),this.filterControl=new j,this.columns=[{id:"name",label:"Name",alwaysVisible:!0},{id:"significance",label:"Significance",visible:!0},{id:"shortDescription",label:"Description"},{id:"actions",label:"",alwaysVisible:!0}],this.aliasColumns$=new P([]),this.selection=new ut(!1),this.selectedCommand$=new P(null),this.onChange=a=>{},this.onTouched=()=>{},this.dataSource=new ui(t),this.selectedCommand$.subscribe(async a=>{if(a&&a.command){let c=await this.yamcs.yamcsClient.getCommand(this.yamcs.instance,a.command.qualifiedName);return this.onChange(c)}else return this.onChange(null)})}ngAfterViewInit(){this.changeSystem(""),this.searchFilter.filter.nativeElement.focus(),this.filterControl.valueChanges.subscribe(()=>{this.paginator.pageIndex=0,this.updateDataSource()}),this.paginator.page.subscribe(()=>{this.updateDataSource(),this.top.nativeElement.scrollIntoView()})}changeSystem(t,o=0){this.system=t,this.updateBrowsePath(),this.paginator.pageIndex=o,this.updateDataSource()}updateDataSource(){let t={system:this.system||"/",noAbstract:!0,details:!0,pos:this.paginator.pageIndex*this.pageSize,limit:this.pageSize,fields:["name","qualifiedName","alias","effectiveSignificance","shortDescription"]},o=this.filterControl.value;o&&(t.q=o.toLowerCase()),this.dataSource.loadCommands(t).then(()=>{this.selection.clear(),this.updateBrowsePath();for(let c of this.aliasColumns$.value){let C=this.columns.indexOf(c);C!==-1&&this.columns.splice(C,1)}let a=[];for(let c of this.dataSource.getAliasNamespaces()){let C={id:c,label:c,alwaysVisible:!0};a.push(C)}this.columns.splice(1,0,...a),this.aliasColumns$.next(a),this.columnChooser.recalculate(this.columns)})}selectRow(t){return t.system?(this.selectedCommand$.next(null),this.changeSystem(t.name)):this.selectedCommand$.next(t),!1}updateBrowsePath(){let t=[],o="";if(this.system)for(let a of this.system.slice(1).split("/"))o+="/"+a,t.push({name:a,system:o});this.breadcrumb$.next(t)}selectNext(){let t=this.dataSource.items$.value,o=0;if(this.selection.hasValue()){let a=this.selection.selected[0];t.indexOf(a)!==-1&&(o=Math.min(t.indexOf(a)+1,t.length-1))}this.selection.select(t[o])}selectPrevious(){let t=this.dataSource.items$.value,o=0;if(this.selection.hasValue()){let a=this.selection.selected[0];t.indexOf(a)!==-1&&(o=Math.max(t.indexOf(a)-1,0))}this.selection.select(t[o])}applySelection(){if(this.selection.hasValue()){let t=this.selection.selected[0],o=this.dataSource.items$.value;t.command&&o.indexOf(t)!==-1&&this.selectRow(t)}}writeValue(t){this.path=t}registerOnChange(t){this.onChange=t}registerOnTouched(t){this.onTouched=t}};i.\u0275fac=function(o){return new(o||i)(y(U),y(wt))},i.\u0275cmp=w({type:i,selectors:[["app-command-selector"]],viewQuery:function(o,a){if(o&1&&(z(Xd,7),z(Be,5),z(lt,5),z(Zd,5)),o&2){let c;J(c=K())&&(a.top=c.first),J(c=K())&&(a.paginator=c.first),J(c=K())&&(a.columnChooser=c.first),J(c=K())&&(a.searchFilter=c.first)}},inputs:{path:"path"},standalone:!0,features:[de([{provide:Le,useExisting:se(()=>i),multi:!0}]),k],decls:12,vars:12,consts:[["top",""],["searchFilter",""],["columnChooser",""],[1,"filter-bar"],["placeholder","Search by name","icon","search",3,"onArrowDown","onArrowUp","onEnter","formControl"],["preferenceKey","sendCommand",3,"columns"],["mat-table","",1,"ya-data-table","expand",3,"dataSource"],[3,"pageSize","hidePageSize","showFirstLastButtons","length"],["icon","account_tree",3,"click","action"],[3,"action","label"],[3,"click","action","label"],["cdkColumnDef","name"],["mat-header-cell","",4,"cdkHeaderCellDef"],["mat-cell","","class","primary-td",4,"cdkCellDef"],["cdkColumnDef","shortDescription"],["mat-cell","","class","wrap200",4,"cdkCellDef"],["cdkColumnDef","significance"],["mat-cell","",4,"cdkCellDef"],[3,"matColumnDef"],["matColumnDef","actions"],["mat-header-cell","","class","expand",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",3,"selected",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell","",1,"primary-td"],[1,"icon12",2,"vertical-align","middle"],["href","",3,"click"],[3,"text","term"],["mat-cell","",1,"wrap200"],["mat-cell",""],[3,"level"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-header-cell","",1,"expand"],["mat-header-row",""],["mat-row",""]],template:function(o,a){if(o&1){let c=A();f(0,"span",null,0),u(2,ip,1,1),h(3,"async"),r(4,"div",3)(5,"ya-search-filter",4,1),v("onArrowDown",function(){return b(c),T(a.selectNext())})("onArrowUp",function(){return b(c),T(a.selectPrevious())})("onEnter",function(){return b(c),T(a.applySelection())}),l(),f(7,"ya-column-chooser",5,2),l(),u(9,Dp,20,9,"table",6),f(10,"mat-paginator",7),h(11,"async")}if(o&2){let c;s(2),_((c=g(3,8,a.breadcrumb$))?2:-1,c),s(3),p("formControl",a.filterControl),s(2),p("columns",a.columns),s(2),_(a.dataSource?9:-1),s(),p("pageSize",a.pageSize)("hidePageSize",!0)("showFirstLastButtons",!0)("length",g(11,10,a.dataSource.totalSize$))}},dependencies:[it,D,Q,Ti,$,_e,gt,at,rt,oe,Be,ge,Ae,He,Fe,Ie,qe,xe,ye,ve,Se,Wt,Yt,lt,Jt,Ft,Kt,Xt],styles:[".pullRight[_ngcontent-%COMP%]{float:right}.primary-td[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{margin-right:7px}"],changeDetection:0});let e=i;return e})();var Mp=["commandSelector"],Ip=["commandForm"],Ap=()=>[];function Fp(e,i){if(e&1&&(r(0,"div",3)(1,"form",4)(2,"h2"),m(3,"Select command"),l(),r(4,"div",5),f(5,"app-command-selector",6,0),l()()(),r(7,"div",7)(8,"mat-toolbar")(9,"mat-toolbar-row")(10,"button",8),m(11,"CANCEL"),l()()()()),e&2){let n=d();s(),p("formGroup",n.selectCommandForm)}}function Op(e,i){if(e&1){let n=A();r(0,"ya-text-action",15),v("click",function(){let o=b(n),a=d(2);return T(a.returnToList(o))}),m(1),l()}e&2&&(p("padding",!1),s(),S(" ",i," "))}function Pp(e,i){if(e&1&&(r(0,"div"),m(1),f(2,"br"),r(3,"h2"),m(4),l()()),e&2){let n=i.$implicit;s(),S(" ",n.namespace,""),s(3),F(n.name)}}function Vp(e,i){e&1&&f(0,"input",20)}function Np(e,i){if(e&1&&(r(0,"form",13)(1,"p"),m(2,"\xA0"),l(),r(3,"h3"),m(4,"Stack advancement"),l(),r(5,"div",16),m(6," Advance when "),f(7,"app-advance-ack-help",17)(8,"br"),r(9,"div",18),f(10,"ya-select",19,2),u(12,Vp,1,0,"input",20),l()(),f(13,"br"),r(14,"div",16),m(15," Wait (ms) "),r(16,"ya-help",21)(17,"p"),m(18,"Wait time before advancing to the next command in the stack."),l(),r(19,"p"),m(20,"This triggers after successful acknowledgment."),l()(),f(21,"br")(22,"input",22),l()()),e&2){let n,t=d(2);p("formGroup",t.stackOptionsForm)("ngClass",t.stackOptionsForm.disabled&&"disabled"),s(7),p("verifiers",t.verifierAcknowledgments)("extra",t.extraAcknowledgments),s(3),p("options",t.ackOptions),s(2),_(((n=t.stackOptionsForm.get("advancementAckDropDown"))==null?null:n.value)==="custom"?12:-1)}}function $p(e,i){if(e&1){let n=A();r(0,"div",3)(1,"div",9)(2,"div",10)(3,"div"),u(4,Op,2,2,"ya-text-action",11),h(5,"spaceSystemName"),r(6,"h2"),m(7),l()(),H(8,Pp,5,2,"div",null,G),l(),r(10,"p"),m(11,"\xA0"),l(),f(12,"app-command-form",12,1),u(14,Np,23,6,"form",13),l()(),r(15,"div",7)(16,"mat-toolbar")(17,"mat-toolbar-row")(18,"button",8),m(19,"CANCEL"),l(),m(20,"\xA0\xA0 "),r(21,"button",14),v("click",function(){b(n);let o=d();return T(o.handleOK())}),m(22),l()()()()}if(e&2){let n,t=i,o=B(13),a=d();s(4),_((n=g(5,7,t.qualifiedName))?4:-1,n),s(3),F(t.name),s(),q(t.alias||Tt(9,Ap)),s(4),p("command",t)("templateProvider",a.templateProvider),s(2),_(a.format==="ycs"?14:-1),s(7),p("disabled",!o.form.valid),s(),S(" ",a.okLabel," ")}}var Tn=class{constructor(i){this.entry=i}getAssignment(i){for(let n in this.entry.args)if(n===i){let t=this.entry.args[n];return O.toValue(t)}}getOption(i,n){for(let t in this.entry.extra||{})if(t===i){let o=this.entry.extra[t];switch(n){case"BOOLEAN":return this.getBooleanOption(o);case"NUMBER":return this.getNumberOption(o);case"STRING":return this.getStringOption(o)}}}getBooleanOption(i){if(i.type==="BOOLEAN")return i}getNumberOption(i){switch(i.type){case"SINT32":case"UINT32":case"SINT64":case"UINT64":return i}}getStringOption(i){if(i.type==="STRING")return i}getComment(){return this.entry.comment}},wn=(()=>{let i=class i{constructor(t,o,a,c,C){this.dialogRef=t,this.yamcs=o,this.changeDetection=c,this.data=C,this.okLabel="OK",this.verifierAcknowledgments=[],this.extraAcknowledgments=[],this.ackOptions=[{id:"",label:"Inherit"},{id:"Acknowledge_Queued",label:"Queued",group:!0},{id:"Acknowledge_Released",label:"Released"},{id:"Acknowledge_Sent",label:"Sent"},{id:"CommandComplete",label:"Completed"}],this.commandFormValid$=new P(!1),this.selectedCommand$=new P(null);let x,E,V;if(C?.entry){let N=C.entry;if(this.templateProvider=new Tn(N),this.selectedCommand$.next(N.command??null),this.verifierAcknowledgments=[],N.command){let fe=[],X=N.command;for(;X;)fe.unshift(X),X=X.baseCommand;for(let dt of fe)for(let Ko of dt.verifier??[])this.verifierAcknowledgments.push({name:`Verifier_${Ko.stage}`});let me=!0;for(let dt of this.verifierAcknowledgments)this.ackOptions.push({id:dt.name,label:dt.name,group:me}),me=!1}this.extraAcknowledgments=o.getProcessor()?.acknowledgments??[];let te=!0;for(let fe of this.extraAcknowledgments)this.ackOptions.push({id:fe.name,label:fe.name.replace("Acknowledge_",""),group:te}),te=!1;if(this.ackOptions.push({id:"custom",label:"Custom",group:!0}),N.advancement?.acknowledgment){let fe=this.ackOptions.find(X=>X.id===N.advancement.acknowledgment);x=fe?fe.id:"custom"}E=x==="custom"?N.advancement?.acknowledgment:"",V=N.advancement?.wait}C?.okLabel&&(this.okLabel=C?.okLabel),C?.format&&(this.format=C.format),this.stackOptionsForm=a.group({advancementAckDropDown:[x||"",[]],advancementAckCustom:[E,[]],advancementWait:[V,[]]}),this.format!=="ycs"&&this.stackOptionsForm.disable(),this.selectCommandForm=a.group({command:["",W.required]}),this.selectCommandForm.valueChanges.subscribe(()=>{let N=this.selectCommandForm.value.command;this.selectedCommand$.next(N||null)}),this.stackOptionsForm.valueChanges.subscribe(N=>{N.advancementAckDropDown!=="custom"&&this.stackOptionsForm.patchValue({advancementAckCustom:void 0},{emitEvent:!1})})}handleOK(){let t={},o=this.stackOptionsForm.get("advancementAckDropDown")?.value,a=this.stackOptionsForm.get("advancementAckCustom")?.value?.trim(),c=this.stackOptionsForm.get("advancementWait")?.value;(o&&o!=="custom"||o==="custom"&&a||c!=null)&&(t.advancement=ae(ae(ae({},o&&o!=="custom"&&{acknowledgment:o}),o==="custom"&&a&&{acknowledgment:a}),c!=null&&{wait:c}));let C={command:this.selectedCommand$.value,args:this.commandForm.getAssignments(),comment:this.commandForm.getComment(),extra:this.commandForm.getExtraOptions(),stackOptions:t};this.dialogRef.close(C)}returnToList(t){this.templateProvider=null,this.selectedCommand$.next(null),this.changeDetection.detectChanges(),this.selectCommandForm.reset(),this.stackOptionsForm.reset(),this.commandSelector.changeSystem(t==="/"?"":t)}};i.\u0275fac=function(o){return new(o||i)(y(Ce),y(U),y(Ge),y(wt),y(ze))},i.\u0275cmp=w({type:i,selectors:[["ng-component"]],viewQuery:function(o,a){if(o&1&&(z(Mp,5),z(Ip,5)),o&2){let c;J(c=K())&&(a.commandSelector=c.first),J(c=K())&&(a.commandForm=c.first)}},standalone:!0,features:[k],decls:4,vars:6,consts:[["commandSelector",""],["commandForm",""],["ackSelect",""],[1,"wrapper"],[1,"ya-form",3,"formGroup"],[1,"command-table-wrapper"],["formControlName","command"],[1,"footer"],["mat-dialog-close","",1,"ya-button"],[1,"command-detail"],[1,"names"],[3,"padding"],[3,"command","templateProvider"],[1,"ya-form",3,"formGroup","ngClass"],[1,"ya-button","primary",3,"click","disabled"],[3,"click","padding"],[1,"label"],[3,"verifiers","extra"],[2,"display","flex","align-items","flex-start"],["formControlName","advancementAckDropDown","emptyOption","Inherit",3,"options"],["type","text","formControlName","advancementAckCustom",2,"width","200px","margin-left","-1px"],["dialogTitle","Wait time"],["type","number","formControlName","advancementWait","placeholder","Inherit","step","1000","min","0"]],template:function(o,a){if(o&1&&(u(0,Fp,12,1),h(1,"async"),u(2,$p,23,10),h(3,"async")),o&2){let c;_(g(1,2,a.selectedCommand$)?-1:0),s(2),_((c=g(3,4,a.selectedCommand$))?2:-1,c)}},dependencies:[cn,sn,qo,D,Si,Q,re,pe,Ei,$,ie,Di,ne,Z,he,Et,Ai,ee,Ze,zt,Zt],styles:[".mat-mdc-dialog-container{border-radius:0;position:relative}.wrapper[_ngcontent-%COMP%]{position:relative;height:calc(100% - 48px);overflow:auto}.command-table-wrapper[_ngcontent-%COMP%]{position:absolute;overflow:auto;inset:56px 0 1em}.command-detail[_ngcontent-%COMP%]{max-width:600px}.footer[_ngcontent-%COMP%]{position:absolute;bottom:0;height:64px;left:0;right:0;border-top:1px solid #d3d3d3}.disabled[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{opacity:.6}div.names[_ngcontent-%COMP%]{display:flex}div.names[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{padding-right:25px}div.names[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:not(:first-child){padding-left:25px;border-left:1px solid rgba(0,0,0,.1)}div.names[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0}div.names[_ngcontent-%COMP%]     .text-action{line-height:0}"]});let e=i;return e})();var jo=(()=>{let i=class i{constructor(t,o){this.dialogRef=t,this.form=o.group({executionTime:["",[W.required]],tags:[[],[]]})}schedule(){this.dialogRef.close(this.form.value)}};i.\u0275fac=function(o){return new(o||i)(y(Ce),y(Ge))},i.\u0275cmp=w({type:i,selectors:[["app-schedule-stack-dialog"]],standalone:!0,features:[k],decls:26,vars:3,consts:[["mat-dialog-title",""],[1,"hint"],[1,"ya-form",3,"formGroup"],[1,"label"],["formControlName","executionTime",3,"showMillis"],[1,"half-break"],["dialogTitle","Timeline Tags"],["formControlName","tags"],["align","end"],[2,"flex","1 1 auto"],["mat-dialog-close","",1,"ya-button"],[1,"ya-button","primary",3,"click","disabled"]],template:function(o,a){o&1&&(r(0,"h2",0),m(1,"Run later"),l(),r(2,"mat-dialog-content")(3,"div",1)(4,"p"),m(5," This command stack will be submitted to the Yamcs Timeline, for execution at a later time. "),l()(),r(6,"form",2)(7,"div",3),m(8," Execution time"),f(9,"br")(10,"ya-date-time-input",4),l(),f(11,"hr",5),r(12,"div",3),m(13," Timeline tags "),r(14,"span",1),m(15,"(optional)"),l(),r(16,"ya-help",6),m(17," Tags allow to categorise items per band. Bands only show items for which one of the tags is matching. "),l(),f(18,"br")(19,"ya-tag-select",7),l()()(),r(20,"mat-dialog-actions",8),f(21,"div",9),r(22,"button",10),m(23,"CANCEL"),l(),r(24,"button",11),v("click",function(){return a.schedule()}),m(25,"SCHEDULE"),l()()),o&2&&(s(6),p("formGroup",a.form),s(4),p("showMillis",!0),s(14),p("disabled",!a.form.valid))},dependencies:[D,re,$,ie,ne,Z,he,Re,Me,De,Xe,ee,qi],encapsulation:2,changeDetection:0});let e=i;return e})();function Lp(e,i){if(e&1&&(r(0,"div",3),m(1),l(),r(2,"div",2),m(3),l()),e&2){let n=i.$implicit;s(),F(n.namespace),s(2),S(" ",n.name," ")}}function Rp(e,i){if(e&1&&f(0,"app-markdown",4),e&2){let n=d();p("text",n.entry.command==null?null:n.entry.command.longDescription)}}function Bp(e,i){if(e&1&&m(0),e&2){let n=d();S(" ",(n.entry.command==null?null:n.entry.command.shortDescription)||"-"," ")}}function Hp(e,i){if(e&1&&(f(0,"app-significance-level",7),m(1)),e&2){let n=i;p("level",n.consequenceLevel),s(),S(" ",n.reasonForWarning," ")}}function qp(e,i){e&1&&m(0," - ")}function jp(e,i){e&1&&(r(0,"span",8),m(1,"satisfied"),l())}function Qp(e,i){e&1&&(r(0,"span",9),m(1,"not satisfied"),l())}function Up(e,i){if(e&1&&(r(0,"tr")(1,"td"),m(2),l(),r(3,"td"),m(4),l(),r(5,"td"),u(6,jp,2,0,"span",8),h(7,"async"),u(8,Qp,2,0,"span",9),h(9,"async"),f(10,"app-live-expression",10,0),l()()),e&2){let n=i.$implicit,t=B(11);s(2),F(n.expression),s(2),F(n.timeout||"-"),s(2),_(g(7,7,t.result$)===!0?6:-1),s(2),_(g(9,9,t.result$)===!1?8:-1),s(2),st("display","none"),p("expression",n.expression)}}function Gp(e,i){e&1&&(r(0,"table",6)(1,"tr")(2,"th"),m(3,"Constraint"),l(),r(4,"th"),m(5,"Timeout"),l(),r(6,"th"),m(7,"Live Evaluation"),l()(),H(8,Up,12,11,"tr",null,G),l()),e&2&&(s(8),q(i))}function Yp(e,i){e&1&&m(0," - ")}var Qo=(()=>{let i=class i{};i.\u0275fac=function(o){return new(o||i)},i.\u0275cmp=w({type:i,selectors:[["app-stacked-command-detail"]],inputs:{entry:"entry"},standalone:!0,features:[k],decls:29,vars:10,consts:[["expr",""],[1,"block-title",2,"padding-top","0"],[1,"block"],[1,"block-title"],[3,"text"],[2,"margin-top","1em","margin-bottom","1em"],["yaDataTable",""],[3,"level"],[1,"evaluation","valid"],[1,"evaluation","invalid"],[3,"expression"]],template:function(o,a){if(o&1&&(r(0,"div",1),m(1,"Command"),l(),r(2,"div",2),m(3),h(4,"shortName"),l(),r(5,"div",3),m(6,"System"),l(),r(7,"div",2),m(8),h(9,"spaceSystemName"),l(),H(10,Lp,4,2,null,null,G),r(12,"div",3),m(13,"Description"),l(),r(14,"div",2),u(15,Rp,1,1,"app-markdown",4)(16,Bp,1,1),l(),f(17,"mat-divider",5),r(18,"div",3),m(19,"Significance"),l(),r(20,"div",2),u(21,Hp,2,2)(22,qp,1,0),l(),f(23,"mat-divider",5),r(24,"div",1),m(25,"Constraints"),l(),r(26,"div",2),u(27,Gp,10,0,"table",6)(28,Yp,1,0),l()),o&2){let c,C;s(3),S(" ",g(4,6,a.entry.command==null?null:a.entry.command.qualifiedName)||"-",`
`),s(5),S(" ",g(9,8,a.entry.command==null?null:a.entry.command.qualifiedName)||"-",`
`),s(2),q(a.entry.command==null?null:a.entry.command.alias),s(5),_(a.entry.command!=null&&a.entry.command.longDescription?15:16),s(6),_((c=a.entry.command==null?null:a.entry.command.effectiveSignificance)?21:22,c),s(6),_((C=a.entry.command==null?null:a.entry.command.constraint)?27:-1,C),s(),_(a.entry.command!=null&&a.entry.command.constraint?-1:28)}},dependencies:[rn,Ji,D,Q,Qi,We,zi,Zt,it],styles:[".evaluation[_ngcontent-%COMP%]{font-family:Roboto Mono,monospace;background-color:#dc143c;color:#fff;padding-left:2px;padding-right:2px}.evaluation.valid[_ngcontent-%COMP%]{background-color:#adff2f;color:#000}"],changeDetection:0});let e=i;return e})();var Wp=["entryParent"],zp=e=>({c:e}),Jp=()=>[];function Kp(e,i){if(e&1){let n=A();r(0,"button",26),v("click",function(){b(n);let o=d();return T(o.openScheduleStackDialog())}),r(1,"mat-icon"),m(2,"schedule"),l(),m(3," Schedule "),l()}if(e&2){let n=d();p("disabled",!n.loaded||n.format!=="ycs"||!n.entries$.value.length)}}function Xp(e,i){if(e&1){let n=A();f(0,"mat-divider",5),r(1,"button",27),v("click",function(){b(n);let o=d();return T(o.convertToJSON())}),r(2,"mat-icon"),m(3,"auto_awesome"),l(),m(4," Convert to *.ycs file "),l()}if(e&2){let n=d();s(),p("disabled",!n.format||n.converting)}}function Zp(e,i){e&1&&(r(0,"ya-detail-toolbar"),m(1,"Command Info"),l(),r(2,"div",28),f(3,"app-stacked-command-detail",29),r(4,"p"),m(5,"\xA0"),l()()),e&2&&(s(3),p("entry",i))}function e0(e,i){e&1&&(r(0,"ya-detail-toolbar"),m(1,"Select an entry"),l())}function t0(e,i){e&1&&f(0,"input",35)}function i0(e,i){e&1&&f(0,"ya-dots")}function n0(e,i){if(e&1&&(r(0,"form",30)(1,"div",31),m(2," Advance when "),f(3,"app-advance-ack-help",32)(4,"br"),r(5,"div",33),f(6,"ya-select",34,2),u(8,t0,1,0,"input",35),l()(),r(9,"div",31),m(10," Wait (ms) "),r(11,"ya-help",36)(12,"p"),m(13,"Wait time before advancing to the next command in the stack."),l(),r(14,"p"),m(15,"This triggers after successful acknowledgment."),l()(),f(16,"br")(17,"input",37),l(),f(18,"div",38),u(19,i0,1,0,"ya-dots"),h(20,"async"),l(),f(21,"mat-divider",39)),e&2){let n,t=d();p("formGroup",t.stackOptionsForm)("ngClass",t.stackOptionsForm.disabled&&"disabled"),s(3),p("extra",t.extraAcknowledgments),s(3),p("options",t.ackOptions),s(2),_(((n=t.stackOptionsForm.get("advancementAckDropDown"))==null?null:n.value)==="custom"?8:-1),s(11),_(g(20,6,t.running$)?19:-1)}}function o0(e,i){e&1&&(r(0,"ya-empty-message")(1,"mat-icon",40),m(2,"link_off"),l(),m(3," Unsupported command stack format "),l())}function a0(e,i){e&1&&(r(0,"ya-empty-message"),m(1," Empty command stack "),f(2,"br"),m(3," Click "),r(4,"mat-icon",41),m(5,"add_circle_outline"),l(),m(6," to start adding commands "),l())}function r0(e,i){e&1&&m(0," [*]: ")}function l0(e,i){if(e&1&&m(0),e&2){let n=d().$implicit;S(" [",n.executionNumber,"]: ")}}function m0(e,i){e&1&&m(0," [ ]: ")}function s0(e,i){if(e&1&&(r(0,"mat-icon",46),m(1," comment "),l()),e&2){let n=d().$implicit;p("matTooltip",n.comment)}}function c0(e,i){if(e&1&&(r(0,"span"),m(1),h(2,"value"),l()),e&2){let n=i.$implicit;s(),fn("[",n.key,": ",g(2,2,n.value),"]")}}function d0(e,i){if(e&1&&(r(0,"tr")(1,"td",50),m(2),l(),r(3,"td",51),f(4,"ya-value",52),h(5,"tovalue"),l()()),e&2){let n=i.$implicit;s(2),S(" ",n.key," "),s(2),p("value",g(5,2,n.value))}}function p0(e,i){if(e&1&&(r(0,"span"),m(1),h(2,"acknowledgmentName"),l()),e&2){let n=d(2).$implicit;s(),fn(" Advance when ",g(2,2,n.advancement.acknowledgment)," ",n.advancement.wait!=null?"+ "+n.advancement.wait+" ms":null," ")}}function u0(e,i){if(e&1&&(r(0,"span"),m(1),l()),e&2){let n=d(2).$implicit;s(),S("Advance after ",n.advancement.wait," ms")}}function f0(e,i){if(e&1&&(r(0,"div",48)(1,"mat-icon"),m(2,"reply"),l(),u(3,p0,3,4,"span")(4,u0,2,1,"span"),l()),e&2){let n=d().$implicit;s(3),_(n.advancement.acknowledgment?3:-1),s(),_(!n.advancement.acknowledgment&&n.advancement.wait!=null?4:-1)}}function _0(e,i){if(e&1&&m(0),e&2){let n=d(2).$implicit;S(" ",n.err," ")}}function C0(e,i){if(e&1&&(r(0,"div",55),f(1,"app-extra-acknowledgments-table",54),l()),e&2){let n=d(3).$implicit;s(),p("command",n.record)("inline",!0)}}function h0(e,i){if(e&1&&(f(0,"app-yamcs-acknowledgments-table",54),u(1,C0,2,2,"div",55)),e&2){let n=d(2).$implicit;p("command",n.record)("inline",!0),s(),_(((n.record==null?null:n.record.extra)||Tt(3,Jp)).length?1:-1)}}function g0(e,i){if(e&1){let n=A();r(0,"div",49)(1,"div",53),v("click",function(){b(n);let o=d().$implicit,a=d();return T(a.selectEntry(o))}),l(),r(2,"div",45),u(3,_0,1,1)(4,h0,2,4),l()()}if(e&2){let n=d().$implicit;s(2),R("err",n.err),s(),_(n.err?3:-1),s(),_(n.err?-1:4)}}function x0(e,i){if(e&1){let n=A();r(0,"div",42),h(1,"async"),v("click",function(){let o=b(n).$implicit,a=d();return T(a.selectEntry(o))})("dblclick",function(){let o=b(n).$implicit,a=d();return T(a.editCommand(o))}),r(2,"div",43)(3,"div",44),u(4,r0,1,0)(5,l0,1,1)(6,m0,1,0),l(),r(7,"div",45),m(8),u(9,s0,2,1,"mat-icon",46),H(10,c0,3,4,"span",null,G),h(12,"keyvalue"),r(13,"table",47),H(14,d0,6,4,"tr",null,G),h(16,"keyvalue"),l(),u(17,f0,5,2,"div",48),l()(),u(18,g0,5,4,"div",49),l()}if(e&2){let n=i.$implicit,t=d();R("selected",n===g(1,7,t.selectedEntry$)),s(4),_(n.executing?4:n.executionNumber===0||n.executionNumber?5:n.executionNumber!==0&&!n.executionNumber?6:-1),s(4),S(" ",n.name," "),s(),_(n.comment?9:-1),s(),q(g(12,9,n.extra)),s(4),q(Ve(16,11,n.args,t.insertionOrder)),s(3),_(n.advancement?17:-1),s(),_(n.executionNumber===0||n.executionNumber?18:-1)}}var xi=(()=>{let i=class i{constructor(t,o,a,c,C,x,E,V,N,te){this.dialog=t,this.yamcs=o,this.route=a,this.router=c,this.title=C,this.authService=x,this.configService=E,this.messageService=V,this.sanitizer=N,this.dirty$=new P(!1),this.entries$=new P([]),this.hasOutputs$=this.entries$.pipe(En(me=>{for(let dt of me)if(dt.record||dt.err)return!0;return!1})),this.running$=new P(!1),this.runningStack=!1,this.selectedEntry$=new P(null),this.clipboardEntry$=new P(null),this.commandHistoryRecords=new Map,this.executionCounter=0,this.loaded=!1,this.converting=!1,this.advancement={acknowledgment:"Acknowledge_Queued",wait:0},this.acceptingAckValues=["OK","DISABLED"],this.stoppingAckValues=["NOK","CANCELLED"],this.nextCommandScheduled=!1,this.ackOptions=[{id:"Acknowledge_Queued",label:"Queued"},{id:"Acknowledge_Released",label:"Released"},{id:"Acknowledge_Sent",label:"Sent"},{id:"CommandComplete",label:"Completed"}],this.insertionOrder=(me,dt)=>0,this.stackOptionsFormCallback=me=>{this.loaded&&(this.advancement={acknowledgment:me.advancementAckDropDown!=="custom"?me.advancementAckDropDown:me.advancementAckCustom,wait:me.advancementWait??0},me.advancementAckDropDown!=="custom"&&this.stackOptionsForm.patchValue({advancementAckCustom:void 0},{emitEvent:!1}),this.dirty$.next(!0))};let fe=E.getConfig();this.bucket=E.getStackBucket(),this.folderPerInstance=fe.displayFolderPerInstance,this.storageClient=o.createStorageClient(),this.extraAcknowledgments=o.getProcessor()?.acknowledgments??[];let X=!0;for(let me of this.extraAcknowledgments)this.ackOptions.push({id:me.name,label:me.name.replace("Acknowledge_",""),group:X}),X=!1;this.ackOptions.push({id:"custom",label:"Custom",group:!0}),this.stackOptionsForm=te.group({advancementAckDropDown:["",[]],advancementAckCustom:["",[]],advancementWait:["",[]]}),this.initStackFile()}initStackFile(){let t=this.getObjectNameFromUrl();this.loadFile(t),this.format!=="ycs"?this.stackOptionsForm.disable():(this.stackOptionsForm.enable(),this.stackOptionsForm.valueChanges.subscribe(this.stackOptionsFormCallback)),this.commandSubscription=this.yamcs.yamcsClient.createCommandSubscription({instance:this.yamcs.instance,processor:this.yamcs.processor,ignorePastCommands:!0},o=>{let a=o.id,c=this.commandHistoryRecords.get(a);c?c=c.mergeEntry(o):c=new ct(o),this.commandHistoryRecords.set(a,c);for(let C of this.entries$.value)if(C.id===a){C.record=c;break}this.checkAckContinueRunning(c)})}handleDrop(t){t.previousIndex!==t.currentIndex&&(Gn(this.entries$.value,t.previousIndex,t.currentIndex),this.entries$.next([...this.entries$.value]),this.dirty$.next(!0))}getObjectNameFromUrl(){let t=this.route.snapshot.url,o="";this.folderPerInstance&&(o+=this.yamcs.instance);for(let a of t)o&&(o+="/"),o+=a.path;return o}getNameWithoutInstance(t){if(this.folderPerInstance){let o=this.yamcs.instance;return t.substring(o.length)}else return t}async loadFile(t){this.objectName=t;let o=this.objectName.lastIndexOf("/");if(o===-1)this.folderLink="/commanding/stacks/browse/",this.filename=this.objectName;else{let C=this.getNameWithoutInstance(this.objectName.substring(0,o));this.folderLink="/commanding/stacks/browse/"+C,this.filename=this.objectName.substring(o+1)}this.title.setTitle(this.filename);let a=O.getExtension(O.getFilename(t))?.toLowerCase();if(a==="ycs"||a==="xml")this.format=a;else{this.loaded=!0;return}let c=await this.storageClient.getObject(this.bucket,t).catch(C=>{C.statusCode===404&&a==="xml"?this.router.navigate([t.replace(/\.xml$/i,".ycs")],{queryParamsHandling:"preserve",relativeTo:this.route.parent}).then(()=>this.initStackFile()):this.messageService.showError("Failed to load stack file '"+t+"'")});if(c?.ok){let C=await c.text(),x;switch(this.format){case"ycs":[x,this.advancement]=this.parseJSON(C);let N=this.ackOptions.find(me=>me.id===this.advancement.acknowledgment),te=N?N.id:"custom";this.stackOptionsForm.setValue({advancementAckDropDown:te,advancementAckCustom:te==="custom"?this.advancement.acknowledgment:"",advancementWait:this.advancement.wait});break;case"xml":let X=new DOMParser().parseFromString(C,"text/xml");x=i.parseXML(X.documentElement,this.configService.getCommandOptions());break}let E=[],V=this.yamcs.instance;for(let N of x){let te=N.namespace??null,fe=N.name;E.push(this.yamcs.yamcsClient.getCommandForNamespace(V,te,fe).then(X=>{N.command=X}))}for(let N of E)try{await N}catch{}for(let N of x)if(N.command)for(let te in N.args){let fe=this.getArgument(te,N.command);if(fe?.type.engType==="enumeration"){let X=!1;for(let me of fe.type.enumValue||[])if(me.label===N.args[te]){X=!0;break}if(!X){for(let me of fe.type.enumValue||[])if(String(me.value)===String(N.args[te])){N.args[te]=me.label,X=!0;break}}}}if(this.format==="xml"){for(let N of x)if(N.command)for(let te in N.args)this.isComplex(te,N.command)&&(N.args[te]=JSON.parse(N.args[te]))}this.entries$.next(x),this.selectedEntry$.next(x.length?x[0]:null),this.loaded=!0}}isComplex(t,o){for(let a of o.argument||[])if(a.name===t)return a.type.engType==="aggregate"||a.type.engType.endsWith("[]");return o.baseCommand?this.isComplex(t,o.baseCommand):!1}getArgument(t,o){for(let a of o.argument||[])if(a.name===t)return a;return o.baseCommand?this.getArgument(t,o.baseCommand):null}parseJSON(t){let o=[],a=JSON.parse(t);if(a.commands)for(let C of a.commands)o.push(this.parseJSONentry(C));let c={acknowledgment:a.advancement?.acknowledgment||"Acknowledge_Queued",wait:a.advancement?.wait!=null?a.advancement?.wait:0};return[o,c]}parseJSONentry(t){return ae(ae(ae(ae({name:t.name,namespace:t.namespace},t.comment&&{comment:t.comment}),t.extraOptions&&{extra:this.parseJSONextraOptions(t.extraOptions)}),t.arguments&&{args:this.parseJSONcommandArguments(t.arguments)}),t.advancement&&{advancement:t.advancement})}parseJSONextraOptions(t){let o={};for(let a of t){let c=i.convertOptionStringToValue(a.id,new String(a.value).toString(),this.configService.getCommandOptions());c&&(o[a.id]=c)}return o}parseJSONcommandArguments(t){let o={};for(let a of t)o[a.name]=a.value;return o}static parseXML(t,o){let a=[];for(let c=0;c<t.childNodes.length;c++){let C=t.childNodes[c];if(C.nodeType!==3&&C.nodeName==="command"){let x=this.parseXMLEntry(C,o);a.push(x)}}return a}static parseXMLEntry(t,o){let a={},c={};for(let x=0;x<t.childNodes.length;x++){let E=t.childNodes[x];if(E.nodeName==="commandArgument"){let V=this.getStringAttribute(E,"argumentName");a[V]=this.getStringAttribute(E,"argumentValue"),a[V]==="true"?a[V]=!0:a[V]==="false"&&(a[V]=!1)}else if(E.nodeName==="extraOptions")for(let V=0;V<E.childNodes.length;V++){let N=E.childNodes[V];if(N.nodeName==="extraOption"){let te=this.getStringAttribute(N,"id"),fe=this.getStringAttribute(N,"value"),X=this.convertOptionStringToValue(te,fe,o);X&&(c[te]=X)}}}let C={name:this.getStringAttribute(t,"qualifiedName"),args:a,extra:c,executing:!1};return t.hasAttribute("comment")&&(C.comment=this.getStringAttribute(t,"comment")),C}selectEntry(t){this.selectedEntry$.next(t)}deleteSelectedCommands(){let t=this.selectedEntry$.value;if(t){let o=this.entries$.value.indexOf(t);o!==-1&&(this.entries$.value.splice(o,1),this.entries$.next([...this.entries$.value]),this.selectedEntry$.next(null),this.dirty$.next(!0))}}clearSelectedOutputs(){let t=this.selectedEntry$.value;t&&(t.executionNumber=void 0,t.id=void 0,t.record=void 0,t.err=void 0)}clearOutputs(){for(let t of this.entries$.value)t.executionNumber=void 0,t.id=void 0,t.record=void 0,t.err=void 0;this.executionCounter=0,this.entries$.next([...this.entries$.value]),this.entries$.value.length&&this.selectEntry(this.entries$.value[0])}hasPendingChanges(){return this.dirty$.value}async runSelection(){let t=this.selectedEntry$.value;t&&(this.running$.next(!0),this.runEntry(t))}async runEntry(t){let o=++this.executionCounter,{instance:a,processor:c}=this.yamcs,C=t.namespace??null;return this.yamcs.yamcsClient.issueCommandForNamespace(a,c,C,t.name,{sequenceNumber:o,args:t.args,extra:t.extra}).then(x=>{t.executionNumber=o,t.executing=!0,t.id=x.id;let E=this.commandHistoryRecords.get(t.id);E&&(t.record=E,this.checkAckContinueRunning(E))}).catch(x=>{t.executionNumber=o,t.executing=!1,t.err=x.message||x,this.stopRun()}).finally(()=>{this.entries$.next([...this.entries$.value])})}runFromSelection(){let t=this.selectedEntry$.value;if(!t){this.stopRun();return}this.running$.next(!0),this.runningStack=!0,this.nextCommandScheduled=!1,this.runEntry(t)}checkAckContinueRunning(t){if(!this.running$.value||this.nextCommandScheduled)return;let o=this.selectedEntry$.value,a=o?.advancement?.acknowledgment||this.advancement.acknowledgment,c=o?.advancement?.wait??this.advancement.wait;if(o?.id===t.id){let C=t.acksByName[a];C&&C.status&&(this.acceptingAckValues.includes(C.status)?(this.nextCommandScheduled=this.runningStack,this.nextCommandDelayTimeout=window.setTimeout(()=>{o.executing=!1,this.running$.value&&o&&(this.advanceSelection(o),this.runningStack?this.runFromSelection():this.stopRun())},Math.max(c,0))):this.stoppingAckValues.includes(C.status)&&(o.executing=!1,this.stopRun()))}}stopRun(){this.running$.next(!1),this.runningStack=!1;for(let t of this.entries$.value)t.executing=!1;window.clearTimeout(this.nextCommandDelayTimeout),this.nextCommandScheduled=!1}advanceSelection(t){let o=this.entries$.value,a=o.indexOf(t);if(a<o.length-1){let c=o[a+1];this.selectEntry(c);let x=this.entryParent.nativeElement.getElementsByClassName("entry")[a+1];this.isVisible(x)||x.scrollIntoView()}else this.selectedEntry$.next(null)}isVisible(t){let o=t.getBoundingClientRect(),a=Math.max(document.documentElement.clientHeight,window.innerHeight);return!(o.bottom<0||o.top-a>=0)}static convertOptionStringToValue(t,o,a){for(let c of a)if(c.id===t)switch(c.type){case"BOOLEAN":return{type:"BOOLEAN",booleanValue:o==="true"};case"NUMBER":return{type:"SINT32",sint32Value:Number(o)};default:return{type:"STRING",stringValue:o}}return null}addCommand(){this.dialog.open(wn,{width:"70%",height:"100%",autoFocus:!1,position:{right:"0"},panelClass:"dialog-full-size",data:{okLabel:"ADD TO STACK",format:this.format}}).afterClosed().subscribe(o=>{if(o){let a=ae({name:o.command.qualifiedName,args:o.args,comment:o.comment,extra:o.extra,command:o.command},o.stackOptions.advancement&&{advancement:o.stackOptions.advancement}),c=this.configService.getConfig();if(c.preferredNamespace){for(let x of o.command.alias||[])if(x.namespace===c.preferredNamespace){a.name=x.name,a.namespace=x.namespace;break}}let C=this.selectedEntry$.value;if(C){let x=this.entries$.value,E=x.indexOf(C);x.splice(E+1,0,a),this.entries$.next([...this.entries$.value])}else this.entries$.next([...this.entries$.value,a]);this.selectEntry(a),this.dirty$.next(!0)}})}editSelectedCommand(){let t=this.selectedEntry$.value;this.editCommand(t)}editCommand(t){return this.selectEntry(t),this.dialog.open(wn,{width:"70%",height:"100%",autoFocus:!1,position:{right:"0"},panelClass:"dialog-full-size",data:{okLabel:"UPDATE",entry:t,format:this.format}}).afterClosed().subscribe(a=>{if(a){let c=ae({name:a.command.qualifiedName,args:a.args,comment:a.comment,extra:a.extra,command:a.command},a.stackOptions.advancement&&{advancement:a.stackOptions.advancement}),C=this.configService.getConfig();if(C.preferredNamespace){for(let V of a.command.alias||[])if(V.namespace===C.preferredNamespace){c.name=V.name,c.namespace=V.namespace;break}}let x=this.entries$.value,E=x.indexOf(t);x.splice(E,1,c),this.entries$.next([...this.entries$.value]),this.selectEntry(c),this.dirty$.next(!0)}}),!1}cutSelectedCommand(){let t=this.selectedEntry$.value;this.advanceSelection(t),this.clipboardEntry$.next(t);let o=this.entries$.value,a=o.indexOf(t);o.splice(a,1),this.entries$.next([...this.entries$.value]),this.dirty$.next(!0)}copySelectedCommand(){let t=this.selectedEntry$.value;this.clipboardEntry$.next(t)}pasteCommand(){let t=this.clipboardEntry$.value;if(t){let o={name:t.name,namespace:t.namespace,args:ae({},t.args),comment:t.comment,command:t.command,executing:!1};t.extra&&(o.extra=ae({},t.extra)),t.advancement&&(o.advancement=ae({},t.advancement));let a=this.selectedEntry$.value;if(a){let c=this.entries$.value,C=c.indexOf(a);c.splice(C+1,0,o),this.entries$.next([...this.entries$.value])}else this.entries$.next([...this.entries$.value,o]);this.selectEntry(o),this.dirty$.next(!0)}}showSchedule(){let t=this.yamcs.connectionInfo$.value?.instance?.capabilities||[];return t.indexOf("timeline")!==-1&&t.indexOf("activities")!==-1&&this.authService.getUser().hasSystemPrivilege("ControlTimeline")}openScheduleStackDialog(){this.dialog.open(jo,{width:"600px"}).afterClosed().subscribe(t=>{if(t){let o={type:"ACTIVITY",duration:"0s",name:this.filename,start:t.executionTime,tags:t.tags,activityDefinition:{type:"COMMAND_STACK",args:{processor:this.yamcs.processor,bucket:this.bucket,stack:this.filename}}};this.yamcs.yamcsClient.createTimelineItem(this.yamcs.instance,o).then(()=>{this.messageService.showInfo("Command stack scheduled")}).catch(a=>this.messageService.showError(a))}})}saveStack(){let t;switch(this.format){case"ycs":t=new Mt(this.entries$.value,{advancement:this.advancement}).toJSON();break;case"xml":t=new Mt(this.entries$.value,{advancement:this.advancement}).toXML();break}let o=this.format==="xml"?"application/xml":"application/json",a=new Blob([t],{type:o});return this.storageClient.uploadObject(this.bucket,this.objectName,a).then(()=>{this.dirty$.next(!1)})}setExportURLs(){let t=new Mt(this.entries$.value,{advancement:this.advancement}),o=new Blob([t.toJSON()],{type:"application/json"});this.JSONblobURL=this.sanitizer.bypassSecurityTrustResourceUrl(URL.createObjectURL(o));let a=new Blob([t.toXML()],{type:"application/xml"});this.XMLblobURL=this.sanitizer.bypassSecurityTrustResourceUrl(URL.createObjectURL(a))}static getStringAttribute(t,o){let a=t.attributes.getNamedItem(o);if(a===null)throw new Error(`No attribute named ${o}`);return a.textContent||""}async convertToJSON(){this.converting||confirm(`Are you sure you want to convert '${this.objectName}' to the new format?
This will delete the original XML file.`)&&(this.converting=!0,this.dirty$.value&&await this.saveStack(),i.convertToJSON(this.messageService,this.storageClient,this.bucket,this.objectName,this.entries$.value,{advancement:this.advancement}).then(t=>{this.router.navigate([t+".ycs"],{queryParamsHandling:"preserve",relativeTo:this.route.parent}).then(()=>this.initStackFile())}).finally(()=>this.converting=!1))}static async convertToJSON(t,o,a,c,C,x){let E=new Mt(C,x),V=new Blob([E.toJSON()],{type:"application/json"}),N=O.getBasename(c);if(!N){t.showError("Failed to convert command stack"),console.error("Failed to convert command stack due to objectName");return}return await o.uploadObject(a,N+".ycs",V),await o.deleteObject(a,c),N}ngOnDestroy(){this.commandSubscription?.cancel(),this.stackOptionsForm.reset()}};i.\u0275fac=function(o){return new(o||i)(y(Je),y(U),y(Ne),y(ke),y(we),y(tt),y(Oe),y(et),y($n),y(Mi))},i.\u0275cmp=w({type:i,selectors:[["ng-component"]],viewQuery:function(o,a){if(o&1&&z(Wp,5),o&2){let c;J(c=K())&&(a.entryParent=c.first)}},standalone:!0,features:[k],decls:94,vars:71,consts:[["exportMenu","matMenu"],["entryParent",""],["ackSelect",""],["mat-icon-button","","color","primary",3,"routerLink","queryParams"],["mat-button","","color","primary","matTooltip","Save stack",3,"click","disabled"],["vertical","",2,"height","100%"],["mat-icon-button","","color","primary","matTooltip","Add a command below",3,"click","disabled"],["mat-icon-button","","color","primary","matTooltip","Edit the selected command",3,"click","disabled"],["mat-icon-button","","color","primary","matTooltip","Cut the selected command",3,"click","disabled"],["mat-icon-button","","color","primary","matTooltip","Copy the selected command",3,"click","disabled"],["mat-icon-button","","color","primary","matTooltip","Paste command from the clipboard",3,"click","disabled"],["mat-icon-button","","color","primary","matTooltip","Run the selected command",3,"click","disabled"],["mat-icon-button","","color","primary","matTooltip","Stop current execution",3,"click","disabled"],["mat-icon-button","","color","primary","matTooltip","Clear all outputs",3,"click","disabled"],["mat-icon-button","","color","primary","matTooltip","Run all from selected command",3,"click","disabled"],["mat-button","","color","primary","matTooltip","Run command stack at a later time",3,"disabled"],["mat-button","","color","primary","matTooltip","Export command stack",3,"click","matMenuTriggerFor","disabled"],[1,"ya-menu"],["mat-menu-item","",3,"href","download"],["mat-menu-item","","title","Certain features are not implemented for XML, the format will be phased out gradually",3,"href","download"],[2,"vertical-align","middle"],[2,"color","#cc0000"],[1,"panel-wrapper"],["cdkDropList","",1,"panel-content",3,"cdkDropListDropped"],["id","drag-boundary"],["cdkDrag","","cdkDragBoundary","#drag-boundary",1,"entry",3,"selected"],["mat-button","","color","primary","matTooltip","Run command stack at a later time",3,"click","disabled"],["mat-button","","color","warn","matTooltip","Convert to the newer format",3,"click","disabled"],[2,"padding","0 16px"],[3,"entry"],[1,"ya-form","panel-content","stack-options",3,"formGroup","ngClass"],[1,"label"],[3,"extra"],[2,"display","flex","align-items","flex-start"],["icon","check_circle_outline","formControlName","advancementAckDropDown",3,"options"],["type","text","formControlName","advancementAckCustom",2,"width","200px","margin-left","-1px"],["dialogTitle","Wait time"],["type","number","formControlName","advancementWait","placeholder","0","step","1000","min","0",2,"width","120px"],[2,"flex","1 1 auto"],["horizontal",""],[2,"vertical-align","bottom","margin-right","10px"],["inline","",2,"vertical-align","bottom"],["cdkDrag","","cdkDragBoundary","#drag-boundary",1,"entry",3,"click","dblclick"],[1,"in"],["cdkDragHandle","",1,"seq"],[1,"body"],[1,"icon14",2,"vertical-align","middle",3,"matTooltip"],[1,"args"],[1,"advance-on"],[1,"out"],["width","1",1,"key"],[1,"value"],[3,"value"],[1,"seq",3,"click"],[3,"command","inline"],[1,"block"]],template:function(o,a){if(o&1){let c=A();r(0,"app-instance-page")(1,"app-instance-toolbar")(2,"a",3)(3,"mat-icon"),m(4,"arrow_back"),l()(),m(5),h(6,"basename"),r(7,"button",4),h(8,"async"),v("click",function(){return b(c),T(a.saveStack())}),r(9,"mat-icon"),m(10,"save"),l(),m(11," Save "),l(),f(12,"mat-divider",5),r(13,"button",6),h(14,"async"),v("click",function(){return b(c),T(a.addCommand())}),r(15,"mat-icon"),m(16,"add_circle_outline"),l()(),r(17,"button",7),h(18,"async"),h(19,"async"),v("click",function(){return b(c),T(a.editSelectedCommand())}),r(20,"mat-icon"),m(21,"edit"),l()(),r(22,"button",8),h(23,"async"),h(24,"async"),v("click",function(){return b(c),T(a.cutSelectedCommand())}),r(25,"mat-icon"),m(26,"content_cut"),l()(),r(27,"button",9),h(28,"async"),h(29,"async"),v("click",function(){return b(c),T(a.copySelectedCommand())}),r(30,"mat-icon"),m(31,"content_copy"),l()(),r(32,"button",10),h(33,"async"),h(34,"async"),v("click",function(){return b(c),T(a.pasteCommand())}),r(35,"mat-icon"),m(36,"content_paste"),l()(),f(37,"mat-divider",5),r(38,"button",11),h(39,"async"),h(40,"async"),v("click",function(){return b(c),T(a.runSelection())}),r(41,"mat-icon"),m(42,"play_arrow"),l()(),r(43,"button",12),h(44,"async"),v("click",function(){return b(c),T(a.stopRun())}),r(45,"mat-icon"),m(46,"stop"),l()(),r(47,"button",13),h(48,"async"),h(49,"async"),v("click",function(){return b(c),T(a.clearOutputs())}),r(50,"mat-icon"),m(51,"refresh"),l()(),r(52,"button",14),h(53,"async"),h(54,"async"),v("click",function(){return b(c),T(a.runFromSelection())}),r(55,"mat-icon"),m(56,"playlist_play"),l()(),f(57,"mat-divider",5),u(58,Kp,4,1,"button",15),f(59,"mat-divider",5),r(60,"button",16),v("click",function(){return b(c),T(a.setExportURLs())}),r(61,"mat-icon"),m(62,"open_in_new"),l(),m(63," Export "),l(),u(64,Xp,5,1),r(65,"mat-menu",17,0)(67,"a",18),h(68,"basename"),r(69,"mat-icon"),m(70,"data_object"),l(),m(71," YCS FILE "),l(),r(72,"a",19),h(73,"basename"),r(74,"mat-icon"),m(75,"code"),l(),r(76,"span",20),m(77," XML FILE "),r(78,"span",21),m(79,"(legacy)"),l()()()()(),r(80,"ya-detail-pane"),u(81,Zp,6,1),h(82,"async"),u(83,e0,2,0,"ya-detail-toolbar"),l(),r(84,"div",22),u(85,n0,22,8)(86,o0,4,0,"ya-empty-message")(87,a0,7,0,"ya-empty-message"),r(88,"div",23,1),v("cdkDropListDropped",function(x){return b(c),T(a.handleDrop(x))}),r(90,"div",24),H(91,x0,19,14,"div",25,G),h(93,"async"),l()()()()}if(o&2){let c,C=B(66);s(2),p("routerLink",a.folderLink)("queryParams",ce(69,zp,a.yamcs.context)),s(3),S(" ",g(6,25,a.filename)," \xA0\xA0\xA0 "),s(2),p("disabled",!a.format||!g(8,27,a.dirty$)),s(6),p("disabled",!a.format||g(14,29,a.running$)),s(4),p("disabled",!a.format||g(18,31,a.running$)||!g(19,33,a.selectedEntry$)),s(5),p("disabled",!a.format||g(23,35,a.running$)||!g(24,37,a.selectedEntry$)),s(5),p("disabled",!a.format||g(28,39,a.running$)||!g(29,41,a.selectedEntry$)),s(5),p("disabled",!a.format||g(33,43,a.running$)||!g(34,45,a.clipboardEntry$)),s(6),p("disabled",!a.format||g(39,47,a.running$)||!g(40,49,a.selectedEntry$)),s(5),p("disabled",!a.format||!g(44,51,a.running$)),s(4),p("disabled",!a.format||g(48,53,a.running$)||!g(49,55,a.hasOutputs$)),s(5),p("disabled",!a.format||g(53,57,a.running$)||!g(54,59,a.selectedEntry$)),s(6),_(a.showSchedule()?58:-1),s(2),p("matMenuTriggerFor",C)("disabled",!a.format),s(4),_(a.format==="xml"?64:-1),s(3),p("href",a.JSONblobURL,_i)("download",g(68,61,a.filename)+".ycs"),s(5),p("href",a.XMLblobURL,_i)("download",g(73,63,a.filename)+".xml"),s(9),_((c=g(82,65,a.selectedEntry$))?81:83,c),s(4),_(a.format==="ycs"?85:-1),s(),_(a.loaded&&!a.format?86:-1),s(),_(a.loaded&&a.format&&!a.entries$.value.length?87:-1),s(4),q(g(93,67,a.entries$))}},dependencies:[Ho,cn,en,Te,be,D,Si,Q,bi,re,pe,Ei,$,ie,Di,ne,Z,$e,zn,Wn,Yn,ht,Ii,Qn,oe,We,_t,Ye,Ct,Ee,Ri,Bi,Hi,It,ee,Ze,ji,ao,lo,Ot,Qo,nn],styles:[".panel-wrapper[_ngcontent-%COMP%]{position:relative;overflow:auto;height:100%}.ya-data-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{vertical-align:top}table.args[_ngcontent-%COMP%]{margin:0 0 0 10px;font-size:10px}table.args[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:0;border:0}table.args[_ngcontent-%COMP%]   td.key[_ngcontent-%COMP%]{min-width:120px;white-space:nowrap}table.args[_ngcontent-%COMP%]   td.value[_ngcontent-%COMP%]{color:gray;padding-left:10px}div.entry[_ngcontent-%COMP%]{font-size:13px;line-height:17px}div.entry[_ngcontent-%COMP%]   div.in[_ngcontent-%COMP%], div.entry[_ngcontent-%COMP%]   div.out[_ngcontent-%COMP%]{display:flex;border-left:8px solid transparent;margin-bottom:10px}div.entry.selected[_ngcontent-%COMP%]   div.in[_ngcontent-%COMP%], div.entry.selected[_ngcontent-%COMP%]   div.out[_ngcontent-%COMP%]{border-color:#009e87}div.entry[_ngcontent-%COMP%]   .seq[_ngcontent-%COMP%]{width:64px;text-align:right;padding-top:5px;padding-right:10px;user-select:none;-webkit-user-select:none;-moz-user-select:none;-khtml-user-select:none;font-family:Roboto Mono,monospace;color:#bdbdbd}div.entry[_ngcontent-%COMP%]   div.in[_ngcontent-%COMP%]   .seq[_ngcontent-%COMP%]{cursor:move}div.entry.selected[_ngcontent-%COMP%]   .seq[_ngcontent-%COMP%]{color:#009e87}div.entry[_ngcontent-%COMP%]   .body[_ngcontent-%COMP%]{flex-grow:1;padding:5px}div.entry[_ngcontent-%COMP%]   div.in[_ngcontent-%COMP%]   .body[_ngcontent-%COMP%]{background-color:#fafafa;border:1px solid rgb(224,224,224);font-family:Roboto Mono,monospace}div.entry[_ngcontent-%COMP%]   div.out[_ngcontent-%COMP%]   .body.err[_ngcontent-%COMP%]{background-color:#fcc;color:#dc143c}.cdk-drag-placeholder[_ngcontent-%COMP%]{opacity:.6}.advance-on[_ngcontent-%COMP%]{color:gray;font-size:12px}.advance-on[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{vertical-align:middle}.advance-on[_ngcontent-%COMP%] > mat-icon[_ngcontent-%COMP%]{transform:rotate(180deg);font-size:12px;height:12px;width:12px}form.stack-options[_ngcontent-%COMP%]{line-height:0;display:flex;align-items:flex-start}.stack-options[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{display:inline-block;width:unset;margin-right:1em;margin-top:0}.disabled[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{opacity:.6}"],changeDetection:0});let e=i;return e})();var y0=["filename"],Uo=(()=>{let i=class i{constructor(t,o,a,c,C){this.dialogRef=t,this.data=C,this.bucket=c.getStackBucket(),this.storageClient=a.createStorageClient(),this.filenameForm=o.group({name:["",[W.required]],format:["ycs",[W.required]]})}save(){let t=this.filenameForm.get("format").value,o=this.filenameForm.get("name").value.trim()+"."+t,a=this.data.path;a.startsWith("/")&&(a=a.substring(1));let c=a?a+"/"+o:o,C=this.data.prefix+c,x=t==="xml"?new Mt([],{}).toXML():new Mt([],{}).toJSON(),E=t==="xml"?"application/xml":"application/json",V=new Blob([x],{type:E});this.storageClient.uploadObject(this.bucket,C,V).then(()=>{this.dialogRef.close(c)})}};i.\u0275fac=function(o){return new(o||i)(y(Ce),y(Ge),y(U),y(Oe),y(ze))},i.\u0275cmp=w({type:i,selectors:[["app-create-stack-dialog"]],viewQuery:function(o,a){if(o&1&&z(y0,5),o&2){let c;J(c=K())&&(a.filenameInput=c.first)}},standalone:!0,features:[k],decls:21,vars:4,consts:[["filename",""],["mat-dialog-title",""],[1,"ya-form",3,"formGroup"],["type","text","formControlName","name"],["formControlName","format"],["value","ycs"],["value","xml"],["align","end"],["mat-dialog-close","",1,"ya-button"],[1,"ya-button","primary",3,"click","disabled"]],template:function(o,a){if(o&1){let c=A();r(0,"h2",1),m(1,"Create stack"),l(),r(2,"mat-dialog-content")(3,"form",2)(4,"label"),m(5," Name "),f(6,"input",3,0),l(),f(8,"br"),r(9,"label"),m(10," Format "),r(11,"select",4)(12,"option",5),m(13,"YCS"),l(),r(14,"option",6),m(15,"XML (deprecated)"),l()()()()(),r(16,"mat-dialog-actions",7)(17,"button",8),m(18,"CANCEL"),l(),r(19,"button",9),v("click",function(){return b(c),T(a.save())}),m(20,"SAVE"),l()()}if(o&2){let c;s(3),p("formGroup",a.filenameForm),s(),R("invalid",(c=a.filenameForm.get("name"))==null?null:c.invalid),s(15),p("disabled",!a.filenameForm.valid)}},dependencies:[D,re,Hn,qn,pe,Bn,$,ie,ne,Z,he,Re,Me,De],encapsulation:2});let e=i;return e})();var Go=(()=>{let i=class i{constructor(t,o,a,c){this.dialogRef=t,this.data=c,this.storageClient=a.createStorageClient(),this.form=o.group({name:["",W.required]})}save(){let{path:t,bucket:o}=this.data;t.startsWith("/")&&(t=t.substring(1));let a=this.form.value.name,c=t?`${t}/${a}/`:`${a}/`;this.storageClient.uploadObject(o,c,new Blob).then(()=>this.dialogRef.close(!0))}};i.\u0275fac=function(o){return new(o||i)(y(Ce),y(Ge),y(U),y(ze))},i.\u0275cmp=w({type:i,selectors:[["app-create-stack-folder-dialog"]],standalone:!0,features:[k],decls:12,vars:2,consts:[["mat-dialog-title",""],[1,"ya-form",3,"formGroup"],["type","text","formControlName","name","pattern","\\w[\\w\\s\\.\\-\\(\\)\\[\\]]*"],["align","end"],["mat-dialog-close","",1,"ya-button"],[1,"ya-button","primary",3,"click","disabled"]],template:function(o,a){o&1&&(r(0,"h2",0),m(1,"Create folder"),l(),r(2,"mat-dialog-content")(3,"form",1)(4,"label"),m(5," Folder name "),f(6,"input",2),l()()(),r(7,"mat-dialog-actions",3)(8,"button",4),m(9,"CANCEL"),l(),r(10,"button",5),v("click",function(){return a.save()}),m(11,"CREATE"),l()()),o&2&&(s(3),p("formGroup",a.form),s(7),p("disabled",!a.form.valid))},dependencies:[D,re,pe,$,ie,jn,ne,Z,he,Re,Me,De],encapsulation:2,changeDetection:0});let e=i;return e})();var Yo=(()=>{let i=class i{constructor(t,o,a,c,C){this.dialogRef=t,this.data=C,this.storageClient=a.createStorageClient(),this.bucket=c.getStackBucket();let x=O.getBasename(O.getFilename(this.data.name));this.filenameForm=o.group({name:[x,[W.required]]})}async rename(){let t,o=this.data.name.lastIndexOf("/");o!==-1&&(t=this.data.name.substring(0,o+1));let c=await(await this.storageClient.getObject(this.bucket,this.data.name)).blob(),C=O.getExtension(O.getFilename(this.data.name))?.toLowerCase(),x=(t||"")+this.filenameForm.get("name").value+(C?"."+C:"");x!==this.data.name&&(await this.storageClient.uploadObject(this.bucket,x,c),await this.storageClient.deleteObject(this.bucket,this.data.name)),this.dialogRef.close(x)}};i.\u0275fac=function(o){return new(o||i)(y(Ce),y(Ge),y(U),y(Oe),y(ze))},i.\u0275cmp=w({type:i,selectors:[["app-rename-stack-dialog"]],standalone:!0,features:[k],decls:13,vars:4,consts:[["filename",""],["mat-dialog-title",""],[1,"ya-form",3,"formGroup"],["type","text","formControlName","name"],["align","end"],["mat-dialog-close","",1,"ya-button"],[1,"ya-button","primary",3,"click","disabled"]],template:function(o,a){if(o&1){let c=A();r(0,"h2",1),m(1,"Rename stack"),l(),r(2,"mat-dialog-content")(3,"form",2)(4,"label"),m(5," Name "),f(6,"input",3,0),l()()(),r(8,"mat-dialog-actions",4)(9,"button",5),m(10,"CANCEL"),l(),r(11,"button",6),v("click",function(){return b(c),T(a.rename())}),m(12," RENAME "),l()()}if(o&2){let c;s(3),p("formGroup",a.filenameForm),s(),R("invalid",(c=a.filenameForm.get("name"))==null?null:c.invalid),s(7),p("disabled",!a.filenameForm.valid)}},dependencies:[D,re,pe,$,ie,ne,Z,he,Re,Me,De],encapsulation:2});let e=i;return e})();var v0=["droparea"],S0=["uploader"],dn=e=>({c:e});function b0(e,i){if(e&1){let n=A();r(0,"button",8),v("click",function(){b(n);let o=d();return T(o.createStack())}),r(1,"mat-icon"),m(2,"add_circle_outline"),l(),m(3," Create stack "),l()}}function T0(e,i){if(e&1){let n=A();r(0,"button",8),v("click",function(){b(n);let o=d();return T(o.openUploadDialog())}),r(1,"mat-icon"),m(2,"file_upload"),l(),m(3," Upload stack "),r(4,"input",9,1),v("change",function(){b(n);let o=d();return T(o.importStack())}),l()()}}function w0(e,i){if(e&1){let n=A();r(0,"button",8),v("click",function(){b(n);let o=d();return T(o.createFolder())}),r(1,"mat-icon"),m(2,"create_new_folder"),l(),m(3," Create folder "),l()}}function k0(e,i){if(e&1){let n=A();r(0,"button",10),v("click",function(){b(n);let o=d();return T(o.deleteSelectedStacks())}),r(1,"mat-icon"),m(2,"delete"),l(),m(3," Delete "),l()}if(e&2){let n=d();p("disabled",!n.selection.hasValue())}}function E0(e,i){if(e&1&&f(0,"ya-breadcrumb",12),e&2){let n=i.$implicit,t=d(3);p("link",n.route)("queryParams",ce(3,dn,t.yamcs.context))("label",n.name)}}function D0(e,i){if(e&1&&(r(0,"ya-breadcrumb-trail"),f(1,"ya-breadcrumb",11),H(2,E0,1,5,"ya-breadcrumb",12,G),l()),e&2){let n=d(),t=d();s(),p("queryParams",ce(1,dn,t.yamcs.context)),s(),q(n)}}function M0(e,i){e&1&&u(0,D0,4,3,"ya-breadcrumb-trail"),e&2&&_(i.length?0:-1)}function I0(e,i){if(e&1){let n=A();r(0,"input",30),v("change",function(o){b(n);let a=d(3);return T(o?a.masterToggle():null)}),l()}if(e&2){let n=d(3);p("checked",n.selection.hasValue()&&n.isAllSelected())}}function A0(e,i){if(e&1&&(r(0,"th",28),u(1,I0,1,1,"input",29),l()),e&2){let n=d(2);s(),_(n.mayManageStacks()?1:-1)}}function F0(e,i){if(e&1){let n=A();r(0,"input",32),v("click",function(o){return b(n),T(o.stopPropagation())})("change",function(o){b(n);let a=d().$implicit,c=d(2);return T(o?c.selection.toggle(a):null)}),l()}if(e&2){let n=d().$implicit,t=d(2);p("checked",t.selection.isSelected(n))}}function O0(e,i){if(e&1&&(r(0,"td",31),u(1,F0,1,1,"input",29),l()),e&2){let n=d(2);s(),_(n.mayManageStacks()?1:-1)}}function P0(e,i){e&1&&(r(0,"th",33),m(1,"Name"),l())}function V0(e,i){if(e&1){let n=A();r(0,"mat-icon",35),m(1," folder "),l(),r(2,"a",36),v("click",function(o){return b(n),T(o.stopPropagation())}),m(3),h(4,"filename"),l()}if(e&2){let n=d().$implicit,t=d(2);s(2),p("routerLink","/commanding/stacks/browse/"+n.nameWithoutInstance)("queryParams",ce(5,dn,t.yamcs.context)),s(),S(" ",g(4,3,n.name)," ")}}function N0(e,i){if(e&1){let n=A();r(0,"mat-icon",35),m(1," description "),l(),r(2,"a",37),h(3,"filename"),v("click",function(o){return b(n),T(o.stopPropagation())}),m(4),h(5,"filename"),l()}if(e&2){let n=d().$implicit,t=d(2);s(2),p("routerLink","/commanding/stacks/files/"+n.nameWithoutInstance)("queryParams",ce(8,dn,t.yamcs.context))("title",g(3,4,n.name)),s(2),S(" ",g(5,6,n.name)," ")}}function $0(e,i){if(e&1&&(r(0,"td",34),u(1,V0,5,7)(2,N0,6,10),l()),e&2){let n=i.$implicit;s(),_(n.folder?1:2)}}function L0(e,i){e&1&&(r(0,"th",33),m(1,"Visibility"),l())}function R0(e,i){e&1&&(r(0,"td",34),m(1,"Private"),l())}function B0(e,i){e&1&&(r(0,"th",33),m(1,"Date modified"),l())}function H0(e,i){if(e&1&&(r(0,"td",34),m(1),h(2,"datetime"),l()),e&2){let n=i.$implicit;s(),S(" ",g(2,1,n.modified)||"-"," ")}}function q0(e,i){e&1&&f(0,"th",38)}function j0(e,i){e&1&&f(0,"mat-divider")}function Q0(e,i){if(e&1){let n=A();r(0,"button",39),v("click",function(o){b(n);let a=d(2).$implicit,c=d(2);return T(c.convertToJSON(o,a.nameWithoutInstance))}),m(1," Convert to new format "),l()}}function U0(e,i){if(e&1){let n=A();r(0,"ya-more")(1,"button",39),v("click",function(){b(n);let o=d().$implicit,a=d(2);return T(a.renameFile(o))}),m(2,"Rename"),l(),r(3,"a",40),m(4,"Download"),l(),f(5,"mat-divider"),r(6,"button",39),v("click",function(){b(n);let o=d().$implicit,a=d(2);return T(a.deleteFile(o))}),m(7,"Delete"),l(),u(8,j0,1,0,"mat-divider"),h(9,"filename"),h(10,"extension"),h(11,"lowercase"),u(12,Q0,2,0,"button",41),h(13,"filename"),h(14,"extension"),h(15,"lowercase"),l()}if(e&2){let n=d().$implicit;s(3),p("href",n.objectUrl,_i),s(5),_(g(11,7,g(10,5,g(9,3,n.name)))==="xml"?8:-1),s(4),_(g(15,13,g(14,11,g(13,9,n.name)))==="xml"?12:-1)}}function G0(e,i){if(e&1&&(r(0,"td",34),u(1,U0,16,15,"ya-more"),l()),e&2){let n=i.$implicit,t=d(2);s(),_(!n.folder&&t.mayManageStacks()?1:-1)}}function Y0(e,i){e&1&&f(0,"th",33)}function W0(e,i){if(e&1){let n=A();r(0,"span",43),m(1," Warning: XML-formatted command stacks are deprecated, "),r(2,"a",44),v("click",function(o){b(n);let a=d(2).$implicit,c=d(2);return T(c.convertToJSON(o,a.nameWithoutInstance))}),m(3," convert to the new format "),l()()}}function z0(e,i){e&1&&f(0,"span")}function J0(e,i){if(e&1&&(r(0,"span"),m(1),h(2,"filename"),h(3,"extension"),l()),e&2){let n=d(2).$implicit;s(),S("Unsupported format '",g(3,3,g(2,1,n.name)),"'")}}function K0(e,i){if(e&1&&(r(0,"span"),u(1,W0,4,0,"span",43),h(2,"filename"),h(3,"extension"),h(4,"lowercase"),u(5,z0,1,0,"span")(6,J0,4,5,"span"),l()),e&2){let n,t=d().$implicit;s(),_((n=g(4,5,g(3,3,g(2,1,t.name))))==="xml"?1:n==="ycs"?5:6)}}function X0(e,i){if(e&1&&(r(0,"td",42),u(1,K0,7,7,"span"),l()),e&2){let n=i.$implicit;s(),_(n.folder?-1:1)}}function Z0(e,i){e&1&&f(0,"tr",45)}function eu(e,i){if(e&1){let n=A();r(0,"tr",46),v("click",function(){let o=b(n).$implicit,a=d(2);return T(a.toggleOne(o))}),l()}if(e&2){let n=i.$implicit,t=d(2);R("selected",t.selection.isSelected(n))}}function tu(e,i){if(e&1&&(r(0,"table",7),M(1,13),u(2,A0,2,1,"th",14)(3,O0,2,1,"td",15),I(),M(4,16),u(5,P0,2,0,"th",17)(6,$0,3,1,"td",18),I(),M(7,19),u(8,L0,2,0,"th",17)(9,R0,2,0,"td",18),I(),M(10,20),u(11,B0,2,0,"th",17)(12,H0,3,3,"td",18),I(),M(13,21),u(14,q0,1,0,"th",22)(15,G0,2,1,"td",23),I(),M(16,24),u(17,Y0,1,0,"th",17)(18,X0,2,1,"td",25),I(),u(19,Z0,1,0,"tr",26)(20,eu,1,2,"tr",27),l()),e&2){let n=d();p("dataSource",n.dataSource),s(19),p("cdkHeaderRowDef",n.displayedColumns),s(),p("cdkRowDefColumns",n.displayedColumns)}}function iu(e,i){e&1&&(r(0,"ya-empty-message"),m(1,"Empty directory."),l())}function nu(e,i){if(e&1){let n=A();r(0,"p")(1,"button",48),v("click",function(){b(n);let o=d(4);return T(o.createStack())}),m(2,"Create a stack"),l(),m(3," or "),r(4,"button",49),v("click",function(){b(n);let o=d(4);return T(o.openUploadDialog())}),m(5,"Import a stack"),l()()}}function ou(e,i){if(e&1&&(r(0,"ya-empty-message",47)(1,"p"),m(2," Command stacks are used to interactively execute a prepared set of commands. To start, either: "),l(),u(3,nu,6,0,"p"),l()),e&2){let n=d(3);s(3),_(n.mayManageStacks()?3:-1)}}function au(e,i){if(e&1&&u(0,iu,2,0,"ya-empty-message")(1,ou,4,1,"ya-empty-message",47),e&2){let n=i,t=d(2);_(t.loaded&&n.length?0:-1),s(),_(t.loaded&&!n.length?1:-1)}}function ru(e,i){if(e&1&&(u(0,au,2,2),h(1,"async")),e&2){let n,t=d();_((n=g(1,1,t.breadcrumb$))?0:-1,n)}}var Wo=(()=>{let i=class i{constructor(t,o,a,c,C,x,E,V){this.dialog=t,this.yamcs=o,this.router=c,this.route=C,this.authService=x,this.messageService=E,this.configService=V,this.breadcrumb$=new P([]),this.dragActive$=new P(!1),this.displayedColumns=["select","name","modified","actions","formatWarning"],this.dataSource=new Ke([]),this.selection=new ut(!0,[]),this.loaded=!1,this.converting=!1,a.setTitle("Command stacks"),this.storageClient=o.createStorageClient();let N=V.getConfig();this.bucket=V.getStackBucket(),this.folderPerInstance=N.stackFolderPerInstance,this.loadCurrentFolder(),this.routerSubscription=c.events.pipe(Dn(te=>te instanceof Rn)).subscribe(()=>{this.loadCurrentFolder()})}loadCurrentFolder(){let t={delimiter:"/"},o="";this.folderPerInstance&&(o=this.yamcs.instance+"/");let a=this.route.snapshot.url;a.length?t.prefix=o+a.map(c=>c.path).join("/")+"/":o&&(t.prefix=o),this.storageClient.listObjects(this.bucket,t).then(c=>{this.updateBrowsePath(),this.changedir(c),this.loaded=!0})}getNameWithoutInstance(t){if(this.folderPerInstance){let o=this.yamcs.instance;return t.substr(o.length)}else return t}changedir(t){this.selection.clear();let o=[];for(let a of t.prefixes||[])o.push({folder:!0,name:a,nameWithoutInstance:this.getNameWithoutInstance(a)});for(let a of t.objects||[])a.name.endsWith("/")||o.push({folder:!1,name:a.name,nameWithoutInstance:this.getNameWithoutInstance(a.name),modified:a.created,objectUrl:this.storageClient.getObjectURL(this.bucket,a.name)});this.dataSource.data=o}isAllSelected(){let t=this.selection.selected.length,o=this.dataSource.filteredData.length;return t===o&&o>0}masterToggle(){this.isAllSelected()?this.selection.clear():this.dataSource.filteredData.forEach(t=>this.selection.select(t))}toggleOne(t){(!this.selection.isSelected(t)||this.selection.selected.length>1)&&this.selection.clear(),this.selection.toggle(t)}createStack(){this.dialog.open(Uo,{width:"400px",data:{path:this.getCurrentPath(),prefix:this.folderPerInstance?this.yamcs.instance+"/":""}}).afterClosed().subscribe(o=>{o&&this.router.navigateByUrl(`/commanding/stacks/files/${o}?c=${this.yamcs.context}`)})}createFolder(){this.dialog.open(Go,{width:"400px",data:{bucket:this.bucket,path:this.getCurrentPath()}}).afterClosed().subscribe({next:()=>this.loadCurrentFolder()})}openUploadDialog(){this.uploaderEl.nativeElement.click()}importStack(){let t=this.getCurrentPath();t.startsWith("/")&&(t=t.substring(1));let o=this.uploaderEl.nativeElement.files,a=[];for(let c in o)if(!isNaN(parseInt(c,10))){let C=o[c],x=t?t+"/"+C.name:C.name,V=(this.folderPerInstance?this.yamcs.instance+"/":"")+x,N=this.storageClient.uploadObject(this.bucket,V,C);a.push(N)}Promise.all(a).then(()=>this.loadCurrentFolder()).catch(c=>this.messageService.showError(c))}convertToJSON(t,o){if(!this.converting&&(t.shiftKey||confirm(`Are you sure you want to convert '${o}' to the new format?
This wil delete the original XML file.
(Press shift if you do not want to show this dialog)`))){this.converting=!0;let a=this.storageClient.getObject(this.bucket,o).then(async c=>{if(c.ok){let x=new DOMParser().parseFromString(await c.text(),"text/xml"),E=xi.parseXML(x.documentElement,this.configService.getCommandOptions());xi.convertToJSON(this.messageService,this.storageClient,this.bucket,o,E,{}).then(()=>{this.loadCurrentFolder()})}else this.messageService.showError("Failed to load '"+o+"' for conversion")}).finally(()=>{this.converting=!1})}}getCurrentPath(){let t="";for(let o of this.route.snapshot.url)t+="/"+o.path;return t||"/"}deleteSelectedStacks(){let t=[],o=[];for(let a of this.selection.selected)a.folder?o.push(this.storageClient.listObjects(this.bucket,{prefix:a.name}).then(c=>{let C=c.objects||[];t.push(...C.map(x=>x.name))})):t.push(a.name);Promise.all(o).then(()=>{if(confirm(`You are about to delete ${t.length} files. Are you sure you want to continue?`)){let a=[];for(let c of t)a.push(this.storageClient.deleteObject(this.bucket,c));Promise.all(a).then(()=>{this.loadCurrentFolder()})}})}renameFile(t){this.dialog.open(Yo,{data:{name:t.name},width:"400px"}).afterClosed().subscribe(a=>{a&&this.loadCurrentFolder()})}deleteFile(t){confirm(`Are you sure you want to delete ${t.nameWithoutInstance}?`)&&this.storageClient.deleteObject(this.bucket,t.name).then(()=>{this.loadCurrentFolder()})}dragEnter(t){return this.dragActive$.next(!0),t.preventDefault(),t.stopPropagation(),!1}dragOver(t){return t.preventDefault(),t.stopPropagation(),!1}dragLeave(t){return this.dragActive$.next(!1),t.preventDefault(),t.stopPropagation(),!1}drop(t){let o=t.dataTransfer||{};if(o){let a=this.getCurrentPath().substring(1);a!==""&&(a+="/"),po(o).then(c=>{let C=[];for(let x of c){let E=a+x._fullPath;this.folderPerInstance&&(E=this.yamcs.instance+"/"+E);let V=this.storageClient.uploadObject(this.bucket,E,x);C.push(V)}Promise.all(C).finally(()=>{this.loadCurrentFolder()})})}return this.dragActive$.next(!1),t.preventDefault(),t.stopPropagation(),!1}mayManageStacks(){let t=this.authService.getUser();return t.hasObjectPrivilege("ManageBucket",this.bucket)||t.hasSystemPrivilege("ManageAnyBucket")}updateBrowsePath(){let t=[],o="";for(let a of this.route.snapshot.url)o+="/"+a.path,t.push({name:a.path,route:"/commanding/stacks/browse"+o});return this.breadcrumb$.next(t),o||"/"}ngOnDestroy(){this.routerSubscription?.unsubscribe()}};i.\u0275fac=function(o){return new(o||i)(y(Je),y(U),y(we),y(ke),y(Ne),y(tt),y(et),y(Oe))},i.\u0275cmp=w({type:i,selectors:[["ng-component"]],viewQuery:function(o,a){if(o&1&&(z(v0,7),z(S0,5)),o&2){let c;J(c=K())&&(a.dropArea=c.first),J(c=K())&&(a.uploaderEl=c.first)}},standalone:!0,features:[k],decls:17,vars:16,consts:[["droparea",""],["uploader",""],["mat-button","","color","primary"],["mat-button","","color","primary",3,"disabled"],[1,"droparea",3,"dragenter"],[1,"droparea-overlay",3,"dragover","dragleave","drop"],[1,"panel-content"],["mat-table","",1,"ya-data-table","expand",3,"dataSource"],["mat-button","","color","primary",3,"click"],["type","file","hidden","","accept",".xml,.XML,.ycs,.YCS","multiple","",3,"change"],["mat-button","","color","primary",3,"click","disabled"],["link","/commanding/stacks/browse","icon","account_tree",3,"queryParams"],[3,"link","queryParams","label"],["cdkColumnDef","select"],["mat-header-cell","","class","checkbox",4,"cdkHeaderCellDef"],["mat-cell","","class","checkbox",4,"cdkCellDef"],["cdkColumnDef","name"],["mat-header-cell","",4,"cdkHeaderCellDef"],["mat-cell","",4,"cdkCellDef"],["cdkColumnDef","visibility"],["cdkColumnDef","modified"],["matColumnDef","actions"],["mat-header-cell","","class","expand",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["cdkColumnDef","formatWarning"],["mat-cell","","style","text-align: right",4,"cdkCellDef"],["mat-header-row","",4,"cdkHeaderRowDef"],["mat-row","",3,"selected","click",4,"cdkRowDef","cdkRowDefColumns"],["mat-header-cell","",1,"checkbox"],["type","checkbox",3,"checked"],["type","checkbox",3,"change","checked"],["mat-cell","",1,"checkbox"],["type","checkbox",3,"click","change","checked"],["mat-header-cell",""],["mat-cell",""],[1,"icon12",2,"vertical-align","middle","margin-right","7px"],[3,"click","routerLink","queryParams"],[3,"click","routerLink","queryParams","title"],["mat-header-cell","",1,"expand"],["mat-menu-item","",3,"click"],["mat-menu-item","","download","",3,"href"],["mat-menu-item",""],["mat-cell","",2,"text-align","right"],["title","Certain features are not implemented for XML, the format will be phased out gradually",2,"color","#cc0000","cursor","help"],["title","Convert to YCS",2,"color","inherit","cursor","pointer",3,"click"],["mat-header-row",""],["mat-row","",3,"click"],["headerTitle","Command Stacks"],[1,"ya-button","primary",3,"click"],[1,"ya-button",3,"click"]],template:function(o,a){if(o&1){let c=A();r(0,"app-instance-page")(1,"app-instance-toolbar"),m(2," Command stacks \xA0\xA0\xA0 "),u(3,b0,4,0,"button",2)(4,T0,6,0,"button",2)(5,w0,4,0,"button",2)(6,k0,4,1,"button",3),l(),r(7,"div",4,0),h(9,"async"),v("dragenter",function(x){return b(c),T(a.dragEnter(x))}),r(10,"div",5),h(11,"async"),v("dragover",function(x){return b(c),T(a.dragOver(x))})("dragleave",function(x){return b(c),T(a.dragLeave(x))})("drop",function(x){return b(c),T(a.drop(x))}),l(),r(12,"div",6),u(13,M0,1,1),h(14,"async"),u(15,tu,21,3,"table",7)(16,ru,2,3),l()()()}if(o&2){let c;s(3),_(a.mayManageStacks()?3:-1),s(),_(a.mayManageStacks()?4:-1),s(),_(a.mayManageStacks()?5:-1),s(),_(a.mayManageStacks()?6:-1),s(),R("active",g(9,10,a.dragActive$)),s(3),R("hide",!g(11,12,a.dragActive$)),s(3),_((c=g(14,14,a.breadcrumb$))?13:-1,c),s(2),_(a.dataSource&&a.dataSource.data.length?15:16)}},dependencies:[Te,be,D,Q,Vn,$e,Pi,gt,at,rt,Oi,ht,oe,We,Ye,ge,Ae,Fe,Ie,xe,ye,ve,Se,Wt,Yt,It,At,Pe,ro,Xt],styles:[".droparea[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;overflow:auto}.droparea-overlay[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;box-sizing:border-box;background:#1b61b91a;border:1px solid rgba(27,97,185,1);z-index:10}table[_ngcontent-%COMP%]{-webkit-user-select:none;user-select:none}"],changeDetection:0});let e=i;return e})();var zo=(()=>{let i=class i{};i.\u0275fac=function(o){return new(o||i)},i.\u0275cmp=w({type:i,selectors:[["app-stack-page"]],standalone:!0,features:[k],decls:1,vars:0,template:function(o,a){o&1&&f(0,"router-outlet")},dependencies:[kt],encapsulation:2,changeDetection:0});let e=i;return e})();var Jo=(()=>{let i=class i{};i.\u0275fac=function(o){return new(o||i)},i.\u0275cmp=w({type:i,selectors:[["app-stacks-page"]],standalone:!0,features:[k],decls:1,vars:0,template:function(o,a){o&1&&f(0,"router-outlet")},dependencies:[kt],encapsulation:2,changeDetection:0});let e=i;return e})();var lu=e=>{let i=e,n=e.findIndex(o=>o.path==="-");n!==-1&&(i=e.slice(0,n));let t="/"+i.map(o=>o.path).join("/");return{consumed:i,posParams:{command:new Ln(t,{})}}},px=[{path:"",canActivate:[hn,Cn],canActivateChild:[gn],runGuardsAndResolvers:"always",component:co,children:[{path:"clearances",canActivate:[ho],children:[{path:"",pathMatch:"full",component:xo},{path:"log",component:Co}]},{path:"send",children:[{path:"",pathMatch:"full",component:Oo},{matcher:lu,children:[{path:"",pathMatch:"full",component:Ao},{path:"-/report/:commandId",component:Eo}]}]},{path:"history",children:[{path:"",pathMatch:"full",component:wo},{path:":commandId",component:ko}]},{path:"queues",component:Lo,canActivate:[fo],children:[{path:"",pathMatch:"full",redirectTo:"pending"},{path:"pending",component:Vo},{path:"log",component:No}]},{path:"stacks",pathMatch:"full",redirectTo:"stacks/browse"},{path:"stacks/browse",component:Jo,children:[{path:"**",component:Wo}]},{path:"stacks/files",component:zo,providers:[bn],children:[{path:"**",component:xi,canDeactivate:[Bo]}]},{path:"ext",canActivate:[hn,Cn],canActivateChild:[gn],runGuardsAndResolvers:"always",children:[{path:":extension",component:so}]}]}];export{px as ROUTES};
