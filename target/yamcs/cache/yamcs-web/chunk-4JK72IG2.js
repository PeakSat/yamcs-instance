import{b as it,d as nt,e as ot,f as st}from"./chunk-FTOGDGWN.js";import{$c as V,Aa as l,Ca as f,F as D,Ga as v,Ja as I,La as S,Ma as x,Na as $,Qc as R,Rc as B,Re as k,Sc as j,Tc as A,Uc as O,Vc as G,Ve as w,Wc as Q,We as at,X as s,Xc as W,Xe as mt,Y as _,Yc as q,Ye as lt,Zc as L,_a as F,_c as U,aa as c,ad as Y,bd as z,ca as C,cd as J,dd as K,e as b,ed as X,ga as y,ib as N,ka as n,la as o,ma as p,na as h,oa as T,pb as H,sa as d,se as Z,te as tt,ve as et,wa as M,xa as P,ya as E,zd as g}from"./chunk-YLFXKKOP.js";var _t=(t,e)=>({c:t,name:e});function Ct(t,e){t&1&&(n(0,"th",17),l(1,"Packet"),o())}function ut(t,e){if(t&1&&(n(0,"a",19),l(1),o()),t&2){let a=d().$implicit,m=d(2);C("queryParams",I(2,_t,m.yamcs.context,a.packetName)),s(),f(" ",a.packetName," ")}}function ht(t,e){if(t&1&&l(0),t&2){let a=d().$implicit;f(" ",a.packetName," ")}}function Tt(t,e){if(t&1&&(n(0,"td",18),c(1,ut,2,5,"a",19)(2,ht,1,1),o()),t&2){let a=d(2);s(),y(a.config.tmArchive?1:2)}}function St(t,e){t&1&&p(0,"td",20)}function xt(t,e){t&1&&(n(0,"th",21),l(1,"Received"),o())}function bt(t,e){if(t&1&&(n(0,"td",22),l(1),S(2,"deltaWith"),o()),t&2){let a=e.$implicit;s(),f(" ",$(2,1,a.lastReceived,a.lastPacketTime)||"-"," ")}}function yt(t,e){t&1&&p(0,"td",20)}function Dt(t,e){t&1&&(n(0,"th",17),l(1,"Packet time"),o())}function vt(t,e){if(t&1&&(n(0,"td",18),l(1),S(2,"datetime"),o()),t&2){let a=e.$implicit;s(),f(" ",x(2,1,a.lastPacketTime)||"-"," ")}}function Rt(t,e){t&1&&p(0,"td",20)}function gt(t,e){t&1&&(n(0,"th",17),l(1,"Packet rate"),o())}function kt(t,e){if(t&1&&(n(0,"td",22),l(1),o()),t&2){let a=e.$implicit;s(),f(" ",a.packetRate," p/s ")}}function wt(t,e){if(t&1&&(n(0,"td",23),l(1),S(2,"async"),o()),t&2){let a=d(2);s(),f(" ",x(2,1,a.totalPacketRate$)," p/s ")}}function Mt(t,e){t&1&&(n(0,"th",17),l(1,"Data rate"),o())}function Pt(t,e){if(t&1&&(n(0,"td",22),l(1),S(2,"dataRate"),o()),t&2){let a=e.$implicit;s(),f(" ",x(2,1,a.dataRate)," ")}}function Et(t,e){if(t&1&&(n(0,"td",23),l(1),S(2,"async"),S(3,"dataRate"),o()),t&2){let a=d(2);s(),f(" ",x(3,3,x(2,1,a.totalDataRate$))," ")}}function It(t,e){t&1&&p(0,"th",24)}function $t(t,e){t&1&&p(0,"td",18)}function Ft(t,e){t&1&&p(0,"td",20)}function Nt(t,e){t&1&&p(0,"tr",25)}function Ht(t,e){t&1&&p(0,"tr",26)}function Bt(t,e){t&1&&p(0,"tr",27)}function jt(t,e){if(t&1&&(n(0,"table",0),h(1,1),c(2,Ct,2,0,"th",2)(3,Tt,3,1,"td",3)(4,St,1,0,"td",4),T(),h(5,5),c(6,xt,2,0,"th",6)(7,bt,3,4,"td",7)(8,yt,1,0,"td",4),T(),h(9,8),c(10,Dt,2,0,"th",2)(11,vt,3,3,"td",3)(12,Rt,1,0,"td",4),T(),h(13,9),c(14,gt,2,0,"th",2)(15,kt,2,1,"td",7)(16,wt,3,3,"td",10),T(),h(17,11),c(18,Mt,2,0,"th",2)(19,Pt,3,3,"td",7)(20,Et,4,5,"td",10),T(),h(21,12),c(22,It,1,0,"th",13)(23,$t,1,0,"td",3)(24,Ft,1,0,"td",4),T(),c(25,Nt,1,0,"tr",14)(26,Ht,1,0,"tr",15)(27,Bt,1,0,"tr",16),o()),t&2){let a=d();C("dataSource",a.dataSource),s(25),C("matHeaderRowDef",a.displayedColumns),s(),C("matRowDefColumns",a.displayedColumns),s(),C("matFooterRowDef",a.displayedColumns)}}var rt=(()=>{let e=class e{constructor(m,i){this.yamcs=m,this.statsByName={},this.dataSource=new X,this.totalPacketRate$=new b(0),this.totalDataRate$=new b(0),this.displayedColumns=["packetName","lastPacketTime","lastReceived","packetRate","dataRate","actions"],this.config=i.getConfig()}ngAfterViewInit(){this.dataSource.sort=this.sort,this.tmstats$&&!this.tmstatsSubscription&&this.yamcs.yamcsClient.getPacketNames(this.yamcs.instance).then(m=>{for(let i of m.packets||[])this.statsByName[i]={packetName:i,packetRate:0,dataRate:0};this.updateData(),this.tmstatsSubscription=this.tmstats$.subscribe(i=>{for(let r of i||[])this.statsByName[r.packetName]=r;this.updateData()})})}updateData(){let m=Object.values(this.statsByName),i=0,r=0;for(let u of m)i+=Number(u.packetRate),r+=Number(u.dataRate);this.totalPacketRate$.next(i),this.totalDataRate$.next(r),this.dataSource.data=m}ngOnDestroy(){this.tmstatsSubscription?.unsubscribe()}};e.\u0275fac=function(i){return new(i||e)(_(k),_(g))},e.\u0275cmp=D({type:e,selectors:[["app-tmstats-table"]],viewQuery:function(i,r){if(i&1&&M(R,5),i&2){let u;P(u=E())&&(r.sort=u.first)}},inputs:{tmstats$:"tmstats$"},standalone:!0,features:[v],decls:1,vars:1,consts:[["mat-table","","matSort","","matSortActive","packetName","matSortDirection","asc","matSortDisableClear","",1,"ya-data-table","expand",3,"dataSource"],["matColumnDef","packetName"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["mat-footer-cell","",4,"matFooterCellDef"],["matColumnDef","lastReceived"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","","style","text-align: right",4,"matCellDef"],["matColumnDef","lastPacketTime"],["matColumnDef","packetRate"],["mat-footer-cell","","style","text-align: right",4,"matFooterCellDef"],["matColumnDef","dataRate"],["matColumnDef","actions"],["mat-header-cell","","class","expand",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-footer-row","",4,"matFooterRowDef"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],["routerLink","/telemetry/packets",3,"queryParams"],["mat-footer-cell",""],["mat-header-cell",""],["mat-cell","",2,"text-align","right"],["mat-footer-cell","",2,"text-align","right"],["mat-header-cell","",1,"expand"],["mat-header-row",""],["mat-row",""],["mat-footer-row",""]],template:function(i,r){i&1&&c(0,jt,28,4,"table",0),i&2&&y(r.dataSource?0:-1)},dependencies:[w,F,H,R,B,j,O,U,Q,A,Y,G,V,W,L,q,z,K,J,Z,tt,et],encapsulation:2,changeDetection:0});let t=e;return t})();function At(t,e){if(t&1&&p(0,"app-tmstats-table",1),t&2){let a=d();C("tmstats$",a.tmstats$)}}var ct=(()=>{let e=class e{constructor(m,i,r,u){this.yamcs=m,this.authService=i,this.tmstats$=new b([]),this.config=u.getConfig(),this.user=i.getUser(),r.setTitle(this.yamcs.instance),this.yamcs.processor&&(this.tmstatsSubscription=m.yamcsClient.createTMStatisticsSubscription({instance:this.yamcs.instance,processor:this.yamcs.processor},pt=>this.tmstats$.next(pt.tmstats||[])))}showPackets(){return this.user.hasAnyObjectPrivilegeOfType("ReadPacket")}ngOnDestroy(){this.tmstatsSubscription?.cancel()}};e.\u0275fac=function(i){return new(i||e)(_(k),_(at),_(N),_(g))},e.\u0275cmp=D({type:e,selectors:[["ng-component"]],standalone:!0,features:[v],decls:5,vars:1,consts:[[1,"panel-content"],[3,"tmstats$"]],template:function(i,r){i&1&&(n(0,"app-instance-page")(1,"app-instance-toolbar"),l(2,"Home"),o(),n(3,"div",0),c(4,At,1,1,"app-tmstats-table",1),o()()),i&2&&(s(4),y(r.showPackets()?4:-1))},dependencies:[nt,it,w,rt],encapsulation:2,changeDetection:0});let t=e;return t})();var le=[{path:"",canActivate:[mt,ot],canActivateChild:[lt],runGuardsAndResolvers:"always",component:st,children:[{path:"",pathMatch:"full",component:ct}]}];export{le as ROUTES};
