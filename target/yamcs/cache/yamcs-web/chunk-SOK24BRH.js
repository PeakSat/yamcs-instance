import{a as Ki,b as br,d as Sr}from"./chunk-EW7XVIEW.js";import{a as hr}from"./chunk-2OT6OSOP.js";import{a as _r}from"./chunk-P3QPVXNS.js";import{a as eo}from"./chunk-QM2PL5Q2.js";import{a as Jt}from"./chunk-2PCCNYKX.js";import{a as to,b as la,c as gr,o as vr,v as yr,w as Cr}from"./chunk-XGAHVREP.js";import{a as xr}from"./chunk-EFG5VZTT.js";import{a as Qi}from"./chunk-6BUZTTN5.js";import"./chunk-ISJZ4IJQ.js";import{b as Ke,d as Je,e as Qa,f as fr}from"./chunk-FTOGDGWN.js";import{Aa as c,Ac as Wi,Ad as qi,Ae as cr,B as On,Ba as Y,Bb as Ee,Bd as gt,C as Ho,Ca as I,Cd as Yi,Da as Ht,Db as he,Dd as ji,De as oa,Ea as Wo,Eb as Ce,Ed as jt,Ee as pr,F,Fc as Lt,Fd as ia,G as Fn,Ga as N,Gb as at,Gc as ri,Gd as tr,H as Vn,Ha as Li,Hb as Wn,Hc as li,Hd as Tt,He as mr,Ia as Z,Ib as te,Ic as zi,Ie as Zi,J as At,Ja as _i,Jb as Te,Jc as si,Jd as Xt,Je as dr,K as A,Kc as Yn,Kd as ir,Ke as ra,L as M,La as T,Lb as Xo,Lc as jn,Ld as Zt,Le as ur,M as Nn,Ma as P,Mb as Wt,Mc as Xn,Md as Qt,N as Bo,Na as tt,Nb as xe,Oa as gi,Oe as Kt,P as Mt,Qb as De,Qd as nr,R as it,Rb as Fi,Rd as ci,Re as X,Sa as Rt,Sb as Vi,Sc as Be,Tb as Ni,Tc as ht,Uc as ft,Ue as vt,V as $n,Va as zo,Vb as Zo,Ve as U,Wa as Bn,Wc as ot,We as yt,X as d,Xc as Ue,Xe as Ka,Y as D,Yb as zt,Yd as Qe,Ye as Ja,Za as qo,Zb as zn,Zc as Ge,_ as Hn,_a as ee,_b as fe,_c as _t,_d as Ot,a as et,aa as v,ab as Ii,ad as wt,b as bt,ba as Uo,bc as mt,bd as We,be as na,c as ja,ca as y,da as St,dc as $i,dd as ze,e as B,ea as de,eb as Yo,ec as Hi,ed as It,fb as jo,fc as dt,g as No,ga as b,gc as Bi,gd as Ko,ha as ie,hc as Qo,hd as Jo,he as ar,i as Ri,ia as ne,ib as nt,ic as oi,id as Zn,ie as Ft,ja as ae,jd as Qn,je as Xi,ka as s,kb as Xa,kd as Kn,la as l,lb as Un,ld as Za,le as pi,ma as w,mb as we,mc as Ui,na as G,nb as ai,o as Rn,oa as W,ob as Me,oc as Gi,oe as or,p as Ln,pa as fn,pb as Re,pc as qt,qa as V,qb as Gn,qc as Fe,qd as Jn,ra as k,rc as Ze,rd as er,sa as h,sc as Ve,sd as ea,tc as Ne,td as ta,te as Le,uc as ut,va as Go,vb as Gt,vc as $e,vd as Yt,ve as rr,w as In,wa as ue,wb as Oi,wc as He,we as lr,xa as ce,xc as qn,xe as sr,ya as pe,yd as $,z as $o,za as oe,zb as Xe,zd as Pe,ze as aa}from"./chunk-YLFXKKOP.js";var wr=(()=>{let t=class t{constructor(n){this.dialogRef=n}confirmDiscard(){this.dialogRef.close(!0)}};t.\u0275fac=function(a){return new(a||t)(D(Fe))},t.\u0275cmp=F({type:t,selectors:[["app-display-file-page-dirty-dialog"]],standalone:!0,features:[N],decls:8,vars:0,consts:[["align","end"],["mat-dialog-close","",1,"ya-button"],[1,"ya-button","primary",3,"click"]],template:function(a,o){a&1&&(s(0,"mat-dialog-content")(1,"p"),c(2,"You have unsaved changes on the current page. Do you want to discard them?"),l()(),s(3,"mat-dialog-actions",0)(4,"button",1),c(5,"CANCEL"),l(),s(6,"button",2),k("click",function(){return o.confirmDiscard()}),c(7,"DISCARD"),l()())},dependencies:[U,Ne,He,$e],encapsulation:2});let e=t;return e})();var Tr=e=>Ho(io).canDeactivate(e),io=(()=>{let t=class t{constructor(n,a,o){this.dialog=n,this.authService=a,this.dialogOpen$=new B(!1),this.bucket=o.getDisplayBucket()}canDeactivate(n){return this.dialogOpen$.value?new ja(a=>{this.dialogRef.afterClosed().subscribe({next:o=>{a.next(o===!0),a.complete()},error:()=>{a.next(!1),a.complete()}})}):n.hasPendingChanges()&&this.mayManageDisplays()?new ja(a=>{this.dialogOpen$.next(!0),this.dialogRef=this.dialog.open(wr,{width:"400px"}),this.dialogRef.afterClosed().subscribe({next:o=>{this.dialogOpen$.next(!1),a.next(o===!0),a.complete()},error:()=>{this.dialogOpen$.next(!1),a.next(!1),a.complete()}})}):No(!0)}mayManageDisplays(){let n=this.authService.getUser();return n.hasObjectPrivilege("ManageBucket",this.bucket)||n.hasSystemPrivilege("ManageAnyBucket")}};t.\u0275fac=function(a){return new(a||t)(On(Ve),On(yt),On(Pe))},t.\u0275prov=$o({token:t,factory:t.\u0275fac});let e=t;return e})();function Zl(e,t){if(e&1&&w(0,"img",6),e&2){let i=h();y("src",i.url,$n)}}var Dr=(()=>{let t=class t{constructor(n,a){this.storageClient=n.createStorageClient(),this.bucket=a.getDisplayBucket()}init(n){return this.url=this.storageClient.getObjectURL(this.bucket,n),Promise.resolve()}hasPendingChanges(){return!1}};t.\u0275fac=function(a){return new(a||t)(D(X),D(Pe))},t.\u0275cmp=F({type:t,selectors:[["app-image-viewer"]],standalone:!0,features:[N],decls:7,vars:1,consts:[["xmlns","http://www.w3.org/2000/svg","version","1.1",1,"checkerboard"],["id","pattern","x","0","y","0","width","24","height","24","patternUnits","userSpaceOnUse"],["fill","rgba(204, 204, 204, 0.4)","x","0","width","12","height","12","y","0"],["fill","rgba(204, 204, 204, 0.4)","x","12","width","12","height","12","y","12"],["fill","url(#pattern)","x","0","y","0","width","100%","height","100%"],[1,"wrapper"],[3,"src"]],template:function(a,o){a&1&&(Nn(),s(0,"svg",0)(1,"pattern",1),w(2,"rect",2)(3,"rect",3),l(),w(4,"rect",4),l(),Bo(),s(5,"div",5),v(6,Zl,1,1,"img",6),l()),a&2&&(d(6),b(o.url?6:-1))},dependencies:[U],styles:[".checkerboard[_ngcontent-%COMP%]{position:absolute;width:100%;height:100%}.wrapper[_ngcontent-%COMP%]{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%)}"],changeDetection:0});let e=t;return e})();function Ql(e,t){if(e&1){let i=V();s(0,"button",1),c(1,"View \u25BE"),l(),s(2,"mat-menu",2,0)(4,"button",3),k("click",function(){A(i);let a=h();return M(a.resetZoom())}),s(5,"mat-icon"),c(6,"aspect_ratio"),l(),c(7," Actual size "),l(),s(8,"button",3),k("click",function(){A(i);let a=h();return M(a.fitZoom())}),s(9,"mat-icon"),c(10,"fit_screen"),l(),c(11," Zoom to fit "),l(),s(12,"button",3),k("click",function(){A(i);let a=h();return M(a.zoomIn())}),s(13,"mat-icon"),c(14,"add_circle_outline"),l(),c(15," Zoom in "),l(),s(16,"button",3),k("click",function(){A(i);let a=h();return M(a.zoomOut())}),s(17,"mat-icon"),c(18,"remove_circle_outline"),l(),c(19," Zoom out "),l()()}if(e&2){let i=oe(3);y("matMenuTriggerFor",i)}}var Pr=(()=>{let t=class t{constructor(){this.initialized$=new B(!1)}init(n){this.viewer=n,this.initialized$.next(!0)}fitZoom(){this.viewer.fitZoom()}zoomIn(){this.viewer.zoomIn()}zoomOut(){this.viewer.zoomOut()}resetZoom(){this.viewer.resetZoom()}};t.\u0275fac=function(a){return new(a||t)},t.\u0275cmp=F({type:t,selectors:[["app-opi-display-viewer-controls"]],standalone:!0,features:[N],decls:2,vars:3,consts:[["viewMenu","matMenu"],["mat-button","","color","primary",3,"matMenuTriggerFor"],["overlapTrigger","false","xPosition","after","yPosition","below",1,"ya-menu"],["mat-menu-item","",3,"click"]],template:function(a,o){a&1&&(v(0,Ql,20,1),T(1,"async")),a&2&&b(P(1,1,o.initialized$)?0:-1)},dependencies:[U,ee,dt,fe,$i,mt,Hi],encapsulation:2});let e=t;return e})();var sa=class{constructor(t){this.messageService=t}writeInfo(t){this.messageService.showInfo(t)}writeError(t){this.messageService.showError(t)}writeWarning(t){this.messageService.showInfo(t)}};var ca=class{constructor(t){this.prefix=t}resolve(t){let i;if(t.name==="Liberation Sans"?(i="LiberationSans-Regular.woff2",t.bold&&t.italic?i="LiberationSans-BoldItalic.woff2":t.bold?i="LiberationSans-Bold.woff2":t.italic&&(i="LiberationSans-Italic.woff2")):t.name==="Liberation Mono"?(i="LiberationMono-Regular.woff2",t.bold&&t.italic?i="LiberationMono-BoldItalic.woff2":t.bold?i="LiberationMono-Bold.woff2":t.italic&&(i="LiberationMono-Italic.woff2")):t.name==="Liberation Serif"&&(i="LiberationSerif-Regular.woff2",t.bold&&t.italic?i="LiberationSerif-BoldItalic.woff2":t.bold?i="LiberationSerif-Bold.woff2":t.italic&&(i="LiberationSerif-Italic.woff2")),i)return new FontFace(t.name,`url(${this.prefix}media/${i})`,{weight:t.bold?"bold":"normal",style:t.italic?"italic":"normal"})}};var pa=class{constructor(t){this.watermarkObserver=t,this.dirty=!1,this.valueRange=[null,null],this.archiveSamples=[],this.bufferSize=500,this.bufferWatermark=400,this.pointer=0,this.alreadyWarned=!1,this.realtimeBuffer=Array(this.bufferSize).fill(void 0)}setArchiveData(t){this.archiveSamples=t,this.dirty=!0}setValueRange(t){this.valueRange=t}addRealtimeValue(t){this.pointer<this.bufferSize&&(this.realtimeBuffer[this.pointer]=t,this.pointer>=this.bufferWatermark&&this.watermarkObserver&&!this.alreadyWarned&&(this.watermarkObserver(),this.alreadyWarned=!0),this.pointer=this.pointer+1),this.dirty=!0}reset(){this.archiveSamples=[],this.realtimeBuffer.fill(void 0),this.pointer=0,this.alreadyWarned=!1,this.valueRange=[null,null],this.dirty=!0}snapshot(){let t=this.realtimeBuffer.filter(a=>a!==void 0),i=null;t.length>0&&(i=t[0][0].getTime());let n=this.archiveSamples.filter(a=>i===null||a[0].getTime()<i).concat(t).sort((a,o)=>a[0].getTime()-o[0].getTime());return{valueRange:this.valueRange,samples:n}}};var Ji=class{constructor(t,i){this.yamcs=t,this.extendRequestedRange=!0,this.resolution=6e3,this.loading$=new B(!1),this.data$=new B({valueRange:[null,null],samples:[]}),this.parameters$=new B([]),this.latestRealtimeValues=new Map,this.syncSubscription=i.sync(()=>{if(this.plotBuffer.dirty&&!this.loading$.getValue()){let n=this.plotBuffer.snapshot();this.data$.next({samples:n.samples,valueRange:n.valueRange}),this.plotBuffer.dirty=!1}}),this.plotBuffer=new pa(()=>{this.reloadVisibleRange()})}addParameter(...t){if(this.parameters$.next([...this.parameters$.value,...t]),this.realtimeSubscription){let i=t.map(n=>({name:n.qualifiedName}));this.addToRealtimeSubscription(i)}else this.connectRealtime()}removeParameter(t){let i=this.parameters$.value.filter(n=>n.qualifiedName!==t);this.parameters$.next(i)}reloadVisibleRange(){return this.updateWindow(this.visibleStart,this.visibleStop,[null,null])}updateWindowOnly(t,i){this.visibleStart=t,this.visibleStop=i}updateWindow(t,i,n){this.loading$.next(!0);let a=this.extendRequestedRange?i.getTime()-t.getTime():0,o=new Date(t.getTime()-a),r=new Date(i.getTime()+a),p=[];for(let u of this.parameters$.value)p.push(this.yamcs.yamcsClient.getParameterSamples(this.yamcs.instance,u.qualifiedName,{start:o.toISOString(),stop:r.toISOString(),count:this.resolution,fields:["time","n","avg","min","max"],gapTime:3e5}));let m=Promise.all(p);return this.lastLoadPromise=m,m.then(u=>{if(this.lastLoadPromise===m){this.loading$.next(!1),this.plotBuffer.reset(),this.latestRealtimeValues.clear(),this.visibleStart=t,this.visibleStop=i,this.minValue=void 0,this.maxValue=void 0;let f=[];for(let x=0;x<u.length;x++)f[x]=this.processSamples(u[x]);let _=this.mergeSeries(...f);this.plotBuffer.setArchiveData(_),this.plotBuffer.setValueRange(n),this.lastLoadPromise=null}})}connectRealtime(){let t=this.parameters$.value.map(i=>({name:i.qualifiedName}));this.realtimeSubscription=this.yamcs.yamcsClient.createParameterSubscription({instance:this.yamcs.instance,processor:this.yamcs.processor,id:t,sendFromCache:!1,updateOnExpiration:!0,abortOnInvalid:!0,action:"REPLACE"},i=>{i.mapping&&(this.idMapping=et(et({},this.idMapping),i.mapping)),i.values&&i.values.length&&this.processRealtimeDelivery(i.values)})}addToRealtimeSubscription(t){this.realtimeSubscription.sendMessage({instance:this.yamcs.instance,processor:this.yamcs.processor,id:t,sendFromCache:!1,updateOnExpiration:!0,abortOnInvalid:!0,action:"ADD"})}processRealtimeDelivery(t){for(let o of t){let r=null,p=$.convertValueToNumber(o.engValue);p!==null&&(o.acquisitionStatus==="EXPIRED"?r=null:o.acquisitionStatus==="ACQUIRED"&&(r=[p,p,p]));let m=this.idMapping[o.numericId];this.latestRealtimeValues.set(m.name,r)}let i=new Date;i.setTime(Date.parse(t[0].generationTime));let n=this.parameters$.value.map(o=>this.latestRealtimeValues.get(o.qualifiedName)||null),a=[i,...n];this.plotBuffer.addRealtimeValue(a)}disconnect(){this.data$.complete(),this.loading$.complete(),this.realtimeSubscription?.cancel(),this.syncSubscription?.unsubscribe()}processSamples(t){let i=[];for(let n of t){let a=new Date;if(a.setTime(Date.parse(n.time)),n.n>0){let o=n.avg,r=n.min,p=n.max;this.minValue===void 0?(this.minValue=r,this.maxValue=p):(this.minValue>r&&(this.minValue=r),this.maxValue<p&&(this.maxValue=p)),i.push([a,[r,o,p]])}else i.push([a,null])}return i}mergeSeries(...t){if(t.length===1)return t[0];let i=t[0];for(let n=1;n<t.length;n++){let a=[],o=0,r=0,p=[],m=null,u=i,f=t[n];for(;o<u.length||r<f.length;){let _=o<u.length?u[o]:null,x=r<f.length?f[r]:null;_&&x?_[0].getTime()===x[0].getTime()?(p=_.slice(1),m=x[1],a.push([_[0],...p,m]),o++,r++):_[0].getTime()<x[0].getTime()?(p=_.slice(1),a.push([_[0],...p,m]),o++):(m=x[1],a.push([x[0],...p,m]),r++):_?(p=_.slice(1),a.push([_[0],...p,m]),o++):x&&(m=x[1],a.push([x[0],...p,m]),r++)}i=a}return i}};var ma=class{constructor(t,i,n,a){this.yamcs=n,this.processedSamples=[],this.subscriptions=[],this.dataSource=new Ji(n,a),this.dataSource.extendRequestedRange=!1,this.dataSource.resolution=400,this.dataSource.addParameter({qualifiedName:t}),this.yamcs.range$.subscribe(r=>{let p=this.yamcs.getMissionTime(),m=$.subtractDuration(p,r);this.dataSource.updateWindow(m,p,[null,null])}),this.dataSource.data$.subscribe(r=>{this.processSamples(r),i.requestRepaint()});let o=a.sync(()=>{let r=this.yamcs.getMissionTime(),p=$.subtractDuration(r,this.yamcs.range$.value),m=p.getTime();for(let u=0;u<this.processedSamples.length;u++)if(this.processedSamples[u].x>=m&&u>0){this.processedSamples.splice(0,u);break}this.dataSource.updateWindowOnly(p,r),this.addEdgeSamples(this.processedSamples),i.requestRepaint()});this.subscriptions.push(o),this.backfillSubscription=n.yamcsClient.createBackfillingSubscription({instance:n.instance},r=>{r.finished&&this.dataSource.reloadVisibleRange()})}processSamples(t){let i=[];for(let n of t.samples){let a=n[0].getTime();if(n[1]){let o=n[1][1];i.push({x:a,y:o})}else i.push({x:a,y:null})}this.addEdgeSamples(i),this.processedSamples=i}addEdgeSamples(t){let{visibleStart:i,visibleStop:n}=this.dataSource;if(i&&n){let a={x:i.getTime(),y:null},o={x:n.getTime(),y:null};t.length?(t[0].x>a.x&&t.splice(0,0,a),t[t.length-1].x<o.x&&t.push(o)):(t.push(a),t.push(o))}}getSamples(){return this.processedSamples}disconnect(){this.backfillSubscription?.cancel(),this.subscriptions.forEach(t=>t.unsubscribe()),this.dataSource?.disconnect()}};var da=class extends br{constructor(t,i){super(i),this.storageClient=t}resolve(t,i){if(t.startsWith("ys://")){let n=t.match(/ys:\/\/([^\\\/]+)\/(.+)/);if(n)return this.storageClient.getObjectURL(n[1],n[2])}return super.resolve(t,i)}};var ua=class{constructor(t,i){this.yamcs=t,this.messageService=i}issueCommand(t,i){this.yamcs.yamcsClient.issueCommand(this.yamcs.instance,this.yamcs.processor,t,{args:i}).catch(n=>this.messageService.showError(n))}runProcedure(t,i){let n={};i&&Object.keys(i).forEach(a=>n[a]=String(i[a])),this.yamcs.yamcsClient.startProcedure(this.yamcs.instance,t,{arguments:n}).catch(a=>this.messageService.showError(a))}};var Kl=["frameInner"],Jl=["displayContainer"],ha="MDB:OPS Name",fa="ops://",es="args.",Er=(()=>{let t=class t{constructor(n,a,o,r,p,m,u,f){this.yamcs=n,this.router=a,this.route=o,this.synchronizer=r,this.messageService=p,this.baseHref=m,this.configService=u,this.formatter=f,this.idMapping={},this.idInfo={},this.pvsByName=new Map,this.subscriptionDirty=!1,this.storageClient=n.createStorageClient(),this.bucket=u.getDisplayBucket()}setViewerContainerEl(n){this.viewerContainerEl=n}updateSubscription(){if(this.subscriptionDirty){this.subscriptionDirty=!1,this.parameterSubscription&&this.parameterSubscription.cancel();let n=[];for(let a of this.pvsByName.keys())a.startsWith(fa)?n.push({namespace:ha,name:a.substr(6)}):n.push({name:a});n.length&&(this.parameterSubscription=this.yamcs.yamcsClient.createParameterSubscription({instance:this.yamcs.instance,processor:this.yamcs.processor,id:n,abortOnInvalid:!1,sendFromCache:!0,updateOnExpiration:!0,action:"REPLACE"},a=>{a.mapping&&(this.idMapping=a.mapping),a.info&&(this.idInfo=a.info);for(let o of a.invalid||[]){let r=o.name;o.namespace===ha&&(r=fa+r);let p=this.display.getPV(r);p&&(p.disconnected=!0)}if(a.values?.length){let o=new Map;for(let r of a.values){r.id=this.idMapping[r.numericId];let p=r.id.name;r.id.namespace===ha&&(p=fa+p);let m=this.idInfo[r.numericId];o.set(p,this.toSample(r,m))}this.display.setValues(o)}}))}}toSample(n,a){let o=$.toDate(n.generationTime),r=this.toAlarmSeverity(n),p={time:o,severity:r,value:void 0};return n.engValue&&(p.value=$.convertValue(n.engValue),n.engValue.type==="ENUMERATED"&&(p.valueIndex=Number(n.engValue.sint64Value))),a.units&&(p.units=a.units),p}toAlarmSeverity(n){if(n.acquisitionStatus==="EXPIRED"||n.acquisitionStatus=="NOT_RECEIVED"||n.acquisitionStatus==="INVALID")return Ki.INVALID;if(!n.monitoringResult)return Ki.NONE;switch(n.monitoringResult){case"DISABLED":case"IN_LIMITS":return Ki.NONE;case"WATCH":case"WARNING":case"DISTRESS":return Ki.MINOR;case"CRITICAL":case"SEVERE":return Ki.MAJOR}}init(n){let a=this.displayContainer.nativeElement;this.display=new Sr(a),this.display.utc=this.formatter.isUTC(),this.display.imagesPrefix=this.baseHref+"media/",this.display.setPathResolver(new da(this.storageClient,this.display)),this.display.setConsoleHandler(new sa(this.messageService)),this.display.setFontResolver(new ca(this.baseHref));let o="";n.lastIndexOf("/")!==-1&&(o=n.substring(0,n.lastIndexOf("/")+1)),this.display.addScriptLibrary("Yamcs",new ua(this.yamcs,this.messageService)),this.display.addEventListener("opendisplay",f=>{let _,x=`?c=${this.yamcs.context}&range=${this.yamcs.getTimeRange()}`;if(f.path.startsWith("/")?_=`/telemetry/displays/files${f.path}${x}`:_=`/telemetry/displays/files/${o}${f.path}${x}`,f.args)for(let g in f.args)_+="&"+es+encodeURIComponent(g)+"="+encodeURIComponent(f.args[g]);this.router.navigateByUrl(_)}),this.display.addEventListener("closedisplay",f=>{this.router.navigateByUrl(`/telemetry/displays/browse?c=${this.yamcs.context}`)}),this.display.addEventListener("openpv",f=>{f.pvName.startsWith("/")?this.router.navigateByUrl(`/telemetry/parameters${f.pvName}/-/summary?c=${this.yamcs.context}`):f.pvName.startsWith(fa)?this.yamcs.yamcsClient.getParameterById(this.yamcs.instance,{namespace:ha,name:f.pvName.substring(6)}).then(_=>{this.router.navigateByUrl(`/telemetry/parameters${_.qualifiedName}/-/summary?c=${this.yamcs.context}`)}):alert(`Can't navigate to PV ${f.pvName}`)}),this.display.addEventListener("runcommand",f=>{this.yamcs.yamcsClient.issueCommand(this.yamcs.instance,this.yamcs.processor,f.command,{args:f.args}).catch(_=>this.messageService.showError(_))}),this.display.addEventListener("runprocedure",f=>{this.yamcs.yamcsClient.startProcedure(this.yamcs.instance,f.procedure,{arguments:f.args}).catch(_=>this.messageService.showError(_))}),this.display.addProvider(this),this.display.absPrefix=this.storageClient.getObjectURL(this.bucket,"");let r=this.storageClient.getObjectURL(this.bucket,n),p={},m=this.route.snapshot.queryParams;for(let f in m)f.startsWith("args.")&&(p[f.substring(5)]=m[f]);let u=this.display.setSource(r,p);return u.then(()=>{let f;!this.display.transparent&&this.display.instance?f=this.display.instance.backgroundColor.hex():f="unset",this.frameInner.nativeElement.style.backgroundColor=f,this.syncSubscription=this.synchronizer.sync(()=>this.updateSubscription())}),u}canProvide(n){return!0}startProviding(n){for(let a of n)this.pvsByName.set(a.name,a);this.subscriptionDirty=!0}stopProviding(n){for(let a of n)this.pvsByName.delete(a.name);this.subscriptionDirty=!0}createHistoricalDataProvider(n,a){let{yamcs:o,synchronizer:r}=this;if(this.configService.getConfig().tmArchive)return new ma(n,a,o,r)}isNavigable(){return!0}shutdown(){}hasPendingChanges(){return!1}zoomIn(){this.display.scale+=.1}zoomOut(){this.display.scale-=.1}resetZoom(){this.display.scale=1}fitZoom(){let n=this.display.instance;if(n&&this.viewerContainerEl){let a=this.viewerContainerEl.clientWidth,o=this.viewerContainerEl.clientHeight,{width:r,height:p}=n.unscaledBounds,m=a/r,u=o/p;this.display.scale=Math.min(m,u)}}ngOnDestroy(){this.syncSubscription?.unsubscribe(),this.parameterSubscription?.cancel(),this.display.destroy()}};t.\u0275fac=function(a){return new(a||t)(D(X),D(Me),D(we),D(vt),D(Qe),D(zo),D(Pe),D(qi))},t.\u0275cmp=F({type:t,selectors:[["app-opi-display-viewer"]],viewQuery:function(a,o){if(a&1&&(ue(Kl,5),ue(Jl,7)),a&2){let r;ce(r=pe())&&(o.frameInner=r.first),ce(r=pe())&&(o.displayContainer=r.first)}},standalone:!0,features:[N],decls:4,vars:0,consts:[["frameInner",""],["displayContainer",""],[1,"frame-inner"],[1,"display-container"]],template:function(a,o){a&1&&(s(0,"div",2,0),w(2,"div",3,1),l())},dependencies:[U],styles:["[_nghost-%COMP%]{width:100%;height:100%;display:table}.frame-inner[_ngcontent-%COMP%]{display:table-cell;vertical-align:middle;overflow:auto;text-align:center;line-height:0}.display-container[_ngcontent-%COMP%]{display:inline-block}"],changeDetection:0});let e=t;return e})();function ns(e,t){if(e&1&&(s(0,"mat-option",5),T(1,"memberPath"),c(2),T(3,"memberPath"),l()),e&2){let i=t.$implicit;y("value",P(1,2,i)),d(2),I(" ",P(3,4,i)," ")}}function as(e,t){if(e&1&&(s(0,"span",6),c(1),l()),e&2){let i=h();d(),Y(i.hint)}}var mi=(()=>{let t=class t{constructor(n,a,o){this.dialogRef=n,this.yamcs=a,this.data=o,this.parameter=new te(null,[Ee.required]),this.label=o.label||"Search parameter",this.okLabel=o.okLabel||"SELECT",this.limit=o.limit||10,this.hint=o.hint}ngOnInit(){let n=this.data.exclude||[];this.filteredOptions=this.parameter.valueChanges.pipe(Ln(300),In(a=>this.yamcs.yamcsClient.getParameters(this.yamcs.instance,{q:a,limit:this.limit,searchMembers:!0})),Ri(a=>a.parameters||[]),Ri(a=>a.filter(o=>{for(let r of n){let p=$.getMemberPath(o);if(r===p)return!1}return!0})))}select(){this.dialogRef.close(this.parameter.value)}};t.\u0275fac=function(a){return new(a||t)(D(Fe),D(X),D(Ze))},t.\u0275cmp=F({type:t,selectors:[["app-select-parameter-dialog"]],standalone:!0,features:[N],decls:17,vars:9,consts:[["auto",""],["mat-dialog-title",""],[1,"ya-form"],["type","text",3,"formControl","matAutocomplete"],[1,"ya-autocomplete"],[3,"value"],[1,"hint"],["align","end"],["mat-dialog-close","",1,"ya-button"],[1,"ya-button","primary",3,"click","disabled"]],template:function(a,o){if(a&1){let r=V();s(0,"h2",1),c(1),l(),s(2,"mat-dialog-content",2)(3,"label"),c(4),w(5,"input",3),s(6,"mat-autocomplete",4,0),ne(8,ns,4,6,"mat-option",5,ie),T(10,"async"),l(),v(11,as,2,1,"span",6),l()(),s(12,"mat-dialog-actions",7)(13,"button",8),c(14,"CANCEL"),l(),s(15,"button",9),k("click",function(){return A(r),M(o.select())}),c(16),l()()}if(a&2){let r=oe(7);d(),Y(o.label),d(3),I(" ",o.label," "),d(),y("formControl",o.parameter)("matAutocomplete",r),d(3),ae(P(10,7,o.filteredOptions)),d(3),b(o.hint?11:-1),d(4),y("disabled",!o.parameter.valid),d(),I(" ",o.okLabel," ")}},dependencies:[U,ee,Xe,he,Wt,Yn,zn,jn,Ne,ut,He,$e,oa],encapsulation:2,changeDetection:0});let e=t;return e})();var _a=(()=>{let t=class t{constructor(n,a,o){this.dialogRef=n,this.yamcs=a,this.data=o,this.delimiterOptions=[{id:"COMMA",label:"Comma"},{id:"SEMICOLON",label:"Semicolon"},{id:"TAB",label:"Tab"}],this.headerOptions=[{id:"QUALIFIED_NAME",label:"Qualified names"},{id:"SHORT_NAME",label:"Short names"},{id:"NONE",label:"None"}],this.downloadURL$=new B(null),this.form=new at({start:new te(null),stop:new te(null),delimiter:new te(null,Ee.required),interval:new Wn(null),header:new te(null,Ee.required)});let r=o.start,p=o.stop;(!r||!p)&&(p=a.getMissionTime(),r=$.subtractDuration(p,"PT1H")),this.form.setValue({start:$.toISOString(r),stop:$.toISOString(p),delimiter:"TAB",header:"QUALIFIED_NAME",interval:""}),this.formChangeSubscription=this.form.valueChanges.subscribe(()=>{this.updateURL()}),this.updateURL()}closeDialog(){this.dialogRef.close(!0)}updateURL(){if(this.form.valid){let n={delimiter:this.form.value.delimiter,header:this.form.value.header};this.data.parameterIds&&(n.parameters=this.data.parameterIds),this.data.list&&(n.list=this.data.list),this.form.value.start&&(n.start=$.toISOString(this.form.value.start)),this.form.value.stop&&(n.stop=$.toISOString(this.form.value.stop)),this.form.value.interval&&(n.interval=this.form.value.interval),this.data.filename&&(n.filename=this.data.filename);let a=this.yamcs.yamcsClient.getParameterValuesDownloadURL(this.yamcs.instance,n);this.downloadURL$.next(a)}else this.downloadURL$.next(null)}ngOnDestroy(){this.formChangeSubscription?.unsubscribe()}};t.\u0275fac=function(a){return new(a||t)(D(Fe),D(X),D(Ze))},t.\u0275cmp=F({type:t,selectors:[["app-export-archive-data-dialog"]],standalone:!0,features:[N],decls:38,vars:9,consts:[["mat-dialog-title",""],[1,"ya-form"],[3,"formGroup"],[1,"small-tabs",3,"mat-stretch-tabs"],["label","Content"],[2,"margin-top","1em"],[1,"label"],["cdkFocusRegionstart","","formControlName","start"],[1,"half-break"],["formControlName","stop"],[1,"hint"],["formControlName","interval","type","text",1,"ya-input"],["label","Format"],["formControlName","delimiter",3,"options"],["formControlName","header",3,"options"],["align","end"],["mat-dialog-close","",1,"ya-button"],[3,"click","link","primary","disabled"]],template:function(a,o){a&1&&(s(0,"h2",0),c(1,"Export archive data"),l(),s(2,"mat-dialog-content",1)(3,"form",2)(4,"mat-tab-group",3)(5,"mat-tab",4)(6,"div",5)(7,"div",6),c(8," Start "),w(9,"ya-date-time-input",7),l(),w(10,"hr",8),s(11,"div",6),c(12," Stop "),w(13,"ya-date-time-input",9),l(),w(14,"hr",8),s(15,"div",6),c(16," Interval (ms) "),s(17,"span",10),c(18,"(optional)"),l(),w(19,"br")(20,"input",11),l()()(),s(21,"mat-tab",12)(22,"div",5)(23,"div",6),c(24," CSV column delimiter"),w(25,"br")(26,"ya-select",13),l(),w(27,"hr",8),s(28,"div",6),c(29," Header"),w(30,"br")(31,"ya-select",14),l()()()()()(),s(32,"mat-dialog-actions",15)(33,"button",16),c(34,"CANCEL"),l(),s(35,"ya-download-button",17),T(36,"async"),k("click",function(){return o.closeDialog()}),c(37," DOWNLOAD "),l()()),a&2&&(d(3),y("formGroup",o.form),d(),y("mat-stretch-tabs",!1),d(22),y("options",o.delimiterOptions),d(5),y("options",o.headerOptions),d(4),y("link",P(36,7,o.downloadURL$))("primary",!0)("disabled",!o.form.valid))},dependencies:[U,ee,Te,Xe,he,Ce,xe,De,Ne,ut,He,$e,Ko,Jo,gt,ia,Tt],encapsulation:2});let e=t;return e})();function rs(e,t){if(e&1){let i=V();s(0,"button",9),T(1,"async"),k("click",function(){A(i);let a=h(3);return M(a.save())}),s(2,"mat-icon"),c(3,"save"),l(),c(4," SAVE "),l()}if(e&2){let i=h(3);y("disabled",!P(1,1,i.viewer.hasUnsavedChanges$))}}function ls(e,t){if(e&1){let i=V();s(0,"button",10),k("click",function(){A(i);let a=h(3);return M(a.viewer.pause())}),s(1,"mat-icon"),c(2,"pause"),l(),c(3," PAUSE "),l()}}function ss(e,t){if(e&1){let i=V();s(0,"button",11),k("click",function(){A(i);let a=h(3);return M(a.viewer.unpause())}),s(1,"mat-icon"),c(2,"play_arrow"),l(),c(3," UNPAUSE "),l()}}function cs(e,t){if(e&1){let i=V();s(0,"button",9),k("click",function(){A(i);let a=h(3);return M(a.viewer.delete())}),s(1,"mat-icon"),c(2,"delete"),l(),c(3," DELETE "),l()}if(e&2){let i=h(3);y("disabled",i.viewer.selection.isEmpty())}}function ps(e,t){if(e&1){let i=V();s(0,"button",4),k("click",function(){A(i);let a=h(3);return M(a.viewer.enableScrollView())}),s(1,"mat-icon",12),c(2,"view_headline"),l(),c(3," SCROLL VIEW "),l()}}function ms(e,t){if(e&1){let i=V();s(0,"button",4),k("click",function(){A(i);let a=h(3);return M(a.viewer.enableStandardView())}),s(1,"mat-icon"),c(2,"view_headline"),l(),c(3," STANDARD VIEW "),l()}}function ds(e,t){if(e&1){let i=V();v(0,rs,5,3,"button",1)(1,ls,4,0,"button",2),T(2,"async"),v(3,ss,4,0,"button",3),T(4,"async"),s(5,"button",4),k("click",function(){A(i);let a=h(2);return M(a.addParameter())}),s(6,"mat-icon"),c(7,"playlist_add"),l(),c(8," ADD "),l(),v(9,cs,4,1,"button",1)(10,ps,4,0,"button",5)(11,ms,4,0,"button",5),s(12,"mat-menu",6,0)(14,"button",7),k("click",function(){A(i);let a=h(2);return M(a.exportArchiveData())}),c(15," Export archive data... "),l()(),s(16,"button",8),k("click",function(a){return A(i),M(a.stopPropagation())}),s(17,"mat-icon"),c(18,"more_vert"),l()()}if(e&2){let i=t,n=oe(13),a=h(2);b(a.mayManageDisplays()?0:-1),d(),b(P(2,8,a.viewer.paused$)?-1:1),d(2),b(P(4,10,a.viewer.paused$)?3:-1),d(6),b(i.scroll?-1:9),d(),b(i.scroll?-1:10),d(),b(i.scroll?11:-1),d(3),y("disabled",!i.parameters.length),d(2),y("matMenuTriggerFor",n)}}function us(e,t){if(e&1&&(v(0,ds,19,12),T(1,"async")),e&2){let i,n=h();b((i=P(1,1,n.viewer.model$))?0:-1,i)}}var Mr=(()=>{let t=class t{constructor(n,a,o,r){this.dialog=n,this.snackbar=a,this.authService=o,this.initialized$=new B(!1),this.bucket=r.getDisplayBucket()}init(n){this.viewer=n,this.initialized$.next(!0)}addParameter(){this.dialog.open(mi,{width:"500px",data:{okLabel:"ADD",exclude:this.viewer.getModel().parameters}}).afterClosed().subscribe(a=>{a&&this.viewer.addParameter(a)})}mayManageDisplays(){let n=this.authService.getUser();return n.hasObjectPrivilege("ManageBucket",this.bucket)||n.hasSystemPrivilege("ManageAnyBucket")}save(){this.viewer.save().then(()=>{this.snackbar.open("Changes saved",void 0,{duration:1e3})}).catch(n=>{this.snackbar.open("Failed to save changes: "+n)})}exportArchiveData(){let n=this.viewer.selection.selected;n.length||(n=this.viewer.getModel().parameters),this.dialog.open(_a,{width:"400px",data:{parameterIds:n}})}};t.\u0275fac=function(a){return new(a||t)(D(Ve),D(qn),D(yt),D(Pe))},t.\u0275cmp=F({type:t,selectors:[["app-parameter-table-viewer-controls"]],standalone:!0,features:[N],decls:2,vars:3,consts:[["moreMenu","matMenu"],["mat-button","","color","primary",3,"disabled"],["mat-button","","color","primary","matTooltip","Pause value updates"],["mat-button","","color","primary","matTooltip","Unpause value updates"],["mat-button","","color","primary",3,"click"],["mat-button","","color","primary"],["overlapTrigger","false"],["mat-menu-item","",3,"click","disabled"],["mat-button","",3,"click","matMenuTriggerFor"],["mat-button","","color","primary",3,"click","disabled"],["mat-button","","color","primary","matTooltip","Pause value updates",3,"click"],["mat-button","","color","primary","matTooltip","Unpause value updates",3,"click"],[2,"transform","rotate(90deg)"]],template:function(a,o){a&1&&(v(0,us,2,3),T(1,"async")),a&2&&b(P(1,1,o.initialized$)?0:-1)},dependencies:[U,ee,dt,fe,$i,mt,Hi,Ui],encapsulation:2});let e=t;return e})();var ga=class{constructor(t=10){this.pointer=0,this.latestValues=new Map,this.buf=Array(t).fill(void 0)}push(t,i){let n={};for(let a of t){let o=i[a.numericId];n[o.name]=a}this.buf[this.pointer]=n,this.pointer=(this.pointer+1)%this.buf.length;for(let a of t){let o=i[a.numericId];this.latestValues.set(o.name,a)}}getLatestValue(t){return this.latestValues.get(t)}setSize(t){this.buf=Array(t).fill(void 0),this.pointer=0}snapshot(){return this.pointer===0?[...this.buf]:[...this.buf.slice(this.pointer),...this.buf.slice(0,this.pointer)].reverse()}};var hs=e=>({c:e});function fs(e,t){if(e&1){let i=V();s(0,"th",19)(1,"input",20),k("change",function(a){A(i);let o=h(2);return M(a?o.masterToggle():null)}),l()()}if(e&2){let i=h(2);d(),y("checked",i.selection.hasValue()&&i.isAllSelected())}}function _s(e,t){if(e&1){let i=V();s(0,"td",21)(1,"input",22),k("click",function(a){return A(i),M(a.stopPropagation())})("change",function(a){let o=A(i).$implicit,r=h(2);return M(a?r.selection.toggle(o.name):null)}),l()()}if(e&2){let i=t.$implicit,n=h(2);d(),y("checked",n.selection.isSelected(i.name))}}function gs(e,t){e&1&&(s(0,"th",23),c(1,"Name"),l())}function vs(e,t){if(e&1&&(s(0,"td",24)(1,"a",25),c(2),l()()),e&2){let i=t.$implicit,n=h(2);d(),y("routerLink","/telemetry/parameters"+i.name)("queryParams",Z(3,hs,n.yamcs.context)),d(),I(" ",i.name," ")}}function ys(e,t){e&1&&(s(0,"th",23),c(1,"Severity"),l())}function Cs(e,t){if(e&1&&w(0,"app-alarm-level",26),e&2){let i=h().$implicit;y("level",i.pval==null?null:i.pval.monitoringResult)}}function xs(e,t){e&1&&(s(0,"span"),c(1,"-"),l())}function bs(e,t){if(e&1&&(s(0,"td",21),v(1,Cs,1,1,"app-alarm-level",26)(2,xs,2,0,"span"),l()),e&2){let i=t.$implicit;d(),b(i.pval!=null&&i.pval.monitoringResult?1:2)}}function Ss(e,t){e&1&&(s(0,"th",23),c(1,"Raw"),l())}function ws(e,t){if(e&1&&(s(0,"td",27),c(1),T(2,"value"),l()),e&2){let i=t.$implicit;d(),I(" ",P(2,1,i.pval==null?null:i.pval.rawValue)||"-"," ")}}function Ts(e,t){e&1&&(s(0,"th",23),c(1,"Eng"),l())}function Ds(e,t){e&1&&(s(0,"span"),c(1,"\u2193"),l())}function Ps(e,t){e&1&&(s(0,"span"),c(1,"\u2191"),l())}function Es(e,t){if(e&1&&(s(0,"ya-expirable",28),c(1),T(2,"value"),v(3,Ds,2,0,"span")(4,Ps,2,0,"span"),l()),e&2){let i=h().$implicit;y("pval",i.pval),d(),I(" ",P(2,4,i.pval==null?null:i.pval.engValue)||"-"," "),d(2),b((i.pval==null?null:i.pval.rangeCondition)==="LOW"?3:-1),d(),b((i.pval==null?null:i.pval.rangeCondition)==="HIGH"?4:-1)}}function ks(e,t){e&1&&(s(0,"span"),c(1,"-"),l())}function As(e,t){if(e&1&&(s(0,"td",27),v(1,Es,5,6,"ya-expirable",28)(2,ks,2,0,"span"),l()),e&2){let i=t.$implicit;d(),b(i.pval?1:2)}}function Ms(e,t){e&1&&(s(0,"th",23),c(1,"Reception time"),l())}function Rs(e,t){if(e&1&&(s(0,"td",21),c(1),T(2,"datetime"),l()),e&2){let i=t.$implicit;d(),I(" ",P(2,1,i.pval==null?null:i.pval.acquisitionTime)||"-"," ")}}function Ls(e,t){e&1&&(s(0,"th",23),c(1,"Generation time"),l())}function Is(e,t){if(e&1&&(s(0,"td",21),c(1),T(2,"datetime"),l()),e&2){let i=t.$implicit;d(),Y(P(2,1,i.pval==null?null:i.pval.generationTime)||"-")}}function Os(e,t){e&1&&(s(0,"th",23),c(1,"Acquisition status"),l())}function Fs(e,t){if(e&1&&(s(0,"td",21),c(1),l()),e&2){let i=t.$implicit;d(),Y((i.pval==null?null:i.pval.acquisitionStatus)||"-")}}function Vs(e,t){e&1&&w(0,"th",29)}function Ns(e,t){if(e&1){let i=V();s(0,"td",21)(1,"ya-icon-action",30),k("click",function(a){let o=A(i).index;return h(2).moveDown.emit(o),M(a.stopPropagation())}),l(),s(2,"ya-icon-action",31),k("click",function(a){let o=A(i).index;return h(2).moveUp.emit(o),M(a.stopPropagation())}),l()()}}function $s(e,t){e&1&&w(0,"tr",32)}function Hs(e,t){if(e&1){let i=V();s(0,"tr",33),k("click",function(){let a=A(i).$implicit,o=h(2);return M(o.toggleOne(a.name))}),l()}if(e&2){let i=t.$implicit,n=h(2);de("selected",n.selection.isSelected(i.name))}}function Bs(e,t){if(e&1&&(s(0,"table",1),G(1,2),v(2,fs,2,1,"th",3)(3,_s,2,1,"td",4),W(),G(4,5),v(5,gs,2,0,"th",6)(6,vs,3,5,"td",7),W(),G(7,8),v(8,ys,2,0,"th",6)(9,bs,3,1,"td",4),W(),G(10,9),v(11,Ss,2,0,"th",6)(12,ws,3,3,"td",10),W(),G(13,11),v(14,Ts,2,0,"th",6)(15,As,3,1,"td",10),W(),G(16,12),v(17,Ms,2,0,"th",6)(18,Rs,3,3,"td",4),W(),G(19,13),v(20,Ls,2,0,"th",6)(21,Is,3,3,"td",4),W(),G(22,14),v(23,Os,2,0,"th",6)(24,Fs,2,1,"td",4),W(),G(25,15),v(26,Vs,1,0,"th",16)(27,Ns,3,0,"td",4),W(),v(28,$s,1,0,"tr",17)(29,Hs,1,2,"tr",18),l()),e&2){let i=h();de("paused",i.paused),y("dataSource",i.dataSource),d(28),y("cdkHeaderRowDef",i.displayedColumns),d(),y("cdkRowDefColumns",i.displayedColumns)}}var Rr=(()=>{let t=class t{constructor(n,a,o){this.yamcs=n,this.changeDetector=a,this.model={scroll:!1,parameters:[]},this.moveUp=new it,this.moveDown=new it,this.dataSource=new It([]),this.defaultColumns=["severity","name","generationTime","rawValue","engValue","acquisitionStatus"],this.syncSubscription=o.syncFast(()=>{this.paused||this.refreshTable()})}ngOnInit(){this.refreshTable()}refreshTable(){let n=this.model.parameters.map(a=>({name:a}));for(let a of n)a.pval=this.buffer.getLatestValue(a.name);this.dataSource.data=n,this.changeDetector.detectChanges()}ngOnChanges(){this.showActions?this.displayedColumns=["select",...this.defaultColumns,"actions"]:this.displayedColumns=this.defaultColumns}isAllSelected(){let n=this.selection.selected.length,a=this.dataSource.filteredData.length;return n===a&&a>0}masterToggle(){this.isAllSelected()?this.selection.clear():this.dataSource.filteredData.forEach(n=>this.selection.select(n.name))}toggleOne(n){(!this.selection.isSelected(n)||this.selection.selected.length>1)&&this.selection.clear(),this.selection.toggle(n)}ngOnDestroy(){this.syncSubscription?.unsubscribe()}};t.\u0275fac=function(a){return new(a||t)(D(X),D(Rt),D(vt))},t.\u0275cmp=F({type:t,selectors:[["app-multiple-parameter-table"]],inputs:{model:"model",buffer:"buffer",showActions:"showActions",paused:"paused",selection:"selection"},outputs:{moveUp:"moveUp",moveDown:"moveDown"},standalone:!0,features:[At,N],decls:1,vars:1,consts:[["mat-table","",1,"ya-data-table","expand",3,"dataSource","paused"],["mat-table","",1,"ya-data-table","expand",3,"dataSource"],["cdkColumnDef","select"],["mat-header-cell","","style","text-align: left",4,"cdkHeaderCellDef"],["mat-cell","",4,"cdkCellDef"],["cdkColumnDef","name"],["mat-header-cell","",4,"cdkHeaderCellDef"],["mat-cell","","style","white-space: nowrap",4,"cdkCellDef"],["cdkColumnDef","severity"],["cdkColumnDef","rawValue"],["mat-cell","","class","wrap200",4,"cdkCellDef"],["cdkColumnDef","engValue"],["cdkColumnDef","receptionTime"],["cdkColumnDef","generationTime"],["cdkColumnDef","acquisitionStatus"],["cdkColumnDef","actions"],["mat-header-cell","","class","expand",4,"cdkHeaderCellDef"],["mat-header-row","",4,"cdkHeaderRowDef"],["mat-row","",3,"selected","click",4,"cdkRowDef","cdkRowDefColumns"],["mat-header-cell","",2,"text-align","left"],["type","checkbox",3,"change","checked"],["mat-cell",""],["type","checkbox",3,"click","change","checked"],["mat-header-cell",""],["mat-cell","",2,"white-space","nowrap"],[3,"routerLink","queryParams"],[3,"level"],["mat-cell","",1,"wrap200"],[3,"pval"],["mat-header-cell","",1,"expand"],["icon","keyboard_arrow_down",3,"click"],["icon","keyboard_arrow_up",3,"click"],["mat-header-row",""],["mat-row","",3,"click"]],template:function(a,o){a&1&&v(0,Bs,30,5,"table",0),a&2&&b(o.dataSource.data.length?0:-1)},dependencies:[Jt,U,Re,si,Lt,ri,li,zi,Be,Ue,Ge,We,ze,Zt,ci,Le,Ft],styles:[".paused[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{font-style:italic}"],changeDetection:0});let e=t;return e})();var Us=e=>({c:e});function Gs(e,t){e&1&&(s(0,"th",10),c(1,"Generation time"),l())}function Ws(e,t){if(e&1&&(s(0,"td",11),c(1),T(2,"datetime"),l()),e&2){let i=t.$implicit;d(),Y(P(2,1,i.generationTime)||"-")}}function zs(e,t){if(e&1){let i=V();s(0,"ya-more")(1,"button",13),k("click",function(){A(i);let a=h(2).$index,o=h(2);return M(o.moveLeft.emit(a))}),c(2,"Move left"),l(),s(3,"button",13),k("click",function(){A(i);let a=h(2).$index,o=h(2);return M(o.moveRight.emit(a))}),c(4,"Move right"),l(),w(5,"mat-divider"),s(6,"button",13),k("click",function(){A(i);let a=h(2).$implicit,o=h(2);return M(o.removeColumn.emit(a))}),c(7,"Remove column"),l()()}}function qs(e,t){if(e&1&&(s(0,"th",10)(1,"a",12),c(2),l(),v(3,zs,8,0,"ya-more"),l()),e&2){let i=h().$implicit,n=h(2);d(),y("routerLink","/telemetry/parameters"+i)("queryParams",Z(4,Us,n.yamcs.context)),d(),I(" ",i," "),d(),b(n.showActions?3:-1)}}function Ys(e,t){e&1&&(s(0,"span"),c(1,"\u2193"),l())}function js(e,t){e&1&&(s(0,"span"),c(1,"\u2191"),l())}function Xs(e,t){if(e&1&&(s(0,"ya-expirable",14),c(1),T(2,"value"),v(3,Ys,2,0,"span")(4,js,2,0,"span"),l()),e&2){let i=h();y("pval",i),d(),I(" ",P(2,4,i.engValue)||"-"," "),d(2),b(i.rangeCondition==="LOW"?3:-1),d(),b(i.rangeCondition==="HIGH"?4:-1)}}function Zs(e,t){e&1&&v(0,Xs,5,6,"ya-expirable",14),e&2&&b(t?0:-1)}function Qs(e,t){e&1&&(s(0,"span"),c(1,"-"),l())}function Ks(e,t){if(e&1&&(s(0,"td",11),v(1,Zs,1,1)(2,Qs,2,0,"span"),l()),e&2){let i,n=t.$implicit,a=h().$implicit;d(),b((i=n.pvals[a])?1:2,i)}}function Js(e,t){if(e&1&&(G(0,5),v(1,qs,4,6,"th",3)(2,Ks,3,1,"td",4),W()),e&2){let i=t.$implicit;y("cdkColumnDef",i)}}function ec(e,t){e&1&&w(0,"th",15)}function tc(e,t){e&1&&w(0,"td",11)}function ic(e,t){e&1&&w(0,"tr",16)}function nc(e,t){e&1&&w(0,"tr",17)}function ac(e,t){if(e&1&&(s(0,"table",1),G(1,2),v(2,Gs,2,0,"th",3)(3,Ws,3,3,"td",4),W(),ne(4,Js,3,1,"ng-container",5,ie),G(6,6),v(7,ec,1,0,"th",7)(8,tc,1,0,"td",4),W(),v(9,ic,1,0,"tr",8)(10,nc,1,0,"tr",9),l()),e&2){let i=h();de("paused",i.paused),y("dataSource",i.dataSource),d(4),ae(i.model.parameters),d(5),y("cdkHeaderRowDef",i.displayedColumns),d(),y("cdkRowDefColumns",i.displayedColumns)}}function oc(e,t){if(e&1&&(s(0,"p"),c(1,"\xA0"),l(),c(2," Buffer size: "),s(3,"select",18)(4,"option",19),c(5,"10"),l(),s(6,"option",20),c(7,"25"),l(),s(8,"option",21),c(9,"50"),l(),s(10,"option",22),c(11,"75"),l(),s(12,"option",23),c(13,"100"),l()()),e&2){let i=h();d(3),y("formControl",i.bufferSizeControl)}}var Lr=(()=>{let t=class t{constructor(n,a,o){this.yamcs=n,this.changeDetector=a,this.model={scroll:!0,parameters:[]},this.removeColumn=new it,this.moveLeft=new it,this.moveRight=new it,this.bufferSize=new it,this.dataSource=new It([]),this.bufferSizeControl=new te("10"),this.displayedColumns=["generationTime","actions"],this.syncSubscription=o.syncFast(()=>{this.paused||this.refreshTable()}),this.bufferSizeControl.valueChanges.subscribe(()=>{let r=this.bufferSizeControl.value;r!==String(this.model.bufferSize)&&this.bufferSize.emit(parseInt(r,10))})}ngOnInit(){this.model.bufferSize&&(this.buffer.setSize(this.model.bufferSize),this.bufferSizeControl.setValue(String(this.model.bufferSize))),this.refreshTable()}refreshTable(){let n=[],a=this.buffer.snapshot();for(let o of a){let r=this.findAnyMatchingParameterValue(o);r&&n.push({generationTime:r.generationTime,pvals:o})}this.dataSource.data=n,this.changeDetector.detectChanges()}findAnyMatchingParameterValue(n){for(let a in n)if(n.hasOwnProperty(a)&&this.model.parameters.indexOf(a)!==-1)return n[a]}ngOnChanges(){this.displayedColumns=["generationTime",...this.model.parameters,"actions"]}ngOnDestroy(){this.syncSubscription?.unsubscribe(),this.bufferSizeControlSubscription?.unsubscribe()}};t.\u0275fac=function(a){return new(a||t)(D(X),D(Rt),D(vt))},t.\u0275cmp=F({type:t,selectors:[["app-scrolling-parameter-table"]],inputs:{model:"model",buffer:"buffer",showActions:"showActions",paused:"paused"},outputs:{removeColumn:"removeColumn",moveLeft:"moveLeft",moveRight:"moveRight",bufferSize:"bufferSize"},standalone:!0,features:[At,N],decls:2,vars:2,consts:[["mat-table","",1,"ya-data-table","expand",3,"dataSource","paused"],["mat-table","",1,"ya-data-table","expand",3,"dataSource"],["cdkColumnDef","generationTime"],["mat-header-cell","",4,"cdkHeaderCellDef"],["mat-cell","",4,"cdkCellDef"],[3,"cdkColumnDef"],["cdkColumnDef","actions"],["mat-header-cell","","class","expand",4,"cdkHeaderCellDef"],["mat-header-row","",4,"cdkHeaderRowDef"],["mat-row","",4,"cdkRowDef","cdkRowDefColumns"],["mat-header-cell",""],["mat-cell",""],[3,"routerLink","queryParams"],["mat-menu-item","",3,"click"],[3,"pval"],["mat-header-cell","",1,"expand"],["mat-header-row",""],["mat-row",""],[3,"formControl"],["value","10"],["value","25"],["value","50"],["value","75"],["value","100"]],template:function(a,o){a&1&&v(0,ac,11,5,"table",0)(1,oc,14,1),a&2&&(b(o.dataSource.data.length?0:-1),d(),b(o.showActions?1:-1))},dependencies:[U,Vi,Ni,Fi,he,Wt,Re,si,Lt,ri,li,zi,qt,mt,Be,Ue,Ge,We,ze,Zt,Ot,Le,Ft],styles:[".paused[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{font-style:italic}"],changeDetection:0});let e=t;return e})();function rc(e,t){if(e&1){let i=V();s(0,"app-scrolling-parameter-table",4),T(1,"async"),T(2,"async"),k("moveLeft",function(a){A(i);let o=h(3);return M(o.moveUp(a))})("moveRight",function(a){A(i);let o=h(3);return M(o.moveDown(a))})("removeColumn",function(a){A(i);let o=h(3);return M(o.removeParameter(a))})("bufferSize",function(a){A(i);let o=h(3);return M(o.setBufferSize(a))}),l()}if(e&2){let i=h(2),n=h();y("model",i)("buffer",n.buffer)("paused",P(1,4,n.paused$))("showActions",P(2,6,n.showActions$))}}function lc(e,t){if(e&1){let i=V();s(0,"app-multiple-parameter-table",5),T(1,"async"),T(2,"async"),k("moveUp",function(a){A(i);let o=h(3);return M(o.moveUp(a))})("moveDown",function(a){A(i);let o=h(3);return M(o.moveDown(a))}),l()}if(e&2){let i=h(2),n=h();y("model",i)("buffer",n.buffer)("paused",P(1,5,n.paused$))("showActions",P(2,7,n.showActions$))("selection",n.selection)}}function sc(e,t){if(e&1&&v(0,rc,3,8,"app-scrolling-parameter-table",2)(1,lc,3,9,"app-multiple-parameter-table",3),e&2){let i=h();b(i.scroll?0:1)}}function cc(e,t){if(e&1){let i=V();s(0,"ya-empty-message")(1,"div",6)(2,"p"),c(3," This file is empty. "),w(4,"br"),c(5," Start by "),s(6,"a",7),k("click",function(){A(i);let a=h(2);return M(a.showAddParameterDialog())}),c(7," adding a parameter "),l(),c(8," . "),l()()()}}function pc(e,t){if(e&1){let i=V();s(0,"ya-empty-message")(1,"div",6)(2,"p"),c(3," This file is empty. "),w(4,"br"),c(5," Start by "),s(6,"a",7),k("click",function(){A(i);let a=h(2);return M(a.showAddParameterDialog())}),c(7," adding a parameter "),l(),c(8," . "),l()()()}}function mc(e,t){e&1&&(s(0,"div",1),v(1,sc,2,1)(2,cc,9,0,"ya-empty-message")(3,pc,9,0,"ng-template",null,0,gi),l()),e&2&&(d(),b(t.parameters.length?1:2))}var Ir=(()=>{let t=class t{constructor(n,a,o){this.yamcs=n,this.dialog=a,this.selection=new Oi(!0,[]),this.model$=new B(null),this.buffer=new ga,this.paused$=new B(!1),this.hasUnsavedChanges$=new B(!1),this.showActions$=new B(!1),this.storageClient=n.createStorageClient(),this.bucket=o.getDisplayBucket()}init(n){return this.objectName=n,this.storageClient.getObject(this.bucket,n).then(a=>{a.text().then(o=>{let r=JSON.parse(o);this.model$.next(r),this.createOrModifySubscription()})}),Promise.resolve()}setEnableActions(){this.showActions$.next(!0)}hasPendingChanges(){return this.hasUnsavedChanges$.value}createOrModifySubscription(){let n=this.model$.value.parameters.map(a=>({name:a}));n.length&&(this.dataSubscription?this.dataSubscription.sendMessage({instance:this.yamcs.instance,processor:this.yamcs.processor,id:n,abortOnInvalid:!1,sendFromCache:!0,updateOnExpiration:!0,action:"REPLACE"}):this.dataSubscription=this.yamcs.yamcsClient.createParameterSubscription({instance:this.yamcs.instance,processor:this.yamcs.processor,id:n,abortOnInvalid:!1,sendFromCache:!0,updateOnExpiration:!0,action:"REPLACE"},a=>{a.mapping&&(this.idMapping=a.mapping);let o=a.values||[];this.buffer.push(o,this.idMapping)}))}addParameter(n){let a=this.model$.value;a.parameters.push(n),this.emitModelUpdate(a),this.hasUnsavedChanges$.next(!0),this.createOrModifySubscription()}emitModelUpdate(n){this.model$.next({scroll:n.scroll,bufferSize:n.bufferSize||10,parameters:n.parameters})}getModel(){return this.model$.value}pause(){this.paused$.next(!0)}unpause(){this.paused$.next(!1)}delete(){if(!this.selection.isEmpty()){let n=this.model$.value;n.parameters=n.parameters.filter(a=>!this.selection.isSelected(a)),this.emitModelUpdate(n),this.hasUnsavedChanges$.next(!0)}this.selection.clear()}enableScrollView(){this.selection.clear();let n=this.model$.value;n.scroll=!0,this.emitModelUpdate(n),this.hasUnsavedChanges$.next(!0)}enableStandardView(){this.selection.clear();let n=this.model$.value;n.scroll=!1,this.emitModelUpdate(n),this.hasUnsavedChanges$.next(!0)}removeParameter(n){let a=this.model$.value;a.parameters=a.parameters.filter(o=>o!==n),this.emitModelUpdate(a),this.hasUnsavedChanges$.next(!0)}moveUp(n){let a=this.model$.value,o=a.parameters[n];n===0?(a.parameters[n]=a.parameters[a.parameters.length-1],a.parameters[a.parameters.length-1]=o):(a.parameters[n]=a.parameters[n-1],a.parameters[n-1]=o),this.emitModelUpdate(a),this.hasUnsavedChanges$.next(!0)}moveDown(n){let a=this.model$.value,o=a.parameters[n];n===a.parameters.length-1?(a.parameters[n]=a.parameters[0],a.parameters[0]=o):(a.parameters[n]=a.parameters[n+1],a.parameters[n+1]=o),this.emitModelUpdate(a),this.hasUnsavedChanges$.next(!0)}setBufferSize(n){this.buffer.setSize(n);let a=this.model$.value;a.bufferSize=n,this.emitModelUpdate(a),this.hasUnsavedChanges$.next(!0)}save(){let n=new Blob([JSON.stringify(et({$schema:"https://yamcs.org/schema/parameter-table.schema.json"},this.model$.value),void 0,2)],{type:"application/json"});return this.storageClient.uploadObject(this.bucket,this.objectName,n).then(()=>{this.hasUnsavedChanges$.next(!1)})}showAddParameterDialog(){this.dialog.open(mi,{width:"500px",data:{okLabel:"ADD",exclude:this.getModel().parameters}}).afterClosed().subscribe(a=>{a&&this.addParameter(a)})}ngOnDestroy(){this.dataSubscription?.cancel()}};t.\u0275fac=function(a){return new(a||t)(D(X),D(Ve),D(Pe))},t.\u0275cmp=F({type:t,selectors:[["app-parameter-table-viewer"]],standalone:!0,features:[N],decls:2,vars:3,consts:[["empty",""],[1,"panel-content"],[3,"model","buffer","paused","showActions"],[3,"model","buffer","paused","showActions","selection"],[3,"moveLeft","moveRight","removeColumn","bufferSize","model","buffer","paused","showActions"],[3,"moveUp","moveDown","model","buffer","paused","showActions","selection"],[2,"text-align","left"],[1,"ya-link",2,"cursor","pointer",3,"click"]],template:function(a,o){if(a&1&&(v(0,mc,5,1,"div",1),T(1,"async")),a&2){let r;b((r=P(1,1,o.model$))?0:-1,r)}},dependencies:[Rr,Lr,U,ee,Xt],styles:[".panel-content[_ngcontent-%COMP%]{position:relative;overflow:auto}"],changeDetection:0});let e=t;return e})();function dc(e,t){if(e&1){let i=V();s(0,"button",1),T(1,"async"),k("click",function(){A(i);let a=h(2);return M(a.save())}),s(2,"mat-icon"),c(3,"save"),l(),c(4," SAVE "),l()}if(e&2){let i=h(2);y("disabled",!P(1,1,i.viewer.hasUnsavedChanges$))}}function uc(e,t){if(e&1&&v(0,dc,5,3,"button",0),e&2){let i=h();b(i.mayManageDisplays()?0:-1)}}var Or=(()=>{let t=class t{constructor(n,a,o){this.snackbar=n,this.authService=a,this.initialized$=new B(!1),this.bucket=o.getDisplayBucket()}init(n){this.viewer=n,this.initialized$.next(!0)}mayManageDisplays(){let n=this.authService.getUser();return n.hasObjectPrivilege("ManageBucket",this.bucket)||n.hasSystemPrivilege("ManageAnyBucket")}save(){this.viewer.save().then(()=>{this.snackbar.open("Changes saved",void 0,{duration:1e3})}).catch(n=>{this.snackbar.open("Failed to save changes: "+n)})}};t.\u0275fac=function(a){return new(a||t)(D(qn),D(yt),D(Pe))},t.\u0275cmp=F({type:t,selectors:[["ng-component"]],standalone:!0,features:[N],decls:2,vars:3,consts:[["mat-button","","color","primary",3,"disabled"],["mat-button","","color","primary",3,"click","disabled"]],template:function(a,o){a&1&&(v(0,uc,1,1),T(1,"async")),a&2&&b(P(1,1,o.initialized$)?0:-1)},dependencies:[U,ee,dt,fe],encapsulation:2});let e=t;return e})();var hc=["scriptContainer"],Fr=(()=>{let t=class t{constructor(n,a,o,r){this.messageService=o,this.authService=r,this.hasUnsavedChanges$=new B(!1),this.storageClient=n.createStorageClient(),this.bucket=a.getDisplayBucket()}init(n){return this.objectName=n,this.storageClient.getObject(this.bucket,n).then(a=>a.text().then(o=>this.initializeEditor(o))).catch(a=>this.messageService.showError(a)),Promise.resolve()}initializeEditor(n){let a=[Cr,gr.of([vr]),yr()];this.mayManageDisplays()?a.push(la.updateListener.of(p=>{p.docChanged&&this.hasUnsavedChanges$.next(!0)})):a.push(to.readOnly.of(!0));let o=la.theme({"&":{width:"100%",height:"100%",fontSize:"12px"},".cm-scroller":{overflow:"auto",fontFamily:"'Roboto Mono', monospace"}},{dark:!1});a.push(o);let r=to.create({doc:n,extensions:a});this.editorView=new la({state:r,parent:this.scriptContainer.nativeElement})}mayManageDisplays(){let n=this.authService.getUser();return n.hasObjectPrivilege("ManageBucket",this.bucket)||n.hasSystemPrivilege("ManageAnyBucket")}hasPendingChanges(){return this.hasUnsavedChanges$.value}async save(){let n=this.editorView.state.doc.toString(),a=new Blob([n],{type:"text/javascript"});return this.storageClient.uploadObject(this.bucket,this.objectName,a).then(()=>{this.hasUnsavedChanges$.next(!1)})}};t.\u0275fac=function(a){return new(a||t)(D(X),D(Pe),D(Qe),D(yt))},t.\u0275cmp=F({type:t,selectors:[["app-script-viewer"]],viewQuery:function(a,o){if(a&1&&ue(hc,5),a&2){let r;ce(r=pe())&&(o.scriptContainer=r.first)}},standalone:!0,features:[N],decls:2,vars:0,consts:[["scriptContainer",""],[1,"script-container"]],template:function(a,o){a&1&&w(0,"div",1,0)},dependencies:[U],styles:[".script-container[_ngcontent-%COMP%]{width:100%;height:100%;display:flex}"],changeDetection:0});let e=t;return e})();function fc(e,t){if(e&1&&(s(0,"pre"),c(1),l()),e&2){let i=h();d(),Y(i.text)}}var Vr=(()=>{let t=class t{constructor(n,a,o){this.changeDetector=a,this.storageClient=n.createStorageClient(),this.bucket=o.getDisplayBucket()}init(n){return this.storageClient.getObject(this.bucket,n).then(a=>{a.text().then(o=>{this.text=o,this.changeDetector.detectChanges()})}),Promise.resolve()}hasPendingChanges(){return!1}};t.\u0275fac=function(a){return new(a||t)(D(X),D(Rt),D(Pe))},t.\u0275cmp=F({type:t,selectors:[["app-text-viewer"]],standalone:!0,features:[N],decls:1,vars:1,template:function(a,o){a&1&&v(0,fc,2,1,"pre"),a&2&&b(o.text?0:-1)},dependencies:[U],styles:["pre[_ngcontent-%COMP%]{margin:1em}"],changeDetection:0});let e=t;return e})();var no=(()=>{let t=class t{constructor(n){this.viewContainerRef=n}};t.\u0275fac=function(a){return new(a||t)(D(Hn))},t.\u0275dir=Fn({type:t,selectors:[["","app-viewer-controls-host",""]],standalone:!0});let e=t;return e})();var ao=(()=>{let t=class t{constructor(n){this.viewContainerRef=n}};t.\u0275fac=function(a){return new(a||t)(D(Hn))},t.\u0275dir=Fn({type:t,selectors:[["","app-viewer-host",""]],standalone:!0});let e=t;return e})();var _c=["viewerContainer"],gc=e=>({c:e});function vc(e,t){}function yc(e,t){}var Nr=(()=>{let t=class t{constructor(n,a,o,r,p){this.yamcs=n,this.route=a,this.title=r,this.subscriptions=[],this.folderPerInstance=p.getConfig().displayFolderPerInstance;let m=this.getObjectNameFromUrl();this.loadFile(m);let u=o.events.pipe(Rn(_=>_ instanceof Un)).subscribe(()=>{let _=this.getObjectNameFromUrl();_!==this.objectName&&this.loadFile(_,!0)});this.subscriptions.push(u);let f=a.snapshot.queryParamMap.get("range");f&&n.range$.next(f),u=n.range$.subscribe(_=>{o.navigate([],{replaceUrl:!0,relativeTo:a,queryParams:{range:_},queryParamsHandling:"merge"})}),this.subscriptions.push(u)}getObjectNameFromUrl(){let n=this.route.snapshot.url,a="";this.folderPerInstance&&(a+=this.yamcs.instance);for(let o of n)a&&(a+="/"),a+=o.path;return a}getNameWithoutInstance(n){if(this.folderPerInstance){let a=this.yamcs.instance;return n.substr(a.length)}else return n}loadFile(n,a=!1){this.objectName=n;let o=this.objectName.lastIndexOf("/");if(o===-1)this.folderLink="/telemetry/displays/browse/",this.filename=this.objectName;else{let r=this.getNameWithoutInstance(this.objectName.substring(0,o));this.folderLink="/telemetry/displays/browse/"+r,this.filename=this.objectName.substring(o+1)}this.title.setTitle(this.filename),a&&this.ngAfterViewInit()}ngAfterViewInit(){if(this.filename.toLowerCase().endsWith(".opi")){let n=this.createViewer(Er);n.setViewerContainerEl(this.viewerContainer.nativeElement),this.createViewerControls(Pr).init(n),this.viewer=n}else if(this.filename.toLowerCase().endsWith(".par")){let n=this.createViewer(Ir);this.createViewerControls(Mr).init(n),n.setEnableActions(),this.viewer=n}else if(this.isImage())this.viewer=this.createViewer(Dr);else if(this.filename.toLocaleLowerCase().endsWith(".js")){let n=this.createViewer(Fr);this.createViewerControls(Or).init(n),this.viewer=n}else this.viewer=this.createViewer(Vr);this.viewer.init(this.objectName)}createViewer(n){let a=this.viewerHost.viewContainerRef;return a.clear(),a.createComponent(n).instance}createViewerControls(n){let a=this.controlsHost.viewContainerRef;return a.clear(),a.createComponent(n).instance}isImage(){let n=this.filename.toLowerCase();return n.endsWith(".png")||n.endsWith(".gif")||n.endsWith(".jpg")||n.endsWith("jpeg")||n.endsWith("bmp")}hasPendingChanges(){return this.viewer.hasPendingChanges()}ngOnDestroy(){this.subscriptions.forEach(n=>n.unsubscribe())}};t.\u0275fac=function(a){return new(a||t)(D(X),D(we),D(Me),D(nt),D(Pe))},t.\u0275cmp=F({type:t,selectors:[["ng-component"]],viewQuery:function(a,o){if(a&1&&(ue(no,5),ue(_c,5),ue(ao,5)),a&2){let r;ce(r=pe())&&(o.controlsHost=r.first),ce(r=pe())&&(o.viewerContainer=r.first),ce(r=pe())&&(o.viewerHost=r.first)}},standalone:!0,features:[N],decls:10,vars:5,consts:[["viewerContainer",""],["mat-icon-button","","color","primary",3,"routerLink","queryParams"],["app-viewer-controls-host",""],[2,"height","100%","width","100%"],["app-viewer-host",""]],template:function(a,o){a&1&&(s(0,"app-instance-page")(1,"app-instance-toolbar")(2,"a",1)(3,"mat-icon"),c(4,"arrow_back"),l()(),c(5),v(6,vc,0,0,"ng-template",2),l(),s(7,"div",3,0),v(9,yc,0,0,"ng-template",4),l()()),a&2&&(d(2),y("routerLink",o.folderLink)("queryParams",Z(3,gc,o.yamcs.context)),d(3),I(" ",o.filename," \xA0\xA0\xA0 "))},dependencies:[Je,Ke,U,Re,oi,fe,no,ao],encapsulation:2,changeDetection:0});let e=t;return e})();var Cc=["filename"];function xc(e,t){if(e&1&&(s(0,"form",2)(1,"label"),c(2," Type "),s(3,"select",7)(4,"option",8),c(5,"Parameter Table"),l()()()()),e&2){let i=h();y("formGroup",i.typeForm)}}function bc(e,t){e&1&&(s(0,"span",10),c(1,"File name must end with "),s(2,"code"),c(3,".par"),l()())}function Sc(e,t){if(e&1&&(s(0,"form",2)(1,"label"),c(2," Name "),w(3,"input",9,0),v(5,bc,4,0,"span",10),l(),w(6,"br"),s(7,"label"),c(8," Path "),w(9,"input",11),l()()),e&2){let i,n,a=h();y("formGroup",a.filenameForm),d(),de("invalid",(i=a.filenameForm.get("name"))==null?null:i.invalid),d(4),b((n=a.filenameForm.get("name"))!=null&&n.invalid?5:-1)}}function wc(e,t){if(e&1){let i=V();s(0,"button",12),k("click",function(){A(i);let a=h();return M(a.selectType())}),c(1,"NEXT \xBB"),l()}if(e&2){let i=h();y("disabled",!i.typeForm.valid)}}function Tc(e,t){if(e&1){let i=V();s(0,"button",13),k("click",function(){A(i);let a=h();return M(a.save())}),c(1," SAVE "),l()}if(e&2){let i=h();y("disabled",!i.filenameForm.valid)}}var $r=(()=>{let t=class t{constructor(n,a,o,r,p,m){this.dialogRef=n,this.data=r,this.changeDetector=p,this.configService=m,this.page=1,this.storageClient=o.createStorageClient(),this.typeForm=a.group({type:["par",Ee.required]}),this.filenameForm=a.group({path:[r.path,Ee.required],name:["",[Ee.required,Ee.pattern(/.*\.par/i)]]})}selectType(){let n=this.typeForm.value.type;this.filenameForm.get("name").setValue(`NewFile.${n}`),this.page=2,this.changeDetector.detectChanges(),this.filenameInput.nativeElement.select()}save(){let n=this.filenameForm.get("path").value.trim(),a=this.filenameForm.get("name").value.trim();n.startsWith("/")&&(n=n.substring(1)),n.endsWith("/")&&(n=n.substring(0,n.length-1));let o=n?n+"/"+a:a,r=new Blob([JSON.stringify({$schema:"https://yamcs.org/schema/parameter-table.schema.json",scroll:!1,parameters:[]},void 0,2)],{type:"application/json"}),p=this.configService.getDisplayBucket(),m=this.data.prefix+o;this.storageClient.uploadObject(p,m,r).then(()=>{this.dialogRef.close(o)})}};t.\u0275fac=function(a){return new(a||t)(D(Fe),D(zt),D(X),D(Ze),D(Rt),D(Pe))},t.\u0275cmp=F({type:t,selectors:[["app-create-display-dialog"]],viewQuery:function(a,o){if(a&1&&ue(Cc,5),a&2){let r;ce(r=pe())&&(o.filenameInput=r.first)}},standalone:!0,features:[N],decls:10,vars:4,consts:[["filename",""],["mat-dialog-title",""],[1,"ya-form",3,"formGroup"],["align","end"],["mat-dialog-close","",1,"ya-button"],[1,"ya-button",3,"disabled"],[1,"ya-button","primary",3,"disabled"],["formControlName","type"],["value","par"],["type","text","formControlName","name"],[1,"error-message"],["type","text","formControlName","path"],[1,"ya-button",3,"click","disabled"],[1,"ya-button","primary",3,"click","disabled"]],template:function(a,o){a&1&&(s(0,"h2",1),c(1,"Create display"),l(),s(2,"mat-dialog-content"),v(3,xc,6,1,"form",2)(4,Sc,10,4,"form",2),l(),s(5,"mat-dialog-actions",3)(6,"button",4),c(7,"CANCEL"),l(),v(8,wc,2,1,"button",5)(9,Tc,2,1,"button",6),l()),a&2&&(d(3),b(o.page===1?3:-1),d(),b(o.page===2?4:-1),d(4),b(o.page===1?8:-1),d(),b(o.page===2?9:-1))},dependencies:[U,Te,Vi,Ni,Xe,Fi,he,Ce,xe,De,Ne,ut,He,$e],encapsulation:2});let e=t;return e})();var Hr=(()=>{let t=class t{constructor(n,a,o,r){this.dialogRef=n,this.data=r,this.storageClient=o.createStorageClient(),this.form=a.group({name:["",Ee.required]})}save(){let{path:n,bucket:a}=this.data;n.startsWith("/")&&(n=n.substring(1));let o=this.form.value.name,r=n?`${n}/${o}/`:`${o}/`;this.storageClient.uploadObject(a,r,new Blob).then(()=>this.dialogRef.close(!0))}};t.\u0275fac=function(a){return new(a||t)(D(Fe),D(zt),D(X),D(Ze))},t.\u0275cmp=F({type:t,selectors:[["app-create-display-folder-dialog"]],standalone:!0,features:[N],decls:12,vars:2,consts:[["mat-dialog-title",""],[1,"ya-form",3,"formGroup"],["type","text","formControlName","name","pattern","\\w[\\w\\s\\.\\-\\(\\)\\[\\]]*"],["align","end"],["mat-dialog-close","",1,"ya-button"],[1,"ya-button","primary",3,"click","disabled"]],template:function(a,o){a&1&&(s(0,"h2",0),c(1,"Create folder"),l(),s(2,"mat-dialog-content")(3,"form",1)(4,"label"),c(5," Folder name "),w(6,"input",2),l()()(),s(7,"mat-dialog-actions",3)(8,"button",4),c(9,"CANCEL"),l(),s(10,"button",5),k("click",function(){return o.save()}),c(11,"CREATE"),l()()),a&2&&(d(3),y("formGroup",o.form),d(7),y("disabled",!o.form.valid))},dependencies:[U,Te,Xe,he,Ce,Zo,xe,De,Ne,ut,He,$e],encapsulation:2,changeDetection:0});let e=t;return e})();var Br=(()=>{let t=class t{constructor(n,a,o,r,p){this.dialogRef=n,this.data=p,this.storageClient=o.createStorageClient(),this.bucket=r.getDisplayBucket();let m=$.getFilename(this.data.name);this.filenameForm=a.group({name:[m,[Ee.required]]})}async rename(){let n,a=this.data.name.lastIndexOf("/");a!==-1&&(n=this.data.name.substring(0,a+1));let r=await(await this.storageClient.getObject(this.bucket,this.data.name)).blob(),p=(n||"")+this.filenameForm.get("name").value;await this.storageClient.uploadObject(this.bucket,p,r),await this.storageClient.deleteObject(this.bucket,this.data.name),this.dialogRef.close(p)}};t.\u0275fac=function(a){return new(a||t)(D(Fe),D(zt),D(X),D(Pe),D(Ze))},t.\u0275cmp=F({type:t,selectors:[["app-rename-display-dialog"]],standalone:!0,features:[N],decls:13,vars:4,consts:[["filename",""],["mat-dialog-title",""],[1,"ya-form",3,"formGroup"],["type","text","formControlName","name"],["align","end"],["mat-dialog-close","",1,"ya-button"],[1,"ya-button","primary",3,"click","disabled"]],template:function(a,o){if(a&1){let r=V();s(0,"h2",1),c(1,"Rename file"),l(),s(2,"mat-dialog-content")(3,"form",2)(4,"label"),c(5," Name "),w(6,"input",3,0),l()()(),s(8,"mat-dialog-actions",4)(9,"button",5),c(10,"CANCEL"),l(),s(11,"button",6),k("click",function(){return A(r),M(o.rename())}),c(12," RENAME "),l()()}if(a&2){let r;d(3),y("formGroup",o.filenameForm),d(),de("invalid",(r=o.filenameForm.get("name"))==null?null:r.invalid),d(7),y("disabled",!o.filenameForm.valid)}},dependencies:[U,Te,Xe,he,Ce,xe,De,Ne,ut,He,$e],encapsulation:2});let e=t;return e})();var Ur=(()=>{let t=class t{transform(n){if(!n)return null;let a=n.toLowerCase();return a.endsWith(".opi")?"Operator Interface":a.endsWith(".par")?"Parameter Table":a.endsWith(".js")?"Script File":a.indexOf(".")!==-1?a.substr(a.lastIndexOf(".")+1).toUpperCase()+" File":null}};t.\u0275fac=function(a){return new(a||t)},t.\u0275pipe=Vn({name:"displayType",type:t,pure:!0,standalone:!0});let e=t;return e})();var Dc=["droparea"],Pc=["uploader"],ya=e=>({c:e});function Ec(e,t){if(e&1){let i=V();s(0,"button",8),k("click",function(){A(i);let a=h();return M(a.createDisplay())}),s(1,"mat-icon"),c(2,"add_circle_outline"),l(),c(3," Create display "),l()}}function kc(e,t){if(e&1){let i=V();s(0,"button",8),k("click",function(){A(i);let a=oe(5);return M(a.click())}),s(1,"mat-icon"),c(2,"file_upload"),l(),c(3," Upload files "),s(4,"input",9,1),k("change",function(){A(i);let a=h();return M(a.uploadFiles())}),l()()}}function Ac(e,t){if(e&1){let i=V();s(0,"button",8),k("click",function(){A(i);let a=h();return M(a.createFolder())}),s(1,"mat-icon"),c(2,"create_new_folder"),l(),c(3," Create folder "),l()}}function Mc(e,t){if(e&1){let i=V();s(0,"button",10),k("click",function(){A(i);let a=h();return M(a.deleteSelectedDisplays())}),s(1,"mat-icon"),c(2,"delete"),l(),c(3," Delete "),l()}if(e&2){let i=h();y("disabled",!i.selection.hasValue())}}function Rc(e,t){if(e&1&&w(0,"ya-breadcrumb",12),e&2){let i=t.$implicit,n=h(3);y("link",i.route)("queryParams",Z(3,ya,n.yamcs.context))("label",i.name)}}function Lc(e,t){if(e&1&&(s(0,"ya-breadcrumb-trail"),w(1,"ya-breadcrumb",11),ne(2,Rc,1,5,"ya-breadcrumb",12,ie),l()),e&2){let i=h(),n=h();d(),y("queryParams",Z(1,ya,n.yamcs.context)),d(),ae(i)}}function Ic(e,t){e&1&&v(0,Lc,4,3,"ya-breadcrumb-trail"),e&2&&b(t.length?0:-1)}function Oc(e,t){if(e&1){let i=V();s(0,"input",29),k("change",function(a){A(i);let o=h(3);return M(a?o.masterToggle():null)}),l()}if(e&2){let i=h(3);y("checked",i.selection.hasValue()&&i.isAllSelected())}}function Fc(e,t){if(e&1&&(s(0,"th",27),v(1,Oc,1,1,"input",28),l()),e&2){let i=h(2);d(),b(i.mayManageDisplays()?1:-1)}}function Vc(e,t){if(e&1){let i=V();s(0,"input",31),k("click",function(a){return A(i),M(a.stopPropagation())})("change",function(a){A(i);let o=h().$implicit,r=h(2);return M(a?r.selection.toggle(o):null)}),l()}if(e&2){let i=h().$implicit,n=h(2);y("checked",n.selection.isSelected(i))}}function Nc(e,t){if(e&1&&(s(0,"td",30),v(1,Vc,1,1,"input",28),l()),e&2){let i=h(2);d(),b(i.mayManageDisplays()?1:-1)}}function $c(e,t){e&1&&(s(0,"th",32),c(1,"Name"),l())}function Hc(e,t){if(e&1){let i=V();s(0,"mat-icon",34),c(1," folder "),l(),s(2,"a",35),k("click",function(a){return A(i),M(a.stopPropagation())}),c(3),T(4,"filename"),l()}if(e&2){let i=h().$implicit,n=h(2);d(2),y("routerLink","/telemetry/displays/browse/"+i.nameWithoutInstance)("queryParams",Z(5,ya,n.yamcs.context)),d(),I(" ",P(4,3,i.name)," ")}}function Bc(e,t){if(e&1){let i=V();s(0,"mat-icon",34),c(1," description "),l(),s(2,"a",35),k("click",function(a){return A(i),M(a.stopPropagation())}),c(3),T(4,"filename"),l()}if(e&2){let i=h().$implicit,n=h(2);d(2),y("routerLink","/telemetry/displays/files/"+i.nameWithoutInstance)("queryParams",Z(5,ya,n.yamcs.context)),d(),I(" ",P(4,3,i.name)," ")}}function Uc(e,t){if(e&1&&(s(0,"td",33),v(1,Hc,5,7)(2,Bc,5,7),l()),e&2){let i=t.$implicit;d(),b(i.folder?1:2)}}function Gc(e,t){e&1&&(s(0,"th",32),c(1,"Type"),l())}function Wc(e,t){e&1&&c(0," Folder ")}function zc(e,t){if(e&1&&(c(0),T(1,"displayType")),e&2){let i=h().$implicit;I(" ",P(1,1,i.name)||"-"," ")}}function qc(e,t){if(e&1&&(s(0,"td",33),v(1,Wc,1,0)(2,zc,2,3),l()),e&2){let i=t.$implicit;d(),b(i.folder?1:2)}}function Yc(e,t){e&1&&(s(0,"th",32),c(1,"Visibility"),l())}function jc(e,t){e&1&&(s(0,"td",33),c(1,"Private"),l())}function Xc(e,t){e&1&&(s(0,"th",32),c(1,"Date modified"),l())}function Zc(e,t){if(e&1&&(s(0,"td",33),c(1),T(2,"datetime"),l()),e&2){let i=t.$implicit;d(),I(" ",P(2,1,i.modified)||"-"," ")}}function Qc(e,t){e&1&&w(0,"th",36)}function Kc(e,t){if(e&1){let i=V();s(0,"ya-more")(1,"button",37),k("click",function(){A(i);let a=h(2).$implicit,o=h(2);return M(o.renameFile(a))}),c(2,"Rename"),l(),s(3,"a",38),c(4,"Download"),l(),w(5,"mat-divider"),s(6,"button",37),k("click",function(){A(i);let a=h(2).$implicit,o=h(2);return M(o.deleteFile(a))}),c(7,"Delete"),l()()}if(e&2){let i=h(2).$implicit;d(3),y("href",i.objectUrl,$n)}}function Jc(e,t){if(e&1&&v(0,Kc,8,1,"ya-more"),e&2){let i=h(3);b(i.mayManageDisplays()?0:-1)}}function ep(e,t){if(e&1&&(s(0,"td",33),v(1,Jc,1,1),l()),e&2){let i=t.$implicit;d(),b(i.folder?-1:1)}}function tp(e,t){e&1&&w(0,"tr",39)}function ip(e,t){if(e&1){let i=V();s(0,"tr",40),k("click",function(){let a=A(i).$implicit,o=h(2);return M(o.toggleOne(a))}),l()}if(e&2){let i=t.$implicit,n=h(2);de("selected",n.selection.isSelected(i))}}function np(e,t){if(e&1&&(s(0,"table",7),G(1,13),v(2,Fc,2,1,"th",14)(3,Nc,2,1,"td",15),W(),G(4,16),v(5,$c,2,0,"th",17)(6,Uc,3,1,"td",18),W(),G(7,19),v(8,Gc,2,0,"th",17)(9,qc,3,1,"td",18),W(),G(10,20),v(11,Yc,2,0,"th",17)(12,jc,2,0,"td",18),W(),G(13,21),v(14,Xc,2,0,"th",17)(15,Zc,3,3,"td",18),W(),G(16,22),v(17,Qc,1,0,"th",23)(18,ep,2,1,"td",24),W(),v(19,tp,1,0,"tr",25)(20,ip,1,2,"tr",26),l()),e&2){let i=h();y("dataSource",i.dataSource),d(19),y("cdkHeaderRowDef",i.displayedColumns),d(),y("cdkRowDefColumns",i.displayedColumns)}}function ap(e,t){e&1&&(s(0,"ya-empty-message"),c(1,"Empty directory."),l())}var Gr=(()=>{let t=class t{constructor(n,a,o,r,p,m,u,f){this.dialog=n,this.yamcs=a,this.router=r,this.route=p,this.authService=m,this.messageService=u,this.breadcrumb$=new B([]),this.dragActive$=new B(!1),this.displayedColumns=["select","name","type","modified","actions"],this.dataSource=new It([]),this.selection=new Oi(!0,[]),o.setTitle("Displays"),this.storageClient=a.createStorageClient();let _=f.getConfig();this.bucket=f.getDisplayBucket(),this.folderPerInstance=_.displayFolderPerInstance,this.loadCurrentFolder(),this.routerSubscription=r.events.pipe(Rn(x=>x instanceof Un)).subscribe(()=>{this.loadCurrentFolder()})}loadCurrentFolder(){let n={delimiter:"/"},a="";this.folderPerInstance&&(a=this.yamcs.instance+"/");let o=this.route.snapshot.url;o.length?n.prefix=a+o.map(r=>r.path).join("/")+"/":a&&(n.prefix=a),this.storageClient.listObjects(this.bucket,n).then(r=>{this.updateBrowsePath(),this.changedir(r)})}getNameWithoutInstance(n){if(this.folderPerInstance){let a=this.yamcs.instance;return n.substr(a.length)}else return n}changedir(n){this.selection.clear();let a=[];for(let o of n.prefixes||[])a.push({folder:!0,name:o,nameWithoutInstance:this.getNameWithoutInstance(o)});for(let o of n.objects||[])o.name.endsWith("/")||a.push({folder:!1,name:o.name,nameWithoutInstance:this.getNameWithoutInstance(o.name),modified:o.created,objectUrl:this.storageClient.getObjectURL(this.bucket,o.name)});this.dataSource.data=a}isAllSelected(){let n=this.selection.selected.length,a=this.dataSource.filteredData.length;return n===a&&a>0}masterToggle(){this.isAllSelected()?this.selection.clear():this.dataSource.filteredData.forEach(n=>this.selection.select(n))}toggleOne(n){(!this.selection.isSelected(n)||this.selection.selected.length>1)&&this.selection.clear(),this.selection.toggle(n)}createDisplay(){this.dialog.open($r,{width:"400px",data:{path:this.getCurrentPath(),prefix:this.folderPerInstance?this.yamcs.instance+"/":""}}).afterClosed().subscribe(a=>{a&&this.router.navigateByUrl(`/telemetry/displays/files/${a}?c=${this.yamcs.context}`)})}createFolder(){this.dialog.open(Hr,{width:"400px",data:{bucket:this.bucket,path:this.getCurrentPath()}}).afterClosed().subscribe({next:()=>this.loadCurrentFolder()})}uploadFiles(){let n=this.getCurrentPath();n.startsWith("/")&&(n=n.substring(1));let a=this.uploaderEl.nativeElement.files,o=[];for(let r in a)if(!isNaN(parseInt(r,10))){let p=a[r],m=n?n+"/"+p.name:p.name,f=(this.folderPerInstance?this.yamcs.instance+"/":"")+m,_=this.storageClient.uploadObject(this.bucket,f,p);o.push(_)}Promise.all(o).then(()=>this.loadCurrentFolder()).catch(r=>this.messageService.showError(r))}getCurrentPath(){let n="";for(let a of this.route.snapshot.url)n+="/"+a.path;return n||"/"}deleteSelectedDisplays(){let n=[],a=[];for(let o of this.selection.selected)o.folder?a.push(this.storageClient.listObjects(this.bucket,{prefix:o.name}).then(r=>{let p=r.objects||[];n.push(...p.map(m=>m.name))})):n.push(o.name);Promise.all(a).then(()=>{if(confirm(`You are about to delete ${n.length} files. Are you sure you want to continue?`)){let o=[];for(let r of n)o.push(this.storageClient.deleteObject(this.bucket,r));Promise.all(o).then(()=>{this.loadCurrentFolder()})}})}renameFile(n){this.dialog.open(Br,{data:{name:n.name},width:"400px"}).afterClosed().subscribe(o=>{o&&this.loadCurrentFolder()})}deleteFile(n){confirm(`Are you sure you want to delete ${n.nameWithoutInstance}?`)&&this.storageClient.deleteObject(this.bucket,n.name).then(()=>{this.loadCurrentFolder()})}dragEnter(n){return this.dragActive$.next(!0),n.preventDefault(),n.stopPropagation(),!1}dragOver(n){return n.preventDefault(),n.stopPropagation(),!1}dragLeave(n){return this.dragActive$.next(!1),n.preventDefault(),n.stopPropagation(),!1}drop(n){let a=n.dataTransfer||{};if(a){let o=this.getCurrentPath().substring(1);o!==""&&(o+="/"),_r(a).then(r=>{let p=[];for(let m of r){let u=o+m._fullPath;this.folderPerInstance&&(u=this.yamcs.instance+"/"+u);let f=this.storageClient.uploadObject(this.bucket,u,m);p.push(f)}Promise.all(p).finally(()=>{this.loadCurrentFolder()})})}return this.dragActive$.next(!1),n.preventDefault(),n.stopPropagation(),!1}mayManageDisplays(){let n=this.authService.getUser();return n.hasObjectPrivilege("ManageBucket",this.bucket)||n.hasSystemPrivilege("ManageAnyBucket")}updateBrowsePath(){let n=[],a="";for(let o of this.route.snapshot.url)a+="/"+o.path,n.push({name:o.path,route:"/telemetry/displays/browse"+a});return this.breadcrumb$.next(n),a||"/"}ngOnDestroy(){this.routerSubscription?.unsubscribe()}};t.\u0275fac=function(a){return new(a||t)(D(Ve),D(X),D(nt),D(Me),D(we),D(yt),D(Qe),D(Pe))},t.\u0275cmp=F({type:t,selectors:[["ng-component"]],viewQuery:function(a,o){if(a&1&&(ue(Dc,7),ue(Pc,5)),a&2){let r;ce(r=pe())&&(o.dropArea=r.first),ce(r=pe())&&(o.uploaderEl=r.first)}},standalone:!0,features:[N],decls:17,vars:16,consts:[["droparea",""],["uploader",""],["mat-button","","color","primary"],["mat-button","","color","primary",3,"disabled"],[1,"droparea",3,"dragenter"],[1,"droparea-overlay",3,"dragover","dragleave","drop"],[1,"panel-content"],["mat-table","",1,"ya-data-table","expand",3,"dataSource"],["mat-button","","color","primary",3,"click"],["type","file","hidden","","multiple","",3,"change"],["mat-button","","color","primary",3,"click","disabled"],["link","/telemetry/displays/browse","icon","account_tree",3,"queryParams"],[3,"link","queryParams","label"],["cdkColumnDef","select"],["mat-header-cell","","class","checkbox",4,"cdkHeaderCellDef"],["mat-cell","","class","checkbox",4,"cdkCellDef"],["cdkColumnDef","name"],["mat-header-cell","",4,"cdkHeaderCellDef"],["mat-cell","",4,"cdkCellDef"],["cdkColumnDef","type"],["cdkColumnDef","visibility"],["cdkColumnDef","modified"],["matColumnDef","actions"],["mat-header-cell","","class","expand",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["mat-header-row","",4,"cdkHeaderRowDef"],["mat-row","",3,"selected","click",4,"cdkRowDef","cdkRowDefColumns"],["mat-header-cell","",1,"checkbox"],["type","checkbox",3,"checked"],["type","checkbox",3,"change","checked"],["mat-cell","",1,"checkbox"],["type","checkbox",3,"click","change","checked"],["mat-header-cell",""],["mat-cell",""],[1,"icon12",2,"vertical-align","middle","margin-right","7px"],[3,"click","routerLink","queryParams"],["mat-header-cell","",1,"expand"],["mat-menu-item","",3,"click"],["mat-menu-item","","download","",3,"href"],["mat-header-row",""],["mat-row","",3,"click"]],template:function(a,o){if(a&1){let r=V();s(0,"app-instance-page")(1,"app-instance-toolbar"),c(2," Displays \xA0\xA0\xA0 "),v(3,Ec,4,0,"button",2)(4,kc,6,0,"button",2)(5,Ac,4,0,"button",2)(6,Mc,4,1,"button",3),l(),s(7,"div",4,0),T(9,"async"),k("dragenter",function(m){return A(r),M(o.dragEnter(m))}),s(10,"div",5),T(11,"async"),k("dragover",function(m){return A(r),M(o.dragOver(m))})("dragleave",function(m){return A(r),M(o.dragLeave(m))})("drop",function(m){return A(r),M(o.drop(m))}),l(),s(12,"div",6),v(13,Ic,1,1),T(14,"async"),v(15,np,21,3,"table",7)(16,ap,2,0,"ya-empty-message"),l()()()}if(a&2){let r;d(3),b(o.mayManageDisplays()?3:-1),d(),b(o.mayManageDisplays()?4:-1),d(),b(o.mayManageDisplays()?5:-1),d(),b(o.mayManageDisplays()?6:-1),d(),de("active",P(9,10,o.dragActive$)),d(3),de("hide",!P(11,12,o.dragActive$)),d(3),b((r=P(14,14,o.breadcrumb$))?13:-1,r),d(2),b(o.dataSource&&o.dataSource.data.length?15:16)}},dependencies:[Ur,Je,Ke,U,ee,Re,si,Lt,ri,li,zi,dt,fe,qt,mt,Be,ft,ot,ht,Ue,Ge,We,ze,ta,ea,Xt,Ot,Le,aa],styles:[".droparea[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;overflow:auto}.droparea-overlay[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;box-sizing:border-box;background:#1b61b91a;border:1px solid rgba(27,97,185,1);z-index:10}"],changeDetection:0});let e=t;return e})();var Wr=(()=>{let t=class t{};t.\u0275fac=function(a){return new(a||t)},t.\u0275cmp=F({type:t,selectors:[["app-display-page"]],standalone:!0,features:[N],decls:1,vars:0,template:function(a,o){a&1&&w(0,"router-outlet")},dependencies:[ai],encapsulation:2,changeDetection:0});let e=t;return e})();var zr=(()=>{let t=class t{};t.\u0275fac=function(a){return new(a||t)},t.\u0275cmp=F({type:t,selectors:[["app-displays-page"]],standalone:!0,features:[N],decls:1,vars:0,template:function(a,o){a&1&&w(0,"router-outlet")},dependencies:[ai],encapsulation:2,changeDetection:0});let e=t;return e})();var qr=(()=>{let t=class t{constructor(n){this.yamcs=n}transform(n){if(!n)return null;let a=this.yamcs.instance;return this.yamcs.yamcsClient.getPacketDownloadURL(a,n.id.name,n.generationTime,n.sequenceNumber)}};t.\u0275fac=function(a){return new(a||t)(D(X,16))},t.\u0275pipe=Vn({name:"packetDownloadLink",type:t,pure:!0,standalone:!0});let e=t;return e})();var Ca=class{constructor(){this.dirty=!1,this.archivePackets=[]}addArchiveData(t){this.archivePackets=this.archivePackets.concat(t),this.dirty=!0}reset(){this.archivePackets=[],this.dirty=!0}snapshot(){return this.archivePackets}};var xa=class extends Gt{constructor(t,i){super(),this.yamcs=t,this.pageSize=100,this.blockHasMore=!1,this.packets$=new B([]),this.loading$=new B(!1),this.syncSubscription=i.sync(()=>{this.buffer.dirty&&!this.loading$.getValue()&&(this.emitPackets(),this.buffer.dirty=!1)}),this.buffer=new Ca}connect(){return this.packets$}emitPackets(){this.packets$.next(this.buffer.snapshot())}loadEntries(t,i){return this.loading$.next(!0),this.loadPage(bt(et({},i),{limit:this.pageSize})).then(n=>{this.loading$.next(!1),this.buffer.reset(),this.blockHasMore=!1,this.buffer.addArchiveData(n),this.emitPackets()})}hasMore(){return!!this.continuationToken&&!this.blockHasMore}loadPage(t){return this.yamcs.yamcsClient.getPackets(this.yamcs.instance,bt(et({},t),{fields:["id","generationTime","earthReceptionTime","receptionTime","sequenceNumber","link","size"]})).then(i=>(this.continuationToken=i.continuationToken,i.packet||[]))}loadMoreData(t){this.continuationToken&&this.loadPage(bt(et({},t),{next:this.continuationToken,limit:this.pageSize})).then(i=>{this.buffer.addArchiveData(i),this.emitPackets()})}disconnect(){this.syncSubscription?.unsubscribe(),this.packets$.complete(),this.loading$.complete()}isEmpty(){return!this.packets$.getValue().length}};var op=["intervalSelect"];function rp(e,t){if(e&1&&(c(0),T(1,"deltaWith")),e&2){let i=h();I(" (",tt(1,1,i.earthReceptionTime,i.generationTime),") ")}}function lp(e,t){if(e&1){let i=V();s(0,"ya-detail-toolbar"),c(1," Packet Detail "),l(),s(2,"div",33)(3,"div",34),c(4,"Packet name"),l(),s(5,"div",35),c(6),l(),s(7,"div",34),c(8,"Generation time"),l(),s(9,"div",35),c(10),T(11,"datetime"),l(),s(12,"div",34),c(13,"Earth reception time"),l(),s(14,"div",35),c(15),T(16,"datetime"),v(17,rp,2,4),l(),s(18,"div",34),c(19,"Reception time"),l(),s(20,"div",35),c(21),T(22,"datetime"),T(23,"deltaWith"),l(),s(24,"div",34),c(25,"Link"),l(),s(26,"div",35),c(27),l(),s(28,"div",34),c(29,"Size"),l(),s(30,"div",35),c(31),T(32,"formatBytes"),l(),s(33,"div",34),c(34," Data "),s(35,"ya-more",36)(36,"button",37),k("click",function(){let a=A(i),o=h();return M(o.copyHex(a))}),c(37,"Copy Hex"),l(),s(38,"button",37),k("click",function(){let a=A(i),o=h();return M(o.copyBinary(a))}),c(39,"Copy Binary"),l(),w(40,"mat-divider"),s(41,"ya-download-menu-item",5),T(42,"packetDownloadLink"),c(43," Download "),l()()(),s(44,"div",38),w(45,"app-hex",39,3),l()()}if(e&2){let i=t;d(6),I(" ",i.id.name," "),d(4),I(" ",P(11,10,i.generationTime)," "),d(5),I(" ",P(16,12,i.earthReceptionTime)||"-"," "),d(2),b(i.earthReceptionTime?17:-1),d(4),Ht(" ",P(22,14,i.receptionTime)," (",tt(23,16,i.receptionTime,i.generationTime),") "),d(6),I(" ",i.link||"-"," "),d(4),I(" ",P(32,19,i.size)," "),d(10),y("link",P(42,21,i)),d(4),y("base64String",i.packet)}}function sp(e,t){e&1&&(s(0,"ya-detail-toolbar"),c(1," Select a packet "),l())}function cp(e,t){if(e&1){let i=V();w(0,"ya-date-time-input",40)(1,"ya-date-time-input",41),s(2,"button",32),k("click",function(){A(i);let a=h();return M(a.applyCustomDates())}),c(3," Apply "),l()}if(e&2){let i=h();d(2),y("disabled",i.filterForm.invalid)}}function pp(e,t){if(e&1){let i=V();s(0,"button",42),k("click",function(){A(i);let a=h();return M(a.jumpToNow())}),c(1,"Jump to now"),l()}}function mp(e,t){e&1&&w(0,"ya-dots")}function dp(e,t){e&1&&(s(0,"th",43),c(1,"Packet name"),l())}function up(e,t){if(e&1&&(s(0,"td",44),c(1),l()),e&2){let i=t.$implicit;d(),I(" ",i.id.name," ")}}function hp(e,t){e&1&&(s(0,"th",43),c(1,"Generation time"),l())}function fp(e,t){if(e&1&&(s(0,"td",44),c(1),T(2,"datetime"),l()),e&2){let i=t.$implicit;d(),I(" ",P(2,1,i.generationTime)," ")}}function _p(e,t){e&1&&(s(0,"th",43),c(1,"Seq"),l())}function gp(e,t){if(e&1&&(s(0,"td",44),c(1),l()),e&2){let i,n=t.$implicit;d(),I(" ",(i=n.sequenceNumber)!==null&&i!==void 0?i:"-"," ")}}function vp(e,t){e&1&&(s(0,"th",43),c(1,"Earth reception time"),l())}function yp(e,t){if(e&1&&(s(0,"td",44),c(1),T(2,"datetime"),l()),e&2){let i=t.$implicit;d(),I(" ",P(2,1,i.earthReceptionTime)||"-"," ")}}function Cp(e,t){e&1&&(s(0,"th",43),c(1,"Reception time"),l())}function xp(e,t){if(e&1&&(s(0,"td",44),c(1),T(2,"datetime"),l()),e&2){let i=t.$implicit;d(),I(" ",P(2,1,i.receptionTime)," ")}}function bp(e,t){e&1&&(s(0,"th",43),c(1,"Link"),l())}function Sp(e,t){if(e&1&&(s(0,"td",44),c(1),l()),e&2){let i=t.$implicit;d(),I(" ",i.link||"-"," ")}}function wp(e,t){e&1&&(s(0,"th",43),c(1,"Size"),l())}function Tp(e,t){if(e&1&&(s(0,"td",44),c(1),T(2,"formatBytes"),l()),e&2){let i=t.$implicit;d(),I(" ",P(2,1,i.size)," ")}}function Dp(e,t){e&1&&w(0,"th",45)}function Pp(e,t){if(e&1){let i=V();s(0,"td",44)(1,"ya-text-action",46),k("click",function(){let a=A(i).$implicit,o=h();return M(o.extractPacket(a))}),c(2," Extract "),l(),s(3,"ya-more")(4,"button",37),k("click",function(){let a=A(i).$implicit,o=h();return M(o.copyHex(a))}),c(5,"Copy Hex"),l(),s(6,"button",37),k("click",function(){let a=A(i).$implicit,o=h();return M(o.copyBinary(a))}),c(7,"Copy Binary"),l(),w(8,"mat-divider"),s(9,"ya-download-menu-item",5),T(10,"packetDownloadLink"),c(11," Download "),l()()()}if(e&2){let i=t.$implicit;d(9),y("link",P(10,1,i))}}function Ep(e,t){e&1&&w(0,"tr",47)}function kp(e,t){if(e&1){let i=V();s(0,"tr",48),k("click",function(){let a=A(i).$implicit,o=h();return M(o.selectPacket(a))}),l()}if(e&2){let i=t.$implicit,n=h();de("selected",n.isSelected(i))}}var gn="PT1H",Xr=(()=>{let t=class t{constructor(n,a,o,r,p,m,u){this.yamcs=n,this.router=a,this.route=o,this.clipboard=m,this.messageService=u,this.columns=[{id:"packetName",label:"Packet name",alwaysVisible:!0},{id:"generationTime",label:"Generation time",alwaysVisible:!0},{id:"earthReceptionTime",label:"Earth reception time",visible:!1},{id:"receptionTime",label:"Reception time",visible:!0},{id:"sequenceNumber",label:"Sequence number",visible:!1},{id:"link",label:"Link",visible:!0},{id:"size",label:"Size",visible:!0},{id:"actions",label:"",alwaysVisible:!0}],this.filterForm=new at({name:new te("ANY"),link:new te("ANY"),interval:new te(gn),customStart:new te(null),customStop:new te(null)}),this.detailPacket$=new B(null),this.nameOptions$=new B([{id:"ANY",label:"Any name"}]),this.linkOptions$=new B([{id:"ANY",label:"Any link"}]),this.intervalOptions=[{id:"PT1H",label:"Last hour"},{id:"PT6H",label:"Last 6 hours"},{id:"P1D",label:"Last 24 hours"},{id:"NO_LIMIT",label:"No limit"},{id:"CUSTOM",label:"Custom",group:!0}],this.downloadURL$=new B(null),r.setTitle("Packets"),this.dataSource=new xa(this.yamcs,p),n.yamcsClient.getPacketNames(n.instance).then(f=>{for(let _ of f.packets||[])this.nameOptions$.next([...this.nameOptions$.value,{id:_,label:_}]);for(let _ of f.links||[])this.linkOptions$.next([...this.linkOptions$.value,{id:_,label:_}])}),this.initializeOptions(),this.loadData(),this.filterForm.get("name").valueChanges.forEach(f=>{this.name=f!=="ANY"?f:null,this.loadData()}),this.filterForm.get("link").valueChanges.forEach(f=>{this.link=f!=="ANY"?f:null,this.loadData()}),this.filterForm.get("interval").valueChanges.forEach(f=>{if(f==="CUSTOM"){let _=this.validStart||this.yamcs.getMissionTime(),x=this.validStop||this.yamcs.getMissionTime();this.filterForm.get("customStart").setValue($.toISOString(_)),this.filterForm.get("customStop").setValue($.toISOString(x))}else f==="NO_LIMIT"?(this.validStart=null,this.validStop=null,this.appliedInterval=f,this.loadData()):(this.validStop=n.getMissionTime(),this.validStart=$.subtractDuration(this.validStop,f),this.appliedInterval=f,this.loadData())})}initializeOptions(){let n=this.route.snapshot.queryParamMap;if(n.has("name")&&(this.name=n.get("name")||"",this.filterForm.get("name").setValue(this.name)),n.has("link")&&(this.link=n.get("link")||"",this.filterForm.get("link").setValue(this.link)),n.has("interval"))if(this.appliedInterval=n.get("interval"),this.filterForm.get("interval").setValue(this.appliedInterval),this.appliedInterval==="CUSTOM"){let a=n.get("customStart");this.filterForm.get("customStart").setValue(a),this.validStart=new Date(a);let o=n.get("customStop");this.filterForm.get("customStop").setValue(o),this.validStop=new Date(o)}else this.appliedInterval==="NO_LIMIT"?(this.validStart=null,this.validStop=null):(this.validStop=this.yamcs.getMissionTime(),this.validStart=$.subtractDuration(this.validStop,this.appliedInterval));else this.appliedInterval=gn,this.validStop=this.yamcs.getMissionTime(),this.validStart=$.subtractDuration(this.validStop,gn)}jumpToNow(){let n=this.filterForm.value.interval;n==="NO_LIMIT"?this.filterForm.get("interval").setValue(gn):n==="CUSTOM"?this.filterForm.get("interval").setValue(gn):(this.validStop=this.yamcs.getMissionTime(),this.validStart=$.subtractDuration(this.validStop,n),this.loadData())}applyCustomDates(){this.validStart=$.toDate(this.filterForm.value.customStart),this.validStop=$.toDate(this.filterForm.value.customStop),this.appliedInterval="CUSTOM",this.loadData()}loadData(){this.updateURL();let n={};this.validStart&&(n.start=this.validStart.toISOString()),this.validStop&&(n.stop=this.validStop.toISOString()),this.name&&(n.name=this.name),this.link&&(n.link=this.link);let a={};this.validStart&&(a.start=this.validStart.toISOString()),this.validStop&&(a.stop=this.validStop.toISOString()),this.name&&(a.name=this.name),this.link&&(a.link=this.link),this.dataSource.loadEntries("realtime",n).then(o=>{let r=this.yamcs.yamcsClient.getPacketsDownloadURL(this.yamcs.instance,a);this.downloadURL$.next(r)})}loadMoreData(){let n={};this.validStart&&(n.start=this.validStart.toISOString()),this.name&&(n.name=this.name),this.link&&(n.link=this.link),this.dataSource.loadMoreData(n)}copyHex(n){this.fetchPacket(n).then(a=>{let o=$.convertBase64ToHex(a.packet??"");this.clipboard.copy(o)?this.messageService.showInfo("Hex copied"):this.messageService.showInfo("Hex copy failed")}).catch(a=>this.messageService.showError(a))}copyBinary(n){this.fetchPacket(n).then(a=>{let o=window.atob(a.packet??"");this.clipboard.copy(o)?this.messageService.showInfo("Binary copied"):this.messageService.showInfo("Binary copy failed")}).catch(a=>this.messageService.showError(a))}updateURL(){this.router.navigate([],{replaceUrl:!0,relativeTo:this.route,queryParams:{name:this.name||null,link:this.link||null,interval:this.appliedInterval,customStart:this.appliedInterval==="CUSTOM"?this.filterForm.value.customStart:null,customStop:this.appliedInterval==="CUSTOM"?this.filterForm.value.customStop:null},queryParamsHandling:"merge"})}selectPacket(n){this.fetchPacket(n).then(a=>{this.detailPacket$.next(a)}).catch(a=>this.messageService.showError(a))}fetchPacket(n){return this.yamcs.yamcsClient.getPacket(this.yamcs.instance,n.id.name,n.generationTime,n.sequenceNumber)}extractPacket(n){this.router.navigate(["/telemetry/packets"+n.id.name,"-","log",n.generationTime,n.sequenceNumber],{queryParams:{c:this.yamcs.context}})}isSelected(n){let a=this.detailPacket$.value;return a?n.id.name===a.id.name&&n.generationTime===a.generationTime&&n.sequenceNumber===a.sequenceNumber:!1}};t.\u0275fac=function(a){return new(a||t)(D(X),D(Me),D(we),D(nt),D(vt),D(Wi),D(Qe))},t.\u0275cmp=F({type:t,selectors:[["ng-component"]],viewQuery:function(a,o){if(a&1&&ue(op,5),a&2){let r;ce(r=pe())&&(o.intervalSelect=r.first)}},standalone:!0,features:[N],decls:70,vars:32,consts:[["exportMenu","matMenu"],["intervalSelect",""],["columnChooser",""],["hexdump",""],[1,"ya-menu"],[3,"link"],["mat-button","","color","primary",3,"matMenuTriggerFor","disabled"],["mat-icon-button","","matTooltip","Jump to now","color","primary",3,"click"],[1,"table-wrapper"],[1,"panel-content"],[3,"formGroup"],[1,"filter-bar"],["formControlName","name",3,"options"],["formControlName","link",3,"options"],["icon","access_time","formControlName","interval",3,"options"],[1,"ya-button"],["preferenceKey","tmPackets",3,"columns"],["mat-table","",1,"ya-data-table","expand",3,"dataSource"],["matColumnDef","packetName"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","generationTime"],["matColumnDef","sequenceNumber"],["matColumnDef","earthReceptionTime"],["matColumnDef","receptionTime"],["matColumnDef","link"],["matColumnDef","size"],["matColumnDef","actions"],["mat-header-cell","","class","expand",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",3,"selected","click",4,"matRowDef","matRowDefColumns"],[2,"flex","1 1 auto"],[1,"ya-button",3,"click","disabled"],[2,"padding","0 16px"],[1,"block-title"],[1,"block"],["icon","more_horiz"],["mat-menu-item","",3,"click"],[1,"block",2,"margin-top","4px"],[3,"base64String"],["formControlName","customStart"],["formControlName","customStop"],[1,"ya-button",3,"click"],["mat-header-cell",""],["mat-cell",""],["mat-header-cell","",1,"expand"],["icon","output",3,"click"],["mat-header-row",""],["mat-row","",3,"click"]],template:function(a,o){if(a&1){let r=V();s(0,"app-instance-page")(1,"app-instance-toolbar"),c(2," Packets \xA0\xA0\xA0 "),s(3,"mat-menu",4,0)(5,"ya-download-menu-item",5),T(6,"async"),c(7," Raw dump "),l()(),s(8,"button",6),T(9,"async"),s(10,"mat-icon"),c(11,"save_alt"),l(),c(12," Export "),l(),s(13,"button",7),k("click",function(){return A(r),M(o.jumpToNow())}),s(14,"mat-icon"),c(15,"refresh"),l()()(),s(16,"ya-detail-pane"),v(17,lp,47,23),T(18,"async"),v(19,sp,2,0,"ya-detail-toolbar"),l(),s(20,"div",8)(21,"div",9)(22,"form",10)(23,"div",11),w(24,"ya-select",12),T(25,"async"),w(26,"ya-select",13),T(27,"async"),w(28,"ya-select",14,1),v(30,cp,4,1)(31,pp,2,0,"button",15),w(32,"ya-column-chooser",16,2),v(34,mp,1,0,"ya-dots"),T(35,"async"),l()(),s(36,"table",17),G(37,18),v(38,dp,2,0,"th",19)(39,up,2,1,"td",20),W(),G(40,21),v(41,hp,2,0,"th",19)(42,fp,3,3,"td",20),W(),G(43,22),v(44,_p,2,0,"th",19)(45,gp,2,1,"td",20),W(),G(46,23),v(47,vp,2,0,"th",19)(48,yp,3,3,"td",20),W(),G(49,24),v(50,Cp,2,0,"th",19)(51,xp,3,3,"td",20),W(),G(52,25),v(53,bp,2,0,"th",19)(54,Sp,2,1,"td",20),W(),G(55,26),v(56,wp,2,0,"th",19)(57,Tp,3,3,"td",20),W(),G(58,27),v(59,Dp,1,0,"th",28)(60,Pp,12,3,"td",20),W(),v(61,Ep,1,0,"tr",29),T(62,"async"),v(63,kp,1,2,"tr",30),T(64,"async"),l(),s(65,"mat-toolbar"),w(66,"span",31),s(67,"button",32),k("click",function(){return A(r),M(o.loadMoreData())}),c(68," Load More "),l(),w(69,"span",31),l()()()()}if(a&2){let r,p,m=oe(4),u=oe(33);d(5),y("link",P(6,16,o.downloadURL$)),d(3),y("matMenuTriggerFor",m)("disabled",!((r=P(9,18,o.dataSource.packets$))!=null&&r.length)),d(9),b((p=P(18,20,o.detailPacket$))?17:19,p),d(5),y("formGroup",o.filterForm),d(2),y("options",P(25,22,o.nameOptions$)),d(2),y("options",P(27,24,o.linkOptions$)),d(2),y("options",o.intervalOptions),d(2),b(o.filterForm.value.interval==="CUSTOM"?30:-1),d(),b(o.filterForm.value.interval!=="CUSTOM"?31:-1),d(),y("columns",o.columns),d(2),b(P(35,26,o.dataSource.loading$)?34:-1),d(2),y("dataSource",o.dataSource),d(25),y("matHeaderRowDef",P(62,28,u.displayedColumns$)),d(2),y("matRowDefColumns",P(64,30,u.displayedColumns$)),d(4),y("disabled",!o.dataSource.hasMore())}},dependencies:[Qi,Je,Ke,qr,U,ee,Te,he,Ce,xe,De,dt,Qo,fe,qt,$i,mt,Hi,Be,ft,_t,ot,ht,wt,Ue,Ge,We,ze,Gi,Ui,Yt,gt,Yi,ji,jt,tr,Ot,Tt,Qt,Le,rr,cr],styles:[".detail[_ngcontent-%COMP%]{background-color:#fcfcfc;float:right;height:100%;width:450px;overflow:auto;border-left:1px solid #d3d3d3;box-sizing:border-box}.table-wrapper[_ngcontent-%COMP%]{position:relative;overflow:auto;height:100%}"],changeDetection:0});let e=t;return e})();var Ap=["hex"],vn=e=>({c:e}),oo=()=>[];function Mp(e,t){if(e&1&&(s(0,"tr")(1,"td",41)(2,"mat-icon",42),c(3,"warning"),l()(),s(4,"td",43),c(5),l()()),e&2){let i=t.$implicit;d(5),Y(i)}}function Rp(e,t){if(e&1&&(s(0,"h4"),c(1,"Warnings"),l(),s(2,"table",39),ne(3,Mp,6,1,"tr",null,ie),T(5,"async"),l(),s(6,"div",40),w(7,"mat-divider"),l()),e&2){let i=h(2);d(3),ae(P(5,0,i.messages$))}}function Lp(e,t){e&1&&w(0,"th",44)}function Ip(e,t){if(e&1&&w(0,"ya-icon-action",46),e&2){let i=h().$implicit;y("icon",i.expanded?"expand_more":"chevron_right")("padding",!1)}}function Op(e,t){if(e&1&&(s(0,"td",45),v(1,Ip,1,2,"ya-icon-action",46),l()),e&2){let i=t.$implicit;d(),b(i.type==="CONTAINER"?1:-1)}}function Fp(e,t){e&1&&(s(0,"th",47),c(1,"Loc"),l())}function Vp(e,t){if(e&1&&c(0),e&2){let i=h().$implicit;I(" ",i.location," ")}}function Np(e,t){if(e&1&&(s(0,"td",48),v(1,Vp,1,1),l()),e&2){let i=t.$implicit;d(),b(i.type==="SIMPLE_PARAMETER"||i.type==="AGGREGATE_PARAMETER"||i.type==="ARRAY_PARAMETER"?1:-1)}}function $p(e,t){e&1&&(s(0,"th",44),c(1,"Bits"),l())}function Hp(e,t){if(e&1&&c(0),e&2){let i=h().$implicit;I(" ",i.size," ")}}function Bp(e,t){if(e&1&&(s(0,"td",49),v(1,Hp,1,1),l()),e&2){let i=t.$implicit;d(),b(i.type==="SIMPLE_PARAMETER"||i.type==="AGGREGATE_PARAMETER"||i.type==="ARRAY_PARAMETER"?1:-1)}}function Up(e,t){e&1&&w(0,"th",50)}function Gp(e,t){if(e&1&&w(0,"ya-icon-action",52),e&2){let i=h().$implicit;y("icon",i.expanded?"expand_more":"chevron_right")}}function Wp(e,t){if(e&1&&(s(0,"td",51),v(1,Gp,1,1,"ya-icon-action",52),l()),e&2){let i=t.$implicit;d(),b(i.type==="AGGREGATE_PARAMETER"||i.type==="ARRAY_PARAMETER"?1:-1)}}function zp(e,t){e&1&&(s(0,"th",53),c(1,"Entry"),l())}function qp(e,t){if(e&1&&(s(0,"a",55),c(1),l()),e&2){let i=h().$implicit,n=h(2);y("routerLink","/telemetry/parameters"+i.parameter.qualifiedName)("queryParams",Z(3,vn,n.yamcs.context)),d(),I(" ",i.parameter.qualifiedName," ")}}function Yp(e,t){e&1&&(s(0,"mat-icon",56),c(1,"chevron_right"),l())}function jp(e,t){if(e&1&&(ne(0,Yp,2,0,"mat-icon",56,ie),s(2,"a",55),c(3),l()),e&2){let i=h().$implicit,n=h(2);ae(Li(3,oo).constructor(i.depth)),d(2),y("routerLink","/telemetry/parameters"+i.parameter.qualifiedName+i.offset)("queryParams",Z(4,vn,n.yamcs.context)),d(),Y(i.name)}}function Xp(e,t){if(e&1&&(s(0,"mat-icon",42),c(1),l()),e&2){let i=t.$index,n=t.$count,a=h(2).$implicit;St("visibility",i===n-1?"visible":"hidden"),d(),I(" ",a.expanded?"expand_more":"chevron_right"," ")}}function Zp(e,t){if(e&1&&(ne(0,Xp,2,3,"mat-icon",57,ie),s(2,"a",55),c(3),l()),e&2){let i=h().$implicit,n=h(2);ae(Li(3,oo).constructor(i.depth)),d(2),y("routerLink","/telemetry/parameters"+i.parameter.qualifiedName+i.offset)("queryParams",Z(4,vn,n.yamcs.context)),d(),Y(i.name)}}function Qp(e,t){if(e&1&&(s(0,"mat-icon",42),c(1),l()),e&2){let i=t.$index,n=t.$count,a=h(2).$implicit;St("visibility",i===n-1?"visible":"hidden"),d(),I(" ",a.expanded?"expand_more":"chevron_right"," ")}}function Kp(e,t){if(e&1&&(ne(0,Qp,2,3,"mat-icon",57,ie),s(2,"a",55),c(3),l()),e&2){let i=h().$implicit,n=h(2);ae(Li(3,oo).constructor(i.depth)),d(2),y("routerLink","/telemetry/parameters"+i.parameter.qualifiedName+i.offset)("queryParams",Z(4,vn,n.yamcs.context)),d(),Y(i.name)}}function Jp(e,t){if(e&1&&(s(0,"td",54),v(1,qp,2,5,"a",55)(2,jp,4,6,"a",55)(3,Zp,4,6,"a",55)(4,Kp,4,6,"a",55),l()),e&2){let i=t.$implicit;d(),b(i.type==="SIMPLE_PARAMETER"||i.type==="AGGREGATE_PARAMETER"||i.type==="ARRAY_PARAMETER"?1:-1),d(),b(i.type==="SIMPLE_VALUE"?2:-1),d(),b(i.type==="AGGREGATE_VALUE"?3:-1),d(),b(i.type==="ARRAY_VALUE"?4:-1)}}function em(e,t){e&1&&(s(0,"th",58),c(1,"Type"),l())}function tm(e,t){e&1&&c(0," container ")}function im(e,t){if(e&1&&c(0),e&2){let i=h().$implicit;I(" ",i.parameter.type.engType," ")}}function nm(e,t){if(e&1&&c(0),e&2){let i=h().$implicit;I(" ",i.parameter.type.engType," ")}}function am(e,t){if(e&1&&c(0),e&2){let i=h().$implicit,n=h(2);I(" ",n.fillTypeWithValueDimension(i.parameter.type.engType,i.engValue==null?null:i.engValue.arrayValue)," ")}}function om(e,t){if(e&1&&c(0),e&2){let i=h().$implicit;I(" ",i.parameterType.engType," ")}}function rm(e,t){if(e&1&&c(0),e&2){let i=h().$implicit;I(" ",i.parameterType.engType," ")}}function lm(e,t){if(e&1&&c(0),e&2){let i=h().$implicit,n=h(2);I(" ",n.fillTypeWithValueDimension(i.parameterType.engType,i.engValue==null?null:i.engValue.arrayValue)," ")}}function sm(e,t){if(e&1&&(s(0,"td",59),v(1,tm,1,0)(2,im,1,1)(3,nm,1,1)(4,am,1,1)(5,om,1,1)(6,rm,1,1)(7,lm,1,1),l()),e&2){let i=t.$implicit;d(),b(i.type==="CONTAINER"?1:-1),d(),b(i.type==="SIMPLE_PARAMETER"?2:-1),d(),b(i.type==="AGGREGATE_PARAMETER"?3:-1),d(),b(i.type==="ARRAY_PARAMETER"?4:-1),d(),b(i.type==="SIMPLE_VALUE"?5:-1),d(),b(i.type==="AGGREGATE_VALUE"?6:-1),d(),b(i.type==="ARRAY_VALUE"?7:-1)}}function cm(e,t){e&1&&(s(0,"th",58),c(1,"Raw value"),l())}function pm(e,t){if(e&1&&w(0,"ya-value",61),e&2){let i=h();y("value",i)}}function mm(e,t){if(e&1&&w(0,"ya-value",61),e&2){let i=h();y("value",i)}}function dm(e,t){if(e&1&&v(0,pm,1,1,"ya-value",61)(1,mm,1,1,"ya-value",61),e&2){let i=h().$implicit;b(i.type==="SIMPLE_PARAMETER"?0:-1),d(),b(i.type==="SIMPLE_VALUE"?1:-1)}}function um(e,t){if(e&1&&(s(0,"td",60),v(1,dm,2,2),l()),e&2){let i,n=t.$implicit;d(),b((i=n.rawValue)?1:-1,i)}}function hm(e,t){e&1&&(s(0,"th",58),c(1,"Engineering value"),l())}function fm(e,t){e&1&&(c(0),T(1,"units")),e&2&&I(" ",P(1,1,t)," ")}function _m(e,t){if(e&1&&(w(0,"ya-value",61),v(1,fm,2,3)),e&2){let i,n=h(),a=h().$implicit;y("value",n),d(),b((i=a.parameter.type==null?null:a.parameter.type.unitSet)?1:-1,i)}}function gm(e,t){e&1&&(c(0),T(1,"units")),e&2&&I(" ",P(1,1,t)," ")}function vm(e,t){if(e&1&&(w(0,"ya-value",61),v(1,gm,2,3)),e&2){let i,n=h(),a=h().$implicit;y("value",n),d(),b((i=a.parameterType.unitSet)?1:-1,i)}}function ym(e,t){if(e&1&&v(0,_m,2,2)(1,vm,2,2),e&2){let i=h().$implicit;b(i.type==="SIMPLE_PARAMETER"?0:-1),d(),b(i.type==="SIMPLE_VALUE"?1:-1)}}function Cm(e,t){if(e&1&&(s(0,"td",60),v(1,ym,2,2),l()),e&2){let i,n=t.$implicit;d(),b((i=n.engValue)?1:-1,i)}}function xm(e,t){e&1&&w(0,"th",62)}function bm(e,t){if(e&1&&c(0),e&2){let i=h().$implicit;I(" ",i.container.qualifiedName," ")}}function Sm(e,t){if(e&1&&(s(0,"td",63),v(1,bm,1,1),l()),e&2){let i=t.$implicit;Uo("colspan",4),d(),b(i.type==="CONTAINER"?1:-1)}}function wm(e,t){e&1&&w(0,"th",64)}function Tm(e,t){if(e&1){let i=V();s(0,"ya-more",66)(1,"button",4),k("click",function(){A(i);let a=h().$implicit,o=h(2);return M(o.selectBitRange(a))}),c(2,"Select in hex view"),l()()}e&2&&y("padding",!1)}function Dm(e,t){if(e&1&&(s(0,"td",65),v(1,Tm,3,1,"ya-more",66),l()),e&2){let i=t.$implicit;d(),b(i.type==="SIMPLE_PARAMETER"||i.type==="AGGREGATE_PARAMETER"||i.type==="ARRAY_PARAMETER"?1:-1)}}function Pm(e,t){e&1&&w(0,"tr",67)}function Em(e,t){if(e&1){let i=V();s(0,"tr",68),k("click",function(){let a=A(i).$implicit,o=h(2);return M(o.toggleRow(a))}),l()}}function km(e,t){if(e&1){let i=V();s(0,"tr",69),k("mouseover",function(){let a=A(i).$implicit,o=h(2);return M(o.highlightBitRange(a))})("mouseout",function(){A(i);let a=h(2);return M(a.clearHighlightedBitRange())})("click",function(){let a=A(i).$implicit,o=h(2);return M(o.toggleRow(a))}),l()}if(e&2){let i=t.$implicit,n=h(2);de("expandable",n.isExpandable(i))}}function Am(e,t){if(e&1){let i=V();s(0,"app-instance-page")(1,"app-instance-toolbar")(2,"a",1)(3,"mat-icon"),c(4,"arrow_back"),l()(),c(5),s(6,"button",2),k("click",function(){A(i);let a=h();return M(a.expandAll())}),s(7,"mat-icon"),c(8,"unfold_more"),l(),c(9," Expand all "),l(),s(10,"button",2),k("click",function(){A(i);let a=h();return M(a.collapseAll())}),s(11,"mat-icon"),c(12,"unfold_less"),l(),c(13," Collapse all "),l()(),s(14,"ya-detail-pane")(15,"ya-detail-toolbar"),c(16," Hex view "),w(17,"span",3),s(18,"ya-more")(19,"button",4),k("click",function(){let a=A(i),o=h();return M(o.copyHex(a.packet))}),c(20,"Copy Hex"),l(),s(21,"button",4),k("click",function(){let a=A(i),o=h();return M(o.copyBinary(a.packet))}),c(22,"Copy Binary"),l()()(),s(23,"div",5),w(24,"app-hex",6,0),l()(),s(26,"div",7)(27,"div",8),v(28,Rp,8,2),T(29,"async"),s(30,"table",9),G(31,10),v(32,Lp,1,0,"th",11)(33,Op,2,1,"td",12),W(),G(34,13),v(35,Fp,2,0,"th",14)(36,Np,2,1,"td",15),W(),G(37,16),v(38,$p,2,0,"th",11)(39,Bp,2,1,"td",17),W(),G(40,18),v(41,Up,1,0,"th",19)(42,Wp,2,1,"td",20),W(),G(43,21),v(44,zp,2,0,"th",22)(45,Jp,5,4,"td",23),W(),G(46,24),v(47,em,2,0,"th",25)(48,sm,8,7,"td",26),W(),G(49,27),v(50,cm,2,0,"th",25)(51,um,2,1,"td",28),W(),G(52,29),v(53,hm,2,0,"th",25)(54,Cm,2,1,"td",28),W(),G(55,30),v(56,xm,1,0,"th",31)(57,Sm,2,2,"td",32),W(),G(58,33),v(59,wm,1,0,"th",34)(60,Dm,2,1,"td",35),W(),v(61,Pm,1,0,"tr",36)(62,Em,1,0,"tr",37)(63,km,1,2,"tr",38),l()()()()}if(e&2){let i,n=t,a=h();d(2),y("queryParams",Z(14,vn,a.yamcs.context)),d(3),Wo(" ",n.id.name," / ",n.generationTime," / ",n.sequenceNumber," \xA0\xA0\xA0 "),d(19),y("base64String",n.packet),d(4),b((i=P(29,12,a.messages$))!=null&&i.length?28:-1),d(2),y("dataSource",a.dataSource),d(31),y("matHeaderRowDef",a.displayedColumns),d(),y("matRowDefColumns",a.containerColumns)("matRowDefWhen",a.isContainer),d(),y("matRowDefColumns",a.displayedColumns)("matRowDefWhen",a.isNoContainer)}}var Zr=(()=>{let t=class t{constructor(n,a,o,r,p,m){this.title=n,this.route=a,this.yamcs=o,this.messageService=r,this.clipboard=p,this.changeDetection=m,this.packetName=Mt.required({alias:"packet"}),this.packet$=new B(null),this.messages$=new B([]),this.allNodes=[],this.dataSource=new It,this.displayedColumns=["icon","location","size","expand-aggray","entry","type","rawValue","engValue","actions"],this.containerColumns=["icon","containerName","type","rawValue","engValue","actions"],this.typeOptions=[{id:"ANY",label:"Any type"},{id:"aggregate",label:"aggregate"},{id:"array",label:"array"},{id:"binary",label:"binary"},{id:"boolean",label:"boolean"},{id:"enumeration",label:"enumeration"},{id:"float",label:"float"},{id:"integer",label:"integer"},{id:"string",label:"string"},{id:"time",label:"time"}]}ngOnInit(){let n=this.packetName(),a=this.route.snapshot.paramMap.get("gentime"),o=Number(this.route.snapshot.paramMap.get("seqno"));this.title.setTitle(n),this.yamcs.yamcsClient.getPacket(this.yamcs.instance,n,a,o).then(r=>this.packet$.next(r)).catch(r=>this.messageService.showError(r)),this.yamcs.yamcsClient.extractPacket(this.yamcs.instance,n,a,o).then(r=>this.processResponse(r)).catch(r=>this.messageService.showError(r))}processResponse(n){this.messages$.next(n.messages||[]);let a;for(let o of n.parameterValues||[]){if(o.entryContainer.qualifiedName!==a?.container.qualifiedName){let r={type:"CONTAINER",container:o.entryContainer,expanded:!1};this.allNodes.push(r),a=r}this.addParameterNodes(a,o,this.allNodes)}a&&(a.expanded=!0),this.updateDataSource()}addParameterNodes(n,a,o){let{parameter:r,location:p,rawValue:m,engValue:u,size:f}=a;if(r.type?.engType.endsWith("[]")){let _={type:"ARRAY_PARAMETER",parent:n,expanded:!1,parameter:r,location:p,rawValue:m,engValue:u,size:f};o.push(_);let x=m?.arrayValue||[],g=u?.arrayValue||[],S=r.type.arrayInfo.type;for(let C=0;C<g.length;C++)this.addValueNode(_,r,S,"["+C+"]","["+C+"]",1,x[C],g[C],o)}else if(r.type?.engType==="aggregate"){let _={type:"AGGREGATE_PARAMETER",parent:n,expanded:!1,parameter:r,location:p,rawValue:m,engValue:u,size:f};o.push(_);let x=m.aggregateValue,g=u.aggregateValue;for(let S=0;S<g.name.length;S++){let C=r.type.member[S].type;this.addValueNode(_,r,C,g.name[S],"."+g.name[S],1,x.value[S],g.value[S],o)}}else o.push({type:"SIMPLE_PARAMETER",parent:n,expanded:!1,parameter:r,location:p,rawValue:m,engValue:u,size:f})}addValueNode(n,a,o,r,p,m,u,f,_){if(o.engType.endsWith("[]")){let x={type:"ARRAY_VALUE",parent:n,expanded:!1,parameter:a,parameterType:o,name:r,offset:p,rawValue:u,engValue:f,depth:m};_.push(x);let g=u?.arrayValue||[],S=f?.arrayValue||[];for(let C=0;C<S.length;C++)this.addValueNode(x,a,o.arrayInfo.type,"["+C+"]",p+"["+C+"]",m+1,g[C],S[C],_)}else if(o.engType==="aggregate"){let x={type:"AGGREGATE_VALUE",parent:n,expanded:!1,parameter:a,parameterType:o,name:r,offset:p,rawValue:u,engValue:f,depth:m};_.push(x);let g=u.aggregateValue,S=f.aggregateValue;for(let C=0;C<S.name.length;C++){let E=o.member[C].type;this.addValueNode(x,a,E,S.name[C],p+"."+S.name[C],m+1,g.value[C],S.value[C],_)}}else _.push({type:"SIMPLE_VALUE",parent:n,expanded:!1,parameter:a,parameterType:o,name:r,offset:p,rawValue:u,engValue:f,depth:m})}get hex(){return this._hex}set hex(n){this._hex=n}highlightBitRange(n){(n.type==="SIMPLE_PARAMETER"||n.type==="AGGREGATE_PARAMETER"||n.type==="ARRAY_PARAMETER")&&this.hex?.setHighlight(new Za(n.location,n.size))}clearHighlightedBitRange(){this.hex?.setHighlight(null)}selectBitRange(n){(n.type==="SIMPLE_PARAMETER"||n.type==="AGGREGATE_PARAMETER"||n.type==="ARRAY_PARAMETER")&&this.hex?.setSelection(new Za(n.location,n.size))}toggleRow(n){this.isExpandable(n)&&(n.expanded?this.collapseNode(n):n.expanded=!0),this.updateDataSource()}collapseNode(n){for(let a of this.allNodes)a.parent===n&&this.collapseNode(a);n.expanded=!1,this.updateDataSource()}expandAll(){for(let n of this.allNodes)this.isExpandable(n)&&(n.expanded=!0);this.updateDataSource()}collapseAll(){for(let n of this.allNodes)n.expanded=!1;this.updateDataSource()}isExpandable(n){return n.type==="CONTAINER"||n.type==="AGGREGATE_PARAMETER"||n.type==="ARRAY_PARAMETER"||n.type==="AGGREGATE_VALUE"||n.type==="ARRAY_VALUE"}updateDataSource(){let n=[];for(let a of this.allNodes)(!a.parent||a.parent?.expanded)&&n.push(a);this.dataSource.data=n}isContainer(n,a){return a.type==="CONTAINER"}isNoContainer(n,a){return a.type!=="CONTAINER"}copyHex(n){let a=$.convertBase64ToHex(n);this.clipboard.copy(a)?this.messageService.showInfo("Hex copied"):this.messageService.showInfo("Hex copy failed")}copyBinary(n){let a=window.atob(n);this.clipboard.copy(a)?this.messageService.showInfo("Binary copied"):this.messageService.showInfo("Binary copy failed")}fillTypeWithValueDimension(n,a){if(n.endsWith("[]")){let o=a?.length||0;n=n.substring(0,n.length-2)+"["+o+"]"}return n.replaceAll("[]","[?]")}};t.\u0275fac=function(a){return new(a||t)(D(nt),D(we),D(X),D(Qe),D(Wi),D(Rt))},t.\u0275cmp=F({type:t,selectors:[["ng-component"]],viewQuery:function(a,o){if(a&1&&ue(Ap,5),a&2){let r;ce(r=pe())&&(o.hex=r.first)}},inputs:{packetName:[1,"packet","packetName"]},standalone:!0,features:[N],decls:2,vars:3,consts:[["hex",""],["mat-icon-button","","routerLink","/telemetry/packets","color","primary",3,"queryParams"],["mat-button","","color","primary",3,"click"],[2,"flex","1 1 auto"],["mat-menu-item","",3,"click"],[2,"padding","0 16px"],[3,"base64String"],[1,"table-wrapper"],[1,"panel-content"],["mat-table","","multiTemplateDataRows","",1,"ya-data-table","expand",3,"dataSource"],["matColumnDef","icon"],["mat-header-cell","","width","1",4,"matHeaderCellDef"],["mat-cell","","class","vtop",4,"matCellDef"],["matColumnDef","location"],["mat-header-cell","","class","no-left-padding","width","1",4,"matHeaderCellDef"],["mat-cell","","class","vtop right no-left-padding",4,"matCellDef"],["matColumnDef","size"],["mat-cell","","class","vtop right",4,"matCellDef"],["matColumnDef","expand-aggray"],["mat-header-cell","","width","1","class","icon",4,"matHeaderCellDef"],["mat-cell","","class","icon vtop",4,"matCellDef"],["matColumnDef","entry"],["mat-header-cell","","class","entry",4,"matHeaderCellDef"],["mat-cell","","class","entry vtop",4,"matCellDef"],["matColumnDef","type"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","","class","mono vtop",4,"matCellDef"],["matColumnDef","rawValue"],["mat-cell","","class","vtop wrap200",4,"matCellDef"],["matColumnDef","engValue"],["matColumnDef","containerName"],["mat-header-cell","","class","no-left-padding",4,"matHeaderCellDef"],["mat-cell","","class","no-left-padding",4,"matCellDef"],["matColumnDef","actions"],["mat-header-cell","","class","expand",4,"matHeaderCellDef"],["mat-cell","","class","icon",4,"matCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","","class","expandable container",3,"click",4,"matRowDef","matRowDefColumns","matRowDefWhen"],["mat-row","",3,"expandable","mouseover","mouseout","click",4,"matRowDef","matRowDefColumns","matRowDefWhen"],["yaDataTable","",1,"expand"],[1,"section-divider"],[1,"iconcol"],[1,"icon12"],[1,"expand"],["mat-header-cell","","width","1"],["mat-cell","",1,"vtop"],[3,"icon","padding"],["mat-header-cell","","width","1",1,"no-left-padding"],["mat-cell","",1,"vtop","right","no-left-padding"],["mat-cell","",1,"vtop","right"],["mat-header-cell","","width","1",1,"icon"],["mat-cell","",1,"icon","vtop"],[3,"icon"],["mat-header-cell","",1,"entry"],["mat-cell","",1,"entry","vtop"],[1,"ya-link",3,"routerLink","queryParams"],[1,"icon12",2,"visibility","hidden"],[1,"icon12",3,"visibility"],["mat-header-cell",""],["mat-cell","",1,"mono","vtop"],["mat-cell","",1,"vtop","wrap200"],[3,"value"],["mat-header-cell","",1,"no-left-padding"],["mat-cell","",1,"no-left-padding"],["mat-header-cell","",1,"expand"],["mat-cell","",1,"icon"],[3,"padding"],["mat-header-row",""],["mat-row","",1,"expandable","container",3,"click"],["mat-row","",3,"mouseover","mouseout","click"]],template:function(a,o){if(a&1&&(v(0,Am,64,16,"app-instance-page"),T(1,"async")),a&2){let r;b((r=P(1,1,o.packet$))?0:-1,r)}},dependencies:[Qi,Je,Ke,U,ee,Re,pi,dt,oi,fe,qt,mt,Be,ft,_t,ot,ht,wt,Ue,Ge,We,ze,Yi,ji,ci,Ot,Xi,Kt],styles:[".detail[_ngcontent-%COMP%]{background-color:#fcfcfc;float:right;height:100%;width:450px;overflow:auto;border-left:1px solid #d3d3d3;box-sizing:border-box}.table-wrapper[_ngcontent-%COMP%]{position:relative;overflow:auto;height:100%}tr.container[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{background-color:#f0f0f0}tr.container[_ngcontent-%COMP%]:hover   td[_ngcontent-%COMP%]{background-color:#f0f0f0!important}tr.expandable[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{cursor:pointer}td.vtop[_ngcontent-%COMP%]{vertical-align:top}td.icon[_ngcontent-%COMP%]{padding:0;line-height:25px;text-align:right}th.entry[_ngcontent-%COMP%], td.entry[_ngcontent-%COMP%]{padding-left:7px}td.right[_ngcontent-%COMP%]{text-align:right}th.no-left-padding[_ngcontent-%COMP%], td.no-left-padding[_ngcontent-%COMP%]{padding-left:5px}.icon12[_ngcontent-%COMP%]{vertical-align:middle}"],changeDetection:0});let e=t;return e})();var Mm=e=>({c:e});function Rm(e,t){e&1&&(s(0,"tr")(1,"td",9),c(2,"No rows to display"),l()())}function Lm(e,t){if(e&1){let i=V();s(0,"tr")(1,"td"),c(2),l(),s(3,"td",10)(4,"ya-icon-action",11),k("click",function(a){let o=A(i).$index;return h(2).moveDown(o),M(a.stopPropagation())}),l(),s(5,"ya-icon-action",12),k("click",function(a){let o=A(i).$index;return h(2).moveUp(o),M(a.stopPropagation())}),l(),s(6,"ya-text-action",13),k("click",function(){let a=A(i).$index,o=h(2);return M(o.deletePattern(a))}),c(7,"DELETE"),l()()()}if(e&2){let i=t.$implicit;d(2),Y(i)}}function Im(e,t){if(e&1&&(s(0,"table",6)(1,"tr")(2,"th"),c(3,"Pattern"),l(),w(4,"th"),l(),v(5,Rm,3,0,"tr"),ne(6,Lm,8,1,"tr",null,ie),l()),e&2){let i=t;d(5),b(i.length?-1:5),d(),ae(i)}}var Qr=(()=>{let t=class t{constructor(n,a,o,r,p,m,u,f){this.router=o,this.route=r,this.yamcs=p,this.dialog=m,this.messageService=u,this.location=f,this.patterns$=new B([]),a.setTitle("Create a Parameter List"),this.form=n.group({name:new te("",[Ee.required]),description:new te})}showAddPatternDialog(){this.dialog.open(mi,{width:"500px",data:{label:"Add parameter or pattern",okLabel:"ADD",hint:"Either an exact parameter name, or a glob pattern with *, **, or ? wildcards."}}).afterClosed().subscribe(a=>{a&&this.patterns$.next([...this.patterns$.value,a])})}deletePattern(n){this.patterns$.value.splice(n,1),this.patterns$.next([...this.patterns$.value])}moveUp(n){let a=this.patterns$.value,o=a[n];n===0?(a[n]=a[a.length-1],a[a.length-1]=o):(a[n]=a[n-1],a[n-1]=o),this.patterns$.next([...this.patterns$.value])}moveDown(n){let a=this.patterns$.value,o=a[n];n===a.length-1?(a[n]=a[0],a[0]=o):(a[n]=a[n+1],a[n+1]=o),this.patterns$.next([...this.patterns$.value])}onConfirm(){let n={name:this.form.value.name,description:this.form.value.description,patterns:[...this.patterns$.value]};this.yamcs.yamcsClient.createParameterList(this.yamcs.instance,n).then(()=>this.router.navigate([".."],{relativeTo:this.route,queryParams:{c:this.yamcs.context}})).catch(a=>this.messageService.showError(a))}};t.\u0275fac=function(a){return new(a||t)(D(zt),D(nt),D(Me),D(we),D(X),D(Ve),D(Qe),D(Bn))},t.\u0275cmp=F({type:t,selectors:[["ng-component"]],standalone:!0,features:[N],decls:33,vars:8,consts:[["mat-icon-button","","routerLink","..","color","primary",3,"queryParams"],[1,"form-content","ya-form"],["novalidate","",3,"formGroup"],["formControlName","name","type","text"],["formControlName","description","rows","5",2,"resize","none"],[1,"ya-button",3,"click"],["yaDataTable","",2,"width","100%"],[1,"action-bar"],["type","submit",1,"ya-button","primary",3,"click","disabled"],["colspan","3"],[2,"text-align","right"],["icon","keyboard_arrow_down",3,"click"],["icon","keyboard_arrow_up",3,"click"],["icon","delete",3,"click"]],template:function(a,o){if(a&1&&(s(0,"app-instance-page")(1,"app-instance-toolbar")(2,"a",0)(3,"mat-icon"),c(4,"arrow_back"),l()(),c(5," Create parameter list "),l(),s(6,"div",1)(7,"form",2)(8,"label"),c(9," Name"),w(10,"br")(11,"input",3),l(),w(12,"br"),s(13,"label"),c(14," Description "),w(15,"textarea",4),l()(),s(16,"p"),c(17,"\xA0"),l(),s(18,"button",5),k("click",function(){return o.showAddPatternDialog()}),s(19,"mat-icon"),c(20,"add_circle_outline"),l(),c(21," Add parameter or pattern "),l(),s(22,"p"),c(23,"\xA0"),l(),v(24,Im,8,1,"table",6),T(25,"async"),s(26,"p"),c(27,"\xA0"),l(),s(28,"div",7)(29,"button",5),k("click",function(){return o.location.back()}),c(30,"Cancel"),l(),s(31,"button",8),k("click",function(){return o.onConfirm()}),c(32," CREATE "),l()()()()),a&2){let r;d(2),y("queryParams",Z(6,Mm,o.yamcs.context)),d(5),y("formGroup",o.form),d(17),b((r=P(25,4,o.patterns$))?24:-1,r),d(7),y("disabled",!o.form.valid)}},dependencies:[Je,Ke,U,ee,Te,Xe,he,Ce,xe,De,Re,pi,oi,fe,ci,Qt],encapsulation:2,changeDetection:0});let e=t;return e})();function Om(e,t){e&1&&(s(0,"tr")(1,"td",8),c(2,"No rows to display"),l()())}function Fm(e,t){if(e&1){let i=V();s(0,"tr")(1,"td"),c(2),l(),s(3,"td",9)(4,"ya-icon-action",10),k("click",function(a){let o=A(i).$index;return h(3).moveDown(o),M(a.stopPropagation())}),l(),s(5,"ya-icon-action",11),k("click",function(a){let o=A(i).$index;return h(3).moveUp(o),M(a.stopPropagation())}),l(),s(6,"ya-text-action",12),k("click",function(){let a=A(i).$index,o=h(3);return M(o.deletePattern(a))}),c(7,"DELETE"),l()()()}if(e&2){let i=t.$implicit;d(2),Y(i)}}function Vm(e,t){if(e&1&&(s(0,"table",5)(1,"tr")(2,"th"),c(3,"Pattern"),l(),w(4,"th"),l(),v(5,Om,3,0,"tr"),ne(6,Fm,8,1,"tr",null,ie),l()),e&2){let i=t;d(5),b(i.length?-1:5),d(),ae(i)}}function Nm(e,t){if(e&1){let i=V();s(0,"app-instance-page")(1,"app-instance-toolbar"),c(2),l(),s(3,"div",0)(4,"form",1)(5,"label"),c(6," Name"),w(7,"br")(8,"input",2),l(),w(9,"br"),s(10,"label"),c(11," Description "),w(12,"textarea",3),l()(),s(13,"p"),c(14,"\xA0"),l(),s(15,"button",4),k("click",function(){A(i);let a=h();return M(a.showAddPatternDialog())}),s(16,"mat-icon"),c(17,"add_circle_outline"),l(),c(18," Add parameter or pattern "),l(),s(19,"p"),c(20,"\xA0"),l(),v(21,Vm,8,1,"table",5),T(22,"async"),s(23,"p"),c(24,"\xA0"),l(),s(25,"div",6)(26,"button",4),k("click",function(){A(i);let a=h();return M(a.location.back())}),c(27,"Cancel"),l(),s(28,"button",7),T(29,"async"),k("click",function(){A(i);let a=h();return M(a.onConfirm())}),c(30," SAVE CHANGES "),l()()()()}if(e&2){let i,n=h();d(2),I(" Edit list: ",t.name," "),d(2),y("formGroup",n.form),d(17),b((i=P(22,4,n.patterns$))?21:-1,i),d(7),y("disabled",!P(29,6,n.dirty$)||!n.form.valid)}}var Kr=(()=>{let t=class t{constructor(n,a,o,r,p,m,u,f){this.router=o,this.route=r,this.yamcs=p,this.dialog=m,this.messageService=u,this.location=f,this.patterns$=new B([]),this.dirty$=new B(!1),a.setTitle("Edit Parameter List");let _=r.snapshot.paramMap.get("list");this.plist$=p.yamcsClient.getParameterList(p.instance,_),this.plist$.then(x=>{this.plist=x,this.form=n.group({name:new te(x.name,[Ee.required]),description:new te(x.description)}),this.formSubscription=this.form.valueChanges.subscribe(()=>{this.dirty$.next(!0)}),this.patterns$.next(x.patterns||[])})}showAddPatternDialog(){this.dialog.open(mi,{width:"500px",data:{label:"Add parameter or pattern",okLabel:"ADD",hint:"Either an exact parameter name, or a glob pattern with *, **, or ? wildcards."}}).afterClosed().subscribe(a=>{a&&(this.patterns$.next([...this.patterns$.value,a]),this.dirty$.next(!0))})}deletePattern(n){this.patterns$.value.splice(n,1),this.patterns$.next([...this.patterns$.value]),this.dirty$.next(!0)}moveUp(n){let a=this.patterns$.value,o=a[n];n===0?(a[n]=a[a.length-1],a[a.length-1]=o):(a[n]=a[n-1],a[n-1]=o),this.patterns$.next([...this.patterns$.value]),this.dirty$.next(!0)}moveDown(n){let a=this.patterns$.value,o=a[n];n===a.length-1?(a[n]=a[0],a[0]=o):(a[n]=a[n+1],a[n+1]=o),this.patterns$.next([...this.patterns$.value]),this.dirty$.next(!0)}onConfirm(){let n={name:this.form.value.name,description:this.form.value.description,patternDefinition:{patterns:[...this.patterns$.value]}};this.yamcs.yamcsClient.updateParameterList(this.yamcs.instance,this.plist.id,n).then(()=>this.router.navigateByUrl(`/telemetry/parameter-lists/${this.plist.id}?c=${this.yamcs.context}`)).catch(a=>this.messageService.showError(a))}ngOnDestroy(){this.formSubscription?.unsubscribe()}};t.\u0275fac=function(a){return new(a||t)(D(zt),D(nt),D(Me),D(we),D(X),D(Ve),D(Qe),D(Bn))},t.\u0275cmp=F({type:t,selectors:[["ng-component"]],standalone:!0,features:[N],decls:2,vars:3,consts:[[1,"form-content","ya-form"],["novalidate","",3,"formGroup"],["formControlName","name","type","text"],["formControlName","description","rows","5",2,"resize","none"],[1,"ya-button",3,"click"],["yaDataTable","",2,"width","100%"],[1,"action-bar"],["type","submit",1,"ya-button","primary",3,"click","disabled"],["colspan","3"],[2,"text-align","right"],["icon","keyboard_arrow_down",3,"click"],["icon","keyboard_arrow_up",3,"click"],["icon","delete",3,"click"]],template:function(a,o){if(a&1&&(v(0,Nm,31,8,"app-instance-page"),T(1,"async")),a&2){let r;b((r=P(1,1,o.plist$))?0:-1,r)}},dependencies:[Je,Ke,U,ee,Te,Xe,he,Ce,xe,De,pi,fe,ci,Qt],encapsulation:2,changeDetection:0});let e=t;return e})();function $m(e,t){if(e&1){let i=V();w(0,"ya-date-time-input",10)(1,"ya-date-time-input",11),s(2,"button",12),k("click",function(){A(i);let a=h(2);return M(a.applyCustomDates())}),c(3," Apply "),l()}if(e&2){let i=h(2);d(2),y("disabled",i.filterForm.invalid)}}function Hm(e,t){if(e&1){let i=V();s(0,"button",13),k("click",function(){A(i);let a=h(2);return M(a.jumpToNow())}),c(1,"Jump to now"),l()}}function Bm(e,t){if(e&1&&(s(0,"span"),c(1," Showing data from "),s(2,"b"),c(3,"the last hour"),l(),c(4," ending at "),s(5,"b"),c(6),T(7,"datetime"),l(),c(8," (Mission Time) "),l()),e&2){let i=h(2);d(6),Y(P(7,1,i.validStop))}}function Um(e,t){if(e&1&&(s(0,"span"),c(1," Showing data from "),s(2,"b"),c(3,"the last 6 hours"),l(),c(4," ending at "),s(5,"b"),c(6),T(7,"datetime"),l(),c(8," (Mission Time) "),l()),e&2){let i=h(2);d(6),Y(P(7,1,i.validStop))}}function Gm(e,t){if(e&1&&(s(0,"span"),c(1," Showing data from "),s(2,"b"),c(3,"the last 24 hours"),l(),c(4," ending at "),s(5,"b"),c(6),T(7,"datetime"),l(),c(8," (Mission Time) "),l()),e&2){let i=h(2);d(6),Y(P(7,1,i.validStop))}}function Wm(e,t){e&1&&(s(0,"span"),c(1," Showing data from "),s(2,"b"),c(3,"all time"),l()())}function zm(e,t){if(e&1&&(s(0,"span"),c(1," Showing data from "),s(2,"b"),c(3),T(4,"datetime"),l(),c(5," to "),s(6,"b"),c(7),T(8,"datetime"),l(),c(9," (Mission Time) "),l()),e&2){let i=h(2);d(3),Y(P(4,2,i.validStart)),d(4),Y(P(8,4,i.validStop))}}function qm(e,t){e&1&&(s(0,"th",23),c(1,"Generation time"),l())}function Ym(e,t){if(e&1&&(s(0,"td",24),c(1),T(2,"datetime"),l()),e&2){let i=t.$implicit;d(),I(" ",P(2,1,i.generationTime)," ")}}function jm(e,t){if(e&1&&(s(0,"th",23),c(1),l()),e&2){let i=h().$implicit;d(),Y(i)}}function Xm(e,t){if(e&1&&(s(0,"td",24),c(1),l()),e&2){let i,n=t.$implicit,a=h().$index;d(),I(" ",(i=n.values[a])!==null&&i!==void 0?i:"-"," ")}}function Zm(e,t){if(e&1&&(G(0,18),v(1,jm,2,1,"th",16)(2,Xm,2,1,"td",17),W()),e&2){let i=t.$implicit;y("cdkColumnDef",i)}}function Qm(e,t){e&1&&w(0,"th",25)}function Km(e,t){e&1&&w(0,"td",24)}function Jm(e,t){e&1&&w(0,"tr",26)}function ed(e,t){e&1&&w(0,"tr",27)}function td(e,t){if(e&1&&(s(0,"div",9)(1,"table",14),G(2,15),v(3,qm,2,0,"th",16)(4,Ym,3,3,"td",17),W(),ne(5,Zm,3,1,"ng-container",18,ie),G(7,19),v(8,Qm,1,0,"th",20)(9,Km,1,0,"td",17),W(),v(10,Jm,1,0,"tr",21),T(11,"async"),v(12,ed,1,0,"tr",22),T(13,"async"),l()()),e&2){let i=h(2);d(),y("dataSource",i.dataSource),d(4),ae(t.headers),d(5),y("matHeaderRowDef",P(11,4,i.displayedColumns$))("matHeaderRowDefSticky",!0),d(2),y("cdkRowDefColumns",P(13,6,i.displayedColumns$))}}function id(e,t){if(e&1){let i=V();s(0,"div",0)(1,"form",1)(2,"div",2),w(3,"ya-select",3),v(4,$m,4,1)(5,Hm,2,0,"button",4),w(6,"div",5),s(7,"button",6),k("click",function(){A(i);let a=h();return M(a.exportParameterData())}),s(8,"mat-icon"),c(9,"download"),l(),c(10," Export CSV "),l()()(),s(11,"div",7),w(12,"div",8),v(13,Bm,9,3,"span")(14,Um,9,3,"span")(15,Gm,9,3,"span")(16,Wm,4,0,"span")(17,zm,10,6,"span"),l(),v(18,td,14,8,"div",9),T(19,"async"),l()}if(e&2){let i,n,a=h();d(),y("formGroup",a.filterForm),d(2),y("options",a.intervalOptions),d(),b(a.filterForm.value.interval==="CUSTOM"?4:-1),d(),b(a.filterForm.value.interval!=="CUSTOM"?5:-1),d(8),b((i=a.appliedInterval)==="PT1H"?13:i==="PT6H"?14:i==="P1D"?15:i==="NO_LIMIT"?16:i==="CUSTOM"?17:-1),d(5),b((n=P(19,6,a.exportData$))?18:-1,n)}}var en="PT1H",Jr=(()=>{let t=class t{constructor(n,a,o,r){this.router=n,this.route=a,this.yamcs=o,this.dialog=r,this.intervalOptions=[{id:"PT1H",label:"Last Hour"},{id:"PT6H",label:"Last 6 Hours"},{id:"P1D",label:"Last 24 Hours"},{id:"NO_LIMIT",label:"No Limit"},{id:"CUSTOM",label:"Custom"}],this.filterForm=new at({interval:new te(en),customStart:new te(null),customStop:new te(null)}),this.displayedColumns=["generationTime","actions"],this.displayedColumns$=new B(this.displayedColumns),this.plist$=new B(null),this.exportData$=new B(null),this.dataSource=new It,this.plistId=a.snapshot.paramMap.get("list"),this.validStop=o.getMissionTime(),this.validStart=$.subtractDuration(this.validStop,en),this.appliedInterval=en,this.initializeOptions(),this.loadData(),this.filterForm.get("interval").valueChanges.forEach(p=>{if(p==="CUSTOM"){let m=this.validStart||this.yamcs.getMissionTime(),u=this.validStop||this.yamcs.getMissionTime();this.filterForm.get("customStart").setValue($.toISOString(m)),this.filterForm.get("customStop").setValue($.toISOString(u))}else p==="NO_LIMIT"?(this.validStart=null,this.validStop=null,this.appliedInterval=p,this.loadData()):(this.validStop=o.getMissionTime(),this.validStart=$.subtractDuration(this.validStop,p),this.appliedInterval=p,this.loadData())})}initializeOptions(){let n=this.route.snapshot.queryParamMap;if(n.has("interval"))if(this.appliedInterval=n.get("interval"),this.filterForm.get("interval").setValue(this.appliedInterval),this.appliedInterval==="CUSTOM"){let a=n.get("customStart");this.filterForm.get("customStart").setValue(a),this.validStart=new Date(a);let o=n.get("customStop");this.filterForm.get("customStop").setValue(o),this.validStop=new Date(o)}else this.appliedInterval==="NO_LIMIT"?(this.validStart=null,this.validStop=null):(this.validStop=this.yamcs.getMissionTime(),this.validStart=$.subtractDuration(this.validStop,this.appliedInterval));else this.appliedInterval=en,this.validStop=this.yamcs.getMissionTime(),this.validStart=$.subtractDuration(this.validStop,en)}jumpToNow(){let n=this.filterForm.value.interval;n==="NO_LIMIT"?this.filterForm.get("interval").setValue(en):(this.validStop=this.yamcs.getMissionTime(),this.validStart=$.subtractDuration(this.validStop,n),this.loadData())}applyCustomDates(){this.validStart=$.toDate(this.filterForm.value.customStart),this.validStop=$.toDate(this.filterForm.value.customStop),this.appliedInterval="CUSTOM",this.loadData()}loadData(){this.updateURL();let n={delimiter:"TAB",limit:100,order:"desc"};if(this.validStart){let a=new Date(this.validStart.getTime());a.setUTCMilliseconds(this.validStart.getUTCMilliseconds()-1),n.start=a.toISOString()}this.validStop&&(n.stop=this.validStop.toISOString()),this.yamcs.yamcsClient.getParameterList(this.yamcs.instance,this.plistId).then(a=>{this.plist$.next(a),a.match&&this.yamcs.yamcsClient.exportParameterValues(this.yamcs.instance,bt(et({},n),{list:a.id})).then(o=>{let r=this.processCsv(o);this.exportData$.next(r),this.displayedColumns$.next(["generationTime",...r.headers,"actions"]),this.dataSource.data=r.records})})}processCsv(n){let a=[],o=n.split(/\r?\n/);for(let u=1;u<o.length;u++){let f=o[u];if(!f)continue;let _=f.split(/\t/),x={generationTime:_[0],values:[]};for(let g=1;g<_.length;g++)x.values[g-1]=_[g]||null;a.push(x)}return{headers:o[0].split(/\t/).slice(1).map(u=>$.getFilename(u)),records:a}}updateURL(){this.router.navigate([],{replaceUrl:!0,relativeTo:this.route,queryParams:{interval:this.appliedInterval,customStart:this.appliedInterval==="CUSTOM"?this.filterForm.value.customStart:null,customStop:this.appliedInterval==="CUSTOM"?this.filterForm.value.customStop:null},queryParamsHandling:"merge"})}exportParameterData(){let n=this.plist$.value;if(n?.match){let o=n.name;this.validStart&&this.validStop?o+="_"+this.validStart.toISOString()+"_"+this.validStop.toISOString():this.validStart?o+="_"+this.validStart.toISOString():this.validStop&&(o+="_"+this.validStop.toISOString()),o+=".csv",this.dialog.open(_a,{width:"400px",data:{list:n.id,start:this.validStart,stop:this.validStop,filename:o}})}}};t.\u0275fac=function(a){return new(a||t)(D(Me),D(we),D(X),D(Ve))},t.\u0275cmp=F({type:t,selectors:[["ng-component"]],standalone:!0,features:[N],decls:2,vars:3,consts:[[1,"panel-content"],[3,"formGroup"],[1,"filter-bar"],["icon","access_time","formControlName","interval",3,"options"],[1,"ya-button"],[2,"flex","1 1 auto"],[1,"ya-button","primary",2,"margin-right","0",3,"click"],[1,"table-status"],[1,"toggles"],[1,"table-container"],["formControlName","customStart"],["formControlName","customStop"],[1,"ya-button",3,"click","disabled"],[1,"ya-button",3,"click"],["mat-table","",1,"ya-data-table","expand",3,"dataSource"],["matColumnDef","generationTime","sticky",""],["mat-header-cell","",4,"cdkHeaderCellDef"],["mat-cell","",4,"cdkCellDef"],[3,"cdkColumnDef"],["cdkColumnDef","actions"],["mat-header-cell","","class","expand",4,"cdkHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef","matHeaderRowDefSticky"],["mat-row","",4,"cdkRowDef","cdkRowDefColumns"],["mat-header-cell",""],["mat-cell",""],["mat-header-cell","",1,"expand"],["mat-header-row",""],["mat-row",""]],template:function(a,o){if(a&1&&(v(0,id,20,8,"div",0),T(1,"async")),a&2){let r;b((r=P(1,1,o.plist$))?0:-1,r)}},dependencies:[U,ee,Te,he,Ce,xe,De,si,Lt,ri,li,fe,Be,_t,ot,Ue,Ge,We,ze,gt,Tt,Le],styles:[".table-container[_ngcontent-%COMP%]{position:absolute;inset:96px 0 0;overflow:auto;margin-top:24px}.table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]{padding-left:24px;padding-right:24px;background-color:inherit;border-bottom:none}.table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{background-color:#fff}.table-status[_ngcontent-%COMP%]{background-color:var(--y-background-color);height:24px;line-height:24px;font-size:12px;padding-left:6px}.table-status[_ngcontent-%COMP%]   .toggles[_ngcontent-%COMP%]{float:right;height:24px;line-height:24px;font-size:12px;padding-right:6px}.table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:first-child, .table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:first-child{background-color:var(--y-background-color);border-left:1px solid rgba(0,0,0,.1);border-right:1px solid rgba(0,0,0,.1)}.table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:last-child, .table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:last-child{border-right:1px solid rgba(0,0,0,.1)}.table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:last-child   td[_ngcontent-%COMP%]{border-bottom:1px solid rgba(0,0,0,.1)}"],changeDetection:0});let e=t;return e})();var ro=e=>({c:e}),nd=e=>[e,"edit"];function ad(e,t){if(e&1&&(s(0,"a",0)(1,"mat-icon"),c(2,"add_circle_outline"),l(),c(3," Create list "),l()),e&2){let i=h();y("queryParams",Z(1,ro,i.yamcs.context))}}function od(e,t){e&1&&(s(0,"th",14),c(1,"Name"),l())}function rd(e,t){if(e&1&&(s(0,"td",15)(1,"a",16),c(2),l()()),e&2){let i=t.$implicit,n=h();d(),y("routerLink",i.id)("queryParams",Z(3,ro,n.yamcs.context)),d(),Y(i.name)}}function ld(e,t){e&1&&(s(0,"th",14),c(1,"Description"),l())}function sd(e,t){if(e&1&&(s(0,"td",17),c(1),l()),e&2){let i=t.$implicit;d(),I(" ",i.description||"-"," ")}}function cd(e,t){e&1&&w(0,"th",18)}function pd(e,t){if(e&1){let i=V();s(0,"td",15)(1,"ya-more")(2,"a",19),c(3," Edit list "),l(),s(4,"button",20),k("click",function(){let a=A(i).$implicit,o=h();return M(o.deleteList(a))}),c(5,"Delete list"),l()()()}if(e&2){let i=t.$implicit,n=h();d(2),y("routerLink",Z(2,nd,i.id))("queryParams",Z(4,ro,n.yamcs.context))}}function md(e,t){e&1&&w(0,"tr",21)}function dd(e,t){e&1&&w(0,"tr",22)}function ud(e,t){e&1&&(s(0,"ya-empty-message"),c(1," No rows to display "),l())}var el=(()=>{let t=class t{constructor(n,a,o,r,p,m){this.yamcs=n,this.authService=a,this.route=r,this.router=p,this.messageService=m,this.filterControl=new te,this.displayedColumns=["name","description","actions"],this.dataSource=new It,o.setTitle("Parameter lists"),this.dataSource.filterPredicate=(u,f)=>u.name.toLowerCase().indexOf(f)>=0}ngAfterViewInit(){let n=this.route.snapshot.queryParamMap;n.has("filter")&&(this.filterControl.setValue(n.get("filter")),this.dataSource.filter=n.get("filter").toLowerCase()),this.filterControl.valueChanges.subscribe(()=>{this.updateURL();let a=this.filterControl.value||"";this.dataSource.filter=a.toLowerCase()}),this.refresh()}mayManageParameterLists(){return this.authService.getUser().hasSystemPrivilege("ManageParameterLists")}refresh(){this.yamcs.yamcsClient.getParameterLists(this.yamcs.instance).then(n=>{this.dataSource.data=n}).catch(n=>this.messageService.showError(n))}updateURL(){let n=this.filterControl.value;this.router.navigate([],{replaceUrl:!0,relativeTo:this.route,queryParams:{filter:n||null},queryParamsHandling:"merge"})}deleteList(n){confirm(`Are you sure you want to delete the list '${n.name}'`)&&this.yamcs.yamcsClient.deleteParameterList(this.yamcs.instance,n.id).then(()=>this.refresh()).catch(a=>this.messageService.showError(a))}};t.\u0275fac=function(a){return new(a||t)(D(X),D(yt),D(nt),D(we),D(Me),D(Qe))},t.\u0275cmp=F({type:t,selectors:[["ng-component"]],standalone:!0,features:[N],decls:20,vars:6,consts:[["mat-button","","color","primary","routerLink","create",3,"queryParams"],[1,"panel-content"],[1,"filter-bar"],["placeholder","Filter lists",3,"formControl"],["mat-table","",1,"ya-data-table","expand",3,"dataSource"],["matColumnDef","name"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","","style","vertical-align: top",4,"matCellDef"],["matColumnDef","description"],["mat-cell","","class","wrap400","style","white-space: pre-wrap",4,"matCellDef"],["matColumnDef","actions"],["mat-header-cell","","class","expand",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell","",2,"vertical-align","top"],[3,"routerLink","queryParams"],["mat-cell","",1,"wrap400",2,"white-space","pre-wrap"],["mat-header-cell","",1,"expand"],["mat-menu-item","",3,"routerLink","queryParams"],["mat-menu-item","",3,"click"],["mat-header-row",""],["mat-row",""]],template:function(a,o){a&1&&(s(0,"app-instance-page")(1,"app-instance-toolbar"),c(2," Parameter lists \xA0\xA0\xA0 "),v(3,ad,4,3,"a",0),l(),s(4,"div",1)(5,"div",2),w(6,"ya-search-filter",3),l(),s(7,"table",4),G(8,5),v(9,od,2,0,"th",6)(10,rd,3,5,"td",7),W(),G(11,8),v(12,ld,2,0,"th",6)(13,sd,2,1,"td",9),W(),G(14,10),v(15,cd,1,0,"th",11)(16,pd,6,6,"td",7),W(),v(17,md,1,0,"tr",12)(18,dd,1,0,"tr",13),l(),v(19,ud,2,0,"ya-empty-message"),l()()),a&2&&(d(3),b(o.mayManageParameterLists()?3:-1),d(3),y("formControl",o.filterControl),d(),y("dataSource",o.dataSource),d(10),y("matHeaderRowDef",o.displayedColumns),d(),y("matRowDefColumns",o.displayedColumns),d(),b(o.dataSource.data.length?-1:19))},dependencies:[Je,Ke,U,he,Wt,Re,Bi,fe,mt,Be,ft,_t,ot,ht,wt,Ue,Ge,We,ze,Xt,Ot,na],encapsulation:2,changeDetection:0});let e=t;return e})();var ba=class extends Gt{constructor(t,i){super(),this.yamcs=t,this.synchronizer=i,this.binaryPreview=16,this.items$=new B([]),this.totalSize$=new B(0),this.loading$=new B(!1),this.idMapping={},this.latestValues=new Map}connect(){return this.syncSubscription=this.synchronizer.syncFast(()=>{this.refreshTable()}),this.items$}async loadParameters(t){return this.loading$.next(!0),this.dataSubscription&&(this.dataSubscription.cancel(),this.dataSubscription=void 0),this.yamcs.yamcsClient.getParameters(this.yamcs.instance,t).then(i=>{this.totalSize$.next(i.totalSize);let n=[];for(let a of i.systems||[])n.push({name:a.qualifiedName,system:a});for(let a of i.parameters||[])n.push({name:$.getMemberPath(a),parameter:a});this.items$.next(n),this.startSubscription(i.parameters||[])}).finally(()=>this.loading$.next(!1))}refreshTable(){let t=this.items$.value;for(let i of t)i.system||(i.pval=this.latestValues.get(i.name));this.items$.next([...t])}startSubscription(t){let i=t.map(n=>({name:$.getMemberPath(n)}));i.length&&(this.dataSubscription=this.yamcs.yamcsClient.createParameterSubscription({instance:this.yamcs.instance,processor:this.yamcs.processor,id:i,abortOnInvalid:!1,sendFromCache:!0,updateOnExpiration:!0,maxBytes:this.binaryPreview+1,action:"REPLACE"},n=>{n.mapping&&(this.idMapping=n.mapping,this.latestValues.clear()),this.processDelivery(n.values||[]),n.mapping&&this.refreshTable()}))}processDelivery(t){for(let i of t){let n=this.idMapping[i.numericId];n&&this.latestValues.set(n.name,i)}}getAliasNamespaces(){let t=[];for(let i of this.items$.value)if(i.parameter?.alias)for(let n of i.parameter.alias)n.namespace&&t.indexOf(n.namespace)===-1&&t.push(n.namespace);return t.sort()}disconnect(){this.syncSubscription?.unsubscribe(),this.dataSubscription?.cancel(),this.items$.complete(),this.totalSize$.complete(),this.loading$.complete()}};var hd=["top"],tl=e=>({c:e}),fd=(e,t)=>({c:e,system:t}),il=e=>({maxBytes:e});function _d(e,t){if(e&1&&w(0,"ya-breadcrumb",30),e&2){let i=t.$implicit;y("link",i.route)("queryParams",i.queryParams)("label",i.name)}}function gd(e,t){if(e&1&&(s(0,"div",5)(1,"ya-breadcrumb-trail"),w(2,"ya-breadcrumb",29),ne(3,_d,1,3,"ya-breadcrumb",30,ie),l()()),e&2){let i=h(),n=h();d(2),y("queryParams",Z(1,tl,n.yamcs.context)),d(),ae(i)}}function vd(e,t){e&1&&v(0,gd,5,3,"div",5),e&2&&b(t.length?0:-1)}function yd(e,t){e&1&&w(0,"ya-dots")}function Cd(e,t){e&1&&(s(0,"th",31),c(1,"Name"),l())}function xd(e,t){if(e&1&&(s(0,"mat-icon",33),c(1,"folder"),l(),s(2,"a",34),c(3),T(4,"filename"),l()),e&2){let i=h().$implicit,n=h();d(2),y("queryParams",_i(4,fd,n.yamcs.context,i.name)),d(),I(" ",P(4,2,i.name),"/ ")}}function bd(e,t){if(e&1&&w(0,"ya-highlight",36),e&2){let i=h(2).$implicit,n=h();y("text",i.name)("term",n.filterForm.value.filter)}}function Sd(e,t){if(e&1&&(w(0,"ya-highlight",36),T(1,"slice")),e&2){let i=h(2).$implicit,n=h();y("text",tt(1,2,i.name,t.length+1))("term",n.filterForm.value.filter)}}function wd(e,t){if(e&1&&(s(0,"mat-icon",33),c(1,"toll"),l(),s(2,"a",35),v(3,bd,1,2,"ya-highlight",36),T(4,"async"),v(5,Sd,2,5,"ya-highlight",36),T(6,"async"),l()),e&2){let i,n=h().$implicit,a=h();d(2),y("routerLink","/telemetry/parameters"+n.name)("queryParams",Z(8,tl,a.yamcs.context)),d(),b(P(4,4,a.system$)?-1:3),d(2),b((i=P(6,6,a.system$))?5:-1,i)}}function Td(e,t){if(e&1&&(s(0,"td",32),v(1,xd,5,7)(2,wd,7,10),l()),e&2){let i=t.$implicit;d(),b(i.system?1:-1),d(),b(i.system?-1:2)}}function Dd(e,t){e&1&&(s(0,"th",37),c(1,"Raw value"),l())}function Pd(e,t){if(e&1&&(s(0,"td",38),c(1),T(2,"value"),l()),e&2){let i=t.$implicit,n=h();d(),I(" ",tt(2,1,i.pval==null?null:i.pval.rawValue,Z(4,il,n.dataSource.binaryPreview))||"-"," ")}}function Ed(e,t){e&1&&(s(0,"th",37),c(1,"Value"),l())}function kd(e,t){if(e&1&&(s(0,"span"),c(1),T(2,"parameterTypeForPath"),T(3,"units"),l()),e&2){let i,n=h(2).$implicit;d(),I(" ",P(3,3,(i=P(2,1,n.parameter))==null?null:i.unitSet)," ")}}function Ad(e,t){e&1&&(s(0,"span"),c(1,"\u2193"),l())}function Md(e,t){e&1&&(s(0,"span"),c(1,"\u2191"),l())}function Rd(e,t){if(e&1&&(s(0,"ya-expirable",39),c(1),T(2,"value"),v(3,kd,4,5,"span")(4,Ad,2,0,"span")(5,Md,2,0,"span"),l()),e&2){let i=h().$implicit,n=h();y("pval",i.pval),d(),I(" ",tt(2,5,i.pval==null?null:i.pval.engValue,Z(8,il,n.dataSource.binaryPreview))||"-"," "),d(2),b(!(i.parameter==null||i.parameter.type==null)&&i.parameter.type.unitSet?3:-1),d(),b((i.pval==null?null:i.pval.rangeCondition)==="LOW"?4:-1),d(),b((i.pval==null?null:i.pval.rangeCondition)==="HIGH"?5:-1)}}function Ld(e,t){e&1&&(s(0,"span"),c(1,"-"),l())}function Id(e,t){if(e&1&&(s(0,"td",38),v(1,Rd,6,10,"ya-expirable",39)(2,Ld,2,0,"span"),l()),e&2){let i=t.$implicit;de("alert",(i.pval==null?null:i.pval.monitoringResult)&&(i.pval==null?null:i.pval.monitoringResult)!=="IN_LIMITS"),d(),b(i.pval?1:-1),d(),b(i.pval?-1:2)}}function Od(e,t){e&1&&(s(0,"th",31),c(1,"Type"),l())}function Fd(e,t){e&1&&(s(0,"span",40),c(1),l()),e&2&&(d(),I(" ",t," "))}function Vd(e,t){e&1&&c(0," - ")}function Nd(e,t){if(e&1&&(s(0,"td",38),v(1,Fd,2,1,"span",40),T(2,"parameterTypeForPath"),v(3,Vd,1,0),l()),e&2){let i,n=t.$implicit;d(),b((i=(i=P(2,1,n.parameter))==null?null:i.engType)?1:3,i)}}function $d(e,t){e&1&&(s(0,"th",31),c(1,"Data source"),l())}function Hd(e,t){if(e&1&&(s(0,"td",38),c(1),T(2,"titlecase"),l()),e&2){let i=t.$implicit;d(),I(" ",P(2,1,i.parameter==null?null:i.parameter.dataSource)||"-"," ")}}function Bd(e,t){e&1&&(s(0,"th",37),c(1,"Description"),l())}function Ud(e,t){if(e&1&&c(0),e&2){let i=h().$implicit;I(" ",i.system.shortDescription||"-"," ")}}function Gd(e,t){if(e&1&&c(0),e&2){let i=h().$implicit;I(" ",i.parameter.shortDescription||"-"," ")}}function Wd(e,t){if(e&1&&(s(0,"td",38),v(1,Ud,1,1)(2,Gd,1,1),l()),e&2){let i=t.$implicit;d(),b(i.system?1:-1),d(),b(i.parameter?2:-1)}}function zd(e,t){if(e&1&&(s(0,"th",31),c(1),l()),e&2){let i=h().$implicit;d(),I(" ",i.label," ")}}function qd(e,t){if(e&1&&w(0,"ya-highlight",36),e&2){let i=h(3);y("text",t)("term",i.filterForm.value.filter)}}function Yd(e,t){e&1&&c(0," - ")}function jd(e,t){if(e&1&&(s(0,"td",38),v(1,qd,1,2,"ya-highlight",36),T(2,"alias"),v(3,Yd,1,0),l()),e&2){let i,n=t.$implicit,a=h().$implicit;d(),b((i=tt(2,1,n.parameter,a.id))?1:3,i)}}function Xd(e,t){if(e&1&&(G(0,23),v(1,zd,2,1,"th",12)(2,jd,4,4,"td",20),W()),e&2){let i=t.$implicit;y("matColumnDef",i.id)}}function Zd(e,t){e&1&&w(0,"th",41)}function Qd(e,t){e&1&&w(0,"td",38)}function Kd(e,t){e&1&&w(0,"tr",42)}function Jd(e,t){if(e&1&&w(0,"tr",43),e&2){let i=t.$implicit,n=h();de("selected",n.selection.isSelected(i))}}function eu(e,t){if(e&1&&(s(0,"div",3),c(1," The Mission Database for "),s(2,"i"),c(3),l(),c(4," does not define any parameters. "),l()),e&2){let i=h();d(3),Y(i.yamcs.instance)}}var lo=[{id:"name",label:"Name",alwaysVisible:!0},{id:"type",label:"Type",visible:!0},{id:"dataSource",label:"Data source",visible:!0},{id:"engValue",label:"Value",visible:!0},{id:"shortDescription",label:"Description",visible:!0},{id:"actions",label:"",alwaysVisible:!0}],tu=[{id:"ANY",label:"Any type"},{id:"aggregate",label:"aggregate"},{id:"array",label:"array"},{id:"binary",label:"binary"},{id:"boolean",label:"boolean"},{id:"enumeration",label:"enumeration"},{id:"float",label:"float"},{id:"integer",label:"integer"},{id:"string",label:"string"},{id:"time",label:"time"}],iu=[{id:"ANY",label:"Any source"},{id:"COMMAND",label:"Command"},{id:"COMMAND_HISTORY",label:"Command History"},{id:"CONSTANT",label:"Constant"},{id:"DERIVED",label:"Derived"},{id:"EXTERNAL1",label:"External 1"},{id:"EXTERNAL2",label:"External 2"},{id:"EXTERNAL3",label:"External 3"},{id:"GROUND",label:"Ground"},{id:"LOCAL",label:"Local"},{id:"SYSTEM",label:"System"},{id:"TELEMETERED",label:"Telemetered"}],nl=(()=>{let t=class t{constructor(n,a,o,r){this.yamcs=n,this.route=a,this.router=o,this.synchronizer=r,this.filterForm=new at({filter:new te,type:new te("ANY"),source:new te("ANY")}),this.shortName=!1,this.pageSize=100,this.system=null,this.system$=new B(null),this.breadcrumb$=new B([]),this.columns=lo,this.typeOptions=tu,this.sourceOptions=iu,this.aliasColumns$=new B([]),this.selection=new Oi(!1),this.dataSource=new ba(this.yamcs,this.synchronizer)}ngAfterViewInit(){let n=this.route.snapshot.queryParamMap;n.has("filter")&&(this.filter=n.get("filter")||"",this.filterForm.get("filter").setValue(this.filter)),n.has("type")&&(this.type=n.get("type"),this.filterForm.get("type").setValue(this.type)),n.has("source")&&(this.source=n.get("source"),this.filterForm.get("source").setValue(this.source)),this.filterForm.get("filter").valueChanges.subscribe(a=>{this.paginator.pageIndex=0,this.filter=a,this.updateDataSource()}),this.filterForm.get("type").valueChanges.forEach(a=>{this.type=a!=="ANY"?a:null,this.updateDataSource()}),this.filterForm.get("source").valueChanges.forEach(a=>{this.source=a!=="ANY"?a:null,this.updateDataSource()}),this.changeSystem(this.route.snapshot.queryParamMap),this.queryParamMapSubscription=this.route.queryParamMap.subscribe(a=>{a.get("system")!==this.system&&this.changeSystem(a)}),this.paginator.page.subscribe(()=>{this.updateDataSource(),this.top.nativeElement.scrollIntoView()})}changeSystem(n){this.system=n.get("system"),this.updateBrowsePath(),n.has("page")?this.paginator.pageIndex=Number(n.get("page")):this.paginator.pageIndex=0,this.updateDataSource()}updateDataSource(){this.updateURL();let n={system:this.system||"/",details:!0,pos:this.paginator.pageIndex*this.pageSize,limit:this.pageSize};this.filter&&(n.q=this.filter,n.searchMembers=!0),this.type&&(n.type=this.type),this.source&&(n.source=this.source),this.dataSource.loadParameters(n).then(()=>{this.selection.clear(),this.updateBrowsePath(),this.system$.next(this.system);let a=[...this.columns];for(let r of this.aliasColumns$.value){let p=a.indexOf(r);p!==-1&&a.splice(p,1)}let o=[];for(let r of this.dataSource.getAliasNamespaces()){let p={id:r,label:r,alwaysVisible:!0};o.push(p)}a.splice(1,0,...o),this.aliasColumns$.next(o),this.columnChooser.recalculate(a)})}updateURL(){this.router.navigate([],{replaceUrl:!0,relativeTo:this.route,queryParams:{page:this.paginator.pageIndex||null,filter:this.filter||null,type:this.type||null,source:this.source||null,system:this.system||null},queryParamsHandling:"merge"})}updateBrowsePath(){let n=[],a="";if(this.system)for(let o of this.system.slice(1).split("/"))a+="/"+o,n.push({name:o,route:"/telemetry/parameters",queryParams:{system:a,c:this.yamcs.context}});this.breadcrumb$.next(n)}selectNext(){let n=this.dataSource.items$.value,a=0;if(this.selection.hasValue()){let o=this.selection.selected[0];n.indexOf(o)!==-1&&(a=Math.min(n.indexOf(o)+1,n.length-1))}this.selection.select(n[a])}selectPrevious(){let n=this.dataSource.items$.value,a=0;if(this.selection.hasValue()){let o=this.selection.selected[0];n.indexOf(o)!==-1&&(a=Math.max(n.indexOf(o)-1,0))}this.selection.select(n[a])}applySelection(){if(this.selection.hasValue()){let n=this.selection.selected[0],a=this.dataSource.items$.value;n.parameter&&a.indexOf(n)!==-1&&this.router.navigate(["/telemetry/parameters"+n.parameter?.qualifiedName],{queryParams:{c:this.yamcs.context}})}}ngOnDestroy(){this.queryParamMapSubscription?.unsubscribe(),this.dataSource.disconnect()}};t.\u0275fac=function(a){return new(a||t)(D(X),D(we),D(Me),D(vt))},t.\u0275cmp=F({type:t,selectors:[["ng-component"]],viewQuery:function(a,o){if(a&1&&(ue(hd,7),ue(Xn,7),ue(Yt,5)),a&2){let r;ce(r=pe())&&(o.top=r.first),ce(r=pe())&&(o.paginator=r.first),ce(r=pe())&&(o.columnChooser=r.first)}},standalone:!0,features:[N],decls:50,vars:26,consts:[["top",""],["columnChooser",""],["empty",""],[1,"panel-content"],[3,"formGroup"],[1,"filter-bar"],["placeholder","Search by name","icon","search",3,"onArrowDown","onArrowUp","onEnter","formControl"],["formControlName","type",3,"options"],["formControlName","source",3,"options"],["preferenceKey","tmParameters",3,"columns"],["mat-table","",1,"ya-data-table","expand",3,"dataSource"],["matColumnDef","name"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","","class","primary-td",4,"matCellDef"],["matColumnDef","rawValue"],["mat-header-cell","","class","wrap200",4,"matHeaderCellDef"],["mat-cell","",4,"cdkCellDef"],["matColumnDef","engValue"],["mat-cell","",3,"alert",4,"matCellDef"],["matColumnDef","type"],["mat-cell","",4,"matCellDef"],["matColumnDef","dataSource"],["matColumnDef","shortDescription"],[3,"matColumnDef"],["matColumnDef","actions"],["mat-header-cell","","class","expand",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",3,"selected",4,"matRowDef","matRowDefColumns"],[3,"pageSize","hidePageSize","showFirstLastButtons","length"],["link","/telemetry/parameters","icon","account_tree",3,"queryParams"],[3,"link","queryParams","label"],["mat-header-cell",""],["mat-cell","",1,"primary-td"],[1,"icon12",2,"vertical-align","middle"],["routerLink","/telemetry/parameters",3,"queryParams"],[3,"routerLink","queryParams"],[3,"text","term"],["mat-header-cell","",1,"wrap200"],["mat-cell",""],[3,"pval"],[1,"mono"],["mat-header-cell","",1,"expand"],["mat-header-row",""],["mat-row",""]],template:function(a,o){if(a&1){let r=V();s(0,"app-instance-page")(1,"app-instance-toolbar"),c(2,"Parameters"),l(),w(3,"span",null,0),s(5,"div",3)(6,"form",4),v(7,vd,1,1),T(8,"async"),s(9,"div",5)(10,"ya-search-filter",6),k("onArrowDown",function(){return A(r),M(o.selectNext())})("onArrowUp",function(){return A(r),M(o.selectPrevious())})("onEnter",function(){return A(r),M(o.applySelection())}),l(),w(11,"ya-select",7)(12,"ya-select",8)(13,"ya-column-chooser",9,1),v(15,yd,1,0,"ya-dots"),T(16,"async"),l()(),s(17,"table",10),G(18,11),v(19,Cd,2,0,"th",12)(20,Td,3,2,"td",13),W(),G(21,14),v(22,Dd,2,0,"th",15)(23,Pd,3,6,"td",16),W(),G(24,17),v(25,Ed,2,0,"th",15)(26,Id,3,4,"td",18),W(),G(27,19),v(28,Od,2,0,"th",12)(29,Nd,4,3,"td",20),W(),G(30,21),v(31,$d,2,0,"th",12)(32,Hd,3,3,"td",20),W(),G(33,22),v(34,Bd,2,0,"th",15)(35,Wd,3,2,"td",20),W(),ne(36,Xd,3,1,"ng-container",23,ie),T(38,"async"),G(39,24),v(40,Zd,1,0,"th",25)(41,Qd,1,0,"td",20),W(),v(42,Kd,1,0,"tr",26),T(43,"async"),v(44,Jd,1,2,"tr",27),T(45,"async"),l(),w(46,"mat-paginator",28),T(47,"async"),l(),v(48,eu,5,1,"ng-template",null,2,gi),l()}if(a&2){let r,p=oe(14);d(6),y("formGroup",o.filterForm),d(),b((r=P(8,14,o.breadcrumb$))?7:-1,r),d(3),y("formControl",o.filterForm.controls.filter),d(),y("options",o.typeOptions),d(),y("options",o.sourceOptions),d(),y("columns",o.columns),d(2),b(P(16,16,o.dataSource.loading$)?15:-1),d(2),y("dataSource",o.dataSource),d(19),ae(P(38,18,o.aliasColumns$)),d(6),y("matHeaderRowDef",P(43,20,p.displayedColumns$)),d(2),y("matRowDefColumns",P(45,22,p.displayedColumns$)),d(2),y("pageSize",o.pageSize)("hidePageSize",!0)("showFirstLastButtons",!0)("length",P(47,24,o.dataSource.totalSize$))}},dependencies:[Je,Ke,U,ee,jo,Ii,Te,he,Ce,Wt,xe,De,Re,Lt,fe,Xn,Be,ft,_t,ot,ht,wt,Ue,Ge,We,ze,ta,ea,Yt,jt,Zt,nr,na,Tt,or,aa,Zi,Kt,Ft],styles:[".primary-td[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{margin-right:7px}"],changeDetection:0});let e=t;return e})();var Sa=class extends Gt{constructor(t,i){super(),this.yamcs=t,this.synchronizer=i,this.binaryPreview=16,this.items$=new B([]),this.totalSize$=new B(0),this.loading$=new B(!1),this.idMapping={},this.latestValues=new Map}connect(){return this.syncSubscription=this.synchronizer.syncFast(()=>{this.refreshTable()}),this.items$}async loadParameters(t){this.loading$.next(!0),this.dataSubscription&&(this.dataSubscription.cancel(),this.dataSubscription=void 0);let i=[];for(let n of t)i.push({name:n.qualifiedName,parameter:n});this.items$.next(i),this.startSubscription(t||[])}refreshTable(){let t=this.items$.value;for(let i of t)i.pval=this.latestValues.get(i.name);this.items$.next([...t])}startSubscription(t){let i=t.map(n=>({name:n.qualifiedName}));i.length&&(this.dataSubscription=this.yamcs.yamcsClient.createParameterSubscription({instance:this.yamcs.instance,processor:this.yamcs.processor,id:i,abortOnInvalid:!1,sendFromCache:!0,updateOnExpiration:!0,maxBytes:this.binaryPreview+1,action:"REPLACE"},n=>{n.mapping&&(this.idMapping=n.mapping,this.latestValues.clear()),this.processDelivery(n.values||[]),this.loading$.next(!1)}))}processDelivery(t){for(let i of t){let n=this.idMapping[i.numericId];n&&this.latestValues.set(n.name,i)}}disconnect(){this.syncSubscription?.unsubscribe(),this.dataSubscription?.cancel(),this.items$.complete(),this.totalSize$.complete(),this.loading$.complete()}};var nu=e=>({c:e}),al=e=>({maxBytes:e});function au(e,t){e&1&&w(0,"ya-dots")}function ou(e,t){e&1&&(s(0,"th",20),c(1,"Name"),l())}function ru(e,t){if(e&1&&(s(0,"td",21)(1,"a",22),c(2),l()()),e&2){let i=t.$implicit,n=h(2);d(),y("routerLink","/telemetry/parameters"+i.parameter.qualifiedName)("queryParams",Z(3,nu,n.yamcs.context)),d(),I(" ",i.name," ")}}function lu(e,t){e&1&&(s(0,"th",23),c(1,"Raw value"),l())}function su(e,t){if(e&1&&(s(0,"td",21),c(1),T(2,"value"),l()),e&2){let i=t.$implicit,n=h(2);d(),I(" ",tt(2,1,i.pval==null?null:i.pval.rawValue,Z(4,al,n.dataSource.binaryPreview))||"-"," ")}}function cu(e,t){e&1&&(s(0,"th",23),c(1,"Value"),l())}function pu(e,t){if(e&1&&(s(0,"span"),c(1),T(2,"parameterTypeForPath"),T(3,"units"),l()),e&2){let i,n=h(2).$implicit;d(),I(" ",P(3,3,(i=P(2,1,n.parameter))==null?null:i.unitSet)," ")}}function mu(e,t){e&1&&(s(0,"span"),c(1,"\u2193"),l())}function du(e,t){e&1&&(s(0,"span"),c(1,"\u2191"),l())}function uu(e,t){if(e&1&&(s(0,"ya-expirable",24),c(1),T(2,"value"),v(3,pu,4,5,"span")(4,mu,2,0,"span")(5,du,2,0,"span"),l()),e&2){let i=h().$implicit,n=h(2);y("pval",i.pval),d(),I(" ",tt(2,5,i.pval==null?null:i.pval.engValue,Z(8,al,n.dataSource.binaryPreview))||"-"," "),d(2),b(!(i.parameter==null||i.parameter.type==null)&&i.parameter.type.unitSet?3:-1),d(),b((i.pval==null?null:i.pval.rangeCondition)==="LOW"?4:-1),d(),b((i.pval==null?null:i.pval.rangeCondition)==="HIGH"?5:-1)}}function hu(e,t){e&1&&(s(0,"span"),c(1,"-"),l())}function fu(e,t){if(e&1&&(s(0,"td",21),v(1,uu,6,10,"ya-expirable",24)(2,hu,2,0,"span"),l()),e&2){let i=t.$implicit;de("alert",(i.pval==null?null:i.pval.monitoringResult)&&(i.pval==null?null:i.pval.monitoringResult)!=="IN_LIMITS"),d(),b(i.pval?1:-1),d(),b(i.pval?-1:2)}}function _u(e,t){e&1&&(s(0,"th",20),c(1,"Type"),l())}function gu(e,t){e&1&&(s(0,"span",25),c(1),l()),e&2&&(d(),I(" ",t," "))}function vu(e,t){e&1&&c(0," - ")}function yu(e,t){if(e&1&&(s(0,"td",21),v(1,gu,2,1,"span",25),T(2,"parameterTypeForPath"),v(3,vu,1,0),l()),e&2){let i,n=t.$implicit;d(),b((i=(i=P(2,1,n.parameter))==null?null:i.engType)?1:3,i)}}function Cu(e,t){e&1&&(s(0,"th",20),c(1,"Data source"),l())}function xu(e,t){if(e&1&&(s(0,"td",21),c(1),T(2,"titlecase"),l()),e&2){let i=t.$implicit;d(),I(" ",P(2,1,i.parameter==null?null:i.parameter.dataSource)||"-"," ")}}function bu(e,t){e&1&&(s(0,"th",23),c(1,"Description"),l())}function Su(e,t){if(e&1&&(s(0,"td",21),c(1),l()),e&2){let i=t.$implicit;d(),I(" ",i.parameter.shortDescription||"-"," ")}}function wu(e,t){e&1&&w(0,"th",26)}function Tu(e,t){e&1&&w(0,"td",21)}function Du(e,t){e&1&&w(0,"tr",27)}function Pu(e,t){e&1&&w(0,"tr",28)}function Eu(e,t){if(e&1&&(s(0,"div",2),w(1,"ya-column-chooser",3,0),v(3,au,1,0,"ya-dots"),T(4,"async"),l(),s(5,"table",4),G(6,5),v(7,ou,2,0,"th",6)(8,ru,3,5,"td",7),W(),G(9,8),v(10,lu,2,0,"th",9)(11,su,3,6,"td",10),W(),G(12,11),v(13,cu,2,0,"th",9)(14,fu,3,4,"td",12),W(),G(15,13),v(16,_u,2,0,"th",6)(17,yu,4,3,"td",7),W(),G(18,14),v(19,Cu,2,0,"th",6)(20,xu,3,3,"td",7),W(),G(21,15),v(22,bu,2,0,"th",9)(23,Su,2,1,"td",7),W(),G(24,16),v(25,wu,1,0,"th",17)(26,Tu,1,0,"td",7),W(),v(27,Du,1,0,"tr",18),T(28,"async"),v(29,Pu,1,0,"tr",19),T(30,"async"),l()),e&2){let i=oe(2),n=h();d(),y("columns",n.columns),d(2),b(P(4,5,n.dataSource.loading$)?3:-1),d(2),y("dataSource",n.dataSource),d(22),y("matHeaderRowDef",P(28,7,i.displayedColumns$)),d(2),y("matRowDefColumns",P(30,9,i.displayedColumns$))}}var ol=(()=>{let t=class t{constructor(n,a,o){this.yamcs=a,this.synchronizer=o,this.plist$=new B(null),this.columns=lo,this.dataSource=new Sa(this.yamcs,this.synchronizer),n.paramMap.subscribe(r=>{let p=r.get("list");this.changeList(p)})}changeList(n){this.yamcs.yamcsClient.getParameterList(this.yamcs.instance,n).then(a=>{this.plist$.next(a),this.dataSource.loadParameters(a.match||[])})}ngOnDestroy(){this.dataSource?.disconnect()}};t.\u0275fac=function(a){return new(a||t)(D(we),D(X),D(vt))},t.\u0275cmp=F({type:t,selectors:[["ng-component"]],viewQuery:function(a,o){if(a&1&&ue(Yt,5),a&2){let r;ce(r=pe())&&(o.columnChooser=r.first)}},standalone:!0,features:[N],decls:3,vars:3,consts:[["columnChooser",""],[1,"panel-content"],[1,"filter-bar"],["preferenceKey","tmParameters",3,"columns"],["mat-table","",1,"ya-data-table","expand",3,"dataSource"],["matColumnDef","name"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","rawValue"],["mat-header-cell","","class","wrap200",4,"matHeaderCellDef"],["mat-cell","",4,"cdkCellDef"],["matColumnDef","engValue"],["mat-cell","",3,"alert",4,"matCellDef"],["matColumnDef","type"],["matColumnDef","dataSource"],["matColumnDef","shortDescription"],["matColumnDef","actions"],["mat-header-cell","","class","expand",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],[3,"routerLink","queryParams"],["mat-header-cell","",1,"wrap200"],[3,"pval"],[1,"mono"],["mat-header-cell","",1,"expand"],["mat-header-row",""],["mat-row",""]],template:function(a,o){if(a&1&&(s(0,"div",1),v(1,Eu,31,11),T(2,"async"),l()),a&2){let r;d(),b((r=P(2,1,o.plist$))?1:-1,r)}},dependencies:[U,ee,Ii,Re,Lt,Be,ft,_t,ot,ht,wt,Ue,Ge,We,ze,Yt,jt,Zt,Zi,Kt,Ft],encapsulation:2,changeDetection:0});let e=t;return e})();var wa=e=>({c:e});function ku(e,t){if(e&1&&(s(0,"a",5)(1,"mat-icon"),c(2,"edit"),l(),c(3," Edit list "),l()),e&2){let i=h(2);y("queryParams",Z(1,wa,i.yamcs.context))}}function Au(e,t){if(e&1&&(s(0,"a",8,3),c(2," Historical Data "),l()),e&2){let i=oe(1),n=h(2);y("active",i.isActive)("queryParams",Z(2,wa,n.yamcs.context))}}function Mu(e,t){if(e&1&&(s(0,"app-instance-page")(1,"app-instance-toolbar")(2,"a",4)(3,"mat-icon"),c(4,"arrow_back"),l()(),c(5),v(6,ku,4,3,"a",5),l(),s(7,"nav",6,0)(9,"a",7,1),c(11," Realtime "),l(),v(12,Au,3,4,"a",8),l(),s(13,"div",9)(14,"mat-tab-nav-panel",null,2),w(16,"router-outlet"),l()()()),e&2){let i=oe(10),n=oe(15),a=h();d(2),y("queryParams",Z(8,wa,a.yamcs.context)),d(3),I(" ",t.name," \xA0\xA0\xA0 "),d(),b(a.mayManageParameterLists()?6:-1),d(),y("mat-stretch-tabs",!1)("tabPanel",n),d(2),y("active",i.isActive)("queryParams",Z(10,wa,a.yamcs.context)),d(3),b(a.config.tmArchive?12:-1)}}var rl=(()=>{let t=class t{constructor(n,a,o,r,p){this.yamcs=a,this.authService=o,this.title=r,this.plist$=new B(null),this.config=p.getConfig(),n.paramMap.subscribe(m=>{let u=m.get("list");this.changeList(u)})}mayManageParameterLists(){return this.authService.getUser().hasSystemPrivilege("ManageParameterLists")}changeList(n){this.yamcs.yamcsClient.getParameterList(this.yamcs.instance,n).then(a=>{this.plist$.next(a),this.title.setTitle(a.name)})}};t.\u0275fac=function(a){return new(a||t)(D(we),D(X),D(yt),D(nt),D(Pe))},t.\u0275cmp=F({type:t,selectors:[["ng-component"]],standalone:!0,features:[N],decls:2,vars:3,consts:[["tabs",""],["rla","routerLinkActive"],["tabPanel",""],["rlb","routerLinkActive"],["mat-icon-button","","routerLink","..","color","primary",3,"queryParams"],["mat-button","","color","primary","routerLink","edit",3,"queryParams"],["mat-tab-nav-bar","",1,"secondary",3,"mat-stretch-tabs","tabPanel"],["mat-tab-link","","routerLink","realtime","routerLinkActive","",3,"active","queryParams"],["mat-tab-link","","routerLink","data","routerLinkActive","",3,"active","queryParams"],[1,"tab-content-wrapper"]],template:function(a,o){if(a&1&&(v(0,Mu,17,12,"app-instance-page"),T(1,"async")),a&2){let r;b((r=P(1,1,o.plist$))?0:-1,r)}},dependencies:[Je,Ke,U,ee,ai,Re,Gn,Bi,oi,fe,Zn,Kn,Qn],encapsulation:2,changeDetection:0});let e=t;return e})();function Ru(e,t){e&1&&(s(0,"th",16),c(1,"Severity"),l())}function Lu(e,t){if(e&1&&(s(0,"td",17),w(1,"app-alarm-level",18),l()),e&2){let i=t.$implicit;d(),y("level",i.severity)("grayscale",!0)}}function Iu(e,t){e&1&&(s(0,"th",16),c(1,"Start"),l())}function Ou(e,t){if(e&1&&(s(0,"td",17),c(1),T(2,"datetime"),l()),e&2){let i=t.$implicit;d(),Y(P(2,1,i.triggerTime)||"-")}}function Fu(e,t){e&1&&(s(0,"th",16),c(1,"Stop"),l())}function Vu(e,t){if(e&1&&(s(0,"td",17),c(1),T(2,"datetime"),l()),e&2){let i=t.$implicit;d(),I(" ",P(2,1,i.updateTime)||"-"," ")}}function Nu(e,t){e&1&&(s(0,"th",16),c(1,"Trip value"),l())}function $u(e,t){e&1&&(s(0,"span"),c(1,"\u2193"),l())}function Hu(e,t){e&1&&(s(0,"span"),c(1,"\u2191"),l())}function Bu(e,t){if(e&1&&(c(0),T(1,"value"),v(2,$u,2,0,"span")(3,Hu,2,0,"span")),e&2){let i=t;I(" ",P(1,3,i.triggerValue.engValue)," "),d(2),b(i.triggerValue.rangeCondition==="LOW"?2:-1),d(),b(i.triggerValue.rangeCondition==="HIGH"?3:-1)}}function Uu(e,t){if(e&1&&(s(0,"td",19),v(1,Bu,4,5),l()),e&2){let i,n=t.$implicit;d(),b((i=n.parameterDetail)?1:-1,i)}}function Gu(e,t){e&1&&(s(0,"th",16),c(1,"Duration"),l())}function Wu(e,t){if(e&1&&(c(0),T(1,"duration")),e&2){let i=h().$implicit,n=h(2);I(" ",P(1,1,n.durationFor(i))||"-"," ")}}function zu(e,t){if(e&1&&(s(0,"mat-icon",20),c(1,"comment"),l()),e&2){let i=h(2).$implicit;y("matTooltip",i.clearInfo==null?null:i.clearInfo.clearMessage)}}function qu(e,t){if(e&1&&(c(0),v(1,zu,2,1,"mat-icon",20)),e&2){let i=h().$implicit;I(" (cleared by ",i.clearInfo==null?null:i.clearInfo.clearedBy,") "),d(),b(i.clearInfo!=null&&i.clearInfo.clearMessage?1:-1)}}function Yu(e,t){if(e&1&&(s(0,"td",17),v(1,Wu,2,3)(2,qu,2,2),l()),e&2){let i=t.$implicit;d(),b(i.updateTime?1:-1),d(),b(i.clearInfo!=null&&i.clearInfo.clearedBy?2:-1)}}function ju(e,t){e&1&&(s(0,"th",21),c(1,"Violations"),l())}function Xu(e,t){if(e&1&&(c(0),T(1,"number"),T(2,"number")),e&2){let i=h().$implicit;Ht(" ",P(1,2,i.violations)," (",tt(2,4,i.violations/i.count*100,"1.2-2"),"%) ")}}function Zu(e,t){e&1&&c(0," - ")}function Qu(e,t){if(e&1&&(s(0,"td",22),v(1,Xu,3,7)(2,Zu,1,0),l()),e&2){let i=t.$implicit;d(),b(i.violations?1:2)}}function Ku(e,t){e&1&&w(0,"th",23)}function Ju(e,t){if(e&1){let i=V();s(0,"td",17)(1,"ya-text-action",24),k("click",function(){let a=A(i).$implicit,o=h(2);return M(o.showChart(a))}),c(2," SHOW CHART "),l(),s(3,"ya-text-action",25),k("click",function(){let a=A(i).$implicit,o=h(2);return M(o.showData(a))}),c(4," SHOW DATA "),l()()}}function e0(e,t){e&1&&w(0,"tr",26)}function t0(e,t){e&1&&w(0,"tr",27)}function i0(e,t){if(e&1&&(s(0,"table",0),G(1,1),v(2,Ru,2,0,"th",2)(3,Lu,2,2,"td",3),W(),G(4,4),v(5,Iu,2,0,"th",2)(6,Ou,3,3,"td",3),W(),G(7,5),v(8,Fu,2,0,"th",2)(9,Vu,3,3,"td",3),W(),G(10,6),v(11,Nu,2,0,"th",2)(12,Uu,2,1,"td",7),W(),G(13,8),v(14,Gu,2,0,"th",2)(15,Yu,3,2,"td",3),W(),G(16,9),v(17,ju,2,0,"th",10)(18,Qu,3,1,"td",11),W(),G(19,12),v(20,Ku,1,0,"th",13)(21,Ju,5,0,"td",3),W(),v(22,e0,1,0,"tr",14)(23,t0,1,0,"tr",15),l()),e&2){let i=h();y("dataSource",i.dataSource),d(22),y("matHeaderRowDef",i.displayedColumns),d(),y("matRowDefColumns",i.displayedColumns)}}var ll=(()=>{let t=class t{constructor(n,a){this.router=n,this.yamcs=a,this.displayedColumns=["severity","start","stop","duration","triggerValue","violations","actions"]}durationFor(n){if(n.updateTime)return $.toDate(n.updateTime).getTime()-$.toDate(n.triggerTime).getTime()}showChart(n){let a=n.triggerTime,o=n.updateTime||n.clearInfo?.clearTime,r,p;o?(r=a,p=o):(r=a,p=eo($.toDate(a),1).toISOString()),this.router.navigate(["/telemetry/parameters"+n.parameterDetail?.triggerValue.id.name,"-","chart"],{queryParams:{c:this.yamcs.context,interval:"CUSTOM",customStart:r,customStop:p}})}showData(n){let a=n.triggerTime,o=n.updateTime||n.clearInfo?.clearTime,r,p;o?(r=a,p=o):(r=a,p=eo($.toDate(a),1).toISOString()),this.router.navigate(["/telemetry/parameters"+n.parameterDetail?.triggerValue.id.name,"-","data"],{queryParams:{c:this.yamcs.context,interval:"CUSTOM",customStart:r,customStop:p}})}};t.\u0275fac=function(a){return new(a||t)(D(Me),D(X))},t.\u0275cmp=F({type:t,selectors:[["app-parameter-alarms-table"]],inputs:{dataSource:"dataSource"},standalone:!0,features:[N],decls:1,vars:1,consts:[["mat-table","",1,"ya-data-table","expand",3,"dataSource"],["matColumnDef","severity"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","start"],["matColumnDef","stop"],["matColumnDef","triggerValue"],["mat-cell","","class","wrap200",4,"matCellDef"],["matColumnDef","duration"],["matColumnDef","violations"],["mat-header-cell","","style","text-align: right",4,"matHeaderCellDef"],["mat-cell","","style","text-align: right",4,"matCellDef"],["matColumnDef","actions"],["mat-header-cell","","class","expand",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],[3,"level","grayscale"],["mat-cell","",1,"wrap200"],[3,"matTooltip"],["mat-header-cell","",2,"text-align","right"],["mat-cell","",2,"text-align","right"],["mat-header-cell","",1,"expand"],["icon","show_chart",3,"click"],["icon","view_headline",3,"click"],["mat-header-row",""],["mat-row",""]],template:function(a,o){a&1&&v(0,i0,24,3,"table",0),a&2&&b(o.dataSource?0:-1)},dependencies:[Jt,U,Yo,fe,Be,ft,_t,ot,ht,wt,Ue,Ge,We,ze,Ui,Qt,Le,lr,Ft],encapsulation:2,changeDetection:0});let e=t;return e})();var Ta=class extends Gt{constructor(t,i){super(),this.yamcs=t,this.qualifiedName=i,this.pageSize=100,this.alarms$=new B([]),this.loading$=new B(!1)}connect(t){return this.alarms$}isEmpty(){return this.alarms$.value.length===0}loadAlarms(t){return this.loading$.next(!0),this.loadPage(bt(et({},t),{limit:this.pageSize+1})).then(i=>{this.loading$.next(!1),this.alarms$.next(i)})}hasMore(){return this.offscreenRecord!=null}loadPage(t){return this.yamcs.yamcsClient.getAlarmsForParameter(this.yamcs.instance,this.qualifiedName,t).then(i=>(i.length>this.pageSize?this.offscreenRecord=i.splice(i.length-1,1)[0]:this.offscreenRecord=null,i))}loadMoreData(t){this.offscreenRecord&&this.loadPage(bt(et({},t),{stop:this.offscreenRecord.triggerTime,limit:this.pageSize+1})).then(i=>{let n=this.alarms$.getValue().concat(i);this.alarms$.next(n)})}disconnect(){this.alarms$.complete(),this.loading$.complete()}};function n0(e,t){if(e&1){let i=V();w(0,"ya-date-time-input",7)(1,"ya-date-time-input",8),s(2,"button",9),k("click",function(){A(i);let a=h();return M(a.applyCustomDates())}),c(3," Apply "),l()}if(e&2){let i=h();d(2),y("disabled",i.filter.invalid)}}function a0(e,t){if(e&1){let i=V();s(0,"button",10),k("click",function(){A(i);let a=h();return M(a.jumpToNow())}),c(1,"Jump to now"),l()}}function o0(e,t){e&1&&w(0,"ya-dots")}function r0(e,t){if(e&1&&(s(0,"span"),c(1," Showing data from "),s(2,"b"),c(3,"the last month"),l(),c(4," ending at "),s(5,"b"),c(6),T(7,"datetime"),l(),c(8," (Mission Time) "),l()),e&2){let i=h();d(6),Y(P(7,1,i.validStop))}}function l0(e,t){if(e&1&&(s(0,"span"),c(1," Showing data from "),s(2,"b"),c(3,"the last year"),l(),c(4," ending at "),s(5,"b"),c(6),T(7,"datetime"),l(),c(8," (Mission Time) "),l()),e&2){let i=h();d(6),Y(P(7,1,i.validStop))}}function s0(e,t){e&1&&(s(0,"span"),c(1," Showing data from "),s(2,"b"),c(3,"all time"),l()())}function c0(e,t){if(e&1&&(s(0,"span"),c(1," Showing data from "),s(2,"b"),c(3),T(4,"datetime"),l(),c(5," to "),s(6,"b"),c(7),T(8,"datetime"),l(),c(9," (Mission Time) "),l()),e&2){let i=h();d(3),Y(P(4,2,i.validStart)),d(4),Y(P(8,4,i.validStop))}}function p0(e,t){e&1&&(s(0,"ya-empty-message"),c(1," No records found matching current filter in the selected time range. "),l())}function m0(e,t){if(e&1){let i=V();s(0,"mat-toolbar"),w(1,"span",11),s(2,"button",9),k("click",function(){A(i);let a=h();return M(a.loadMoreData())}),c(3," Load More "),l(),w(4,"span",11),l()}if(e&2){let i=h();d(2),y("disabled",!i.dataSource.hasMore())}}var Da="P1M",sl=(()=>{let t=class t{constructor(n){this.yamcs=n,this.qualifiedName=Mt.required({alias:"parameter"}),this.intervalOptions=[{id:"P1M",label:"Last Month"},{id:"P1Y",label:"Last Year"},{id:"NO_LIMIT",label:"No Limit"},{id:"CUSTOM",label:"Custom"}],this.filter=new at({interval:new te(Da),customStart:new te(null),customStop:new te(null)})}ngOnInit(){let n=this.qualifiedName();this.dataSource=new Ta(this.yamcs,n),this.validStop=this.yamcs.getMissionTime(),this.validStart=$.subtractDuration(this.validStop,Da),this.appliedInterval=Da,this.loadData(),this.filter.get("interval").valueChanges.forEach(a=>{if(a==="CUSTOM"){let o=this.validStart||this.yamcs.getMissionTime(),r=this.validStop||this.yamcs.getMissionTime();this.filter.get("customStart").setValue($.toISOString(o)),this.filter.get("customStop").setValue($.toISOString(r))}else a==="NO_LIMIT"?(this.validStart=null,this.validStop=null,this.appliedInterval=a,this.loadData()):(this.validStop=this.yamcs.getMissionTime(),this.validStart=$.subtractDuration(this.validStop,a),this.appliedInterval=a,this.loadData())})}jumpToNow(){let n=this.filter.value.interval;n==="NO_LIMIT"?this.filter.get("interval").setValue(Da):(this.validStop=this.yamcs.getMissionTime(),this.validStart=$.subtractDuration(this.validStop,n),this.loadData())}applyCustomDates(){this.validStart=$.toDate(this.filter.value.customStart),this.validStop=$.toDate(this.filter.value.customStop),this.appliedInterval="CUSTOM",this.loadData()}loadData(){let n={detail:!0};this.validStart&&(n.start=this.validStart.toISOString()),this.validStop&&(n.stop=this.validStop.toISOString()),this.dataSource.loadAlarms(n)}loadMoreData(){let n={detail:!0};this.validStart&&(n.start=this.validStart.toISOString()),this.dataSource.loadMoreData(n)}ngOnDestroy(){this.dataSource?.disconnect()}};t.\u0275fac=function(a){return new(a||t)(D(X))},t.\u0275cmp=F({type:t,selectors:[["ng-component"]],inputs:{qualifiedName:[1,"parameter","qualifiedName"]},standalone:!0,features:[N],decls:17,vars:13,consts:[[1,"panel-content"],[3,"formGroup"],[1,"filter-bar"],["formControlName","interval","icon","access_time",3,"options"],[1,"ya-button"],[1,"table-status"],[3,"dataSource"],["formControlName","customStart"],["formControlName","customStop"],[1,"ya-button",3,"click","disabled"],[1,"ya-button",3,"click"],[2,"flex","1 1 auto"]],template:function(a,o){if(a&1&&(s(0,"div",0)(1,"form",1)(2,"div",2),w(3,"ya-select",3),v(4,n0,4,1)(5,a0,2,0,"button",4)(6,o0,1,0,"ya-dots"),T(7,"async"),l()(),s(8,"div",5),v(9,r0,9,3,"span")(10,l0,9,3,"span")(11,s0,4,0,"span")(12,c0,10,6,"span"),l(),w(13,"app-parameter-alarms-table",6),v(14,p0,2,0,"ya-empty-message")(15,m0,5,1,"mat-toolbar"),T(16,"async"),l()),a&2){let r;d(),y("formGroup",o.filter),d(2),y("options",o.intervalOptions),d(),b(o.filter.value.interval==="CUSTOM"?4:-1),d(),b(o.filter.value.interval!=="CUSTOM"?5:-1),d(),b(P(7,9,o.dataSource.loading$)?6:-1),d(3),b((r=o.appliedInterval)==="P1M"?9:r==="P1Y"?10:r==="NO_LIMIT"?11:r==="CUSTOM"?12:-1),d(4),y("dataSource",o.dataSource),d(),b(o.dataSource.isEmpty()?14:-1),d(),b(!P(16,11,o.dataSource.loading$)&&!o.dataSource.isEmpty()?15:-1)}},dependencies:[ll,U,ee,Te,he,Ce,xe,De,Gi,gt,jt,Xt,Tt,Le],styles:[".table-status[_ngcontent-%COMP%]{background-color:var(--y-background-color);height:24px;line-height:24px;font-size:12px;padding-left:6px}"],changeDetection:0});let e=t;return e})();var cl=function(e,t,i,n,a,o){var r=function(p){return p==="logscale"?!1:n(p)};return ti(e,t,i,r,a,o)},ti=function(e,t,i,n,a,o){var r=n("pixelsPerLabel"),p=[],m,u,f,_;if(o)for(m=0;m<o.length;m++)p.push({v:o[m]});else{if(n("logscale")){_=Math.floor(i/r);var x=yn(e,Pa,1),g=yn(t,Pa,-1);x==-1&&(x=0),g==-1&&(g=Pa.length-1);var S=null;if(g-x>=_/4){for(var C=g;C>=x;C--){var E=Pa[C],L=Math.log(E/e)/Math.log(t/e)*i,O={v:E};S===null?S={tickValue:E,pixel_coord:L}:Math.abs(L-S.pixel_coord)>=r?S={tickValue:E,pixel_coord:L}:O.label="",p.push(O)}p.reverse()}}if(p.length===0){var H=n("labelsKMG2"),z,Q;H?(z=[1,2,4,8,16,32,64,128,256],Q=16):(z=[1,2,5,10,20,50,100],Q=10);var be=Math.ceil(i/r),q=Math.abs(t-e)/be,J=Math.floor(Math.log(q)/Math.log(Q)),_e=Math.pow(Q,J),j,me,ct,Oe;for(u=0;u<z.length&&(j=_e*z[u],me=Math.floor(e/j)*j,ct=Math.ceil(t/j)*j,_=Math.abs(ct-me)/j,Oe=i/_,!(Oe>r));u++);for(me>ct&&(j*=-1),m=0;m<=_;m++)f=me+m*j,p.push({v:f})}}var Dt=n("axisLabelFormatter");for(m=0;m<p.length;m++)p[m].label===void 0&&(p[m].label=Dt.call(a,p[m].v,0,n,a));return p},Ci=function(e,t,i,n,a,o){var r=d0(e,t,i,n);return r>=0?so(e,t,r,n,a):[]},re={MILLISECONDLY:0,TWO_MILLISECONDLY:1,FIVE_MILLISECONDLY:2,TEN_MILLISECONDLY:3,FIFTY_MILLISECONDLY:4,HUNDRED_MILLISECONDLY:5,FIVE_HUNDRED_MILLISECONDLY:6,SECONDLY:7,TWO_SECONDLY:8,FIVE_SECONDLY:9,TEN_SECONDLY:10,THIRTY_SECONDLY:11,MINUTELY:12,TWO_MINUTELY:13,FIVE_MINUTELY:14,TEN_MINUTELY:15,THIRTY_MINUTELY:16,HOURLY:17,TWO_HOURLY:18,SIX_HOURLY:19,DAILY:20,TWO_DAILY:21,WEEKLY:22,MONTHLY:23,QUARTERLY:24,BIANNUAL:25,ANNUAL:26,DECADAL:27,CENTENNIAL:28,NUM_GRANULARITIES:29},se={DATEFIELD_Y:0,DATEFIELD_M:1,DATEFIELD_D:2,DATEFIELD_HH:3,DATEFIELD_MM:4,DATEFIELD_SS:5,DATEFIELD_MS:6,NUM_DATEFIELDS:7},ge=[];ge[re.MILLISECONDLY]={datefield:se.DATEFIELD_MS,step:1,spacing:1};ge[re.TWO_MILLISECONDLY]={datefield:se.DATEFIELD_MS,step:2,spacing:2};ge[re.FIVE_MILLISECONDLY]={datefield:se.DATEFIELD_MS,step:5,spacing:5};ge[re.TEN_MILLISECONDLY]={datefield:se.DATEFIELD_MS,step:10,spacing:10};ge[re.FIFTY_MILLISECONDLY]={datefield:se.DATEFIELD_MS,step:50,spacing:50};ge[re.HUNDRED_MILLISECONDLY]={datefield:se.DATEFIELD_MS,step:100,spacing:100};ge[re.FIVE_HUNDRED_MILLISECONDLY]={datefield:se.DATEFIELD_MS,step:500,spacing:500};ge[re.SECONDLY]={datefield:se.DATEFIELD_SS,step:1,spacing:1e3*1};ge[re.TWO_SECONDLY]={datefield:se.DATEFIELD_SS,step:2,spacing:1e3*2};ge[re.FIVE_SECONDLY]={datefield:se.DATEFIELD_SS,step:5,spacing:1e3*5};ge[re.TEN_SECONDLY]={datefield:se.DATEFIELD_SS,step:10,spacing:1e3*10};ge[re.THIRTY_SECONDLY]={datefield:se.DATEFIELD_SS,step:30,spacing:1e3*30};ge[re.MINUTELY]={datefield:se.DATEFIELD_MM,step:1,spacing:1e3*60};ge[re.TWO_MINUTELY]={datefield:se.DATEFIELD_MM,step:2,spacing:1e3*60*2};ge[re.FIVE_MINUTELY]={datefield:se.DATEFIELD_MM,step:5,spacing:1e3*60*5};ge[re.TEN_MINUTELY]={datefield:se.DATEFIELD_MM,step:10,spacing:1e3*60*10};ge[re.THIRTY_MINUTELY]={datefield:se.DATEFIELD_MM,step:30,spacing:1e3*60*30};ge[re.HOURLY]={datefield:se.DATEFIELD_HH,step:1,spacing:1e3*3600};ge[re.TWO_HOURLY]={datefield:se.DATEFIELD_HH,step:2,spacing:1e3*3600*2};ge[re.SIX_HOURLY]={datefield:se.DATEFIELD_HH,step:6,spacing:1e3*3600*6};ge[re.DAILY]={datefield:se.DATEFIELD_D,step:1,spacing:1e3*86400};ge[re.TWO_DAILY]={datefield:se.DATEFIELD_D,step:2,spacing:1e3*86400*2};ge[re.WEEKLY]={datefield:se.DATEFIELD_D,step:7,spacing:1e3*604800};ge[re.MONTHLY]={datefield:se.DATEFIELD_M,step:1,spacing:1e3*7200*365.2425};ge[re.QUARTERLY]={datefield:se.DATEFIELD_M,step:3,spacing:1e3*21600*365.2425};ge[re.BIANNUAL]={datefield:se.DATEFIELD_M,step:6,spacing:1e3*43200*365.2425};ge[re.ANNUAL]={datefield:se.DATEFIELD_Y,step:1,spacing:1e3*86400*365.2425};ge[re.DECADAL]={datefield:se.DATEFIELD_Y,step:10,spacing:1e3*864e3*365.2425};ge[re.CENTENNIAL]={datefield:se.DATEFIELD_Y,step:100,spacing:1e3*864e4*365.2425};var Pa=function(){for(var e=[],t=-39;t<=39;t++)for(var i=Math.pow(10,t),n=1;n<=9;n++){var a=i*n;e.push(a)}return e}(),d0=function(e,t,i,n){for(var a=n("pixelsPerLabel"),o=0;o<re.NUM_GRANULARITIES;o++){var r=u0(e,t,o);if(i/r>=a)return o}return-1},u0=function(e,t,i){var n=ge[i].spacing;return Math.round(1*(t-e)/n)},so=function(e,t,i,n,a){var o=n("axisLabelFormatter"),r=n("labelsUTC"),p=r?ka:Ea,m=ge[i].datefield,u=ge[i].step,f=ge[i].spacing,_=new Date(e),x=[];x[se.DATEFIELD_Y]=p.getFullYear(_),x[se.DATEFIELD_M]=p.getMonth(_),x[se.DATEFIELD_D]=p.getDate(_),x[se.DATEFIELD_HH]=p.getHours(_),x[se.DATEFIELD_MM]=p.getMinutes(_),x[se.DATEFIELD_SS]=p.getSeconds(_),x[se.DATEFIELD_MS]=p.getMilliseconds(_);var g=x[m]%u;i==re.WEEKLY&&(g=p.getDay(_)),x[m]-=g;for(var S=m+1;S<se.NUM_DATEFIELDS;S++)x[S]=S===se.DATEFIELD_D?1:0;var C=[],E=p.makeDate.apply(null,x),L=E.getTime();if(i<=re.HOURLY)for(L<e&&(L+=f,E=new Date(L));L<=t;)C.push({v:L,label:o.call(a,E,i,n,a)}),L+=f,E=new Date(L);else for(L<e&&(x[m]+=u,E=p.makeDate.apply(null,x),L=E.getTime());L<=t;)(i>=re.DAILY||p.getHours(E)%u===0)&&C.push({v:L,label:o.call(a,E,i,n,a)}),x[m]+=u,E=p.makeDate.apply(null,x),L=E.getTime();return C};var bi=10,h0=Math.log(bi),Se=function(e){return Math.log(e)/h0},xn=function(e,t,i){var n=Se(e),a=Se(t),o=n+i*(a-n),r=Math.pow(bi,o);return r};var fl=[7,3],_l=[7,2,2,2],tn=1,nn=2,an=function(e){return e.getContext("2d")},Si=function(t,i,n){t.addEventListener(i,n,!1)};function Pt(e,t,i){e.removeEventListener(t,i,!1)}function ii(e){return e=e||window.event,e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault(),e.cancelBubble=!0,e.cancel=!0,e.returnValue=!1,!1}function gl(e,t,i){var n,a,o;if(t===0)n=i,a=i,o=i;else{var r=Math.floor(e*6),p=e*6-r,m=i*(1-t),u=i*(1-t*p),f=i*(1-t*(1-p));switch(r){case 1:n=u,a=i,o=m;break;case 2:n=m,a=i,o=f;break;case 3:n=m,a=u,o=i;break;case 4:n=f,a=m,o=i;break;case 5:n=i,a=m,o=u;break;case 6:case 0:n=i,a=f,o=m;break}}return n=Math.floor(255*n+.5),a=Math.floor(255*a+.5),o=Math.floor(255*o+.5),"rgb("+n+","+a+","+o+")"}function ui(e){var t=e.getBoundingClientRect(),i=window,n=document.documentElement;return{x:t.left+(i.pageXOffset||n.scrollLeft),y:t.top+(i.pageYOffset||n.scrollTop)}}function on(e){return!e.pageX||e.pageX<0?0:e.pageX}function rn(e){return!e.pageY||e.pageY<0?0:e.pageY}function ln(e,t){return on(e)-t.px}function sn(e,t){return rn(e)-t.py}function vl(e){return!!e&&!isNaN(e)}function cn(e,t){return!(!e||e.yval===null||e.x===null||e.x===void 0||e.y===null||e.y===void 0||isNaN(e.x)||!t&&isNaN(e.y))}function ho(e,t){var i=Math.min(Math.max(1,t||2),21);return Math.abs(e)<.001&&e!==0?e.toExponential(i-1):e.toPrecision(i)}function xi(e){return e<10?"0"+e:""+e}var Ea={getFullYear:e=>e.getFullYear(),getMonth:e=>e.getMonth(),getDate:e=>e.getDate(),getHours:e=>e.getHours(),getMinutes:e=>e.getMinutes(),getSeconds:e=>e.getSeconds(),getMilliseconds:e=>e.getMilliseconds(),getDay:e=>e.getDay(),makeDate:function(e,t,i,n,a,o,r){return new Date(e,t,i,n,a,o,r)}},ka={getFullYear:e=>e.getUTCFullYear(),getMonth:e=>e.getUTCMonth(),getDate:e=>e.getUTCDate(),getHours:e=>e.getUTCHours(),getMinutes:e=>e.getUTCMinutes(),getSeconds:e=>e.getUTCSeconds(),getMilliseconds:e=>e.getUTCMilliseconds(),getDay:e=>e.getUTCDay(),makeDate:function(e,t,i,n,a,o,r){return new Date(Date.UTC(e,t,i,n,a,o,r))}};function uo(e,t,i,n){var a=xi(e)+":"+xi(t);if(i&&(a+=":"+xi(i),n)){var o=""+n;a+="."+("000"+o).substring(o.length)}return a}function fo(e,t){var i=t?ka:Ea,n=new Date(e),a=i.getFullYear(n),o=i.getMonth(n),r=i.getDate(n),p=i.getHours(n),m=i.getMinutes(n),u=i.getSeconds(n),f=i.getMilliseconds(n),_=""+a,x=xi(o+1),g=xi(r),S=p*3600+m*60+u+.001*f,C=_+"/"+x+"/"+g;return S&&(C+=" "+uo(p,m,u,f)),C}function po(e,t){var i=Math.pow(10,t);return Math.round(e*i)/i}function yn(e,t,i,n,a){if((n==null||a===null||a===void 0)&&(n=0,a=t.length-1),n>a)return-1;i==null&&(i=0);var o=function(u){return u>=0&&u<t.length},r=parseInt((n+a)/2,10),p=t[r],m;return p==e?r:p>e?i>0&&(m=r-1,o(m)&&t[m]<e)?r:yn(e,t,i,n,r-1):p<e?i<0&&(m=r+1,o(m)&&t[m]>e)?r:yn(e,t,i,r+1,a):-1}function _o(e){var t,i;if((e.search("-")==-1||e.search("T")!=-1||e.search("Z")!=-1)&&(i=mo(e),i&&!isNaN(i)))return i;if(e.search("-")!=-1){for(t=e.replace("-","/","g");t.search("-")!=-1;)t=t.replace("-","/");i=mo(t)}else i=mo(e);return(!i||isNaN(i))&&console.error("Couldn't parse "+e+" as a date"),i}function mo(e){return new Date(e).getTime()}function xt(e,t){if(typeof t<"u"&&t!==null)for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);return e}var f0=typeof Node<"u"&&Node!==null&&typeof Node=="object"?function(t){return t instanceof Node}:function(t){return typeof t=="object"&&typeof t.nodeType=="number"&&typeof t.nodeName=="string"};function Ma(e,t){if(typeof t<"u"&&t!==null){for(var i in t)if(t.hasOwnProperty(i)){let n=t[i];n===null?e[i]=null:wi(n)?e[i]=n.slice():f0(n)?e[i]=n:typeof n=="object"?((typeof e[i]!="object"||e[i]===null)&&(e[i]={}),Ma(e[i],n)):e[i]=n}}return e}function yl(e){if(e===null)return"null";let t=typeof e;return(t==="object"||t==="function"&&typeof e.item=="function")&&typeof e.length=="number"&&e.nodeType!==3&&e.nodeType!==4?"array":t}function wi(e){let t=typeof e;return e!==null&&(t==="object"||t==="function"&&typeof e.item=="function")&&typeof e.length=="number"&&e.nodeType!==3&&e.nodeType!==4}function go(e){return e!==null&&typeof e=="object"&&typeof e.getTime=="function"}function vo(e){for(var t=[],i=0;i<e.length;i++)wi(e[i])?t.push(vo(e[i])):t.push(e[i]);return t}function pn(){return document.createElement("canvas")}function bn(e){try{var t=window.devicePixelRatio,i=e.webkitBackingStorePixelRatio||e.mozBackingStorePixelRatio||e.msBackingStorePixelRatio||e.oBackingStorePixelRatio||e.backingStorePixelRatio||1;return t!==void 0?t/i:1}catch{return 1}}function Cl(e,t,i,n){t=t||0,i=i||e.length,this.hasNext=!0,this.peek=null,this.start_=t,this.array_=e,this.predicate_=n,this.end_=Math.min(e.length,t+i),this.nextIdx_=t-1,this.next()}Cl.prototype.next=function(){if(!this.hasNext)return null;for(var e=this.peek,t=this.nextIdx_+1,i=!1;t<this.end_;){if(!this.predicate_||this.predicate_(this.array_,t)){this.peek=this.array_[t],i=!0;break}t++}return this.nextIdx_=t,i||(this.hasNext=!1,this.peek=null),e};function Ra(e,t,i,n){return new Cl(e,t,i,n)}var _0=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e){window.setTimeout(e,1e3/60)}}();function yo(e,t,i,n){var a=0,o,r=new Date().getTime();if(e(a),t==1){n();return}var p=t-1;(function m(){a>=t||_0.call(window,function(){var u=new Date().getTime(),f=u-r;o=a,a=Math.floor(f/i);var _=a-o,x=a+_>p;x||a>=p?(e(p),n()):(_!==0&&e(a),m())})})()}var pl={annotationClickHandler:!0,annotationDblClickHandler:!0,annotationMouseOutHandler:!0,annotationMouseOverHandler:!0,axisLineColor:!0,axisLineWidth:!0,clickCallback:!0,drawCallback:!0,drawHighlightPointCallback:!0,drawPoints:!0,drawPointCallback:!0,drawGrid:!0,fillAlpha:!0,gridLineColor:!0,gridLineWidth:!0,hideOverlayOnMouseOut:!0,highlightCallback:!0,highlightCircleSize:!0,interactionModel:!0,labelsDiv:!0,labelsKMB:!0,labelsKMG2:!0,labelsSeparateLines:!0,labelsShowZeroValues:!0,legend:!0,panEdgeFraction:!0,pixelsPerYLabel:!0,pointClickCallback:!0,pointSize:!0,rangeSelectorPlotFillColor:!0,rangeSelectorPlotFillGradientColor:!0,rangeSelectorPlotStrokeColor:!0,rangeSelectorBackgroundStrokeColor:!0,rangeSelectorBackgroundLineWidth:!0,rangeSelectorPlotLineWidth:!0,rangeSelectorForegroundStrokeColor:!0,rangeSelectorForegroundLineWidth:!0,rangeSelectorAlpha:!0,showLabelsOnHighlight:!0,showRoller:!0,strokeWidth:!0,underlayCallback:!0,unhighlightCallback:!0,zoomCallback:!0};function xl(e,t){var i={};if(e)for(var n=1;n<e.length;n++)i[e[n]]=!0;var a=function(m){for(var u in m)if(m.hasOwnProperty(u)&&!pl[u])return!0;return!1};for(var o in t)if(t.hasOwnProperty(o)){if(o=="highlightSeriesOpts"||i[o]&&!t.series){if(a(t[o]))return!0}else if(o=="series"||o=="axes"){var r=t[o];for(var p in r)if(r.hasOwnProperty(p)&&a(r[p]))return!0}else if(!pl[o])return!0}return!1}var Sn={DEFAULT:function(e,t,i,n,a,o,r){i.beginPath(),i.fillStyle=o,i.arc(n,a,r,0,2*Math.PI,!1),i.fill()}};function Co(e){for(var t=0;t<e.length;t++){var i=e.charAt(t);if(i==="\r")return t+1<e.length&&e.charAt(t+1)===`
`?`\r
`:i;if(i===`
`)return t+1<e.length&&e.charAt(t+1)==="\r"?`
\r`:i}return null}function xo(e,t){if(t===null||e===null)return!1;for(var i=e;i&&i!==t;)i=i.parentNode;return i===t}function ml(e,t){return t<0?1/Math.pow(e,-t):Math.pow(e,t)}var g0=/^#([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})?$/,v0=/^rgba?\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})(?:,\s*([01](?:\.\d+)?))?\)$/;function dl(e){var t,i,n,a,o=null;if(t=g0.exec(e))i=parseInt(t[1],16),n=parseInt(t[2],16),a=parseInt(t[3],16),t[4]&&(o=parseInt(t[4],16));else if(t=v0.exec(e))i=parseInt(t[1],10),n=parseInt(t[2],10),a=parseInt(t[3],10),t[4]&&(o=parseFloat(t[4]));else return null;return o!==null?{r:i,g:n,b:a,a:o}:{r:i,g:n,b:a}}function mn(e){var t=dl(e);if(t)return t;var i=document.createElement("div");i.style.backgroundColor=e,i.style.visibility="hidden",document.body.appendChild(i);var n=window.getComputedStyle(i,null).backgroundColor;return document.body.removeChild(i),dl(n)}function bl(e){try{var t=e||document.createElement("canvas");t.getContext("2d")}catch{return!1}return!0}function ni(e,t,i){var n=parseFloat(e);if(!isNaN(n))return n;if(/^ *$/.test(e))return null;if(/^ *nan *$/i.test(e))return NaN;var a="Unable to parse '"+e+"' as a number";return i!==void 0&&t!==void 0&&(a+=" on line "+(1+(t||0))+" ('"+i+"') of CSV."),console.error(a),null}var y0=["k","M","G","T","P","E","Z","Y"],Sl=["m","\xB5","n","p","f","a","z","y"],C0=["Ki","Mi","Gi","Ti","Pi","Ei","Zi","Yi"],x0=["p-10","p-20","p-30","p-40","p-50","p-60","p-70","p-80"],b0=["K","M","G","T","P","E","Z","Y"],S0=Sl;function La(e,t){var i=t("sigFigs");if(i!==null)return ho(e,i);if(e===0)return"0";var n=t("digitsAfterDecimal"),a=t("maxNumberWidth"),o=t("labelsKMB"),r=t("labelsKMG2"),p,m=Math.abs(e);if(o||r){var u,f=[],_=[];o&&(u=1e3,f=y0,_=Sl),r&&(u=1024,f=C0,_=x0,o&&(f=b0,_=S0));var x,g;if(m>=u){for(g=f.length;g>0;)if(x=ml(u,g),--g,m>=x)return m/x>=Math.pow(10,a)?p=e.toExponential(n):p=po(e/x,n)+f[g],p}else if(m<1){for(g=0;g<_.length&&(++g,x=ml(u,g),!(m*x>=1)););return m*x<Math.pow(10,-n)?p=e.toExponential(n):p=po(e*x,n)+_[g-1],p}}return m>=Math.pow(10,a)||m<Math.pow(10,-n)?p=e.toExponential(n):p=""+po(e,n),p}function wn(e,t,i){return La.call(this,e,i)}var ul=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function Ti(e,t,i){var n=i("labelsUTC"),a=n?ka:Ea,o=a.getFullYear(e),r=a.getMonth(e),p=a.getDate(e),m=a.getHours(e),u=a.getMinutes(e),f=a.getSeconds(e),_=a.getMilliseconds(e);if(t>=re.DECADAL)return""+o;if(t>=re.MONTHLY)return ul[r]+"&#160;"+o;var x=m*3600+u*60+f+.001*_;if(x===0||t>=re.DAILY)return xi(p)+"&#160;"+ul[r];if(t<re.SECONDLY){var g=""+_;return xi(f)+"."+("000"+g).substring(g.length)}else return t>re.MINUTELY?uo(m,u,f,0):uo(m,u,f,_)}function dn(e,t){return fo(e,t("labelsUTC"))}var Aa=[],hl=!1;function Cn(e){return typeof e=="function"&&e(),!0}function wl(e){if(typeof document<"u"){let t=function(){if(!hl){hl=!0,e.onDOMready=Cn,document.removeEventListener("DOMContentLoaded",t,!1),window.removeEventListener("load",t,!1);for(let n=0;n<Aa.length;++n)Aa[n]();Aa=null}};e.onDOMready=function(n){if(document.readyState==="complete")return e.onDOMready=Cn,Cn(n);let a=function(r){return typeof r=="function"&&Aa.push(r),!1};return e.onDOMready=a,document.addEventListener("DOMContentLoaded",t,!1),window.addEventListener("load",t,!1),document.readyState==="complete"?(t(),e.onDOMready=Cn,Cn(n)):a(n)}}}var st=function(e){this.dygraph_=e,this.points=[],this.setNames=[],this.annotations=[],this.yAxes_=null,this.xTicks_=null,this.yTicks_=null};st.prototype.addDataset=function(e,t){this.points.push(t),this.setNames.push(e)};st.prototype.getPlotArea=function(){return this.area_};st.prototype.computePlotArea=function(){var e={x:0,y:0};e.w=this.dygraph_.width_-e.x-this.dygraph_.getOption("rightGap"),e.h=this.dygraph_.height_;var t={chart_div:this.dygraph_.graphDiv,reserveSpaceLeft:function(i){var n={x:e.x,y:e.y,w:i,h:e.h};return e.x+=i,e.w-=i,n},reserveSpaceRight:function(i){var n={x:e.x+e.w-i,y:e.y,w:i,h:e.h};return e.w-=i,n},reserveSpaceTop:function(i){var n={x:e.x,y:e.y,w:e.w,h:i};return e.y+=i,e.h-=i,n},reserveSpaceBottom:function(i){var n={x:e.x,y:e.y+e.h-i,w:e.w,h:i};return e.h-=i,n},chartRect:function(){return{x:e.x,y:e.y,w:e.w,h:e.h}}};this.dygraph_.cascadeEvents_("layout",t),this.area_=e};st.prototype.setAnnotations=function(e){this.annotations=[];for(var t=this.dygraph_.getOption("xValueParser")||function(a){return a},i=0;i<e.length;i++){var n={};if(!e[i].xval&&e[i].x===void 0){console.error("Annotations must have an 'x' property");return}if(e[i].icon&&!(e[i].hasOwnProperty("width")&&e[i].hasOwnProperty("height"))){console.error("Must set width and height when setting annotation.icon property");return}xt(n,e[i]),n.xval||(n.xval=t(n.x)),this.annotations.push(n)}};st.prototype.setXTicks=function(e){this.xTicks_=e};st.prototype.setYAxes=function(e){this.yAxes_=e};st.prototype.evaluate=function(){this._xAxis={},this._evaluateLimits(),this._evaluateLineCharts(),this._evaluateLineTicks(),this._evaluateAnnotations()};st.prototype._evaluateLimits=function(){var e=this.dygraph_.xAxisRange();this._xAxis.minval=e[0],this._xAxis.maxval=e[1];var t=e[1]-e[0];this._xAxis.scale=t!==0?1/t:1,this.dygraph_.getOptionForAxis("logscale","x")&&(this._xAxis.xlogrange=Se(this._xAxis.maxval)-Se(this._xAxis.minval),this._xAxis.xlogscale=this._xAxis.xlogrange!==0?1/this._xAxis.xlogrange:1);for(var i=0;i<this.yAxes_.length;i++){var n=this.yAxes_[i];n.minyval=n.computedValueRange[0],n.maxyval=n.computedValueRange[1],n.yrange=n.maxyval-n.minyval,n.yscale=n.yrange!==0?1/n.yrange:1,(this.dygraph_.getOption("logscale")||n.logscale)&&(n.ylogrange=Se(n.maxyval)-Se(n.minyval),n.ylogscale=n.ylogrange!==0?1/n.ylogrange:1,(!isFinite(n.ylogrange)||isNaN(n.ylogrange))&&console.error("axis "+i+" of graph at "+n.g+" can't be displayed in log scale for range ["+n.minyval+" - "+n.maxyval+"]"))}};st.calcXNormal_=function(e,t,i){return i?(Se(e)-Se(t.minval))*t.xlogscale:(e-t.minval)*t.scale};st.calcYNormal_=function(e,t,i){if(i){var n=1-(Se(t)-Se(e.minyval))*e.ylogscale;return isFinite(n)?n:NaN}else return 1-(t-e.minyval)*e.yscale};st.prototype._evaluateLineCharts=function(){for(var e=this.dygraph_.getOption("stackedGraph"),t=this.dygraph_.getOptionForAxis("logscale","x"),i=0;i<this.points.length;i++){for(var n=this.points[i],a=this.setNames[i],o=this.dygraph_.getOption("connectSeparatedPoints",a),r=this.dygraph_.axisPropertiesForSeries(a),p=this.dygraph_.attributes_.getForSeries("logscale",a),m=0;m<n.length;m++){var u=n[m];u.x=st.calcXNormal_(u.xval,this._xAxis,t);var f=u.yval;e&&(u.y_stacked=st.calcYNormal_(r,u.yval_stacked,p),f!==null&&!isNaN(f)&&(f=u.yval_stacked)),f===null&&(f=NaN,o||(u.yval=NaN)),u.y=st.calcYNormal_(r,f,p)}this.dygraph_.dataHandler_.onLineEvaluated(n,r,p)}};st.prototype._evaluateLineTicks=function(){var e,t,i,n,a,o;for(this.xticks=[],e=0;e<this.xTicks_.length;e++)t=this.xTicks_[e],i=t.label,o=!("label_v"in t),a=o?t.v:t.label_v,n=this.dygraph_.toPercentXCoord(a),n>=0&&n<1&&this.xticks.push({pos:n,label:i,has_tick:o});for(this.yticks=[],e=0;e<this.yAxes_.length;e++)for(var r=this.yAxes_[e],p=0;p<r.ticks.length;p++)t=r.ticks[p],i=t.label,o=!("label_v"in t),a=o?t.v:t.label_v,n=this.dygraph_.toPercentYCoord(a,e),n>0&&n<=1&&this.yticks.push({axis:e,pos:n,label:i,has_tick:o})};st.prototype._evaluateAnnotations=function(){var e,t={};for(e=0;e<this.annotations.length;e++){var i=this.annotations[e];t[i.xval+","+i.series]=i}if(this.annotated_points=[],!(!this.annotations||!this.annotations.length))for(var n=0;n<this.points.length;n++){var a=this.points[n];for(e=0;e<a.length;e++){var o=a[e],r=o.xval+","+o.name;r in t&&(o.annotation=t[r],this.annotated_points.push(o),delete t[r])}}};st.prototype.removeAllDatasets=function(){delete this.points,delete this.setNames,delete this.setPointsLengths,delete this.setPointsOffsets,this.points=[],this.setNames=[],this.setPointsLengths=[],this.setPointsOffsets=[]};var Tn=st;var ke=function(e,t,i,n){if(this.dygraph_=e,this.layout=n,this.element=t,this.elementContext=i,this.height=e.height_,this.width=e.width_,!bl(this.element))throw"Canvas is not supported.";this.area=n.getPlotArea();var a=this.dygraph_.canvas_ctx_;a.beginPath(),a.rect(this.area.x,this.area.y,this.area.w,this.area.h),a.clip(),a=this.dygraph_.hidden_ctx_,a.beginPath(),a.rect(this.area.x,this.area.y,this.area.w,this.area.h),a.clip()};ke.prototype.clear=function(){this.elementContext.clearRect(0,0,this.width,this.height)};ke.prototype.render=function(){this._updatePoints(),this._renderLineChart()};ke._getIteratorPredicate=function(e){return e?ke._predicateThatSkipsEmptyPoints:null};ke._predicateThatSkipsEmptyPoints=function(e,t){return e[t].yval!==null};ke._drawStyledLine=function(e,t,i,n,a,o,r){var p=e.dygraph,m=p.getBooleanOption("stepPlot",e.setName);wi(n)||(n=null);var u=p.getBooleanOption("drawGapEdgePoints",e.setName),f=e.points,_=e.setName,x=Ra(f,0,f.length,ke._getIteratorPredicate(p.getBooleanOption("connectSeparatedPoints",_))),g=n&&n.length>=2,S=e.drawingContext;S.save(),g&&S.setLineDash&&S.setLineDash(n);var C=ke._drawSeries(e,x,i,r,a,u,m,t);ke._drawPointsOnLine(e,C,o,t,r),g&&S.setLineDash&&S.setLineDash([]),S.restore()};ke._drawSeries=function(e,t,i,n,a,o,r,p){var m=null,u=null,f=null,_,x,g=[],S=!0,C=e.drawingContext;C.beginPath(),C.strokeStyle=p,C.lineWidth=i;for(var E=t.array_,L=t.end_,O=t.predicate_,H=t.start_;H<L;H++){if(x=E[H],O){for(;H<L&&!O(E,H);)H++;if(H==L)break;x=E[H]}if(x.canvasy===null||x.canvasy!=x.canvasy)r&&m!==null&&(C.moveTo(m,u),C.lineTo(x.canvasx,u)),m=u=null;else{if(_=!1,o||m===null){t.nextIdx_=H,t.next(),f=t.hasNext?t.peek.canvasy:null;var z=f===null||f!=f;_=m===null&&z,o&&(!S&&m===null||t.hasNext&&z)&&(_=!0)}m!==null?i&&(r&&(C.moveTo(m,u),C.lineTo(x.canvasx,u)),C.lineTo(x.canvasx,x.canvasy)):C.moveTo(x.canvasx,x.canvasy),(a||_)&&g.push([x.canvasx,x.canvasy,x.idx]),m=x.canvasx,u=x.canvasy}S=!1}return C.stroke(),g};ke._drawPointsOnLine=function(e,t,i,n,a){for(var o=e.drawingContext,r=0;r<t.length;r++){var p=t[r];o.save(),i.call(e.dygraph,e.dygraph,e.setName,o,p[0],p[1],n,a,p[2]),o.restore()}};ke.prototype._updatePoints=function(){for(var e=this.layout.points,t=e.length;t--;)for(var i=e[t],n=i.length;n--;){var a=i[n];a.canvasx=this.area.w*a.x+this.area.x,a.canvasy=this.area.h*a.y+this.area.y}};ke.prototype._renderLineChart=function(e,t){var i=t||this.elementContext,n,a=this.layout.points,o=this.layout.setNames,r;this.colors=this.dygraph_.colorsMap_;var p=this.dygraph_.getOption("plotter"),m=p;wi(m)||(m=[m]);var u={};for(n=0;n<o.length;n++){r=o[n];var f=this.dygraph_.getOption("plotter",r);f!=p&&(u[r]=f)}for(n=0;n<m.length;n++)for(var _=m[n],x=n==m.length-1,g=0;g<a.length;g++)if(r=o[g],!(e&&r!=e)){var S=a[g],C=_;if(r in u)if(x)C=u[r];else continue;var E=this.colors[r],L=this.dygraph_.getOption("strokeWidth",r);i.save(),i.strokeStyle=E,i.lineWidth=L,C({points:S,setName:r,drawingContext:i,color:E,strokeWidth:L,dygraph:this.dygraph_,axis:this.dygraph_.axisPropertiesForSeries(r),plotArea:this.area,seriesIndex:g,seriesCount:a.length,singleSeriesName:e,allSeriesPoints:a}),i.restore()}};ke._Plotters={linePlotter:function(e){ke._linePlotter(e)},fillPlotter:function(e){ke._fillPlotter(e)},errorPlotter:function(e){ke._errorPlotter(e)}};ke._linePlotter=function(e){var t=e.dygraph,i=e.setName,n=e.strokeWidth,a=t.getNumericOption("strokeBorderWidth",i),o=t.getOption("drawPointCallback",i)||Sn.DEFAULT,r=t.getOption("strokePattern",i),p=t.getBooleanOption("drawPoints",i),m=t.getNumericOption("pointSize",i);a&&n&&ke._drawStyledLine(e,t.getOption("strokeBorderColor",i),n+2*a,r,p,o,m),ke._drawStyledLine(e,e.color,n,r,p,o,m)};ke._errorPlotter=function(e){var t=e.dygraph,i=e.setName,n=t.getBooleanOption("errorBars")||t.getBooleanOption("customBars");if(n){var a=t.getBooleanOption("fillGraph",i);a&&console.warn("Can't use fillGraph option with customBars or errorBars option");var o=e.drawingContext,r=e.color,p=t.getNumericOption("fillAlpha",i),m=t.getBooleanOption("stepPlot",i),u=e.points,f=Ra(u,0,u.length,ke._getIteratorPredicate(t.getBooleanOption("connectSeparatedPoints",i))),_,x=NaN,g=NaN,S=[-1,-1],C=mn(r),E="rgba("+C.r+","+C.g+","+C.b+","+p+")";o.fillStyle=E,o.beginPath();for(var L=function(H){return H==null||isNaN(H)};f.hasNext;){var O=f.next();if(!m&&L(O.y)||m&&!isNaN(g)&&L(g)){x=NaN;continue}_=[O.y_bottom,O.y_top],m&&(g=O.y),isNaN(_[0])&&(_[0]=O.y),isNaN(_[1])&&(_[1]=O.y),_[0]=e.plotArea.h*_[0]+e.plotArea.y,_[1]=e.plotArea.h*_[1]+e.plotArea.y,isNaN(x)||(m?(o.moveTo(x,S[0]),o.lineTo(O.canvasx,S[0]),o.lineTo(O.canvasx,S[1])):(o.moveTo(x,S[0]),o.lineTo(O.canvasx,_[0]),o.lineTo(O.canvasx,_[1])),o.lineTo(x,S[1]),o.closePath()),S=_,x=O.canvasx}o.fill()}};ke._fastCanvasProxy=function(e){var t=[],i=null,n=null,a=1,o=2,r=0,p=function(f){if(!(t.length<=1)){for(var _=t.length-1;_>0;_--){var x=t[_];if(x[0]==o){var g=t[_-1];g[1]==x[1]&&g[2]==x[2]&&t.splice(_,1)}}for(var _=0;_<t.length-1;){var x=t[_];x[0]==o&&t[_+1][0]==o?t.splice(_,1):_++}if(t.length>2&&!f){var S=0;t[0][0]==o&&S++;for(var C=null,E=null,_=S;_<t.length;_++){var x=t[_];if(x[0]==a)if(C===null&&E===null)C=_,E=_;else{var L=x[2];L<t[C][2]?C=_:L>t[E][2]&&(E=_)}}var O=t[C],H=t[E];t.splice(S,t.length-S),C<E?(t.push(O),t.push(H)):(C>E&&t.push(H),t.push(O))}}},m=function(f){p(f);for(var _=0,x=t.length;_<x;_++){var g=t[_];g[0]==a?e.lineTo(g[1],g[2]):g[0]==o&&e.moveTo(g[1],g[2])}t.length&&(n=t[t.length-1][1]),r+=t.length,t=[]},u=function(f,_,x){var g=Math.round(_);if(i===null||g!=i){var S=i-n>1,C=g-i>1,E=S||C;m(E),i=g}t.push([f,_,x])};return{moveTo:function(f,_){u(o,f,_)},lineTo:function(f,_){u(a,f,_)},stroke:function(){m(!0),e.stroke()},fill:function(){m(!0),e.fill()},beginPath:function(){m(!0),e.beginPath()},closePath:function(){m(!0),e.closePath()},_count:function(){return r}}};ke._fillPlotter=function(e){if(!e.singleSeriesName&&e.seriesIndex===0){for(var t=e.dygraph,i=t.getLabels().slice(1),n=i.length;n>=0;n--)t.visibility()[n]||i.splice(n,1);var a=function(){for(var $t=0;$t<i.length;$t++)if(t.getBooleanOption("fillGraph",i[$t]))return!0;return!1}();if(a)for(var o=e.plotArea,r=e.allSeriesPoints,p=r.length,m=t.getBooleanOption("stackedGraph"),u=t.getColors(),f={},_,x,g=function($t,jl,Xl,Fo){if($t.lineTo(jl,Xl),m)for(var Ya=Fo.length-1;Ya>=0;Ya--){var Vo=Fo[Ya];$t.lineTo(Vo[0],Vo[1])}},S=p-1;S>=0;S--){var C=e.drawingContext,E=i[S];if(t.getBooleanOption("fillGraph",E)){var L=t.getNumericOption("fillAlpha",E),O=t.getBooleanOption("stepPlot",E),H=u[S],z=t.axisPropertiesForSeries(E),Q=1+z.minyval*z.yscale;Q<0?Q=0:Q>1&&(Q=1),Q=o.h*Q+o.y;var be=r[S],q=Ra(be,0,be.length,ke._getIteratorPredicate(t.getBooleanOption("connectSeparatedPoints",E))),J=NaN,_e=[-1,-1],j,me=mn(H),ct="rgba("+me.r+","+me.g+","+me.b+","+L+")";C.fillStyle=ct,C.beginPath();var Oe,Dt=!0;(be.length>2*t.width_||Ye.FORCE_FAST_PROXY)&&(C=ke._fastCanvasProxy(C));for(var je=[],ye;q.hasNext;){if(ye=q.next(),!vl(ye.y)&&!O){g(C,J,_e[1],je),je=[],J=NaN,ye.y_stacked!==null&&!isNaN(ye.y_stacked)&&(f[ye.canvasx]=o.h*ye.y_stacked+o.y);continue}if(m){if(!Dt&&Oe==ye.xval)continue;Dt=!1,Oe=ye.xval,_=f[ye.canvasx];var Mi;_===void 0?Mi=Q:x?Mi=_[0]:Mi=_,j=[ye.canvasy,Mi],O?_e[0]===-1?f[ye.canvasx]=[ye.canvasy,Q]:f[ye.canvasx]=[ye.canvasy,_e[0]]:f[ye.canvasx]=ye.canvasy}else isNaN(ye.canvasy)&&O?j=[o.y+o.h,Q]:j=[ye.canvasy,Q];isNaN(J)?(C.moveTo(ye.canvasx,j[1]),C.lineTo(ye.canvasx,j[0])):(O&&C.lineTo(ye.canvasx,_e[0]),C.lineTo(ye.canvasx,j[0]),m&&(je.push([J,_e[1]]),x&&_?je.push([ye.canvasx,_[1]]):je.push([ye.canvasx,j[1]]))),_e=j,J=ye.canvasx}x=O,j&&ye&&(g(C,ye.canvasx,j[1],je),je=[]),C.fill()}}}};var Di=ke;var w0=100,ve={};ve.maybeTreatMouseOpAsClick=function(e,t,i){i.dragEndX=ln(e,i),i.dragEndY=sn(e,i);var n=Math.abs(i.dragEndX-i.dragStartX),a=Math.abs(i.dragEndY-i.dragStartY);n<2&&a<2&&t.lastx_!==void 0&&t.lastx_!==null&&ve.treatMouseOpAsClick(t,e,i),i.regionWidth=n,i.regionHeight=a};ve.startPan=function(e,t,i){var n,a;i.isPanning=!0;var o=t.xAxisRange();if(t.getOptionForAxis("logscale","x")?(i.initialLeftmostDate=Se(o[0]),i.dateRange=Se(o[1])-Se(o[0])):(i.initialLeftmostDate=o[0],i.dateRange=o[1]-o[0]),i.xUnitsPerPixel=i.dateRange/(t.plotter_.area.w-1),t.getNumericOption("panEdgeFraction")){var r=t.width_*t.getNumericOption("panEdgeFraction"),p=t.xAxisExtremes(),m=t.toDomXCoord(p[0])-r,u=t.toDomXCoord(p[1])+r,f=t.toDataXCoord(m),_=t.toDataXCoord(u);i.boundedDates=[f,_];var x=[],g=t.height_*t.getNumericOption("panEdgeFraction");for(n=0;n<t.axes_.length;n++){a=t.axes_[n];var S=a.extremeRange,C=t.toDomYCoord(S[0],n)+g,E=t.toDomYCoord(S[1],n)-g,L=t.toDataYCoord(C,n),O=t.toDataYCoord(E,n);x[n]=[L,O]}i.boundedValues=x}else i.boundedDates=null,i.boundedValues=null;for(i.is2DPan=!1,i.axes=[],n=0;n<t.axes_.length;n++){a=t.axes_[n];var H={},z=t.yAxisRange(n),Q=t.attributes_.getForAxis("logscale",n);Q?(H.initialTopValue=Se(z[1]),H.dragValueRange=Se(z[1])-Se(z[0])):(H.initialTopValue=z[1],H.dragValueRange=z[1]-z[0]),H.unitsPerPixel=H.dragValueRange/(t.plotter_.area.h-1),i.axes.push(H),a.valueRange&&(i.is2DPan=!0)}};ve.movePan=function(e,t,i){i.dragEndX=ln(e,i),i.dragEndY=sn(e,i);var n=i.initialLeftmostDate-(i.dragEndX-i.dragStartX)*i.xUnitsPerPixel;i.boundedDates&&(n=Math.max(n,i.boundedDates[0]));var a=n+i.dateRange;if(i.boundedDates&&a>i.boundedDates[1]&&(n=n-(a-i.boundedDates[1]),a=n+i.dateRange),t.getOptionForAxis("logscale","x")?t.dateWindow_=[Math.pow(bi,n),Math.pow(bi,a)]:t.dateWindow_=[n,a],i.is2DPan)for(var o=i.dragEndY-i.dragStartY,r=0;r<t.axes_.length;r++){var p=t.axes_[r],m=i.axes[r],u=o*m.unitsPerPixel,f=i.boundedValues?i.boundedValues[r]:null,_=m.initialTopValue+u;f&&(_=Math.min(_,f[1]));var x=_-m.dragValueRange;f&&x<f[0]&&(_=_-(x-f[0]),x=_-m.dragValueRange),t.attributes_.getForAxis("logscale",r)?p.valueRange=[Math.pow(bi,x),Math.pow(bi,_)]:p.valueRange=[x,_]}t.drawGraph_(!1)};ve.endPan=ve.maybeTreatMouseOpAsClick;ve.startZoom=function(e,t,i){i.isZooming=!0,i.zoomMoved=!1};ve.moveZoom=function(e,t,i){i.zoomMoved=!0,i.dragEndX=ln(e,i),i.dragEndY=sn(e,i);var n=Math.abs(i.dragStartX-i.dragEndX),a=Math.abs(i.dragStartY-i.dragEndY);i.dragDirection=n<a/2?nn:tn,t.drawZoomRect_(i.dragDirection,i.dragStartX,i.dragEndX,i.dragStartY,i.dragEndY,i.prevDragDirection,i.prevEndX,i.prevEndY),i.prevEndX=i.dragEndX,i.prevEndY=i.dragEndY,i.prevDragDirection=i.dragDirection};ve.treatMouseOpAsClick=function(e,t,i){for(var n=e.getFunctionOption("clickCallback"),a=e.getFunctionOption("pointClickCallback"),o=null,r=-1,p=Number.MAX_VALUE,m=0;m<e.selPoints_.length;m++){var u=e.selPoints_[m],f=Math.pow(u.canvasx-i.dragEndX,2)+Math.pow(u.canvasy-i.dragEndY,2);!isNaN(f)&&(r==-1||f<p)&&(p=f,r=m)}var _=e.getNumericOption("highlightCircleSize")+2;if(p<=_*_&&(o=e.selPoints_[r]),o){var g={cancelable:!0,point:o,canvasx:i.dragEndX,canvasy:i.dragEndY},x=e.cascadeEvents_("pointClick",g);if(x)return;a&&a.call(e,t,o)}var g={cancelable:!0,xval:e.lastx_,pts:e.selPoints_,canvasx:i.dragEndX,canvasy:i.dragEndY};e.cascadeEvents_("click",g)||n&&n.call(e,t,e.lastx_,e.selPoints_)};ve.endZoom=function(e,t,i){t.clearZoomRect_(),i.isZooming=!1,ve.maybeTreatMouseOpAsClick(e,t,i);var n=t.getArea();if(i.regionWidth>=10&&i.dragDirection==tn){var a=Math.min(i.dragStartX,i.dragEndX),o=Math.max(i.dragStartX,i.dragEndX);a=Math.max(a,n.x),o=Math.min(o,n.x+n.w),a<o&&t.doZoomX_(a,o),i.cancelNextDblclick=!0}else if(i.regionHeight>=10&&i.dragDirection==nn){var r=Math.min(i.dragStartY,i.dragEndY),p=Math.max(i.dragStartY,i.dragEndY);r=Math.max(r,n.y),p=Math.min(p,n.y+n.h),r<p&&t.doZoomY_(r,p),i.cancelNextDblclick=!0}i.dragStartX=null,i.dragStartY=null};ve.startTouch=function(e,t,i){e.preventDefault(),e.touches.length>1&&(i.startTimeForDoubleTapMs=null);for(var n=[],a=0;a<e.touches.length;a++){var o=e.touches[a],r=o.target.getBoundingClientRect();n.push({pageX:o.pageX,pageY:o.pageY,dataX:t.toDataXCoord(o.clientX-r.left),dataY:t.toDataYCoord(o.clientY-r.top)})}if(i.initialTouches=n,n.length==1)i.initialPinchCenter=n[0],i.touchDirections={x:!0,y:!0};else if(n.length>=2){i.initialPinchCenter={pageX:.5*(n[0].pageX+n[1].pageX),pageY:.5*(n[0].pageY+n[1].pageY),dataX:.5*(n[0].dataX+n[1].dataX),dataY:.5*(n[0].dataY+n[1].dataY)};var p=180/Math.PI*Math.atan2(i.initialPinchCenter.pageY-n[0].pageY,n[0].pageX-i.initialPinchCenter.pageX);p=Math.abs(p),p>90&&(p=90-p),i.touchDirections={x:p<90-45/2,y:p>45/2}}i.initialRange={x:t.xAxisRange(),y:t.yAxisRange()}};ve.moveTouch=function(e,t,i){i.startTimeForDoubleTapMs=null;var n,a=[];for(n=0;n<e.touches.length;n++){var o=e.touches[n];a.push({pageX:o.pageX,pageY:o.pageY})}var r=i.initialTouches,p,m=i.initialPinchCenter;a.length==1?p=a[0]:p={pageX:.5*(a[0].pageX+a[1].pageX),pageY:.5*(a[0].pageY+a[1].pageY)};var u={pageX:p.pageX-m.pageX,pageY:p.pageY-m.pageY},f=i.initialRange.x[1]-i.initialRange.x[0],_=i.initialRange.y[0]-i.initialRange.y[1];u.dataX=u.pageX/t.plotter_.area.w*f,u.dataY=u.pageY/t.plotter_.area.h*_;var x,g;if(a.length==1)x=1,g=1;else if(a.length>=2){var S=r[1].pageX-m.pageX;x=(a[1].pageX-p.pageX)/S;var C=r[1].pageY-m.pageY;g=(a[1].pageY-p.pageY)/C}x=Math.min(8,Math.max(.125,x)),g=Math.min(8,Math.max(.125,g));var E=!1;if(i.touchDirections.x){var L=m.dataX-u.dataX/x;t.dateWindow_=[L+(i.initialRange.x[0]-m.dataX)/x,L+(i.initialRange.x[1]-m.dataX)/x],E=!0}if(i.touchDirections.y)for(n=0;n<1;n++){var O=t.axes_[n],H=t.attributes_.getForAxis("logscale",n);if(!H){var L=m.dataY-u.dataY/g;O.valueRange=[L+(i.initialRange.y[0]-m.dataY)/g,L+(i.initialRange.y[1]-m.dataY)/g],E=!0}}if(t.drawGraph_(!1),E&&a.length>1&&t.getFunctionOption("zoomCallback")){var z=t.xAxisRange();t.getFunctionOption("zoomCallback").call(t,z[0],z[1],t.yAxisRanges())}};ve.endTouch=function(e,t,i){if(e.touches.length!==0)ve.startTouch(e,t,i);else if(e.changedTouches.length==1){var n=new Date().getTime(),a=e.changedTouches[0];i.startTimeForDoubleTapMs&&n-i.startTimeForDoubleTapMs<500&&i.doubleTapX&&Math.abs(i.doubleTapX-a.screenX)<50&&i.doubleTapY&&Math.abs(i.doubleTapY-a.screenY)<50?t.resetZoom():(i.startTimeForDoubleTapMs=n,i.doubleTapX=a.screenX,i.doubleTapY=a.screenY)}};var Tl=function(e,t,i){return e<t?t-e:e>i?e-i:0},T0=function(e,t){var i=ui(t.canvas_),n={left:i.x,right:i.x+t.canvas_.offsetWidth,top:i.y,bottom:i.y+t.canvas_.offsetHeight},a={x:on(e),y:rn(e)},o=Tl(a.x,n.left,n.right),r=Tl(a.y,n.top,n.bottom);return Math.max(o,r)};ve.defaultModel={mousedown:function(e,t,i){if(!(e.button&&e.button==2)){i.initializeMouseDown(e,t,i),e.altKey||e.shiftKey?ve.startPan(e,t,i):ve.startZoom(e,t,i);var n=function(o){if(i.isZooming){var r=T0(o,t);r<w0?ve.moveZoom(o,t,i):i.dragEndX!==null&&(i.dragEndX=null,i.dragEndY=null,t.clearZoomRect_())}else i.isPanning&&ve.movePan(o,t,i)},a=function(o){i.isZooming?i.dragEndX!==null?ve.endZoom(o,t,i):ve.maybeTreatMouseOpAsClick(o,t,i):i.isPanning&&ve.endPan(o,t,i),Pt(document,"mousemove",n),Pt(document,"mouseup",a),i.destroy()};t.addAndTrackEvent(document,"mousemove",n),t.addAndTrackEvent(document,"mouseup",a)}},willDestroyContextMyself:!0,touchstart:function(e,t,i){ve.startTouch(e,t,i)},touchmove:function(e,t,i){ve.moveTouch(e,t,i)},touchend:function(e,t,i){ve.endTouch(e,t,i)},dblclick:function(e,t,i){if(i.cancelNextDblclick){i.cancelNextDblclick=!1;return}var n={canvasx:i.dragEndX,canvasy:i.dragEndY,cancelable:!0};t.cascadeEvents_("dblclick",n)||e.altKey||e.shiftKey||t.resetZoom()}};ve.nonInteractiveModel_={mousedown:function(e,t,i){i.initializeMouseDown(e,t,i)},mouseup:ve.maybeTreatMouseOpAsClick};ve.dragIsPanInteractionModel={mousedown:function(e,t,i){i.initializeMouseDown(e,t,i),ve.startPan(e,t,i)},mousemove:function(e,t,i){i.isPanning&&ve.movePan(e,t,i)},mouseup:function(e,t,i){i.isPanning&&ve.endPan(e,t,i)}};var Et=ve;var D0={highlightCircleSize:3,highlightSeriesOpts:null,highlightSeriesBackgroundAlpha:.5,highlightSeriesBackgroundColor:"rgb(255, 255, 255)",labelsSeparateLines:!1,labelsShowZeroValues:!0,labelsKMB:!1,labelsKMG2:!1,showLabelsOnHighlight:!0,digitsAfterDecimal:2,maxNumberWidth:6,sigFigs:null,strokeWidth:1,strokeBorderWidth:0,strokeBorderColor:"white",axisTickSize:3,axisLabelFontSize:14,rightGap:5,showRoller:!1,xValueParser:void 0,delimiter:",",sigma:2,errorBars:!1,fractions:!1,wilsonInterval:!0,customBars:!1,fillGraph:!1,fillAlpha:.15,connectSeparatedPoints:!1,stackedGraph:!1,stackedGraphNaNFill:"all",hideOverlayOnMouseOut:!0,resizable:"no",legend:"onmouseover",legendFollowOffsetX:50,legendFollowOffsetY:-50,stepPlot:!1,xRangePad:0,yRangePad:null,drawAxesAtZero:!1,titleHeight:28,xLabelHeight:18,yLabelWidth:18,axisLineColor:"black",axisLineWidth:.3,gridLineWidth:.3,axisLabelWidth:50,gridLineColor:"rgb(128,128,128)",interactionModel:Et.defaultModel,animatedZooms:!1,animateBackgroundFade:!0,showRangeSelector:!1,rangeSelectorHeight:40,rangeSelectorPlotStrokeColor:"#808FAB",rangeSelectorPlotFillGradientColor:"white",rangeSelectorPlotFillColor:"#A7B1C4",rangeSelectorBackgroundStrokeColor:"gray",rangeSelectorBackgroundLineWidth:1,rangeSelectorPlotLineWidth:1.5,rangeSelectorForegroundStrokeColor:"black",rangeSelectorForegroundLineWidth:1,rangeSelectorAlpha:.6,showInRangeSelector:null,plotter:[Di._fillPlotter,Di._errorPlotter,Di._linePlotter],plugins:[],axes:{x:{pixelsPerLabel:70,axisLabelWidth:60,axisLabelFormatter:Ti,valueFormatter:dn,drawGrid:!0,drawAxis:!0,independentTicks:!0,ticker:Ci},y:{axisLabelWidth:50,pixelsPerLabel:30,valueFormatter:La,axisLabelFormatter:wn,drawGrid:!0,drawAxis:!0,independentTicks:!0,ticker:ti},y2:{axisLabelWidth:50,pixelsPerLabel:30,valueFormatter:La,axisLabelFormatter:wn,drawAxis:!0,drawGrid:!1,independentTicks:!1,ticker:ti}}},un=D0;var pt=function(e){this.dygraph_=e,this.yAxes_=[],this.xAxis_={},this.series_={},this.global_=this.dygraph_.attrs_,this.user_=this.dygraph_.user_attrs_||{},this.labels_=[],this.highlightSeries_=this.get("highlightSeriesOpts")||{},this.reparseSeries()};pt.AXIS_STRING_MAPPINGS_={y:0,Y:0,y1:0,Y1:0,y2:1,Y2:1};pt.axisToIndex_=function(e){if(typeof e=="string"){if(pt.AXIS_STRING_MAPPINGS_.hasOwnProperty(e))return pt.AXIS_STRING_MAPPINGS_[e];throw"Unknown axis : "+e}if(typeof e=="number"){if(e===0||e===1)return e;throw"Dygraphs only supports two y-axes, indexed from 0-1."}if(e)throw"Unknown axis : "+e;return 0};pt.prototype.reparseSeries=function(){var e=this.get("labels");if(e){this.labels_=e.slice(1),this.yAxes_=[{series:[],options:{}}],this.xAxis_={options:{}},this.series_={};for(var t=this.user_.series||{},i=0;i<this.labels_.length;i++){var n=this.labels_[i],a=t[n]||{},o=pt.axisToIndex_(a.axis);this.series_[n]={idx:i,yAxis:o,options:a},this.yAxes_[o]?this.yAxes_[o].series.push(n):this.yAxes_[o]={series:[n],options:{}}}var r=this.user_.axes||{};xt(this.yAxes_[0].options,r.y||{}),this.yAxes_.length>1&&xt(this.yAxes_[1].options,r.y2||{}),xt(this.xAxis_.options,r.x||{}),typeof process<"u"}};pt.prototype.get=function(e){var t=this.getGlobalUser_(e);return t!==null?t:this.getGlobalDefault_(e)};pt.prototype.getGlobalUser_=function(e){return this.user_.hasOwnProperty(e)?this.user_[e]:null};pt.prototype.getGlobalDefault_=function(e){return this.global_.hasOwnProperty(e)?this.global_[e]:un.hasOwnProperty(e)?un[e]:null};pt.prototype.getForAxis=function(e,t){var i,n;if(typeof t=="number")i=t,n=i===0?"y":"y2";else{if(t=="y1"&&(t="y"),t=="y")i=0;else if(t=="y2")i=1;else if(t=="x")i=-1;else throw"Unknown axis "+t;n=t}var a=i==-1?this.xAxis_:this.yAxes_[i];if(a){var o=a.options;if(o.hasOwnProperty(e))return o[e]}if(!(t==="x"&&e==="logscale")){var r=this.getGlobalUser_(e);if(r!==null)return r}var p=un.axes[n];return p.hasOwnProperty(e)?p[e]:this.getGlobalDefault_(e)};pt.prototype.getForSeries=function(e,t){if(t===this.dygraph_.getHighlightSeries()&&this.highlightSeries_.hasOwnProperty(e))return this.highlightSeries_[e];if(!this.series_.hasOwnProperty(t))throw"Unknown series: "+t;var i=this.series_[t],n=i.options;return n.hasOwnProperty(e)?n[e]:this.getForAxis(e,i.yAxis)};pt.prototype.numAxes=function(){return this.yAxes_.length};pt.prototype.axisForSeries=function(e){return this.series_[e].yAxis};pt.prototype.axisOptions=function(e){return this.yAxes_[e].options};pt.prototype.seriesForAxis=function(e){return this.yAxes_[e].series};pt.prototype.seriesNames=function(){return this.labels_};var Dl=pt;function bo(){this.tarps=[]}bo.prototype.cover=function(){for(var e=document.getElementsByTagName("iframe"),t=0;t<e.length;t++){var i=e[t],n=ui(i),a=n.x,o=n.y,r=i.offsetWidth,p=i.offsetHeight,m=document.createElement("div");m.style.position="absolute",m.style.left=a+"px",m.style.top=o+"px",m.style.width=r+"px",m.style.height=p+"px",m.style.zIndex=999,document.body.appendChild(m),this.tarps.push(m)}};bo.prototype.uncover=function(){for(var e=0;e<this.tarps.length;e++)this.tarps[e].parentNode.removeChild(this.tarps[e]);this.tarps=[]};var Ia=bo;var Pl=function(){},Vt=Pl;Vt.X=0;Vt.Y=1;Vt.EXTRAS=2;Vt.prototype.extractSeries=function(e,t,i){};Vt.prototype.seriesToPoints=function(e,t,i){for(var n=[],a=0;a<e.length;++a){var o=e[a],r=o[1],p=r===null?null:Vt.parseFloat(r),m={x:NaN,y:NaN,xval:Vt.parseFloat(o[0]),yval:p,name:t,idx:a+i,canvasx:NaN,canvasy:NaN};n.push(m)}return this.onPointsCreated_(e,n),n};Vt.prototype.onPointsCreated_=function(e,t){};Vt.prototype.rollingAverage=function(e,t,i,n){};Vt.prototype.getExtremeYValues=function(e,t,i){};Vt.prototype.onLineEvaluated=function(e,t,i){};Vt.parseFloat=function(e){return e===null?NaN:e};var Pi=Pl;var Dn=function(){};Dn.prototype=new Pi;Dn.prototype.extractSeries=function(e,t,i){var n=[];let a=i.get("labels")[t],o=i.getForSeries("logscale",a);for(var r=0;r<e.length;r++){var p=e[r][0],m=e[r][t];o&&m<=0&&(m=null),n.push([p,m])}return n};Dn.prototype.rollingAverage=function(e,t,i,o){t=Math.min(t,e.length);var a=[],o,r,p,m,u;if(t==1)return e;for(o=0;o<e.length;o++){for(m=0,u=0,r=Math.max(0,o-t+1);r<o+1;r++)p=e[r][1],!(p===null||isNaN(p))&&(u++,m+=e[r][1]);u?a[o]=[e[o][0],m/u]:a[o]=[e[o][0],null]}return a};Dn.prototype.getExtremeYValues=function(t,i,n){for(var a=null,o=null,r,p=0,m=t.length-1,u=p;u<=m;u++)r=t[u][1],!(r===null||isNaN(r))&&((o===null||r>o)&&(o=r),(a===null||r<a)&&(a=r));return[a,o]};var Pn=Dn;var Ei=function(){Pi.call(this)};Ei.prototype=new Pi;Ei.prototype.extractSeries=function(e,t,i){};Ei.prototype.rollingAverage=function(e,t,i,n){};Ei.prototype.onPointsCreated_=function(e,t){for(var i=0;i<e.length;++i){var n=e[i],a=t[i];a.y_top=NaN,a.y_bottom=NaN,a.yval_minus=Pi.parseFloat(n[2][0]),a.yval_plus=Pi.parseFloat(n[2][1])}};Ei.prototype.getExtremeYValues=function(e,t,i){for(var n=null,a=null,o,r=0,p=e.length-1,m=r;m<=p;m++)if(o=e[m][1],!(o===null||isNaN(o))){var u=e[m][2][0],f=e[m][2][1];u>o&&(u=o),f<o&&(f=o),(a===null||f>a)&&(a=f),(n===null||u<n)&&(n=u)}return[n,a]};Ei.prototype.onLineEvaluated=function(e,t,i){for(var n,a=0;a<e.length;a++)n=e[a],n.y_top=Tn.calcYNormal_(t,n.yval_minus,i),n.y_bottom=Tn.calcYNormal_(t,n.yval_plus,i)};var hi=Ei;var Oa=function(){};Oa.prototype=new hi;Oa.prototype.extractSeries=function(e,t,i){var n=[],a,o,r,p;let m=i.get("labels")[t],u=i.getForSeries("logscale",m),f=i.getForSeries("sigma",m);for(var _=0;_<e.length;_++)a=e[_][0],p=e[_][t],u&&p!==null&&(p[0]<=0||p[0]-f*p[1]<=0)&&(p=null),p!==null?(o=p[0],o!==null&&!isNaN(o)?(r=f*p[1],n.push([a,o,[o-r,o+r,p[1]]])):n.push([a,o,[o,o,o]])):n.push([a,null,[null,null,null]]);return n};Oa.prototype.rollingAverage=function(e,t,i,p){t=Math.min(t,e.length);var a=[];let o=i.get("labels")[p],r=i.getForSeries("sigma",o);var p,m,u,f,_,x,g,S,C;for(p=0;p<e.length;p++){for(_=0,S=0,x=0,m=Math.max(0,p-t+1);m<p+1;m++)u=e[m][1],!(u===null||isNaN(u))&&(x++,_+=u,S+=Math.pow(e[m][2][2],2));x?(g=Math.sqrt(S)/x,C=_/x,a[p]=[e[p][0],C,[C-r*g,C+r*g]]):(f=t==1?e[p][1]:null,a[p]=[e[p][0],f,[f,f]])}return a};var So=Oa;var Fa=function(){};Fa.prototype=new hi;Fa.prototype.extractSeries=function(e,t,i){var n=[],a,o,r;let p=i.get("labels")[t],m=i.getForSeries("logscale",p);for(var u=0;u<e.length;u++)a=e[u][0],r=e[u][t],m&&r!==null&&(r[0]<=0||r[1]<=0||r[2]<=0)&&(r=null),r!==null?(o=r[1],o!==null&&!isNaN(o)?n.push([a,o,[r[0],r[2]]]):n.push([a,o,[o,o]])):n.push([a,null,[null,null]]);return n};Fa.prototype.rollingAverage=function(e,t,i,f){t=Math.min(t,e.length);var a=[],o,r,p,m,u,f,_;for(r=0,m=0,p=0,u=0,f=0;f<e.length;f++){if(o=e[f][1],_=e[f][2],a[f]=e[f],o!==null&&!isNaN(o)&&(r+=_[0],m+=o,p+=_[1],u+=1),f-t>=0){var x=e[f-t];x[1]!==null&&!isNaN(x[1])&&(r-=x[2][0],m-=x[1],p-=x[2][1],u-=1)}u?a[f]=[e[f][0],1*m/u,[1*r/u,1*p/u]]:a[f]=[e[f][0],null,[null,null]]}return a};var wo=Fa;var Va=function(){};Va.prototype=new Pn;Va.prototype.extractSeries=function(e,t,i){var n=[],a,o,r,p,m,u,f=100;let _=i.get("labels")[t],x=i.getForSeries("logscale",_);for(var g=0;g<e.length;g++)a=e[g][0],r=e[g][t],x&&r!==null&&(r[0]<=0||r[1]<=0)&&(r=null),r!==null?(p=r[0],m=r[1],p!==null&&!isNaN(p)?(u=m?p/m:0,o=f*u,n.push([a,o,[p,m]])):n.push([a,p,[p,m]])):n.push([a,null,[null,null]]);return n};Va.prototype.rollingAverage=function(e,t,i,o){t=Math.min(t,e.length);var a=[],o,r=0,p=0,m=100;for(o=0;o<e.length;o++){r+=e[o][2][0],p+=e[o][2][1],o-t>=0&&(r-=e[o-t][2][0],p-=e[o-t][2][1]);var u=e[o][0],f=p?r/p:0;a[o]=[u,m*f]}return a};var To=Va;var Na=function(){};Na.prototype=new hi;Na.prototype.extractSeries=function(e,t,i){var n=[],a,o,r,p,m,u,f,_,x=100;let g=i.get("labels")[t],S=i.getForSeries("logscale",g),C=i.getForSeries("sigma",g);for(var E=0;E<e.length;E++)a=e[E][0],r=e[E][t],S&&r!==null&&(r[0]<=0||r[1]<=0)&&(r=null),r!==null?(p=r[0],m=r[1],p!==null&&!isNaN(p)?(u=m?p/m:0,f=m?C*Math.sqrt(u*(1-u)/m):1,_=x*f,o=x*u,n.push([a,o,[o-_,o+_,p,m]])):n.push([a,p,[p,p,p,m]])):n.push([a,null,[null,null,null,null]]);return n};Na.prototype.rollingAverage=function(e,t,i,f){t=Math.min(t,e.length);var a=[];let o=i.get("labels")[f],r=i.getForSeries("sigma",o),p=i.getForSeries("wilsonInterval",o);var m,u,f,_,x=0,g=0,S=100;for(f=0;f<e.length;f++){x+=e[f][2][2],g+=e[f][2][3],f-t>=0&&(x-=e[f-t][2][2],g-=e[f-t][2][3]);var C=e[f][0],E=g?x/g:0;if(p)if(g){var L=E<0?0:E,O=g,H=r*Math.sqrt(L*(1-L)/O+r*r/(4*O*O)),z=1+r*r/g;m=(L+r*r/(2*g)-H)/z,u=(L+r*r/(2*g)+H)/z,a[f]=[C,L*S,[m*S,u*S]]}else a[f]=[C,0,[0,0]];else _=g?r*Math.sqrt(E*(1-E)/g):1,a[f]=[C,S*E,[S*(E-_),S*(E+_)]]}return a};var Do=Na;var ki=function(){this.annotations_=[]};ki.prototype.toString=function(){return"Annotations Plugin"};ki.prototype.activate=function(e){return{clearChart:this.clearChart,didDrawChart:this.didDrawChart}};ki.prototype.detachLabels=function(){for(var e=0;e<this.annotations_.length;e++){var t=this.annotations_[e];t.parentNode&&t.parentNode.removeChild(t),this.annotations_[e]=null}this.annotations_=[]};ki.prototype.clearChart=function(e){this.detachLabels()};ki.prototype.didDrawChart=function(e){var t=e.dygraph,i=t.layout_.annotated_points;if(!(!i||i.length===0))for(var n=e.canvas.parentNode,a=function(z,Q,be){return function(q){var J=be.annotation;J.hasOwnProperty(z)?J[z](J,be,t,q):t.getOption(Q)&&t.getOption(Q)(J,be,t,q)}},o=e.dygraph.getArea(),r={},p=0;p<i.length;p++){var m=i[p];if(!(m.canvasx<o.x||m.canvasx>o.x+o.w||m.canvasy<o.y||m.canvasy>o.y+o.h)){var u=m.annotation,f=6;u.hasOwnProperty("tickHeight")&&(f=u.tickHeight);var _=document.createElement("div");_.style.fontSize=t.getOption("axisLabelFontSize")+"px";var x="dygraph-annotation";u.hasOwnProperty("icon")||(x+=" dygraphDefaultAnnotation dygraph-default-annotation"),u.hasOwnProperty("cssClass")&&(x+=" "+u.cssClass),_.className=x;var g=u.hasOwnProperty("width")?u.width:16,S=u.hasOwnProperty("height")?u.height:16;if(u.hasOwnProperty("icon")){var C=document.createElement("img");C.src=u.icon,C.width=g,C.height=S,_.appendChild(C)}else m.annotation.hasOwnProperty("shortText")&&_.appendChild(document.createTextNode(m.annotation.shortText));var E=m.canvasx-g/2;_.style.left=E+"px";var L=0;if(u.attachAtBottom){var O=o.y+o.h-S-f;r[E]?O-=r[E]:r[E]=0,r[E]+=f+S,L=O}else L=m.canvasy-S-f;_.style.top=L+"px",_.style.width=g+"px",_.style.height=S+"px",_.title=m.annotation.text,_.style.color=t.colorsMap_[m.name],_.style.borderColor=t.colorsMap_[m.name],u.div=_,t.addAndTrackEvent(_,"click",a("clickHandler","annotationClickHandler",m,this)),t.addAndTrackEvent(_,"mouseover",a("mouseOverHandler","annotationMouseOverHandler",m,this)),t.addAndTrackEvent(_,"mouseout",a("mouseOutHandler","annotationMouseOutHandler",m,this)),t.addAndTrackEvent(_,"dblclick",a("dblClickHandler","annotationDblClickHandler",m,this)),n.appendChild(_),this.annotations_.push(_);var H=e.drawingContext;if(H.save(),H.strokeStyle=u.hasOwnProperty("tickColor")?u.tickColor:t.colorsMap_[m.name],H.lineWidth=u.hasOwnProperty("tickWidth")?u.tickWidth:t.getOption("strokeWidth"),H.beginPath(),!u.attachAtBottom)H.moveTo(m.canvasx,m.canvasy),H.lineTo(m.canvasx,m.canvasy-2-f);else{var O=L+S;H.moveTo(m.canvasx,O),H.lineTo(m.canvasx,O+f)}H.closePath(),H.stroke(),H.restore()}}};ki.prototype.destroy=function(){this.detachLabels()};var Po=ki;var Ai=function(){this.xlabels_=[],this.ylabels_=[]};Ai.prototype.toString=function(){return"Axes Plugin"};Ai.prototype.activate=function(e){return{layout:this.layout,clearChart:this.clearChart,willDrawChart:this.willDrawChart}};Ai.prototype.layout=function(e){var t=e.dygraph;if(t.getOptionForAxis("drawAxis","y")){var i=t.getOptionForAxis("axisLabelWidth","y")+2*t.getOptionForAxis("axisTickSize","y");e.reserveSpaceLeft(i)}if(t.getOptionForAxis("drawAxis","x")){var n;t.getOption("xAxisHeight")?n=t.getOption("xAxisHeight"):n=t.getOptionForAxis("axisLabelFontSize","x")+2*t.getOptionForAxis("axisTickSize","x"),e.reserveSpaceBottom(n)}if(t.numAxes()==2){if(t.getOptionForAxis("drawAxis","y2")){var i=t.getOptionForAxis("axisLabelWidth","y2")+2*t.getOptionForAxis("axisTickSize","y2");e.reserveSpaceRight(i)}}else t.numAxes()>2&&t.error("Only two y-axes are supported at this time. (Trying to use "+t.numAxes()+")")};Ai.prototype.detachLabels=function(){function e(t){for(var i=0;i<t.length;i++){var n=t[i];n.parentNode&&n.parentNode.removeChild(n)}}e(this.xlabels_),e(this.ylabels_),this.xlabels_=[],this.ylabels_=[]};Ai.prototype.clearChart=function(e){this.detachLabels()};Ai.prototype.willDrawChart=function(e){var t=e.dygraph;if(!t.getOptionForAxis("drawAxis","x")&&!t.getOptionForAxis("drawAxis","y")&&!t.getOptionForAxis("drawAxis","y2"))return;function i(j){return Math.round(j)+.5}function n(j){return Math.round(j)-.5}var a=e.drawingContext,o=e.canvas.parentNode,r=t.width_,p=t.height_,m,u,f,_,x,g=function(j){return{position:"absolute",fontSize:t.getOptionForAxis("axisLabelFontSize",j)+"px",width:t.getOptionForAxis("axisLabelWidth",j)+"px"}},S={x:g("x"),y:g("y"),y2:g("y2")},C=function(j,me,ct){var Oe=document.createElement("div"),Dt=S[ct=="y2"?"y2":me];xt(Oe.style,Dt);var je=document.createElement("div");return je.className="dygraph-axis-label dygraph-axis-label-"+me+(ct?" dygraph-axis-label-"+ct:""),je.innerHTML=j,Oe.appendChild(je),Oe};a.save();var E=t.layout_,L=e.dygraph.plotter_.area,O=function(j){return function(me){return t.getOptionForAxis(me,j)}};let H=this;if(t.getOptionForAxis("drawAxis","y")||t.numAxes()==2&&t.getOptionForAxis("drawAxis","y2")){if(E.yticks&&E.yticks.length>0){var z=t.numAxes(),Q=[O("y"),O("y2")];E.yticks.forEach(function(j){if(j.label!==void 0){u=L.x;var me=1,ct="y1",Oe=Q[0];if(j.axis==1&&(u=L.x+L.w,me=-1,ct="y2",Oe=Q[1]),!!Oe("drawAxis")){var Dt=Oe("axisLabelFontSize");f=L.y+j.pos*L.h,m=C(j.label,"y",z==2?ct:null);var je=f-Dt/2;je<0&&(je=0),je+Dt+3>p?m.style.bottom="0":m.style.top=Math.min(je,p-2*Dt)+"px",j.axis===0?(m.style.left=L.x-Oe("axisLabelWidth")-Oe("axisTickSize")+"px",m.style.textAlign="right"):j.axis==1&&(m.style.left=L.x+L.w+Oe("axisTickSize")+"px",m.style.textAlign="left"),m.style.width=Oe("axisLabelWidth")+"px",o.appendChild(m),H.ylabels_.push(m)}}})}var be;if(t.getOption("drawAxesAtZero")){var q=t.toPercentXCoord(0);(q>1||q<0||isNaN(q))&&(q=0),be=i(L.x+q*L.w)}else be=i(L.x);a.strokeStyle=t.getOptionForAxis("axisLineColor","y"),a.lineWidth=t.getOptionForAxis("axisLineWidth","y"),a.beginPath(),a.moveTo(be,n(L.y)),a.lineTo(be,n(L.y+L.h)),a.closePath(),a.stroke(),t.numAxes()==2&&t.getOptionForAxis("drawAxis","y2")&&(a.strokeStyle=t.getOptionForAxis("axisLineColor","y2"),a.lineWidth=t.getOptionForAxis("axisLineWidth","y2"),a.beginPath(),a.moveTo(n(L.x+L.w),n(L.y)),a.lineTo(n(L.x+L.w),n(L.y+L.h)),a.closePath(),a.stroke())}if(t.getOptionForAxis("drawAxis","x")){if(E.xticks){var J=O("x");E.xticks.forEach(function(j){if(j.label!==void 0){u=L.x+j.pos*L.w,f=L.y+L.h,m=C(j.label,"x"),m.style.textAlign="center",m.style.top=f+J("axisTickSize")+"px";var me=u-J("axisLabelWidth")/2;me+J("axisLabelWidth")>r&&(me=r-J("axisLabelWidth"),m.style.textAlign="right"),me<0&&(me=0,m.style.textAlign="left"),m.style.left=me+"px",m.style.width=J("axisLabelWidth")+"px",o.appendChild(m),H.xlabels_.push(m)}})}a.strokeStyle=t.getOptionForAxis("axisLineColor","x"),a.lineWidth=t.getOptionForAxis("axisLineWidth","x"),a.beginPath();var _e;if(t.getOption("drawAxesAtZero")){var q=t.toPercentYCoord(0,0);(q>1||q<0)&&(q=1),_e=n(L.y+q*L.h)}else _e=n(L.y+L.h);a.moveTo(i(L.x),_e),a.lineTo(i(L.x+L.w),_e),a.closePath(),a.stroke()}a.restore()};var Eo=Ai;var fi=function(){this.title_div_=null,this.xlabel_div_=null,this.ylabel_div_=null,this.y2label_div_=null};fi.prototype.toString=function(){return"ChartLabels Plugin"};fi.prototype.activate=function(e){return{layout:this.layout,didDrawChart:this.didDrawChart}};var El=function(e){var t=document.createElement("div");return t.style.position="absolute",t.style.left=e.x+"px",t.style.top=e.y+"px",t.style.width=e.w+"px",t.style.height=e.h+"px",t};fi.prototype.detachLabels_=function(){for(var e=[this.title_div_,this.xlabel_div_,this.ylabel_div_,this.y2label_div_],t=0;t<e.length;t++){var i=e[t];i&&i.parentNode&&i.parentNode.removeChild(i)}this.title_div_=null,this.xlabel_div_=null,this.ylabel_div_=null,this.y2label_div_=null};var kl=function(e,t,i,n,a){var o=document.createElement("div");o.style.position="absolute",i==1?o.style.left="0px":o.style.left=t.x+"px",o.style.top=t.y+"px",o.style.width=t.w+"px",o.style.height=t.h+"px",o.style.fontSize=e.getOption("yLabelWidth")-2+"px";var r=document.createElement("div");r.style.position="absolute",r.style.width=t.h+"px",r.style.height=t.w+"px",r.style.top=t.h/2-t.w/2+"px",r.style.left=t.w/2-t.h/2+"px",r.className="dygraph-label-rotate-"+(i==1?"right":"left");var p=document.createElement("div");return p.className=n,p.innerHTML=a,r.appendChild(p),o.appendChild(r),o};fi.prototype.layout=function(e){this.detachLabels_();var t=e.dygraph,i=e.chart_div;if(t.getOption("title")){var n=e.reserveSpaceTop(t.getOption("titleHeight"));this.title_div_=El(n),this.title_div_.style.fontSize=t.getOption("titleHeight")-8+"px";var a=document.createElement("div");a.className="dygraph-label dygraph-title",a.innerHTML=t.getOption("title"),this.title_div_.appendChild(a),i.appendChild(this.title_div_)}if(t.getOption("xlabel")){var o=e.reserveSpaceBottom(t.getOption("xLabelHeight"));this.xlabel_div_=El(o),this.xlabel_div_.style.fontSize=t.getOption("xLabelHeight")-2+"px";var a=document.createElement("div");a.className="dygraph-label dygraph-xlabel",a.innerHTML=t.getOption("xlabel"),this.xlabel_div_.appendChild(a),i.appendChild(this.xlabel_div_)}if(t.getOption("ylabel")){var r=e.reserveSpaceLeft(0);this.ylabel_div_=kl(t,r,1,"dygraph-label dygraph-ylabel",t.getOption("ylabel")),i.appendChild(this.ylabel_div_)}if(t.getOption("y2label")&&t.numAxes()==2){var p=e.reserveSpaceRight(0);this.y2label_div_=kl(t,p,2,"dygraph-label dygraph-y2label",t.getOption("y2label")),i.appendChild(this.y2label_div_)}};fi.prototype.didDrawChart=function(e){var t=e.dygraph;this.title_div_&&(this.title_div_.children[0].innerHTML=t.getOption("title")),this.xlabel_div_&&(this.xlabel_div_.children[0].innerHTML=t.getOption("xlabel")),this.ylabel_div_&&(this.ylabel_div_.children[0].children[0].innerHTML=t.getOption("ylabel")),this.y2label_div_&&(this.y2label_div_.children[0].children[0].innerHTML=t.getOption("y2label"))};fi.prototype.clearChart=function(){};fi.prototype.destroy=function(){this.detachLabels_()};var ko=fi;var En=function(){};En.prototype.toString=function(){return"Gridline Plugin"};En.prototype.activate=function(e){return{willDrawChart:this.willDrawChart}};En.prototype.willDrawChart=function(e){var t=e.dygraph,i=e.drawingContext,n=t.layout_,a=e.dygraph.plotter_.area;function o(L){return Math.round(L)+.5}function r(L){return Math.round(L)-.5}var p,m,u,f;if(t.getOptionForAxis("drawGrid","y")){for(var _=["y","y2"],x=[],g=[],S=[],C=[],E=[],u=0;u<_.length;u++)S[u]=t.getOptionForAxis("drawGrid",_[u]),S[u]&&(x[u]=t.getOptionForAxis("gridLineColor",_[u]),g[u]=t.getOptionForAxis("gridLineWidth",_[u]),E[u]=t.getOptionForAxis("gridLinePattern",_[u]),C[u]=E[u]&&E[u].length>=2);f=n.yticks,i.save(),f.forEach(L=>{if(L.has_tick){var O=L.axis;S[O]&&(i.save(),C[O]&&i.setLineDash&&i.setLineDash(E[O]),i.strokeStyle=x[O],i.lineWidth=g[O],p=o(a.x),m=r(a.y+L.pos*a.h),i.beginPath(),i.moveTo(p,m),i.lineTo(p+a.w,m),i.stroke(),i.restore())}}),i.restore()}if(t.getOptionForAxis("drawGrid","x")){f=n.xticks,i.save();var E=t.getOptionForAxis("gridLinePattern","x"),C=E&&E.length>=2;C&&i.setLineDash&&i.setLineDash(E),i.strokeStyle=t.getOptionForAxis("gridLineColor","x"),i.lineWidth=t.getOptionForAxis("gridLineWidth","x"),f.forEach(H=>{H.has_tick&&(p=o(a.x+H.pos*a.w),m=r(a.y+a.h),i.beginPath(),i.moveTo(p,m),i.lineTo(p,a.y),i.stroke())}),C&&i.setLineDash&&i.setLineDash([]),i.restore()}};En.prototype.destroy=function(){};var Ao=En;var kt=function(){this.legend_div_=null,this.is_generated_div_=!1};kt.prototype.toString=function(){return"Legend Plugin"};kt.prototype.activate=function(e){var t,i=e.getOption("labelsDiv");return i&&i!==null?typeof i=="string"||i instanceof String?t=document.getElementById(i):t=i:(t=document.createElement("div"),t.className="dygraph-legend",e.graphDiv.appendChild(t),this.is_generated_div_=!0),this.legend_div_=t,this.one_em_width_=10,{select:this.select,deselect:this.deselect,predraw:this.predraw,didDrawChart:this.didDrawChart}};var P0=function(e){var t=document.createElement("span");t.setAttribute("style","margin: 0; padding: 0 0 0 1em; border: 0;"),e.appendChild(t);var i=t.offsetWidth;return e.removeChild(t),i},E0=function(e){return e.replace(/&/g,"&amp;").replace(/"/g,"&#34;").replace(/</g,"&lt;").replace(/>/g,"&gt;")};kt.prototype.select=function(e){var t=e.selectedX,i=e.selectedPoints,n=e.selectedRow,a=e.dygraph.getOption("legend");if(a==="never"){this.legend_div_.style.display="none";return}var o=kt.generateLegendHTML(e.dygraph,t,i,this.one_em_width_,n);if(o instanceof Node&&o.nodeType===Node.DOCUMENT_FRAGMENT_NODE?(this.legend_div_.innerHTML="",this.legend_div_.appendChild(o)):this.legend_div_.innerHTML=o,this.legend_div_.style.display="",a==="follow"){var r=e.dygraph.plotter_.area,p=this.legend_div_.offsetWidth,m=e.dygraph.getOptionForAxis("axisLabelWidth","y"),u=e.dygraph.getHighlightSeries(),f;u?(f=i.find(C=>C.name===u),f||(f=i[0])):f=i[0];let g=e.dygraph.getNumericOption("legendFollowOffsetX"),S=e.dygraph.getNumericOption("legendFollowOffsetY");var _=f.x*r.w+g,x=f.y*r.h+S;_+p+1>r.w&&(_=_-2*g-p-(m-r.x)),this.legend_div_.style.left=m+_+"px",this.legend_div_.style.top=x+"px"}else if(a==="onmouseover"&&this.is_generated_div_){var r=e.dygraph.plotter_.area,p=this.legend_div_.offsetWidth;this.legend_div_.style.left=r.x+r.w-p-1+"px",this.legend_div_.style.top=r.y+"px"}};kt.prototype.deselect=function(e){var t=e.dygraph.getOption("legend");t!=="always"&&(this.legend_div_.style.display="none");var i=P0(this.legend_div_);this.one_em_width_=i;var n=kt.generateLegendHTML(e.dygraph,void 0,void 0,i,null);n instanceof Node&&n.nodeType===Node.DOCUMENT_FRAGMENT_NODE?(this.legend_div_.innerHTML="",this.legend_div_.appendChild(n)):this.legend_div_.innerHTML=n};kt.prototype.didDrawChart=function(e){this.deselect(e)};kt.prototype.predraw=function(e){if(this.is_generated_div_){e.dygraph.graphDiv.appendChild(this.legend_div_);var t=e.dygraph.plotter_.area,i=this.legend_div_.offsetWidth;this.legend_div_.style.left=t.x+t.w-i-1+"px",this.legend_div_.style.top=t.y+"px"}};kt.prototype.destroy=function(){this.legend_div_=null};kt.generateLegendHTML=function(e,t,i,n,a){var o={dygraph:e,x:t,i:a,series:[]},r={},p=e.getLabels();if(p)for(var m=1;m<p.length;m++){var u=e.getPropertiesForSeries(p[m]),f=e.getOption("strokePattern",p[m]),_={dashHTML:k0(f,u.color,n),label:p[m],labelHTML:E0(p[m]),isVisible:u.visible,color:u.color};o.series.push(_),r[p[m]]=_}if(typeof t<"u"){var x=e.optionsViewForAxis_("x"),g=x("valueFormatter");o.xHTML=g.call(e,t,x,p[0],e,a,0);for(var S=[],C=e.numAxes(),m=0;m<C;m++)S[m]=e.optionsViewForAxis_("y"+(m?1+m:""));var E=e.getOption("labelsShowZeroValues"),L=e.getHighlightSeries();for(m=0;m<i.length;m++){var O=i[m],_=r[O.name];if(_.y=O.yval,O.yval===0&&!E||isNaN(O.canvasy)){_.isVisible=!1;continue}var u=e.getPropertiesForSeries(O.name),H=S[u.axis-1],z=H("valueFormatter"),Q=z.call(e,O.yval,H,O.name,e,a,p.indexOf(O.name));xt(_,{yHTML:Q}),O.name==L&&(_.isHighlighted=!0)}}var be=e.getOption("legendFormatter")||kt.defaultFormatter;return be.call(e,o)};kt.defaultFormatter=function(e){var t=e.dygraph;if(t.getOption("showLabelsOnHighlight")!==!0)return"";var i=t.getOption("labelsSeparateLines"),n;if(typeof e.x>"u"){if(t.getOption("legend")!="always")return"";n="";for(var a=0;a<e.series.length;a++){var o=e.series[a];o.isVisible&&(n!==""&&(n+=i?"<br />":" "),n+=`<span style='font-weight: bold; color: ${o.color};'>${o.dashHTML} ${o.labelHTML}</span>`)}return n}n=e.xHTML+":";for(var a=0;a<e.series.length;a++){var o=e.series[a];if(!(!o.y&&!o.yHTML)&&o.isVisible){i&&(n+="<br>");var r=o.isHighlighted?' class="highlight"':"";n+=`<span${r}> <b><span style='color: ${o.color};'>${o.labelHTML}</span></b>:&#160;${o.yHTML}</span>`}}return n};function k0(e,t,i){if(!e||e.length<=1)return`<div class="dygraph-legend-line" style="border-bottom-color: ${t};"></div>`;var n,a,o,r,p=0,m=0,u=[],f;for(n=0;n<=e.length;n++)p+=e[n%e.length];if(f=Math.floor(i/(p-e[0])),f>1){for(n=0;n<e.length;n++)u[n]=e[n]/i;m=u.length}else{for(f=1,n=0;n<e.length;n++)u[n]=e[n]/p;m=u.length+1}var _="";for(a=0;a<f;a++)for(n=0;n<m;n+=2)o=u[n%u.length],n<e.length?r=u[(n+1)%u.length]:r=0,_+=`<div class="dygraph-legend-dash" style="margin-right: ${r}em; padding-left: ${o}em;"></div>`;return _}var Mo=kt;var Ie=function(){this.hasTouchInterface_=typeof TouchEvent<"u",this.isMobileDevice_=/mobile|android/gi.test(navigator.appVersion),this.interfaceCreated_=!1};Ie.prototype.toString=function(){return"RangeSelector Plugin"};Ie.prototype.activate=function(e){return this.dygraph_=e,this.getOption_("showRangeSelector")&&this.createInterface_(),{layout:this.reserveSpace_,predraw:this.renderStaticLayer_,didDrawChart:this.renderInteractiveLayer_}};Ie.prototype.destroy=function(){this.bgcanvas_=null,this.fgcanvas_=null,this.leftZoomHandle_=null,this.rightZoomHandle_=null};Ie.prototype.getOption_=function(e,t){return this.dygraph_.getOption(e,t)};Ie.prototype.setDefaultOption_=function(e,t){this.dygraph_.attrs_[e]=t};Ie.prototype.createInterface_=function(){this.createCanvases_(),this.createZoomHandles_(),this.initInteraction_(),this.getOption_("animatedZooms")&&(console.warn("Animated zooms and range selector are not compatible; disabling animatedZooms."),this.dygraph_.updateOptions({animatedZooms:!1},!0)),this.interfaceCreated_=!0,this.addToGraph_()};Ie.prototype.addToGraph_=function(){var e=this.graphDiv_=this.dygraph_.graphDiv;e.appendChild(this.bgcanvas_),e.appendChild(this.fgcanvas_),e.appendChild(this.leftZoomHandle_),e.appendChild(this.rightZoomHandle_)};Ie.prototype.removeFromGraph_=function(){var e=this.graphDiv_;e.removeChild(this.bgcanvas_),e.removeChild(this.fgcanvas_),e.removeChild(this.leftZoomHandle_),e.removeChild(this.rightZoomHandle_),this.graphDiv_=null};Ie.prototype.reserveSpace_=function(e){this.getOption_("showRangeSelector")&&e.reserveSpaceBottom(this.getOption_("rangeSelectorHeight")+4)};Ie.prototype.renderStaticLayer_=function(){this.updateVisibility_()&&(this.resize_(),this.drawStaticLayer_())};Ie.prototype.renderInteractiveLayer_=function(){!this.updateVisibility_()||this.isChangingRange_||(this.placeZoomHandles_(),this.drawInteractiveLayer_())};Ie.prototype.updateVisibility_=function(){var e=this.getOption_("showRangeSelector");if(e)this.interfaceCreated_?(!this.graphDiv_||!this.graphDiv_.parentNode)&&this.addToGraph_():this.createInterface_();else if(this.graphDiv_){this.removeFromGraph_();var t=this.dygraph_;setTimeout(function(){t.width_=0,t.resize()},1)}return e};Ie.prototype.resize_=function(){function e(a,o,r,p){var m=p||bn(o);a.style.top=r.y+"px",a.style.left=r.x+"px",a.width=r.w*m,a.height=r.h*m,a.style.width=r.w+"px",a.style.height=r.h+"px",m!=1&&o.scale(m,m)}var t=this.dygraph_.layout_.getPlotArea(),i=0;this.dygraph_.getOptionForAxis("drawAxis","x")&&(i=this.getOption_("xAxisHeight")||this.getOption_("axisLabelFontSize")+2*this.getOption_("axisTickSize")),this.canvasRect_={x:t.x,y:t.y+t.h+i+4,w:t.w,h:this.getOption_("rangeSelectorHeight")};var n=this.dygraph_.getNumericOption("pixelRatio");e(this.bgcanvas_,this.bgcanvas_ctx_,this.canvasRect_,n),e(this.fgcanvas_,this.fgcanvas_ctx_,this.canvasRect_,n)};Ie.prototype.createCanvases_=function(){this.bgcanvas_=pn(),this.bgcanvas_.className="dygraph-rangesel-bgcanvas",this.bgcanvas_.style.position="absolute",this.bgcanvas_.style.zIndex=9,this.bgcanvas_ctx_=an(this.bgcanvas_),this.fgcanvas_=pn(),this.fgcanvas_.className="dygraph-rangesel-fgcanvas",this.fgcanvas_.style.position="absolute",this.fgcanvas_.style.zIndex=9,this.fgcanvas_.style.cursor="default",this.fgcanvas_ctx_=an(this.fgcanvas_)};Ie.prototype.createZoomHandles_=function(){var e=new Image;e.className="dygraph-rangesel-zoomhandle",e.style.position="absolute",e.style.zIndex=10,e.style.visibility="hidden",e.style.cursor="col-resize",e.width=9,e.height=16,e.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAkAAAAQCAYAAADESFVDAAAAAXNSR0IArs4c6QAAAAZiS0dEANAAzwDP4Z7KegAAAAlwSFlzAAAOxAAADsQBlSsOGwAAAAd0SU1FB9sHGw0cMqdt1UwAAAAZdEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIEdJTVBXgQ4XAAAAaElEQVQoz+3SsRFAQBCF4Z9WJM8KCDVwownl6YXsTmCUsyKGkZzcl7zkz3YLkypgAnreFmDEpHkIwVOMfpdi9CEEN2nGpFdwD03yEqDtOgCaun7sqSTDH32I1pQA2Pb9sZecAxc5r3IAb21d6878xsAAAAAASUVORK5CYII=",this.isMobileDevice_&&(e.width*=2,e.height*=2),this.leftZoomHandle_=e,this.rightZoomHandle_=e.cloneNode(!1)};Ie.prototype.initInteraction_=function(){var e=this,t=document,i=0,n=null,a=!1,o=!1,r=!this.isMobileDevice_,p=new Ia,m,u,f,_,x,g,S,C,E,L,O,H,z,Q;m=function(q){var J=e.dygraph_.xAxisExtremes(),_e=(J[1]-J[0])/e.canvasRect_.w,j=J[0]+(q.leftHandlePos-e.canvasRect_.x)*_e,me=J[0]+(q.rightHandlePos-e.canvasRect_.x)*_e;return[j,me]},u=function(q){return ii(q),a=!0,i=q.clientX,n=q.target?q.target:q.srcElement,(q.type==="mousedown"||q.type==="dragstart")&&(Si(t,"mousemove",f),Si(t,"mouseup",_)),e.fgcanvas_.style.cursor="col-resize",p.cover(),!0},f=function(q){if(!a)return!1;ii(q);var J=q.clientX-i;if(Math.abs(J)<4)return!0;i=q.clientX;var _e=e.getZoomHandleStatus_(),j;n==e.leftZoomHandle_?(j=_e.leftHandlePos+J,j=Math.min(j,_e.rightHandlePos-n.width-3),j=Math.max(j,e.canvasRect_.x)):(j=_e.rightHandlePos+J,j=Math.min(j,e.canvasRect_.x+e.canvasRect_.w),j=Math.max(j,_e.leftHandlePos+n.width+3));var me=n.width/2;return n.style.left=j-me+"px",e.drawInteractiveLayer_(),r&&x(),!0},_=function(q){return a?(a=!1,p.uncover(),Pt(t,"mousemove",f),Pt(t,"mouseup",_),e.fgcanvas_.style.cursor="default",r||x(),!0):!1},x=function(){try{var q=e.getZoomHandleStatus_();if(e.isChangingRange_=!0,!q.isZoomed)e.dygraph_.resetZoom();else{var J=m(q);e.dygraph_.doZoomXDates_(J[0],J[1])}}finally{e.isChangingRange_=!1}},g=function(q){var J=e.leftZoomHandle_.getBoundingClientRect(),_e=J.left+J.width/2;J=e.rightZoomHandle_.getBoundingClientRect();var j=J.left+J.width/2;return q.clientX>_e&&q.clientX<j},S=function(q){return!o&&g(q)&&e.getZoomHandleStatus_().isZoomed?(ii(q),o=!0,i=q.clientX,q.type==="mousedown"&&(Si(t,"mousemove",C),Si(t,"mouseup",E)),!0):!1},C=function(q){if(!o)return!1;ii(q);var J=q.clientX-i;if(Math.abs(J)<4)return!0;i=q.clientX;var _e=e.getZoomHandleStatus_(),j=_e.leftHandlePos,me=_e.rightHandlePos,ct=me-j;j+J<=e.canvasRect_.x?(j=e.canvasRect_.x,me=j+ct):me+J>=e.canvasRect_.x+e.canvasRect_.w?(me=e.canvasRect_.x+e.canvasRect_.w,j=me-ct):(j+=J,me+=J);var Oe=e.leftZoomHandle_.width/2;return e.leftZoomHandle_.style.left=j-Oe+"px",e.rightZoomHandle_.style.left=me-Oe+"px",e.drawInteractiveLayer_(),r&&L(),!0},E=function(q){return o?(o=!1,Pt(t,"mousemove",C),Pt(t,"mouseup",E),r||L(),!0):!1},L=function(){try{e.isChangingRange_=!0,e.dygraph_.dateWindow_=m(e.getZoomHandleStatus_()),e.dygraph_.drawGraph_(!1)}finally{e.isChangingRange_=!1}},O=function(q){if(!(a||o)){var J=g(q)?"move":"default";J!=e.fgcanvas_.style.cursor&&(e.fgcanvas_.style.cursor=J)}},H=function(q){q.type=="touchstart"&&q.targetTouches.length==1?u(q.targetTouches[0])&&ii(q):q.type=="touchmove"&&q.targetTouches.length==1?f(q.targetTouches[0])&&ii(q):_(q)},z=function(q){q.type=="touchstart"&&q.targetTouches.length==1?S(q.targetTouches[0])&&ii(q):q.type=="touchmove"&&q.targetTouches.length==1?C(q.targetTouches[0])&&ii(q):E(q)},Q=function(q,J){for(var _e=["touchstart","touchend","touchmove","touchcancel"],j=0;j<_e.length;j++)e.dygraph_.addAndTrackEvent(q,_e[j],J)},this.setDefaultOption_("interactionModel",Et.dragIsPanInteractionModel),this.setDefaultOption_("panEdgeFraction",1e-4);var be=window.opera?"mousedown":"dragstart";this.dygraph_.addAndTrackEvent(this.leftZoomHandle_,be,u),this.dygraph_.addAndTrackEvent(this.rightZoomHandle_,be,u),this.dygraph_.addAndTrackEvent(this.fgcanvas_,"mousedown",S),this.dygraph_.addAndTrackEvent(this.fgcanvas_,"mousemove",O),this.hasTouchInterface_&&(Q(this.leftZoomHandle_,H),Q(this.rightZoomHandle_,H),Q(this.fgcanvas_,z))};Ie.prototype.drawStaticLayer_=function(){var e=this.bgcanvas_ctx_;e.clearRect(0,0,this.canvasRect_.w,this.canvasRect_.h);try{this.drawMiniPlot_()}catch(i){console.warn(i)}var t=.5;this.bgcanvas_ctx_.lineWidth=this.getOption_("rangeSelectorBackgroundLineWidth"),e.strokeStyle=this.getOption_("rangeSelectorBackgroundStrokeColor"),e.beginPath(),e.moveTo(t,t),e.lineTo(t,this.canvasRect_.h-t),e.lineTo(this.canvasRect_.w-t,this.canvasRect_.h-t),e.lineTo(this.canvasRect_.w-t,t),e.stroke()};Ie.prototype.drawMiniPlot_=function(){var e=this.getOption_("rangeSelectorPlotFillColor"),t=this.getOption_("rangeSelectorPlotFillGradientColor"),i=this.getOption_("rangeSelectorPlotStrokeColor");if(!(!e&&!i)){var n=this.getOption_("stepPlot"),a=this.computeCombinedSeriesAndLimits_(),o=a.yMax-a.yMin,r=this.bgcanvas_ctx_,p=.5,m=this.dygraph_.xAxisExtremes(),u=Math.max(m[1]-m[0],1e-30),f=(this.canvasRect_.w-p)/u,_=(this.canvasRect_.h-p)/o,x=this.canvasRect_.w-p,g=this.canvasRect_.h-p,S=null,C=null;r.beginPath(),r.moveTo(p,g);for(var E=0;E<a.data.length;E++){var L=a.data[E],O=L[0]!==null?(L[0]-m[0])*f:NaN,H=L[1]!==null?g-(L[1]-a.yMin)*_:NaN;!n&&S!==null&&Math.round(O)==Math.round(S)||(isFinite(O)&&isFinite(H)?(S===null?r.lineTo(O,g):n&&r.lineTo(O,C),r.lineTo(O,H),S=O,C=H):(S!==null&&(n?(r.lineTo(O,C),r.lineTo(O,g)):r.lineTo(S,g)),S=C=null))}if(r.lineTo(x,g),r.closePath(),e){var z=this.bgcanvas_ctx_.createLinearGradient(0,0,0,g);t&&z.addColorStop(0,t),z.addColorStop(1,e),this.bgcanvas_ctx_.fillStyle=z,r.fill()}i&&(this.bgcanvas_ctx_.strokeStyle=i,this.bgcanvas_ctx_.lineWidth=this.getOption_("rangeSelectorPlotLineWidth"),r.stroke())}};Ie.prototype.computeCombinedSeriesAndLimits_=function(){var e=this.dygraph_,t=this.getOption_("logscale"),i,n=e.numColumns(),a=e.getLabels(),o=new Array(n),r=!1,p=e.visibility(),m=[];for(i=1;i<n;i++){var u=this.getOption_("showInRangeSelector",a[i]);m.push(u),u!==null&&(r=!0)}if(r)for(i=1;i<n;i++)o[i]=m[i-1];else for(i=1;i<n;i++)o[i]=p[i-1];var f=[],_=e.dataHandler_,x=e.attributes_;for(i=1;i<e.numColumns();i++)if(o[i]){var g=_.extractSeries(e.rawData_,i,x);e.rollPeriod()>1&&(g=_.rollingAverage(g,e.rollPeriod(),x,i)),f.push(g)}var S=[];for(i=0;i<f[0].length;i++){for(var C=0,E=0,L=0;L<f.length;L++){var O=f[L][i][1];O===null||isNaN(O)||(E++,C+=O)}S.push([f[0][i][0],C/E])}var H=Number.MAX_VALUE,z=-Number.MAX_VALUE;for(i=0;i<S.length;i++){var Q=S[i][1];Q!==null&&isFinite(Q)&&(!t||Q>0)&&(H=Math.min(H,Q),z=Math.max(z,Q))}var be=.25;if(t)for(z=Se(z),z+=z*be,H=Se(H),i=0;i<S.length;i++)S[i][1]=Se(S[i][1]);else{var q,J=z-H;J<=Number.MIN_VALUE?q=z*be:q=J*be,z+=q,H-=q}return{data:S,yMin:H,yMax:z}};Ie.prototype.placeZoomHandles_=function(){var e=this.dygraph_.xAxisExtremes(),t=this.dygraph_.xAxisRange(),i=e[1]-e[0],n=Math.max(0,(t[0]-e[0])/i),a=Math.max(0,(e[1]-t[1])/i),o=this.canvasRect_.x+this.canvasRect_.w*n,r=this.canvasRect_.x+this.canvasRect_.w*(1-a),p=Math.max(this.canvasRect_.y,this.canvasRect_.y+(this.canvasRect_.h-this.leftZoomHandle_.height)/2),m=this.leftZoomHandle_.width/2;this.leftZoomHandle_.style.left=o-m+"px",this.leftZoomHandle_.style.top=p+"px",this.rightZoomHandle_.style.left=r-m+"px",this.rightZoomHandle_.style.top=this.leftZoomHandle_.style.top,this.leftZoomHandle_.style.visibility="visible",this.rightZoomHandle_.style.visibility="visible"};Ie.prototype.drawInteractiveLayer_=function(){var e=this.fgcanvas_ctx_;e.clearRect(0,0,this.canvasRect_.w,this.canvasRect_.h);var t=1,i=this.canvasRect_.w-t,n=this.canvasRect_.h-t,a=this.getZoomHandleStatus_();if(e.strokeStyle=this.getOption_("rangeSelectorForegroundStrokeColor"),e.lineWidth=this.getOption_("rangeSelectorForegroundLineWidth"),!a.isZoomed)e.beginPath(),e.moveTo(t,t),e.lineTo(t,n),e.lineTo(i,n),e.lineTo(i,t),e.stroke();else{var o=Math.max(t,a.leftHandlePos-this.canvasRect_.x),r=Math.min(i,a.rightHandlePos-this.canvasRect_.x);let p=this.getOption_("rangeSelectorVeilColour");e.fillStyle=p||"rgba(240, 240, 240, "+this.getOption_("rangeSelectorAlpha").toString()+")",e.fillRect(0,0,o,this.canvasRect_.h),e.fillRect(r,0,this.canvasRect_.w-r,this.canvasRect_.h),e.beginPath(),e.moveTo(t,t),e.lineTo(o,t),e.lineTo(o,n),e.lineTo(r,n),e.lineTo(r,t),e.lineTo(i,t),e.stroke()}};Ie.prototype.getZoomHandleStatus_=function(){var e=this.leftZoomHandle_.width/2,t=parseFloat(this.leftZoomHandle_.style.left)+e,i=parseFloat(this.rightZoomHandle_.style.left)+e;return{leftHandlePos:t,rightHandlePos:i,isZoomed:t-1>this.canvasRect_.x||i+1<this.canvasRect_.x+this.canvasRect_.w}};var Ro=Ie;var $a=function(e){this.container=e};$a.prototype.draw=function(e,t){this.container.innerHTML="",typeof this.date_graph<"u"&&this.date_graph.destroy(),this.date_graph=new Ye(this.container,e,t)};$a.prototype.setSelection=function(e){var t=!1;e.length&&(t=e[0].row),this.date_graph.setSelection(t)};$a.prototype.getSelection=function(){var e=[],t=this.date_graph.getSelection();if(t<0)return e;for(var i=this.date_graph.layout_.points,n=0;n<i.length;++n)e.push({row:t,column:n+1});return e};var Al=$a;var R=function(t,i,n){this.__init__(t,i,n)};R.NAME="Dygraph";R.VERSION="2.2.1";var Lo={};R._require=function(t){return t in Lo?Lo[t]:R._require._b(t)};R._require._b=null;R._require.add=function(t,i){Lo[t]=i};R.DEFAULT_ROLL_PERIOD=1;R.DEFAULT_WIDTH=480;R.DEFAULT_HEIGHT=320;R.ANIMATION_STEPS=12;R.ANIMATION_DURATION=200;R.Plotters=Di._Plotters;R.addedAnnotationCSS=!1;R.prototype.__init__=function(e,t,i){if(this.is_initial_draw_=!0,this.readyFns_=[],i==null&&(i={}),i=R.copyUserAttrs_(i),typeof e=="string"&&(e=document.getElementById(e)),!e)throw new Error("Constructing dygraph with a non-existent div!");this.maindiv_=e,this.file_=t,this.rollPeriod_=i.rollPeriod||R.DEFAULT_ROLL_PERIOD,this.previousVerticalX_=-1,this.fractions_=i.fractions||!1,this.dateWindow_=i.dateWindow||null,this.annotations_=[],e.innerHTML="";let n=window.getComputedStyle(e,null);(n.paddingLeft!=="0px"||n.paddingRight!=="0px"||n.paddingTop!=="0px"||n.paddingBottom!=="0px")&&console.error("Main div contains padding; graph will misbehave"),e.style.width===""&&i.width&&(e.style.width=i.width+"px"),e.style.height===""&&i.height&&(e.style.height=i.height+"px"),e.style.height===""&&e.clientHeight===0&&(e.style.height=R.DEFAULT_HEIGHT+"px",e.style.width===""&&(e.style.width=R.DEFAULT_WIDTH+"px")),this.width_=e.clientWidth||i.width||0,this.height_=e.clientHeight||i.height||0,i.stackedGraph&&(i.fillGraph=!0),this.user_attrs_={},xt(this.user_attrs_,i),this.attrs_={},Ma(this.attrs_,un),this.boundaryIds_=[],this.setIndexByName_={},this.datasetIndex_=[],this.registeredEvents_=[],this.eventListeners_={},this.attributes_=new Dl(this),this.createInterface_(),this.plugins_=[];for(var a=R.PLUGINS.concat(this.getOption("plugins")),o=0;o<a.length;o++){var r=a[o],p;typeof r.activate<"u"?p=r:p=new r;var m={plugin:p,events:{},options:{},pluginOptions:{}},u=p.activate(this);for(var f in u)u.hasOwnProperty(f)&&(m.events[f]=u[f]);this.plugins_.push(m)}for(var o=0;o<this.plugins_.length;o++){var _=this.plugins_[o];for(var f in _.events)if(_.events.hasOwnProperty(f)){var x=_.events[f],g=[_.plugin,x];f in this.eventListeners_?this.eventListeners_[f].push(g):this.eventListeners_[f]=[g]}}this.createDragInterface_(),this.start_()};R.prototype.cascadeEvents_=function(e,t){if(!(e in this.eventListeners_))return!1;var i={dygraph:this,cancelable:!1,defaultPrevented:!1,preventDefault:function(){if(!i.cancelable)throw"Cannot call preventDefault on non-cancelable event.";i.defaultPrevented=!0},propagationStopped:!1,stopPropagation:function(){i.propagationStopped=!0}};xt(i,t);var n=this.eventListeners_[e];if(n)for(var a=n.length-1;a>=0;a--){var o=n[a][0],r=n[a][1];if(r.call(o,i),i.propagationStopped)break}return i.defaultPrevented};R.prototype.getPluginInstance_=function(e){for(var t=0;t<this.plugins_.length;t++){var i=this.plugins_[t];if(i.plugin instanceof e)return i.plugin}return null};R.prototype.isZoomed=function(e){let t=!!this.dateWindow_;if(e==="x")return t;let i=this.axes_.map(n=>!!n.valueRange).indexOf(!0)>=0;if(e==null)return t||i;if(e==="y")return i;throw new Error(`axis parameter is [${e}] must be null, 'x' or 'y'.`)};R.prototype.toString=function(){var e=this.maindiv_,t=e&&e.id?e.id:e;return"[Dygraph "+t+"]"};R.prototype.attr_=function(e,t){return typeof process<"u",t?this.attributes_.getForSeries(e,t):this.attributes_.get(e)};R.prototype.getOption=function(e,t){return this.attr_(e,t)};R.prototype.getNumericOption=function(e,t){return this.getOption(e,t)};R.prototype.getStringOption=function(e,t){return this.getOption(e,t)};R.prototype.getBooleanOption=function(e,t){return this.getOption(e,t)};R.prototype.getFunctionOption=function(e,t){return this.getOption(e,t)};R.prototype.getOptionForAxis=function(e,t){return this.attributes_.getForAxis(e,t)};R.prototype.optionsViewForAxis_=function(e){var t=this;return function(i){var n=t.user_attrs_.axes;return n&&n[e]&&n[e].hasOwnProperty(i)?n[e][i]:e==="x"&&i==="logscale"?!1:typeof t.user_attrs_[i]<"u"?t.user_attrs_[i]:(n=t.attrs_.axes,n&&n[e]&&n[e].hasOwnProperty(i)?n[e][i]:e=="y"&&t.axes_[0].hasOwnProperty(i)?t.axes_[0][i]:e=="y2"&&t.axes_[1].hasOwnProperty(i)?t.axes_[1][i]:t.attr_(i))}};R.prototype.rollPeriod=function(){return this.rollPeriod_};R.prototype.xAxisRange=function(){return this.dateWindow_?this.dateWindow_:this.xAxisExtremes()};R.prototype.xAxisExtremes=function(){var e=this.getNumericOption("xRangePad")/this.plotter_.area.w;if(this.numRows()===0)return[0-e,1+e];var t=this.rawData_[0][0],i=this.rawData_[this.rawData_.length-1][0];if(e){var n=i-t;t-=n*e,i+=n*e}return[t,i]};R.prototype.yAxisExtremes=function(){let e=this.gatherDatasets_(this.rolledSeries_,null),{extremes:t}=e,i=this.axes_;this.computeYAxisRanges_(t);let n=this.axes_;return this.axes_=i,n.map(a=>a.extremeRange)};R.prototype.yAxisRange=function(e){if(typeof e>"u"&&(e=0),e<0||e>=this.axes_.length)return null;var t=this.axes_[e];return[t.computedValueRange[0],t.computedValueRange[1]]};R.prototype.yAxisRanges=function(){for(var e=[],t=0;t<this.axes_.length;t++)e.push(this.yAxisRange(t));return e};R.prototype.toDomCoords=function(e,t,i){return[this.toDomXCoord(e),this.toDomYCoord(t,i)]};R.prototype.toDomXCoord=function(e){if(e===null)return null;var t=this.plotter_.area,i=this.xAxisRange();return t.x+(e-i[0])/(i[1]-i[0])*t.w};R.prototype.toDomYCoord=function(e,t){var i=this.toPercentYCoord(e,t);if(i===null)return null;var n=this.plotter_.area;return n.y+i*n.h};R.prototype.toDataCoords=function(e,t,i){return[this.toDataXCoord(e),this.toDataYCoord(t,i)]};R.prototype.toDataXCoord=function(e){if(e===null)return null;var t=this.plotter_.area,i=this.xAxisRange();if(this.attributes_.getForAxis("logscale","x")){var n=(e-t.x)/t.w;return xn(i[0],i[1],n)}else return i[0]+(e-t.x)/t.w*(i[1]-i[0])};R.prototype.toDataYCoord=function(e,t){if(e===null)return null;var i=this.plotter_.area,n=this.yAxisRange(t);if(typeof t>"u"&&(t=0),this.attributes_.getForAxis("logscale",t)){var a=(e-i.y)/i.h;return xn(n[1],n[0],a)}else return n[0]+(i.y+i.h-e)/i.h*(n[1]-n[0])};R.prototype.toPercentYCoord=function(e,t){if(e===null)return null;typeof t>"u"&&(t=0);var i=this.yAxisRange(t),n,a=this.attributes_.getForAxis("logscale",t);if(a){var o=Se(i[0]),r=Se(i[1]);n=(r-Se(e))/(r-o)}else n=(i[1]-e)/(i[1]-i[0]);return n};R.prototype.toPercentXCoord=function(e){if(e===null)return null;var t=this.xAxisRange(),i,n=this.attributes_.getForAxis("logscale","x");if(n===!0){var a=Se(t[0]),o=Se(t[1]);i=(Se(e)-a)/(o-a)}else i=(e-t[0])/(t[1]-t[0]);return i};R.prototype.numColumns=function(){return this.rawData_?this.rawData_[0]?this.rawData_[0].length:this.attr_("labels").length:0};R.prototype.numRows=function(){return this.rawData_?this.rawData_.length:0};R.prototype.getValue=function(e,t){return e<0||e>=this.rawData_.length||t<0||t>=this.rawData_[e].length?null:this.rawData_[e][t]};R.prototype.createInterface_=function(){var e=this.maindiv_;this.graphDiv=document.createElement("div"),this.graphDiv.style.textAlign="left",this.graphDiv.style.position="relative",e.appendChild(this.graphDiv),this.canvas_=pn(),this.canvas_.style.position="absolute",this.canvas_.style.top=0,this.canvas_.style.left=0,this.hidden_=this.createPlotKitCanvas_(this.canvas_),this.canvas_ctx_=an(this.canvas_),this.hidden_ctx_=an(this.hidden_),this.resizeElements_(),this.graphDiv.appendChild(this.hidden_),this.graphDiv.appendChild(this.canvas_),this.mouseEventElement_=this.createMouseEventElement_(),this.layout_=new Tn(this);var t=this;if(this.mouseMoveHandler_=function(n){t.mouseMove_(n)},this.mouseOutHandler_=function(n){var a=n.target||n.fromElement,o=n.relatedTarget||n.toElement;xo(a,t.graphDiv)&&!xo(o,t.graphDiv)&&t.mouseOut_(n)},this.addAndTrackEvent(window,"mouseout",this.mouseOutHandler_),this.addAndTrackEvent(this.mouseEventElement_,"mousemove",this.mouseMoveHandler_),!this.resizeHandler_){this.resizeHandler_=function(n){t.resize()},this.addAndTrackEvent(window,"resize",this.resizeHandler_),this.resizeObserver_=null;var i=this.getStringOption("resizable");if(typeof ResizeObserver>"u"&&i!=="no"&&(console.error("ResizeObserver unavailable; ignoring resizable property"),i="no"),i==="horizontal"||i==="vertical"||i==="both"?e.style.resize=i:i!=="passive"&&(i="no"),i!=="no"){let n=window.getComputedStyle(e).overflow;window.getComputedStyle(e).overflow==="visible"&&(e.style.overflow="hidden"),this.resizeObserver_=new ResizeObserver(this.resizeHandler_),this.resizeObserver_.observe(e)}}};R.prototype.resizeElements_=function(){this.graphDiv.style.width=this.width_+"px",this.graphDiv.style.height=this.height_+"px";var e=this.getNumericOption("pixelRatio"),t=e||bn(this.canvas_ctx_);this.canvas_.width=this.width_*t,this.canvas_.height=this.height_*t,this.canvas_.style.width=this.width_+"px",this.canvas_.style.height=this.height_+"px",t!==1&&this.canvas_ctx_.scale(t,t);var i=e||bn(this.hidden_ctx_);this.hidden_.width=this.width_*i,this.hidden_.height=this.height_*i,this.hidden_.style.width=this.width_+"px",this.hidden_.style.height=this.height_+"px",i!==1&&this.hidden_ctx_.scale(i,i)};R.prototype.destroy=function(){this.canvas_ctx_.restore(),this.hidden_ctx_.restore();for(var e=this.plugins_.length-1;e>=0;e--){var t=this.plugins_.pop();t.plugin.destroy&&t.plugin.destroy()}var i=function(a){for(;a.hasChildNodes();)i(a.firstChild),a.removeChild(a.firstChild)};this.removeTrackedEvents_(),Pt(window,"mouseout",this.mouseOutHandler_),Pt(this.mouseEventElement_,"mousemove",this.mouseMoveHandler_),this.resizeObserver_&&(this.resizeObserver_.disconnect(),this.resizeObserver_=null),Pt(window,"resize",this.resizeHandler_),this.resizeHandler_=null,i(this.maindiv_);var n=function(o){for(var r in o)typeof o[r]=="object"&&(o[r]=null)};n(this.layout_),n(this.plotter_),n(this)};R.prototype.createPlotKitCanvas_=function(e){var t=pn();return t.style.position="absolute",t.style.top=e.style.top,t.style.left=e.style.left,t.width=this.width_,t.height=this.height_,t.style.width=this.width_+"px",t.style.height=this.height_+"px",t};R.prototype.createMouseEventElement_=function(){return this.canvas_};R.prototype.setColors_=function(){var e=this.getLabels(),t=e.length-1;this.colors_=[],this.colorsMap_={};for(var i=this.getNumericOption("colorSaturation")||1,n=this.getNumericOption("colorValue")||.5,a=Math.ceil(t/2),o=this.getOption("colors"),r=this.visibility(),p=0;p<t;p++)if(r[p]){var m=e[p+1],u=this.attributes_.getForSeries("color",m);if(!u)if(o)u=o[p%o.length];else{var f=p%2?a+(p+1)/2:Math.ceil((p+1)/2),_=1*f/(1+t);u=gl(_,i,n)}this.colors_.push(u),this.colorsMap_[m]=u}};R.prototype.getColors=function(){return this.colors_};R.prototype.getPropertiesForSeries=function(e){for(var t=-1,i=this.getLabels(),n=1;n<i.length;n++)if(i[n]==e){t=n;break}return t==-1?null:{name:e,column:t,visible:this.visibility()[t-1],color:this.colorsMap_[e],axis:1+this.attributes_.axisForSeries(e)}};R.prototype.createRollInterface_=function(){var e=this.roller_;e||(this.roller_=e=document.createElement("input"),e.type="text",e.style.display="none",e.className="dygraph-roller",this.graphDiv.appendChild(e));var t=this.getBooleanOption("showRoller")?"block":"none",i=this.getArea(),n={top:i.y+i.h-25+"px",left:i.x+1+"px",display:t};e.size="2",e.value=this.rollPeriod_,xt(e.style,n);let a=this;e.onchange=function(){return a.adjustRoll(e.value)}};R.prototype.createDragInterface_=function(){var e={isZooming:!1,isPanning:!1,is2DPan:!1,dragStartX:null,dragStartY:null,dragEndX:null,dragEndY:null,dragDirection:null,prevEndX:null,prevEndY:null,prevDragDirection:null,cancelNextDblclick:!1,initialLeftmostDate:null,xUnitsPerPixel:null,dateRange:null,px:0,py:0,boundedDates:null,boundedValues:null,tarp:new Ia,initializeMouseDown:function(r,p,m){r.preventDefault?r.preventDefault():(r.returnValue=!1,r.cancelBubble=!0);var u=ui(p.canvas_);m.px=u.x,m.py=u.y,m.dragStartX=ln(r,m),m.dragStartY=sn(r,m),m.cancelNextDblclick=!1,m.tarp.cover()},destroy:function(){var r=this;if((r.isZooming||r.isPanning)&&(r.isZooming=!1,r.dragStartX=null,r.dragStartY=null),r.isPanning){r.isPanning=!1,r.draggingDate=null,r.dateRange=null;for(var p=0;p<i.axes_.length;p++)delete i.axes_[p].draggingValue,delete i.axes_[p].dragValueRange}r.tarp.uncover()}},t=this.getOption("interactionModel"),i=this,n=function(r){return function(p){r(p,i,e)}};for(var a in t)t.hasOwnProperty(a)&&this.addAndTrackEvent(this.mouseEventElement_,a,n(t[a]));if(!t.willDestroyContextMyself){var o=function(r){e.destroy()};this.addAndTrackEvent(document,"mouseup",o)}};R.prototype.drawZoomRect_=function(e,t,i,n,a,o,r,p){var m=this.canvas_ctx_;o==tn?m.clearRect(Math.min(t,r),this.layout_.getPlotArea().y,Math.abs(t-r),this.layout_.getPlotArea().h):o==nn&&m.clearRect(this.layout_.getPlotArea().x,Math.min(n,p),this.layout_.getPlotArea().w,Math.abs(n-p)),e==tn?i&&t&&(m.fillStyle="rgba(128,128,128,0.33)",m.fillRect(Math.min(t,i),this.layout_.getPlotArea().y,Math.abs(i-t),this.layout_.getPlotArea().h)):e==nn&&a&&n&&(m.fillStyle="rgba(128,128,128,0.33)",m.fillRect(this.layout_.getPlotArea().x,Math.min(n,a),this.layout_.getPlotArea().w,Math.abs(a-n)))};R.prototype.clearZoomRect_=function(){this.currentZoomRectArgs_=null,this.canvas_ctx_.clearRect(0,0,this.width_,this.height_)};R.prototype.doZoomX_=function(e,t){this.currentZoomRectArgs_=null;var i=this.toDataXCoord(e),n=this.toDataXCoord(t);this.doZoomXDates_(i,n)};R.prototype.doZoomXDates_=function(e,t){var i=this.xAxisRange(),n=[e,t];let a=this.getFunctionOption("zoomCallback"),o=this;this.doAnimatedZoom(i,n,null,null,function(){a&&a.call(o,e,t,o.yAxisRanges())})};R.prototype.doZoomY_=function(e,t){this.currentZoomRectArgs_=null;for(var i=this.yAxisRanges(),n=[],a=0;a<this.axes_.length;a++){var o=this.toDataYCoord(e,a),r=this.toDataYCoord(t,a);n.push([r,o])}let p=this.getFunctionOption("zoomCallback"),m=this;this.doAnimatedZoom(null,null,i,n,function(){if(p){let[f,_]=m.xAxisRange();p.call(m,f,_,m.yAxisRanges())}})};R.zoomAnimationFunction=function(e,t){var i=1.5;return(1-Math.pow(i,-e))/(1-Math.pow(i,-t))};R.prototype.resetZoom=function(){let e=this.isZoomed("x"),t=this.isZoomed("y"),i=e||t;if(this.clearSelection(),!i)return;let[n,a]=this.xAxisExtremes(),o=this.getBooleanOption("animatedZooms"),r=this.getFunctionOption("zoomCallback");if(!o){this.dateWindow_=null,this.axes_.forEach(x=>{x.valueRange&&delete x.valueRange}),this.drawGraph_(),r&&r.call(this,n,a,this.yAxisRanges());return}var p=null,m=null,u=null,f=null;e&&(p=this.xAxisRange(),m=[n,a]),t&&(u=this.yAxisRanges(),f=this.yAxisExtremes());let _=this;this.doAnimatedZoom(p,m,u,f,function(){_.dateWindow_=null,_.axes_.forEach(g=>{g.valueRange&&delete g.valueRange}),r&&r.call(_,n,a,_.yAxisRanges())})};R.prototype.doAnimatedZoom=function(e,t,i,n,a){var o=this.getBooleanOption("animatedZooms")?R.ANIMATION_STEPS:1,r=[],p=[],m,u;if(e!==null&&t!==null)for(m=1;m<=o;m++)u=R.zoomAnimationFunction(m,o),r[m-1]=[e[0]*(1-u)+u*t[0],e[1]*(1-u)+u*t[1]];if(i!==null&&n!==null)for(m=1;m<=o;m++){u=R.zoomAnimationFunction(m,o);for(var f=[],_=0;_<this.axes_.length;_++)f.push([i[_][0]*(1-u)+u*n[_][0],i[_][1]*(1-u)+u*n[_][1]]);p[m-1]=f}let x=this;yo(function(g){if(p.length)for(var S=0;S<x.axes_.length;S++){var C=p[g][S];x.axes_[S].valueRange=[C[0],C[1]]}r.length&&(x.dateWindow_=r[g]),x.drawGraph_()},o,R.ANIMATION_DURATION/o,a)};R.prototype.getArea=function(){return this.plotter_.area};R.prototype.eventToDomCoords=function(e){if(e.offsetX&&e.offsetY)return[e.offsetX,e.offsetY];var t=ui(this.mouseEventElement_),i=on(e)-t.x,n=rn(e)-t.y;return[i,n]};R.prototype.findClosestRow=function(e){for(var t=1/0,i=-1,n=this.layout_.points,a=0;a<n.length;a++)for(var o=n[a],r=o.length,p=0;p<r;p++){var m=o[p];if(cn(m,!0)){var u=Math.abs(m.canvasx-e);u<t&&(t=u,i=m.idx)}}return i};R.prototype.findClosestPoint=function(e,t){for(var i=1/0,n,a,o,r,p,m,u,f=this.layout_.points.length-1;f>=0;--f)for(var _=this.layout_.points[f],x=0;x<_.length;++x)r=_[x],cn(r)&&(a=r.canvasx-e,o=r.canvasy-t,n=a*a+o*o,n<i&&(i=n,p=r,m=f,u=r.idx));var g=this.layout_.setNames[m];return{row:u,seriesName:g,point:p}};R.prototype.findStackedPoint=function(e,t){for(var i=this.findClosestRow(e),n,a,o=0;o<this.layout_.points.length;++o){var r=this.getLeftBoundary_(o),p=i-r,m=this.layout_.points[o];if(!(p>=m.length)){var u=m[p];if(cn(u)){var f=u.canvasy;if(e>u.canvasx&&p+1<m.length){var _=m[p+1];if(cn(_)){var x=_.canvasx-u.canvasx;if(x>0){var g=(e-u.canvasx)/x;f+=g*(_.canvasy-u.canvasy)}}}else if(e<u.canvasx&&p>0){var S=m[p-1];if(cn(S)){var x=u.canvasx-S.canvasx;if(x>0){var g=(u.canvasx-e)/x;f+=g*(S.canvasy-u.canvasy)}}}(o===0||f<t)&&(n=u,a=o)}}}var C=this.layout_.setNames[a];return{row:i,seriesName:C,point:n}};R.prototype.mouseMove_=function(e){var t=this.layout_.points;if(t!=null){var i=this.eventToDomCoords(e),n=i[0],a=i[1],o=this.getOption("highlightSeriesOpts"),r=!1;if(o&&!this.isSeriesLocked()){var p;this.getBooleanOption("stackedGraph")?p=this.findStackedPoint(n,a):p=this.findClosestPoint(n,a),r=this.setSelection(p.row,p.seriesName)}else{var m=this.findClosestRow(n);r=this.setSelection(m)}var u=this.getFunctionOption("highlightCallback");u&&r&&u.call(this,e,this.lastx_,this.selPoints_,this.lastRow_,this.highlightSet_)}};R.prototype.getLeftBoundary_=function(e){if(this.boundaryIds_[e])return this.boundaryIds_[e][0];for(var t=0;t<this.boundaryIds_.length;t++)if(this.boundaryIds_[t]!==void 0)return this.boundaryIds_[t][0];return 0};R.prototype.animateSelection_=function(e){var t=10,i=30;this.fadeLevel===void 0&&(this.fadeLevel=0),this.animateId===void 0&&(this.animateId=0);var n=this.fadeLevel,a=e<0?n:t-n;if(a<=0){this.fadeLevel&&this.updateSelection_(1);return}var o=++this.animateId,r=this,p=function(){r.fadeLevel!==0&&e<0&&(r.fadeLevel=0,r.clearSelection())};yo(function(m){r.animateId==o&&(r.fadeLevel+=e,r.fadeLevel===0?r.clearSelection():r.updateSelection_(r.fadeLevel/t))},a,i,p)};R.prototype.updateSelection_=function(e){this.cascadeEvents_("select",{selectedRow:this.lastRow_===-1?void 0:this.lastRow_,selectedX:this.lastx_===null?void 0:this.lastx_,selectedPoints:this.selPoints_});var t,i=this.canvas_ctx_;if(this.getOption("highlightSeriesOpts")){i.clearRect(0,0,this.width_,this.height_);var n=1-this.getNumericOption("highlightSeriesBackgroundAlpha"),a=mn(this.getOption("highlightSeriesBackgroundColor"));if(n){var o=this.getBooleanOption("animateBackgroundFade");if(o){if(e===void 0){this.animateSelection_(1);return}n*=e}i.fillStyle="rgba("+a.r+","+a.g+","+a.b+","+n+")",i.fillRect(0,0,this.width_,this.height_)}this.plotter_._renderLineChart(this.highlightSet_,i)}else if(this.previousVerticalX_>=0){var r=0,p=this.attr_("labels");for(t=1;t<p.length;t++){var m=this.getNumericOption("highlightCircleSize",p[t]);m>r&&(r=m)}var u=this.previousVerticalX_;i.clearRect(u-r-1,0,2*r+2,this.height_)}if(this.selPoints_.length>0){var f=this.selPoints_[0].canvasx;for(i.save(),t=0;t<this.selPoints_.length;t++){var _=this.selPoints_[t];if(!isNaN(_.canvasy)){var x=this.getNumericOption("highlightCircleSize",_.name),g=this.getFunctionOption("drawHighlightPointCallback",_.name),S=this.plotter_.colors[_.name];g||(g=Sn.DEFAULT),i.lineWidth=this.getNumericOption("strokeWidth",_.name),i.strokeStyle=S,i.fillStyle=S,g.call(this,this,_.name,i,f,_.canvasy,S,x,_.idx)}}i.restore(),this.previousVerticalX_=f}};R.prototype.setSelection=function(t,i,n,a){this.selPoints_=[];var o=!1;if(t!==!1&&t>=0){t!=this.lastRow_&&(o=!0),this.lastRow_=t;for(var r=0;r<this.layout_.points.length;++r){var p=this.layout_.points[r],m=t-this.getLeftBoundary_(r);if(m>=0&&m<p.length&&p[m].idx==t){var u=p[m];u.yval!==null&&this.selPoints_.push(u)}else for(var f=0;f<p.length;++f){var u=p[f];if(u.idx==t){u.yval!==null&&this.selPoints_.push(u);break}}}}else this.lastRow_>=0&&(o=!0),this.lastRow_=-1;if(this.selPoints_.length?this.lastx_=this.selPoints_[0].xval:this.lastx_=null,i!==void 0&&(this.highlightSet_!==i&&(o=!0),this.highlightSet_=i),n!==void 0&&(this.lockedSet_=n),o&&(this.updateSelection_(void 0),a)){var _=this.getFunctionOption("highlightCallback");if(_){var x={};_.call(this,x,this.lastx_,this.selPoints_,this.lastRow_,this.highlightSet_)}}return o};R.prototype.mouseOut_=function(e){this.getFunctionOption("unhighlightCallback")&&this.getFunctionOption("unhighlightCallback").call(this,e),this.getBooleanOption("hideOverlayOnMouseOut")&&!this.lockedSet_&&this.clearSelection()};R.prototype.clearSelection=function(){if(this.cascadeEvents_("deselect",{}),this.lockedSet_=!1,this.fadeLevel){this.animateSelection_(-1);return}this.canvas_ctx_.clearRect(0,0,this.width_,this.height_),this.fadeLevel=0,this.selPoints_=[],this.lastx_=null,this.lastRow_=-1,this.highlightSet_=null};R.prototype.getSelection=function(){if(!this.selPoints_||this.selPoints_.length<1)return-1;for(var e=0;e<this.layout_.points.length;e++)for(var t=this.layout_.points[e],i=0;i<t.length;i++)if(t[i].x==this.selPoints_[0].x)return t[i].idx;return-1};R.prototype.getHighlightSeries=function(){return this.highlightSet_};R.prototype.isSeriesLocked=function(){return this.lockedSet_};R.prototype.loadedEvent_=function(e){this.rawData_=this.parseCSV_(e),this.cascadeDataDidUpdateEvent_(),this.predraw_()};R.prototype.addXTicks_=function(){var e;this.dateWindow_?e=[this.dateWindow_[0],this.dateWindow_[1]]:e=this.xAxisExtremes();var t=this.optionsViewForAxis_("x"),i=t("ticker")(e[0],e[1],this.plotter_.area.w,t,this);this.layout_.setXTicks(i)};R.prototype.getHandlerClass_=function(){var e;return this.attr_("dataHandler")?e=this.attr_("dataHandler"):this.fractions_?this.getBooleanOption("errorBars")?e=Do:e=To:this.getBooleanOption("customBars")?e=wo:this.getBooleanOption("errorBars")?e=So:e=Pn,e};R.prototype.predraw_=function(){var e=new Date;this.dataHandler_=new(this.getHandlerClass_()),this.layout_.computePlotArea(),this.computeYAxes_(),this.is_initial_draw_||(this.canvas_ctx_.restore(),this.hidden_ctx_.restore()),this.canvas_ctx_.save(),this.hidden_ctx_.save(),this.plotter_=new Di(this,this.hidden_,this.hidden_ctx_,this.layout_),this.createRollInterface_(),this.cascadeEvents_("predraw"),this.rolledSeries_=[null];for(var t=1;t<this.numColumns();t++){var i=this.dataHandler_.extractSeries(this.rawData_,t,this.attributes_);this.rollPeriod_>1&&(i=this.dataHandler_.rollingAverage(i,this.rollPeriod_,this.attributes_,t)),this.rolledSeries_.push(i)}this.drawGraph_();var n=new Date;this.drawingTimeMs_=n-e};R.PointType=void 0;R.stackPoints_=function(e,t,i,n){for(var a=null,o=null,r=null,p=-1,m=function(S){if(!(p>=S)){for(var C=S;C<e.length;++C)if(r=null,!isNaN(e[C].yval)&&e[C].yval!==null){p=C,r=e[C];break}}},u=0;u<e.length;++u){var f=e[u],_=f.xval;t[_]===void 0&&(t[_]=0);var x=f.yval;isNaN(x)||x===null?n=="none"?x=0:(m(u),o&&r&&n!="none"?x=o.yval+(r.yval-o.yval)*((_-o.xval)/(r.xval-o.xval)):o&&n=="all"?x=o.yval:r&&n=="all"?x=r.yval:x=0):o=f;var g=t[_];a!=_&&(g+=x,t[_]=g),a=_,f.yval_stacked=g,g>i[1]&&(i[1]=g),g<i[0]&&(i[0]=g)}};R.prototype.gatherDatasets_=function(e,t){var i=[],n=[],a=[],o={},r,p,m,u,f,_=e.length-1,x;for(r=_;r>=1;r--)if(this.visibility()[r-1]){if(t){x=e[r];var g=t[0],S=t[1];for(m=null,u=null,p=0;p<x.length;p++)x[p][0]>=g&&m===null&&(m=p),x[p][0]<=S&&(u=p);m===null&&(m=0);for(var C=m,E=!0;E&&C>0;)C--,E=x[C][1]===null;u===null&&(u=x.length-1);var L=u;for(E=!0;E&&L<x.length-1;)L++,E=x[L][1]===null;C!==m&&(m=C),L!==u&&(u=L),i[r-1]=[m,u],x=x.slice(m,u+1)}else x=e[r],i[r-1]=[0,x.length-1];var O=this.attr_("labels")[r],H=this.dataHandler_.getExtremeYValues(x,t,this.getBooleanOption("stepPlot",O)),z=this.dataHandler_.seriesToPoints(x,O,i[r-1][0]);this.getBooleanOption("stackedGraph")&&(f=this.attributes_.axisForSeries(O),a[f]===void 0&&(a[f]=[]),R.stackPoints_(z,a[f],H,this.getBooleanOption("stackedGraphNaNFill"))),o[O]=H,n[r]=z}return{points:n,extremes:o,boundaryIds:i}};R.prototype.drawGraph_=function(){var e=new Date,t=this.is_initial_draw_;this.is_initial_draw_=!1,this.layout_.removeAllDatasets(),this.setColors_(),this.attrs_.pointSize=.5*this.getNumericOption("highlightCircleSize");var i=this.gatherDatasets_(this.rolledSeries_,this.dateWindow_),n=i.points,a=i.extremes;this.boundaryIds_=i.boundaryIds,this.setIndexByName_={};for(var o=this.attr_("labels"),r=0,p=1;p<n.length;p++)this.visibility()[p-1]&&(this.layout_.addDataset(o[p],n[p]),this.datasetIndex_[p]=r++);for(var p=0;p<o.length;p++)this.setIndexByName_[o[p]]=p;if(this.computeYAxisRanges_(a),this.layout_.setYAxes(this.axes_),this.addXTicks_(),this.layout_.evaluate(),this.renderGraph_(t),this.getStringOption("timingName")){var m=new Date;console.log(this.getStringOption("timingName")+" - drawGraph: "+(m-e)+"ms")}};R.prototype.renderGraph_=function(e){this.cascadeEvents_("clearChart"),this.plotter_.clear();let t=this.getFunctionOption("underlayCallback");t&&t.call(this,this.hidden_ctx_,this.layout_.getPlotArea(),this,this);var i={canvas:this.hidden_,drawingContext:this.hidden_ctx_};this.cascadeEvents_("willDrawChart",i),this.plotter_.render(),this.cascadeEvents_("didDrawChart",i),this.lastRow_=-1,this.canvas_.getContext("2d").clearRect(0,0,this.width_,this.height_);let n=this.getFunctionOption("drawCallback");if(n!==null&&n.call(this,this,e),e)for(this.readyFired_=!0;this.readyFns_.length>0;){var a=this.readyFns_.pop();a(this)}};R.prototype.computeYAxes_=function(){var e,t,i,n;for(this.axes_=[],e=0;e<this.attributes_.numAxes();e++)i={g:this},xt(i,this.attributes_.axisOptions(e)),this.axes_[e]=i;for(e=0;e<this.axes_.length;e++)if(e===0)i=this.optionsViewForAxis_("y"+(e?"2":"")),n=i("valueRange"),n&&(this.axes_[e].valueRange=n);else{var a=this.user_attrs_.axes;a&&a.y2&&(n=a.y2.valueRange,n&&(this.axes_[e].valueRange=n))}};R.prototype.numAxes=function(){return this.attributes_.numAxes()};R.prototype.axisPropertiesForSeries=function(e){return this.axes_[this.attributes_.axisForSeries(e)]};R.prototype.computeYAxisRanges_=function(e){for(var t=function($t){return isNaN(parseFloat($t))},i=this.attributes_.numAxes(),n,a,o,r,p,m=0;m<i;m++){var u=this.axes_[m],f=this.attributes_.getForAxis("logscale",m),_=this.attributes_.getForAxis("includeZero",m),x=this.attributes_.getForAxis("independentTicks",m);o=this.attributes_.seriesForAxis(m),n=!0,r=.1;let $t=this.getNumericOption("yRangePad");if($t!==null&&(n=!1,r=$t/this.plotter_.area.h),o.length===0)u.extremeRange=[0,1];else{for(var g=1/0,S=-1/0,C,E,L=0;L<o.length;L++)e.hasOwnProperty(o[L])&&(C=e[o[L]][0],C!==null&&(g=Math.min(C,g)),E=e[o[L]][1],E!==null&&(S=Math.max(E,S)));_&&!f&&(g>0&&(g=0),S<0&&(S=0)),g==1/0&&(g=0),S==-1/0&&(S=1),a=S-g,a===0&&(S!==0?a=Math.abs(S):(S=1,a=1));var O=S,H=g;n&&(f?(O=S+r*a,H=g):(O=S+r*a,H=g-r*a,H<0&&g>=0&&(H=0),O>0&&S<=0&&(O=0))),u.extremeRange=[H,O]}if(u.valueRange){var z=t(u.valueRange[0])?u.extremeRange[0]:u.valueRange[0],Q=t(u.valueRange[1])?u.extremeRange[1]:u.valueRange[1];u.computedValueRange=[z,Q]}else u.computedValueRange=u.extremeRange;if(!n){if(z=u.computedValueRange[0],Q=u.computedValueRange[1],z===Q)if(z===0)Q=1;else{var be=Math.abs(z/10);z-=be,Q+=be}if(f){var q=r/(2*r-1),J=(r-1)/(2*r-1);u.computedValueRange[0]=xn(z,Q,q),u.computedValueRange[1]=xn(z,Q,J)}else a=Q-z,u.computedValueRange[0]=z-a*r,u.computedValueRange[1]=Q+a*r}if(x){u.independentTicks=x;var _e=this.optionsViewForAxis_("y"+(m?"2":"")),j=_e("ticker");u.ticks=j(u.computedValueRange[0],u.computedValueRange[1],this.plotter_.area.h,_e,this),p||(p=u)}}if(p===void 0)throw'Configuration Error: At least one axis has to have the "independentTicks" option activated.';for(var m=0;m<i;m++){var u=this.axes_[m];if(!u.independentTicks){for(var _e=this.optionsViewForAxis_("y"+(m?"2":"")),j=_e("ticker"),me=p.ticks,ct=p.computedValueRange[1]-p.computedValueRange[0],Oe=u.computedValueRange[1]-u.computedValueRange[0],Dt=[],je=0;je<me.length;je++){var ye=(me[je].v-p.computedValueRange[0])/ct,Mi=u.computedValueRange[0]+ye*Oe;Dt.push(Mi)}u.ticks=j(u.computedValueRange[0],u.computedValueRange[1],this.plotter_.area.h,_e,this,Dt)}}};R.prototype.detectTypeFromString_=function(e){var t=!1,i=e.indexOf("-");(i>0&&e[i-1]!="e"&&e[i-1]!="E"||e.indexOf("/")>=0||isNaN(parseFloat(e)))&&(t=!0),this.setXAxisOptions_(t)};R.prototype.setXAxisOptions_=function(e){e?(this.attrs_.xValueParser=_o,this.attrs_.axes.x.valueFormatter=dn,this.attrs_.axes.x.ticker=Ci,this.attrs_.axes.x.axisLabelFormatter=Ti):(this.attrs_.xValueParser=function(t){return parseFloat(t)},this.attrs_.axes.x.valueFormatter=function(t){return t},this.attrs_.axes.x.ticker=ti,this.attrs_.axes.x.axisLabelFormatter=this.attrs_.axes.x.valueFormatter)};R.prototype.parseCSV_=function(e){var t=[],i=Co(e),n=e.split(i||`
`),a,o,r=this.getStringOption("delimiter");n[0].indexOf(r)==-1&&n[0].indexOf("	")>=0&&(r="	");var p=0;"labels"in this.user_attrs_||(p=1,this.attrs_.labels=n[0].split(r),this.attributes_.reparseSeries());for(var m=0,u,f=!1,_=this.attr_("labels").length,x=!1,g=p;g<n.length;g++){var S=n[g];if(m=g,S.length!==0&&S[0]!="#"){var C=S.split(r);if(!(C.length<2)){var E=[];if(f||(this.detectTypeFromString_(C[0]),u=this.getFunctionOption("xValueParser"),f=!0),E[0]=u(C[0],this),this.fractions_)for(o=1;o<C.length;o++)a=C[o].split("/"),a.length!=2?(console.error(`Expected fractional "num/den" values in CSV data but found a value '`+C[o]+"' on line "+(1+g)+" ('"+S+"') which is not of this form."),E[o]=[0,0]):E[o]=[ni(a[0],g,S),ni(a[1],g,S)];else if(this.getBooleanOption("errorBars"))for(C.length%2!=1&&console.error("Expected alternating (value, stdev.) pairs in CSV data but line "+(1+g)+" has an odd number of values ("+(C.length-1)+"): '"+S+"'"),o=1;o<C.length;o+=2)E[(o+1)/2]=[ni(C[o],g,S),ni(C[o+1],g,S)];else if(this.getBooleanOption("customBars"))for(o=1;o<C.length;o++){var L=C[o];/^ *$/.test(L)?E[o]=[null,null,null]:(a=L.split(";"),a.length==3?E[o]=[ni(a[0],g,S),ni(a[1],g,S),ni(a[2],g,S)]:console.warn('When using customBars, values must be either blank or "low;center;high" tuples (got "'+L+'" on line '+(1+g)+")"))}else for(o=1;o<C.length;o++)E[o]=ni(C[o],g,S);if(t.length>0&&E[0]<t[t.length-1][0]&&(x=!0),E.length!=_&&console.error("Number of columns in line "+g+" ("+E.length+") does not agree with number of labels ("+_+") "+S),g===0&&this.attr_("labels")){var O=!0;for(o=0;O&&o<E.length;o++)E[o]&&(O=!1);if(O){console.warn("The dygraphs 'labels' option is set, but the first row of CSV data ('"+S+"') appears to also contain labels. Will drop the CSV labels and use the option labels.");continue}}t.push(E)}}}return x&&(console.warn("CSV is out of order; order it correctly to speed loading."),t.sort(function(H,z){return H[0]-z[0]})),t};function A0(e){let t=e[0],i=t[0];if(typeof i!="number"&&!go(i))throw new Error(`Expected number or date but got ${typeof i}: ${i}.`);for(let n=1;n<t.length;n++){let a=t[n];if(a!=null&&typeof a!="number"&&!wi(a))throw new Error(`Expected number or array but got ${typeof a}: ${a}.`)}}R.prototype.parseArray_=function(e){if(e.length===0&&(e=[[0]]),e[0].length===0)return console.error("Data set cannot contain an empty row"),null;A0(e);var t;if(this.attr_("labels")===null){for(console.warn("Using default labels. Set labels explicitly via 'labels' in the options parameter"),this.attrs_.labels=["X"],t=1;t<e[0].length;t++)this.attrs_.labels.push("Y"+t);this.attributes_.reparseSeries()}else{var i=this.attr_("labels");if(i.length!=e[0].length)return console.error("Mismatch between number of labels ("+i+") and number of columns in array ("+e[0].length+")"),null}if(go(e[0][0])){this.attrs_.axes.x.valueFormatter=dn,this.attrs_.axes.x.ticker=Ci,this.attrs_.axes.x.axisLabelFormatter=Ti;var n=vo(e);for(t=0;t<e.length;t++){if(n[t].length===0)return console.error("Row "+(1+t)+" of data is empty"),null;if(n[t][0]===null||typeof n[t][0].getTime!="function"||isNaN(n[t][0].getTime()))return console.error("x value in row "+(1+t)+" is not a Date"),null;n[t][0]=n[t][0].getTime()}return n}else return this.attrs_.axes.x.valueFormatter=function(a){return a},this.attrs_.axes.x.ticker=ti,this.attrs_.axes.x.axisLabelFormatter=wn,e};R.prototype.parseDataTable_=function(e){var t=function(z){var Q=String.fromCharCode(65+z%26);for(z=Math.floor(z/26);z>0;)Q=String.fromCharCode(65+(z-1)%26)+Q.toLowerCase(),z=Math.floor((z-1)/26);return Q},i=e.getNumberOfColumns(),n=e.getNumberOfRows(),a=e.getColumnType(0);if(a=="date"||a=="datetime")this.attrs_.xValueParser=_o,this.attrs_.axes.x.valueFormatter=dn,this.attrs_.axes.x.ticker=Ci,this.attrs_.axes.x.axisLabelFormatter=Ti;else if(a=="number")this.attrs_.xValueParser=function(z){return parseFloat(z)},this.attrs_.axes.x.valueFormatter=function(z){return z},this.attrs_.axes.x.ticker=ti,this.attrs_.axes.x.axisLabelFormatter=this.attrs_.axes.x.valueFormatter;else throw new Error("only 'date', 'datetime' and 'number' types are supported for column 1 of DataTable input (Got '"+a+"')");var o=[],r={},p=!1,m,u;for(m=1;m<i;m++){var f=e.getColumnType(m);if(f=="number")o.push(m);else if(f=="string"&&this.getBooleanOption("displayAnnotations")){var _=o[o.length-1];r.hasOwnProperty(_)?r[_].push(m):r[_]=[m],p=!0}else throw new Error("Only 'number' is supported as a dependent type with Gviz. 'string' is only supported if displayAnnotations is true")}var x=[e.getColumnLabel(0)];for(m=0;m<o.length;m++)x.push(e.getColumnLabel(o[m])),this.getBooleanOption("errorBars")&&(m+=1);this.attrs_.labels=x,i=x.length;var g=[],S=!1,C=[];for(m=0;m<n;m++){var E=[];if(typeof e.getValue(m,0)>"u"||e.getValue(m,0)===null){console.warn("Ignoring row "+m+" of DataTable because of undefined or null first column.");continue}if(a=="date"||a=="datetime"?E.push(e.getValue(m,0).getTime()):E.push(e.getValue(m,0)),this.getBooleanOption("errorBars"))for(u=0;u<i-1;u++)E.push([e.getValue(m,1+2*u),e.getValue(m,2+2*u)]);else{for(u=0;u<o.length;u++){var L=o[u];if(E.push(e.getValue(m,L)),p&&r.hasOwnProperty(L)&&e.getValue(m,r[L][0])!==null){var O={};O.series=e.getColumnLabel(L),O.xval=E[0],O.shortText=t(C.length),O.text="";for(var H=0;H<r[L].length;H++)H&&(O.text+=`
`),O.text+=e.getValue(m,r[L][H]);C.push(O)}}for(u=0;u<E.length;u++)isFinite(E[u])||(E[u]=null)}g.length>0&&E[0]<g[g.length-1][0]&&(S=!0),g.push(E)}S&&(console.warn("DataTable is out of order; order it correctly to speed loading."),g.sort(function(z,Q){return z[0]-Q[0]})),this.rawData_=g,C.length>0&&this.setAnnotations(C,!0),this.attributes_.reparseSeries()};R.prototype.cascadeDataDidUpdateEvent_=function(){this.cascadeEvents_("dataDidUpdate",{})};R.prototype.start_=function(){var e=this.file_;typeof e=="function"&&(e=e());let t=yl(e);if(t=="array")this.rawData_=this.parseArray_(e),this.cascadeDataDidUpdateEvent_(),this.predraw_();else if(t=="object"&&typeof e.getColumnRange=="function")this.parseDataTable_(e),this.cascadeDataDidUpdateEvent_(),this.predraw_();else if(t=="string"){var i=Co(e);if(i)this.loadedEvent_(e);else{var n;window.XMLHttpRequest?n=new XMLHttpRequest:n=new ActiveXObject("Microsoft.XMLHTTP");var a=this;n.onreadystatechange=function(){n.readyState==4&&(n.status===200||n.status===0)&&a.loadedEvent_(n.responseText)},n.open("GET",e,!0),n.send(null)}}else console.error("Unknown data format: "+t)};R.prototype.updateOptions=function(e,t){typeof t>"u"&&(t=!1);var i=e.file,n=R.copyUserAttrs_(e),a=this.attributes_.numAxes();"rollPeriod"in n&&(this.rollPeriod_=n.rollPeriod),"dateWindow"in n&&(this.dateWindow_=n.dateWindow);var o=xl(this.attr_("labels"),n);Ma(this.user_attrs_,n),this.attributes_.reparseSeries(),a<this.attributes_.numAxes()&&this.plotter_.clear(),i?(this.cascadeEvents_("dataWillUpdate",{}),this.file_=i,t||this.start_()):t||(o?this.predraw_():this.renderGraph_(!1))};R.copyUserAttrs_=function(e){var t={};for(var i in e)e.hasOwnProperty(i)&&i!="file"&&e.hasOwnProperty(i)&&(t[i]=e[i]);return t};R.prototype.resize=function(e,t){if(!this.resize_lock){this.resize_lock=!0,e===null!=(t===null)&&(console.warn("Dygraph.resize() should be called with zero parameters or two non-NULL parameters. Pretending it was zero."),e=t=null);var i=this.width_,n=this.height_;e?(this.maindiv_.style.width=e+"px",this.maindiv_.style.height=t+"px",this.width_=e,this.height_=t):(this.width_=this.maindiv_.clientWidth,this.height_=this.maindiv_.clientHeight),(i!=this.width_||n!=this.height_)&&(this.resizeElements_(),this.predraw_()),this.resize_lock=!1}};R.prototype.adjustRoll=function(e){this.rollPeriod_=e,this.predraw_()};R.prototype.visibility=function(){for(this.getOption("visibility")||(this.attrs_.visibility=[]);this.getOption("visibility").length<this.numColumns()-1;)this.attrs_.visibility.push(!0);return this.getOption("visibility")};R.prototype.setVisibility=function(e,t){var i=this.visibility(),n=!1;if(Array.isArray(e)||(e!==null&&typeof e=="object"?n=!0:e=[e]),n)for(var a in e)e.hasOwnProperty(a)&&(a<0||a>=i.length?console.warn("Invalid series number in setVisibility: "+a):i[a]=e[a]);else for(var a=0;a<e.length;a++)typeof e[a]=="boolean"?a>=i.length?console.warn("Invalid series number in setVisibility: "+a):i[a]=e[a]:e[a]<0||e[a]>=i.length?console.warn("Invalid series number in setVisibility: "+e[a]):i[e[a]]=t;this.predraw_()};R.prototype.size=function(){return{width:this.width_,height:this.height_}};R.prototype.setAnnotations=function(e,t){if(this.annotations_=e,!this.layout_){console.warn("Tried to setAnnotations before dygraph was ready. Try setting them in a ready() block. See dygraphs.com/tests/annotation.html");return}this.layout_.setAnnotations(this.annotations_),t||this.predraw_()};R.prototype.annotations=function(){return this.annotations_};R.prototype.getLabels=function(){var e=this.attr_("labels");return e?e.slice():null};R.prototype.indexFromSetName=function(e){return this.setIndexByName_[e]};R.prototype.getRowForX=function(e){for(var t=0,i=this.numRows()-1;t<=i;){var n=i+t>>1,a=this.getValue(n,0);if(a<e)t=n+1;else if(a>e)i=n-1;else if(t!=n)i=n;else return n}return null};R.prototype.ready=function(e){this.is_initial_draw_?this.readyFns_.push(e):e.call(this,this)};R.prototype.addAndTrackEvent=function(e,t,i){Si(e,t,i),this.registeredEvents_.push({elem:e,type:t,fn:i})};R.prototype.removeTrackedEvents_=function(){if(this.registeredEvents_)for(var e=0;e<this.registeredEvents_.length;e++){var t=this.registeredEvents_[e];Pt(t.elem,t.type,t.fn)}this.registeredEvents_=[]};R.PLUGINS=[Mo,Eo,Ro,ko,Po,Ao];R.GVizChart=Al;R.DASHED_LINE=fl;R.DOT_DASH_LINE=_l;R.dateAxisLabelFormatter=Ti;R.toRGB_=mn;R.findPos=ui;R.pageX=on;R.pageY=rn;R.dateString_=fo;R.defaultInteractionModel=Et.defaultModel;R.nonInteractiveModel=R.nonInteractiveModel_=Et.nonInteractiveModel_;R.Circles=Sn;R.Plugins={Legend:Mo,Axes:Eo,Annotations:Po,ChartLabels:ko,Grid:Ao,RangeSelector:Ro};R.DataHandlers={DefaultHandler:Pn,BarsHandler:hi,CustomBarsHandler:wo,DefaultFractionHandler:To,ErrorBarsHandler:So,FractionsBarsHandler:Do};R.startPan=Et.startPan;R.startZoom=Et.startZoom;R.movePan=Et.movePan;R.moveZoom=Et.moveZoom;R.endPan=Et.endPan;R.endZoom=Et.endZoom;R.numericLinearTicks=cl;R.numericTicks=ti;R.dateTicker=Ci;R.Granularity=re;R.getDateAxis=so;R.floatFormat=ho;wl(R);var Ye=R;function M0(e,t){e&1&&w(0,"div",0)}function R0(e,t){if(e&1){let i=V();s(0,"div",1),k("click",function(){let a=A(i).$implicit,o=h();return M(o.doSelect(a))}),l(),v(1,M0,1,0,"div",0)}if(e&2){let i=t.$implicit,n=t.$index,a=h();St("background-color",i),de("selected",i===a.selectedColor),d(),b((n+1)%10===0?1:-1)}}var Io=["#ff0029","#377eb8","#66a61e","#984ea3","#00d2d5","#ff7f00","#af8d00","#7f80cd","#b3e900","#c42e60","#a65628","#f781bf","#8dd3c7","#bebada","#fb8072","#80b1d3","#fdb462","#fccde5","#bc80bd","#ffed6f","#c4eaff","#cf8c00","#1b9e77","#d95f02","#e7298a","#e6ab02","#a6761d","#0097ff","#00d067","#000000"],Ha=(()=>{let t=class t{constructor(){this.selectedColor=Io[Math.floor(Math.random()*Io.length)],this.select=new it,this.colors=Io}doSelect(n){this.select.emit(n),this.selectedColor=n}};t.\u0275fac=function(a){return new(a||t)},t.\u0275cmp=F({type:t,selectors:[["app-color-palette"]],inputs:{selectedColor:"selectedColor"},outputs:{select:"select"},standalone:!0,features:[N],decls:3,vars:0,consts:[[2,"clear","both"],[1,"box",3,"click"]],template:function(a,o){a&1&&(ne(0,R0,2,5,null,null,ie),w(2,"div",0)),a&2&&ae(o.colors)},dependencies:[U],styles:[".box[_ngcontent-%COMP%]{float:left;width:20px;height:20px;box-sizing:border-box;cursor:pointer}.box[_ngcontent-%COMP%]:hover{border:1px solid black}.box.selected[_ngcontent-%COMP%]{border:2px solid black}"],changeDetection:0});let e=t;return e})();function L0(e,t){if(e&1){let i=V();s(0,"div",2),k("click",function(){let a=A(i).$implicit,o=h();return M(o.select(a))}),l()}if(e&2){let i=t.$implicit,n=h();St("border-bottom",i+"px solid")("border-color",i===n.selectedThickness?n.color:"black"),de("selected",i===n.selectedThickness)}}var Ba=(()=>{let t=class t{constructor(n){this.changeDetection=n,this.options=[1,2,3,4],this.selectedThickness=2}select(n){this.selectedThickness=n}changeColor(n){this.color=n,this.changeDetection.detectChanges()}};t.\u0275fac=function(a){return new(a||t)(D(Rt))},t.\u0275cmp=F({type:t,selectors:[["app-thickness"]],inputs:{selectedThickness:"selectedThickness",color:"color"},standalone:!0,features:[N],decls:3,vars:0,consts:[[1,"box",3,"selected","borderBottom","borderColor"],[2,"clear","both"],[1,"box",3,"click"]],template:function(a,o){a&1&&(ne(0,L0,1,6,"div",0,ie),w(2,"div",1)),a&2&&ae(o.options)},dependencies:[U],styles:[".box[_ngcontent-%COMP%]{float:left;width:30px;height:20px;box-sizing:border-box;cursor:pointer;margin-right:5px}"],changeDetection:0});let e=t;return e})();var I0=["palette"],O0=["thickness"],Ml=(()=>{let t=class t{constructor(n,a){this.dialogRef=n,this.data=a}select(){this.dialogRef.close({color:this.palette.selectedColor,thickness:this.thickness.selectedThickness})}};t.\u0275fac=function(a){return new(a||t)(D(Fe),D(Ze))},t.\u0275cmp=F({type:t,selectors:[["app-modify-parameter-dialog"]],viewQuery:function(a,o){if(a&1&&(ue(I0,7),ue(O0,7)),a&2){let r;ce(r=pe())&&(o.palette=r.first),ce(r=pe())&&(o.thickness=r.first)}},standalone:!0,features:[N],decls:17,vars:3,consts:[["palette",""],["thickness",""],[3,"select","selectedColor"],[3,"selectedThickness","color"],["align","end"],["mat-dialog-close","",1,"ya-button"],[1,"ya-button","primary",3,"click"]],template:function(a,o){if(a&1){let r=V();s(0,"mat-dialog-content")(1,"label"),c(2,"Color"),l(),w(3,"br"),s(4,"app-color-palette",2,0),k("select",function(m){A(r);let u=oe(11);return M(u.changeColor(m))}),l(),w(6,"br"),s(7,"label"),c(8,"Thickness"),l(),w(9,"br")(10,"app-thickness",3,1),l(),s(12,"mat-dialog-actions",4)(13,"button",5),c(14,"CANCEL"),l(),s(15,"button",6),k("click",function(){return A(r),M(o.select())}),c(16,"OK"),l()()}a&2&&(d(4),y("selectedColor",o.data.color),d(6),y("selectedThickness",o.data.strokeWidth)("color",o.data.color))},dependencies:[Ha,U,Ne,He,$e,Ba],encapsulation:2,changeDetection:0});let e=t;return e})();function F0(e,t){if(e&1&&(s(0,"div",1)(1,"div",2)(2,"span",3),c(3),T(4,"datetime"),l()()()),e&2){let i=h(2);St("left",i.timestampData.canvasx+"px"),d(),St("background-color","black"),d(2),Y(tt(4,5,i.timestampData.timestamp,!1))}}function V0(e,t){if(e&1&&v(0,F0,5,8,"div",0),e&2){let i=h();b(i.timestampData?0:-1)}}var Rl=(()=>{let t=class t{};t.\u0275fac=function(a){return new(a||t)},t.\u0275cmp=F({type:t,selectors:[["app-timestamp-tracker"]],inputs:{legendData:"legendData",timestampData:"timestampData"},standalone:!0,features:[N],decls:1,vars:1,consts:[[1,"timestamp",2,"pointer-events","none",3,"left"],[1,"timestamp",2,"pointer-events","none"],[1,"box"],[1,"xvalue"]],template:function(a,o){a&1&&v(0,V0,1,1),a&2&&b(o.legendData!=null&&o.legendData.x?0:-1)},dependencies:[U,Le],styles:[".timestamp[_ngcontent-%COMP%]{position:absolute;bottom:0;background-color:transparent}.box[_ngcontent-%COMP%]{margin-top:5px;margin-right:5px;padding-left:3px;padding-right:3px;border-radius:2px;display:inline-block;font-size:10px;line-height:14px;position:relative;left:-50%}.xvalue[_ngcontent-%COMP%]{margin-left:5px;font-weight:700;color:#fff;white-space:nowrap}"],changeDetection:0});let e=t;return e})();var Ua=class{constructor(){this.canvas=document.createElement("canvas")}activate(t){return t.graphDiv.appendChild(this.canvas),{select:this.select,deselect:this.deselect}}select(t){let i=t.dygraph.width_,n=t.dygraph.height_;this.canvas.width=i,this.canvas.height=n,this.canvas.style.width=i+"px",this.canvas.style.height=n+"px";let a=this.canvas.getContext("2d");a.clearRect(0,0,i,n),a.strokeStyle="#e1e1e1",a.beginPath();for(let o of t.dygraph.selPoints_){let r=Math.floor(o.canvasy)+.5;a.moveTo(0,r),a.lineTo(i,r)}a.stroke(),a.closePath()}deselect(t){this.canvas.getContext("2d").clearRect(0,0,this.canvas.width,this.canvas.height)}destroy(){this.canvas=null}toString(){return"Crosshair Plugin"}};var kn=class{constructor(){this.yLimits=[]}activate(t){return{willDrawChart:this.willDrawChart}}setAlarmZones(t){this.yLimits=[];for(let i of t)this.yLimits.push(i.y1IsLimit?i.y1:i.y2)}willDrawChart(t){let i=t.dygraph,n=t.drawingContext,a=i.layout_,o=t.dygraph.plotter_.area;if(i.getOptionForAxis("drawGrid","y")){let r=["y","y2"],p=[],m=[],u=[],f=[],_=[];for(let g=0;g<r.length;g++)u[g]=i.getOptionForAxis("drawGrid",r[g]),u[g]&&(p[g]=i.getOptionForAxis("gridLineColor",r[g]),m[g]=i.getOptionForAxis("gridLineWidth",r[g]),_[g]=i.getOptionForAxis("gridLinePattern",r[g]),f[g]=_[g]&&_[g].length>=2);let x=a.yticks;n.save();for(let g of x){if(!g.has_tick||this.yLimits.indexOf(parseFloat(g.label))>=0)continue;let S=g.axis;if(u[S]){n.save(),f[S]&&n.setLineDash&&n.setLineDash(_[S]),n.strokeStyle=p[S],n.lineWidth=m[S];let C=this.halfUp(o.x),E=this.halfDown(o.y+g.pos*o.h);n.beginPath(),n.moveTo(C,E),n.lineTo(C+o.w,E),n.stroke(),n.restore()}}n.restore()}if(i.getOptionForAxis("drawGrid","x")){let r=a.xticks;n.save();let p=i.getOptionForAxis("gridLinePattern","x"),m=p&&p.length>=2;m&&n.setLineDash&&n.setLineDash(p),n.strokeStyle=i.getOptionForAxis("gridLineColor","x"),n.lineWidth=i.getOptionForAxis("gridLineWidth","x");for(let u of r){if(!u.has_tick)continue;let f=this.halfUp(o.x+u.pos*o.w),_=this.halfDown(o.y+o.h);n.beginPath(),n.moveTo(f,_),n.lineTo(f,o.y),n.closePath(),n.stroke()}m&&n.setLineDash&&n.setLineDash([]),n.restore()}}halfUp(t){return Math.round(t)+.5}halfDown(t){return Math.round(t)-.5}toString(){return"Gridline Plugin"}destroy(){}};function Ga(e){let t,i,n=[];if(e.type&&e.type.defaultAlarm){let o=e.type.defaultAlarm;if(o.staticAlarmRange){let r=-1/0;for(let p=o.staticAlarmRange.length-1;p>=0;p--){let m=o.staticAlarmRange[p];if(m.minInclusive!==void 0){let u={y1:r,y2:m.minInclusive,y1IsLimit:!1,color:Ll(m.level)||"black"};n.push(u),r=u.y2,t===void 0?t=m.minInclusive:t=Math.min(t,m.minInclusive)}}r=1/0;for(let p=o.staticAlarmRange.length-1;p>=0;p--){let m=o.staticAlarmRange[p];if(m.maxInclusive){let u={y1:m.maxInclusive,y2:r,y1IsLimit:!0,color:Ll(m.level)||"black"};n.push(u),r=u.y1,i===void 0?i=m.maxInclusive:i=Math.max(i,m.maxInclusive)}}}}let a=[null,null];return t!==void 0&&(a[0]=t),i!==void 0&&(a[1]=i),{valueRange:a,staticAlarmZones:n}}function Ll(e){switch(e){case"WATCH":return"#ffdddb";case"WARNING":return"#ffc3c1";case"DISTRESS":return"#ffaaa8";case"CRITICAL":return"#c35e5c";case"SEVERE":return"#a94442";default:console.error("Unknown level "+e)}}function N0(e,t){if(e&1&&(s(0,"span",4),c(1),l()),e&2){let i=h().$implicit;d(),Y(i.yHTML)}}function $0(e,t){if(e&1){let i=V();s(0,"div",6),k("click",function(){A(i);let a=h().$implicit,o=h(2);return M(o.close.emit(a.label))}),s(1,"mat-icon",7),c(2,"close"),l()()}}function H0(e,t){if(e&1){let i=V();s(0,"div",2)(1,"span",3),k("click",function(){let a=A(i).$implicit,o=h(2);return M(o.select.emit(a.label))}),c(2),l(),v(3,N0,2,1,"span",4)(4,$0,3,0,"div",5),l()}if(e&2){let i=t.$implicit,n=t.$index,a=h(2);St("background-color",a.backgroundColor)("border","1px solid "+a.borderColor)("border-left","3px solid "+i.color)("padding-right",a.closable&&n!==0?"15px":"5px"),d(2),Y(i.label),d(),b(i.yHTML?3:-1),d(),b(a.closable&&n!==0?4:-1)}}function B0(e,t){if(e&1&&(s(0,"div",0),ne(1,H0,5,11,"div",1,ie),l()),e&2){let i=h();d(),ae(i.data.series)}}var Il=(()=>{let t=class t{constructor(){this.closable=!1,this.select=new it,this.close=new it}};t.\u0275fac=function(a){return new(a||t)},t.\u0275cmp=F({type:t,selectors:[["app-parameter-legend"]],inputs:{data:"data",backgroundColor:"backgroundColor",borderColor:"borderColor",closable:"closable"},outputs:{select:"select",close:"close"},standalone:!0,features:[N],decls:1,vars:1,consts:[[1,"legend","no-select"],[1,"legend-box",3,"backgroundColor","border","borderLeft","paddingRight"],[1,"legend-box"],[1,"label",3,"click"],[1,"yvalue"],[1,"close-button"],[1,"close-button",3,"click"],[1,"icon12"]],template:function(a,o){a&1&&v(0,B0,3,0,"div",0),a&2&&b(o.data?0:-1)},dependencies:[fe],styles:[".legend[_ngcontent-%COMP%]{position:absolute;top:0;left:63px;background-color:transparent}.legend-box[_ngcontent-%COMP%]{margin-top:5px;margin-right:5px;padding-left:3px;padding-right:15px;border-radius:2px;display:inline-block;font-size:10px;line-height:14px;position:relative}.label[_ngcontent-%COMP%]{cursor:pointer}.label[_ngcontent-%COMP%]:hover{opacity:.7}.yvalue[_ngcontent-%COMP%]{margin-left:5px;font-weight:700}.close-button[_ngcontent-%COMP%]{position:absolute;top:0;right:0;cursor:pointer}"],changeDetection:0});let e=t;return e})();var An=(()=>{let t=class t{constructor(){this.grid=!1,this.axis=!0,this.axisLineWidth=1,this.alarmRanges="line",this.color="#1b61b9",this.strokeWidth=2}};t.\u0275fac=function(a){return new(a||t)},t.\u0275cmp=F({type:t,selectors:[["app-parameter-series"]],inputs:{parameter:"parameter",grid:"grid",axis:"axis",axisLineWidth:"axisLineWidth",alarmRanges:"alarmRanges",color:"color",label:"label",strokeWidth:"strokeWidth"},standalone:!0,features:[N],decls:0,vars:0,template:function(a,o){},encapsulation:2});let e=t;return e})();var U0=["graphContainer"],Oo=(()=>{let t=class t{constructor(n,a){this.dialog=n,this.formatter=a,this.fillGraph=!1,this.xGrid=!1,this.xAxis=!0,this.xAxisLineWidth=1,this.duration="PT1H",this.height="100%",this.width="100%",this.removableSeries=!1,this.stop=new Date,this.crosshair="vertical",this.axisBackgroundColor="#fafafa",this.axisLineColor="#e1e1e1",this.gridLineColor="#f2f2f2",this.plotAreaBackgroundColor="#fff",this.highlightColor="#e1e1e1",this.onVisibleRange=new it,this.onManualRangeChange=new it,this.parameters=[],this.parameterConfig=new Map,this.disableDataReload=!1,this.legendData$=new B(null),this.timestampTrackerData$=new B(null)}ngAfterViewInit(){this.dataSource.parameters$.value.forEach(a=>{this.parameters.push(a)}),this.seriesComponents.forEach(a=>{this.parameterConfig.set(a.parameter,a)});let n=this.graphContainer.nativeElement;if(this.initDygraphs(n),this.dataSource.data$.subscribe(a=>{if(this.disableDataReload)return;let o={file:a.samples.length?a.samples:`X
`};if(this.dataSource.visibleStart&&(o.dateWindow=[this.dataSource.visibleStart.getTime(),this.dataSource.visibleStop.getTime()],this.onVisibleRange.emit([this.dataSource.visibleStart,this.dataSource.visibleStop])),a.valueRange[0]!==null&&a.valueRange[1]!==null)o.axes={y:{valueRange:a.valueRange}};else{let r=Ga(this.parameters[0]).valueRange,p=r[0];this.dataSource.minValue!==void 0&&(p=p!==null?Math.min(p,this.dataSource.minValue):this.dataSource.minValue);let m=r[1];this.dataSource.maxValue!==void 0&&(m=m!==null?Math.max(m,this.dataSource.maxValue):this.dataSource.maxValue),p===m&&p!==null&&(p=Math.min(p,0),m=Math.max(m,0)),p!==null&&m!==null&&(p=p-(m-p)*.1,m=m+(m-p)*.1),o.axes={y:{valueRange:[p,m]}}}this.dygraph.updateOptions(o)}),this.duration){let a=this.stop,o=$.subtractDuration(a,this.duration);this.dataSource.updateWindow(o,a,[null,null])}this.applyTheme()}initDygraphs(n){let a={},o=this.parameters.map(g=>this.parameterConfig.get(g.qualifiedName));o.forEach(g=>{a[g.label||g.parameter]={color:g.color,strokeWidth:g.strokeWidth}});let r=this.parameters[0],p=o[0],u=Ga(r).staticAlarmZones,f=null,_={legend:"always",fillGraph:this.fillGraph,drawGrid:!1,drawPoints:!1,showRoller:!1,customBars:!0,gridLineColor:this.gridLineColor,axisLineColor:this.axisLineColor,axisLabelFontSize:11,digitsAfterDecimal:6,labels:["Generation Time",...o.map(g=>g.label||g.parameter)],rightGap:0,labelsUTC:this.formatter.isUTC(),series:a,axes:{x:{drawAxis:this.xAxis,drawGrid:this.xGrid,axisLineWidth:this.xAxisLineWidth||1e-7},y:{axisLabelWidth:50,drawAxis:p.axis,drawGrid:p.grid,axisLineWidth:p.axisLineWidth||1e-7,valueRange:Ga(r).valueRange}},interactionModel:{mousedown:(g,S,C)=>{C.initializeMouseDown(g,S,C),g.altKey||g.shiftKey?Ye.startZoom(g,S,C):Ye.startPan(g,S,C)},mousemove:(g,S,C)=>{C.isPanning?(this.disableDataReload=!0,Ye.movePan(g,S,C)):C.isZooming&&(this.disableDataReload=!0,Ye.moveZoom(g,S,C))},mouseup:(g,S,C)=>{C.isPanning?Ye.endPan(g,S,C):C.isZooming&&Ye.endZoom(g,S,C);let E=S.xAxisRange(),L=new Date(E[0]),O=new Date(E[1]),H=S.yAxisRanges()[0];this.dataSource.updateWindow(L,O,H),this.onManualRangeChange.emit(),this.disableDataReload=!1},click:(g,S,C)=>{f=S,g.preventDefault(),g.stopPropagation()},mouseout:(g,S,C)=>{if(C.isPanning){let E=S.xAxisRange(),L=new Date(E[0]),O=new Date(E[1]),H=S.yAxisRanges()[0];this.dataSource.updateWindow(L,O,H)}this.disableDataReload=!1},mousewheel:(g,S,C)=>{if(f!==S)return;let L=(g.detail?g.detail*-1:g.deltaY/40)/50;g.offsetX&&g.offsetY||(g.offsetX=g.layerX-g.target.offsetLeft,g.offsetY=g.layerY-g.target.offsetTop);let O=this.offsetToPercentage(g.offsetX);this.zoom(L,O),g.preventDefault(),g.stopPropagation()}},underlayCallback:(g,S,C)=>{if(g.save(),g.globalAlpha=1,g.fillStyle=this.plotAreaBackgroundColor,g.fillRect(S.x,S.y,S.w,S.h),p.alarmRanges==="line")for(let E of u){let L=E.y1IsLimit?E.y1:E.y2,O=C.toDomCoords(0,L)[1];g.strokeStyle=E.color,g.lineWidth=1,g.beginPath(),g.moveTo(S.x,O),g.lineTo(S.x+S.w,O),g.stroke()}else if(p.alarmRanges==="fill"){g.globalAlpha=.2;for(let E of u){if(E.y2===null)return;let L,O;E.y1===-1/0?L=S.y+S.h:L=C.toDomCoords(0,E.y1)[1],E.y2===1/0?O=0:O=C.toDomCoords(0,E.y2)[1],g.fillStyle=E.color,g.fillRect(S.x,Math.min(L,O),S.w,Math.abs(O-L))}}g.restore()},drawHighlightPointCallback:(g,S,C,E,L,O,H)=>{if((p.label||p.parameter)===S){C.save(),C.setLineDash([5,5]),C.strokeStyle=this.highlightColor,C.lineWidth=1,this.timestampTrackerData$.next({timestamp:new Date(g.selPoints_[0].xval),canvasx:g.selPoints_[0].canvasx}),C.beginPath();let z=Math.floor(g.selPoints_[0].canvasx)+.5;if((this.crosshair==="vertical"||this.crosshair==="both")&&(C.moveTo(z,0),C.lineTo(z,g.height_)),this.crosshair==="horizontal"||this.crosshair==="both")for(let Q of g.selPoints_){let be=Math.floor(Q.canvasy)+.5;C.moveTo(0,be),C.lineTo(g.width_,be)}C.stroke(),C.closePath(),C.restore()}C.beginPath(),C.arc(E,L,H,0,2*Math.PI,!1),C.fill()},legendFormatter:g=>{for(let S of g.series)if(S.y===void 0){let C=this.dataSource.latestRealtimeValues.get(S.label);C&&(S.y=C[1],S.yHTML=String(C[1]))}return this.legendData$.next(g),""},plugins:[new Ua]};this.xAxisHeight!==void 0&&(_.xAxisHeight=this.xAxisHeight),Ye.Plugins.Grid=kn,Ye.PLUGINS=[Ye.Plugins.Legend,Ye.Plugins.Axes,Ye.Plugins.Annotations,Ye.Plugins.ChartLabels,Ye.Plugins.Grid,Ye.Plugins.RangeSelector],this.dygraph=new Ye(n,`X
`,_),this.dygraph.getPluginInstance_(kn).setAlarmZones(u)}getParameters(){return this.parameters}addParameter(n,a){this.dataSource.addParameter(n),this.parameters.push(n),this.parameterConfig.set(n.qualifiedName,a),this.updateDygraphSeries()}removeParameter(n){let a=n;this.dataSource.removeParameter(a),this.parameters=this.parameters.filter(o=>o.qualifiedName!==a),this.parameterConfig.delete(a),this.updateDygraphSeries()}modifyParameter(n){let a=this.dygraph.getPropertiesForSeries(n);this.dialog.open(Ml,{data:bt(et({},a),{strokeWidth:this.dygraph.getOption("strokeWidth",n)})}).afterClosed().subscribe(r=>{if(r){let p=this.parameterConfig.get(n);p.color=r.color,p.strokeWidth=r.thickness,this.updateDygraphSeries()}})}updateDygraphSeries(){let n={},a=this.parameters.map(r=>this.parameterConfig.get(r.qualifiedName));a.forEach(r=>{n[r.label||r.parameter]={color:r.color,strokeWidth:r.strokeWidth}});let o={labels:["Generation Time",...a.map(r=>r.label||r.parameter)],series:n};this.dataSource.reloadVisibleRange().then(()=>{this.dygraph.updateOptions(o,!0)})}applyTheme(){if(this.dygraph&&this.dygraph.updateOptions({axisLineColor:this.axisLineColor,gridLineColor:this.gridLineColor}),this.graphContainer){let n=this.graphContainer.nativeElement;n.style.backgroundColor=this.axisBackgroundColor}}getDateRange(){if(this.dygraph){let n=this.dygraph.xAxisRange();return[new Date(n[0]),new Date(n[1])]}}zoomIn(){this.zoom(.2)}zoomOut(){this.zoom(-.25)}reset(){let n=this.dygraph.xAxisRange(),a=new Date(n[0]),o=new Date(n[1]);this.dataSource.updateWindow(a,o,[null,null])}zoom(n,a=.5){this.dygraph.updateOptions({dateWindow:this.adjustAxis(this.dygraph.xAxisRange(),n,a)});let o=this.dygraph.xAxisRange(),r=new Date(o[0]),p=new Date(o[1]);this.dataSource.updateWindow(r,p,[null,null]),this.onManualRangeChange.emit()}updateWindowOnly(n,a){this.dataSource.updateWindowOnly(n,a),this.dygraph.updateOptions({dateWindow:[n,a]})}adjustAxis(n,a,o){let p=(n[1]-n[0])*a,m=[p*o,p*(1-o)];return[n[0]+m[0],n[1]-m[1]]}offsetToPercentage(n){let a=this.dygraph.toDomCoords(this.dygraph.xAxisRange()[0],null)[0],o=n-a,r=this.dygraph.toDomCoords(this.dygraph.xAxisRange()[1],null)[0]-a;return r===0?0:o/r}ngOnDestroy(){this.dygraph?.destroy()}};t.\u0275fac=function(a){return new(a||t)(D(Ve),D(qi))},t.\u0275cmp=F({type:t,selectors:[["app-parameter-plot"]],contentQueries:function(a,o,r){if(a&1&&Go(r,An,4),a&2){let p;ce(p=pe())&&(o.seriesComponents=p)}},viewQuery:function(a,o){if(a&1&&ue(U0,7),a&2){let r;ce(r=pe())&&(o.graphContainer=r.first)}},inputs:{dataSource:"dataSource",fillGraph:"fillGraph",xGrid:"xGrid",xAxis:"xAxis",xAxisLineWidth:"xAxisLineWidth",xAxisHeight:"xAxisHeight",duration:"duration",height:"height",width:"width",removableSeries:"removableSeries",stop:"stop",crosshair:"crosshair"},outputs:{onVisibleRange:"onVisibleRange",onManualRangeChange:"onManualRangeChange"},standalone:!0,features:[N],decls:9,vars:16,consts:[["graphContainer",""],[1,"legend-wrapper"],[3,"close","select","data","backgroundColor","borderColor","closable"],[1,"timestamp-wrapper"],[3,"legendData","timestampData"],[1,"graph-container"]],template:function(a,o){if(a&1){let r=V();s(0,"div",1)(1,"app-parameter-legend",2),T(2,"async"),k("close",function(m){return A(r),M(o.removeParameter(m))})("select",function(m){return A(r),M(o.modifyParameter(m))}),l()(),s(3,"div",3),w(4,"app-timestamp-tracker",4),T(5,"async"),T(6,"async"),l(),w(7,"div",5,0)}a&2&&(d(),y("data",P(2,10,o.legendData$))("backgroundColor",o.plotAreaBackgroundColor)("borderColor",o.gridLineColor)("closable",o.removableSeries),d(3),y("legendData",P(5,12,o.legendData$))("timestampData",P(6,14,o.timestampTrackerData$)),d(3),St("height",o.height)("width",o.width))},dependencies:[ee,Il,Rl],styles:[".legend-wrapper[_ngcontent-%COMP%]{position:relative;z-index:50}.timestamp-wrapper[_ngcontent-%COMP%]{position:absolute;z-index:50;bottom:4px}.graph-container[_ngcontent-%COMP%]{overflow:hidden}  .annotation{background-color:#ffb6c1;color:red!important;opacity:.7;border-color:red!important}  .dygraph-axis-label{color:#aaa}  .dygraph-legend{position:absolute;font-size:14px;z-index:10;width:250px;background:#fff;line-height:normal;text-align:left;overflow:hidden}  .dygraph-legend-line{display:inline-block;position:relative;bottom:.5ex;padding-left:1em;height:1px;border-bottom-width:2px;border-bottom-style:solid}  .dygraph-legend-dash{display:inline-block;position:relative;bottom:.5ex;height:1px;border-bottom-width:2px;border-bottom-style:solid}  .dygraph-roller{position:absolute;z-index:10}  .dygraph-annotation{position:absolute;z-index:10;overflow:hidden}  .dygraph-default-annotation{border:1px solid black;background-color:#fff;text-align:center}  .dygraph-axis-label{z-index:10;line-height:normal;overflow:hidden;color:#000}  .dygraph-title{font-weight:700;z-index:10;text-align:center}  .dygraph-xlabel{text-align:center}  .dygraph-label-rotate-left{text-align:center;transform:rotate(90deg)}  .dygraph-label-rotate-right{text-align:center;transform:rotate(-90deg)}"],changeDetection:0});let e=t;return e})();var G0=["palette"],W0=["thickness"];function z0(e,t){if(e&1&&(s(0,"mat-option",6),T(1,"memberPath"),c(2),T(3,"memberPath"),l()),e&2){let i=t.$implicit;y("value",P(1,2,i)),d(2),I(" ",P(3,4,i)," ")}}var Ol=(()=>{let t=class t{constructor(n,a,o){this.dialogRef=n,this.yamcs=a,this.data=o,this.parameter=new te(null,[Ee.required])}ngOnInit(){let n=this.data.exclude;this.filteredOptions=this.parameter.valueChanges.pipe(Ln(300),In(a=>this.yamcs.yamcsClient.getParameters(this.yamcs.instance,{q:a,limit:10,searchMembers:!0})),Ri(a=>a.parameters||[]),Ri(a=>a.filter(o=>{for(let r of n){let p=$.getMemberPath(o);if(r.qualifiedName===p)return!1}return!0})))}select(){this.dialogRef.close({qualifiedName:this.parameter.value,color:this.palette.selectedColor,thickness:this.thickness.selectedThickness})}};t.\u0275fac=function(a){return new(a||t)(D(Fe),D(X),D(Ze))},t.\u0275cmp=F({type:t,selectors:[["app-compare-parameter-dialog"]],viewQuery:function(a,o){if(a&1&&(ue(G0,7),ue(W0,7)),a&2){let r;ce(r=pe())&&(o.palette=r.first),ce(r=pe())&&(o.thickness=r.first)}},standalone:!0,features:[N],decls:24,vars:6,consts:[["auto",""],["palette",""],["thickness",""],[1,"ya-form"],["type","text",3,"formControl","matAutocomplete"],[1,"ya-autocomplete"],[3,"value"],[3,"color"],["align","end"],["mat-dialog-close","",1,"ya-button"],[1,"ya-button","primary",3,"click","disabled"]],template:function(a,o){if(a&1){let r=V();s(0,"mat-dialog-content",3)(1,"label"),c(2," Search parameter for comparison "),w(3,"input",4),s(4,"mat-autocomplete",5,0),ne(6,z0,4,6,"mat-option",6,ie),T(8,"async"),l()(),w(9,"br"),s(10,"label"),c(11,"Color"),l(),w(12,"app-color-palette",null,1)(14,"br"),s(15,"label"),c(16,"Thickness"),l(),w(17,"app-thickness",7,2),l(),s(19,"mat-dialog-actions",8)(20,"button",9),c(21,"CANCEL"),l(),s(22,"button",10),k("click",function(){return A(r),M(o.select())}),c(23,"ADD"),l()()}if(a&2){let r=oe(5),p=oe(13);d(3),y("formControl",o.parameter)("matAutocomplete",r),d(3),ae(P(8,4,o.filteredOptions)),d(11),y("color",p.selectedColor),d(5),y("disabled",!o.parameter.valid)}},dependencies:[Ha,U,ee,Xe,he,Wt,Yn,zn,jn,Ne,He,$e,oa,Ba],encapsulation:2,changeDetection:0});let e=t;return e})();var Fl=(()=>{let t=class t{constructor(n,a,o){this.dialogRef=n,this.yamcs=o,this.form=new at({start:new te(null,Ee.required),stop:new te(null,Ee.required)});let r=a.start,p=a.stop;(!r||!p)&&(p=this.yamcs.getMissionTime(),r=$.subtractDuration(p,"PT1H")),this.form.setValue({start:$.toISOString(r),stop:$.toISOString(p)})}select(){let n=$.toDate(this.form.value.start),a=$.toDate(this.form.value.stop);this.dialogRef.close({start:n,stop:a})}};t.\u0275fac=function(a){return new(a||t)(D(Fe),D(Ze),D(X))},t.\u0275cmp=F({type:t,selectors:[["app-select-range-dialog"]],standalone:!0,features:[N],decls:15,vars:2,consts:[["mat-dialog-title",""],[1,"ya-form"],[3,"formGroup"],["formControlName","start"],["formControlName","stop"],["align","end"],["mat-dialog-close","",1,"ya-button"],[1,"ya-button","primary",3,"click","disabled"]],template:function(a,o){a&1&&(s(0,"h2",0),c(1,"Select Range"),l(),s(2,"mat-dialog-content",1)(3,"form",2)(4,"label"),c(5," Start "),w(6,"ya-date-time-input",3),l(),s(7,"label"),c(8," Stop "),w(9,"ya-date-time-input",4),l()()(),s(10,"mat-dialog-actions",5)(11,"button",6),c(12,"CANCEL"),l(),s(13,"button",7),k("click",function(){return o.select()}),c(14,"OK"),l()()),a&2&&(d(3),y("formGroup",o.form),d(10),y("disabled",!o.form.valid))},dependencies:[U,Te,he,Ce,xe,De,Ne,ut,He,$e,gt],encapsulation:2});let e=t;return e})();function q0(e,t){e&1&&(s(0,"span"),c(1,"Date Range"),l())}function Y0(e,t){if(e&1&&(s(0,"span"),c(1),T(2,"datetime"),T(3,"datetime"),l()),e&2){let i=h(),n=h();d(),Ht(" ",P(2,2,n)," - ",P(3,4,i)," ")}}function j0(e,t){if(e&1&&v(0,Y0,4,6,"span"),e&2){let i=h(2);b(i==="CUSTOM"?0:-1)}}function X0(e,t){if(e&1&&(v(0,j0,1,1),T(1,"async")),e&2){let i,n=h(3);b((i=P(1,1,n.customStop$))?0:-1,i)}}function Z0(e,t){if(e&1){let i=V();s(0,"div",2)(1,"ya-text-action",10),k("click",function(){A(i);let a=h(2);return M(a.compareParameter())}),c(2," Comparison "),l(),w(3,"span",9),s(4,"ya-text-action",11),k("click",function(){A(i);let a=h(2);return M(a.chooseRange())}),v(5,q0,2,0,"span")(6,X0,2,3),T(7,"async"),l(),s(8,"ya-text-action",12),k("click",function(){A(i);let a=h(2);return M(a.loadLatest("PT1M"))}),c(9," 1 minute "),l(),s(10,"ya-text-action",12),k("click",function(){A(i);let a=h(2);return M(a.loadLatest("PT5M"))}),c(11," 5 minutes "),l(),s(12,"ya-text-action",12),k("click",function(){A(i);let a=h(2);return M(a.loadLatest("PT15M"))}),c(13," 15 minutes "),l(),s(14,"ya-text-action",12),k("click",function(){A(i);let a=h(2);return M(a.loadLatest("PT30M"))}),c(15," 30 minutes "),l(),s(16,"ya-text-action",12),k("click",function(){A(i);let a=h(2);return M(a.loadLatest("PT1H"))}),c(17," 1 hour "),l(),s(18,"ya-text-action",12),k("click",function(){A(i);let a=h(2);return M(a.loadLatest("PT6H"))}),c(19," 6 hours "),l(),s(20,"ya-text-action",12),k("click",function(){A(i);let a=h(2);return M(a.loadLatest("PT12H"))}),c(21," 12 hours "),l(),s(22,"ya-text-action",12),k("click",function(){A(i);let a=h(2);return M(a.loadLatest("P1D"))}),c(23," 1 day "),l(),s(24,"ya-text-action",12),k("click",function(){A(i);let a=h(2);return M(a.loadLatest("P2D"))}),c(25," 2 days "),l(),s(26,"ya-text-action",12),k("click",function(){A(i);let a=h(2);return M(a.loadLatest("P1W"))}),c(27," 7 days "),l(),s(28,"ya-text-action",12),k("click",function(){A(i);let a=h(2);return M(a.loadLatest("P2W"))}),c(29," 14 days "),l(),s(30,"ya-text-action",12),k("click",function(){A(i);let a=h(2);return M(a.loadLatest("P1M"))}),c(31," 30 days "),l()()}if(e&2){let i,n=t,a=h(2);d(4),y("active",n==="CUSTOM"),d(),b(n!=="CUSTOM"?5:-1),d(),b((i=P(7,15,a.customStart$))?6:-1,i),d(2),y("active",n==="PT1M"),d(2),y("active",n==="PT5M"),d(2),y("active",n==="PT15M"),d(2),y("active",n==="PT30M"),d(2),y("active",n==="PT1H"),d(2),y("active",n==="PT6H"),d(2),y("active",n==="PT12H"),d(2),y("active",n==="P1D"),d(2),y("active",n==="P2D"),d(2),y("active",n==="P1W"),d(2),y("active",n==="P2W"),d(2),y("active",n==="P1M")}}function Q0(e,t){e&1&&(s(0,"span"),c(1,"the last minute"),l())}function K0(e,t){e&1&&(s(0,"span"),c(1,"the last 5 minutes"),l())}function J0(e,t){e&1&&(s(0,"span"),c(1,"the last 15 minutes"),l())}function eh(e,t){e&1&&(s(0,"span"),c(1,"the last 30 minutes"),l())}function th(e,t){e&1&&(s(0,"span"),c(1,"the last hour"),l())}function ih(e,t){e&1&&(s(0,"span"),c(1,"the last 6 hours"),l())}function nh(e,t){e&1&&(s(0,"span"),c(1,"the last 12 hours"),l())}function ah(e,t){e&1&&(s(0,"span"),c(1,"the last 24 hours"),l())}function oh(e,t){e&1&&(s(0,"span"),c(1,"the last 2 days"),l())}function rh(e,t){e&1&&(s(0,"span"),c(1,"the last week"),l())}function lh(e,t){e&1&&(s(0,"span"),c(1,"the last 2 weeks"),l())}function sh(e,t){e&1&&(s(0,"span"),c(1,"the last month"),l())}function ch(e,t){e&1&&(s(0,"span"),c(1,"the selected range"),l())}function ph(e,t){if(e&1&&(s(0,"span",14),c(1," There is no data for this chart in "),v(2,Q0,2,0,"span")(3,K0,2,0,"span")(4,J0,2,0,"span")(5,eh,2,0,"span")(6,th,2,0,"span")(7,ih,2,0,"span")(8,nh,2,0,"span")(9,ah,2,0,"span")(10,oh,2,0,"span")(11,rh,2,0,"span")(12,lh,2,0,"span")(13,sh,2,0,"span")(14,ch,2,0,"span"),l()),e&2){let i;d(2),b((i=t)==="PT1M"?2:i==="PT5M"?3:i==="PT15M"?4:i==="PT30M"?5:i==="PT1H"?6:i==="PT6H"?7:i==="PT12H"?8:i==="P1D"?9:i==="P2D"?10:i==="P1W"?11:i==="P2W"?12:i==="P1M"?13:14)}}function mh(e,t){if(e&1&&(s(0,"div",13),v(1,ph,15,1,"span",14),T(2,"async"),l()),e&2){let i,n=h(4);d(),b((i=P(2,1,n.range$))?1:-1,i)}}function dh(e,t){if(e&1&&v(0,mh,3,3,"div",13),e&2){let i=h();b(i.samples.length===0?0:-1)}}function uh(e,t){if(e&1&&(v(0,dh,1,1),T(1,"async")),e&2){let i=h(2);b(P(1,1,i.dataSource.loading$)?-1:0)}}function hh(e,t){if(e&1){let i=V();s(0,"div",1),v(1,Z0,32,17,"div",2),T(2,"async"),l(),s(3,"div",3)(4,"app-parameter-plot",4,0),k("onVisibleRange",function(a){A(i);let o=h();return M(o.onVisibleRange(a))})("onManualRangeChange",function(){A(i);let a=h();return M(a.onManualRangeChange())}),w(6,"app-parameter-series",5),l(),s(7,"div",6)(8,"div",7)(9,"button",8),k("click",function(){A(i);let a=oe(5);return M(a.zoomIn())}),s(10,"mat-icon"),c(11,"add"),l()(),w(12,"span",9),s(13,"button",8),k("click",function(){A(i);let a=oe(5);return M(a.zoomOut())}),s(14,"mat-icon"),c(15,"remove"),l()()()(),v(16,uh,2,3),T(17,"async"),l()}if(e&2){let i,n,a=h();d(),b((i=P(2,9,a.range$))?1:-1,i),d(3),y("xGrid",!0)("xAxisHeight",24)("dataSource",a.dataSource)("stop",a.missionTime)("removableSeries",!0),d(2),y("parameter",t.qualifiedName)("grid",!0),d(10),b((n=P(17,11,a.dataSource.data$))?16:-1,n)}}var Vl=(()=>{let t=class t{constructor(n,a,o,r,p){this.router=n,this.route=a,this.yamcs=o,this.dialog=r,this.synchronizer=p,this.qualifiedName=Mt.required({alias:"parameter"}),this.range$=new B("PT15M"),this.customStart$=new B(null),this.customStop$=new B(null)}ngOnInit(){this.missionTime=this.yamcs.getMissionTime(),this.initializeOptions();let n=this.qualifiedName();this.dataSource=new Ji(this.yamcs,this.synchronizer),this.parameter$=this.yamcs.yamcsClient.getParameter(this.yamcs.instance,n),this.parameter$.then(a=>{if(a.qualifiedName=n,this.dataSource.addParameter(a),this.range$.value==="CUSTOM"){let r=this.customStart$.value,p=this.customStop$.value;this.dataSource.updateWindow(r,p,[null,null])}else{let r=this.yamcs.getMissionTime(),p=$.subtractDuration(r,this.range$.value);this.dataSource.updateWindow(p,r,[null,null])}this.timeSubscription=this.yamcs.time$.subscribe(()=>{if(this.range$.value!=="CUSTOM"){let r=this.yamcs.getMissionTime(),p=$.subtractDuration(r,this.range$.value);this.plot?.updateWindowOnly(p,r)}}),this.backfillSubscription=this.yamcs.yamcsClient.createBackfillingSubscription({instance:this.yamcs.instance},r=>{r.finished&&this.dataSource.reloadVisibleRange()})})}initializeOptions(){let n=this.route.snapshot.queryParamMap;n.has("interval")&&(this.range$.next(n.get("interval")),n.get("interval")==="CUSTOM"&&(this.customStart$.next(new Date(n.get("customStart"))),this.customStop$.next(new Date(n.get("customStop"))))),this.updateURL()}onVisibleRange(n){this.customStart$.next(n[0]),this.customStop$.next(n[1])}onManualRangeChange(){this.range$.next("CUSTOM")}loadLatest(n){this.range$.next(n);let a=this.yamcs.getMissionTime(),o=$.subtractDuration(a,n);this.updateURL(),this.dataSource.updateWindow(o,a,[null,null])}chooseRange(){let n=this.plot.getDateRange();n&&this.dialog.open(Fl,{width:"400px",data:{start:n[0],stop:n[1]}}).afterClosed().subscribe(o=>{o&&(this.range$.next("CUSTOM"),this.customStart$.next(o.start),this.customStop$.next(o.stop),this.updateURL(),this.dataSource.updateWindow(o.start,o.stop,[null,null]))})}compareParameter(){this.dialog.open(Ol,{width:"600px",data:{exclude:this.plot.getParameters()}}).afterClosed().subscribe(a=>{a&&this.yamcs.yamcsClient.getParameter(this.yamcs.instance,a.qualifiedName).then(o=>{let r=new An;r.parameter=a.qualifiedName,r.color=a.color,r.strokeWidth=a.thickness,o.qualifiedName=a.qualifiedName,this.plot.addParameter(o,r)})})}updateURL(){this.router.navigate([],{replaceUrl:!0,relativeTo:this.route,queryParams:{interval:this.range$.value,customStart:this.range$.value==="CUSTOM"?this.customStart$.value:null,customStop:this.range$.value==="CUSTOM"?this.customStop$.value:null},queryParamsHandling:"merge"})}ngOnDestroy(){this.backfillSubscription?.cancel(),this.timeSubscription?.unsubscribe(),this.dataSource?.disconnect()}};t.\u0275fac=function(a){return new(a||t)(D(Me),D(we),D(X),D(Ve),D(vt))},t.\u0275cmp=F({type:t,selectors:[["ng-component"]],viewQuery:function(a,o){if(a&1&&ue(Oo,5),a&2){let r;ce(r=pe())&&(o.plot=r.first)}},inputs:{qualifiedName:[1,"parameter","qualifiedName"]},standalone:!0,features:[N],decls:2,vars:3,consts:[["plot",""],[2,"padding-left","12px","padding-right","12px","padding-top","12px"],[1,"plot-top-actions"],[1,"plot-container"],["duration","",3,"onVisibleRange","onManualRangeChange","xGrid","xAxisHeight","dataSource","stop","removableSeries"],[3,"parameter","grid"],[1,"zoom-actions"],[1,"zoom-actions-inner","elevation-z1"],["mat-button","",3,"click"],[1,"separator"],["icon","add_circle_outline",3,"click"],["icon","date_range",3,"click","active"],[3,"click","active"],[1,"no-data-message"],[1,"mat-caption",2,"color","#777"]],template:function(a,o){if(a&1&&(v(0,hh,18,13),T(1,"async")),a&2){let r;b((r=P(1,1,o.parameter$))?0:-1,r)}},dependencies:[Oo,An,U,ee,dt,fe,Qt,Le],styles:[".plot-container[_ngcontent-%COMP%]{border-top:1px solid rgba(0,0,0,.12);position:absolute;inset:48px 0 0}.zoom-actions[_ngcontent-%COMP%]{position:absolute;bottom:35px;left:0;right:0;margin:0 auto;text-align:center}.zoom-actions-inner[_ngcontent-%COMP%]{display:inline-block;background-color:#fafafa}.zoom-actions[_ngcontent-%COMP%]   .mat-button[_ngcontent-%COMP%]{line-height:inherit;min-width:0}.no-data-message[_ngcontent-%COMP%]{position:absolute;inset:50% 0 0;margin:0 auto;text-align:center;pointer-events:none}.plot-top-actions[_ngcontent-%COMP%]{height:24px;line-height:24px}.separator[_ngcontent-%COMP%]{border-right:1px solid rgba(0,0,0,.12)}"],changeDetection:0});let e=t;return e})();var Nl=(()=>{let t=class t{constructor(n,a,o){this.dialogRef=n,this.yamcs=a,this.data=o,this.delimiterOptions=[{id:"COMMA",label:"Comma"},{id:"SEMICOLON",label:"Semicolon"},{id:"TAB",label:"Tab"}],this.downloadURL$=new B(null),this.form=new at({start:new te(null),stop:new te(null),delimiter:new te(null,Ee.required),interval:new Wn(null)});let r=o.start,p=o.stop;(!r||!p)&&(p=a.getMissionTime(),r=$.subtractDuration(p,"PT1H")),this.form.setValue({start:o.start?$.toISOString(o.start):"",stop:o.stop?$.toISOString(o.stop):"",delimiter:"TAB",interval:""}),this.formChangeSubscription=this.form.valueChanges.subscribe(()=>{this.updateURL()}),this.updateURL()}closeDialog(){this.dialogRef.close(!0)}updateURL(){if(this.form.valid){let n={parameters:this.data.parameter,delimiter:this.form.value.delimiter};this.form.value.start&&(n.start=$.toISOString(this.form.value.start)),this.form.value.stop&&(n.stop=$.toISOString(this.form.value.stop)),this.form.value.interval&&(n.interval=this.form.value.interval);let a=this.yamcs.yamcsClient.getParameterValuesDownloadURL(this.yamcs.instance,n);this.downloadURL$.next(a)}else this.downloadURL$.next(null)}ngOnDestroy(){this.formChangeSubscription?.unsubscribe()}};t.\u0275fac=function(a){return new(a||t)(D(Fe),D(X),D(Ze))},t.\u0275cmp=F({type:t,selectors:[["ng-component"]],standalone:!0,features:[N],decls:33,vars:7,consts:[["mat-dialog-title",""],[1,"ya-form"],[3,"formGroup"],[1,"hint"],["formControlName","start"],["formControlName","stop"],["formControlName","delimiter",3,"options"],["formControlName","interval","type","text",1,"ya-input"],["align","end"],["mat-dialog-close","",1,"ya-button"],[3,"click","link","primary","disabled"]],template:function(a,o){a&1&&(s(0,"h2",0),c(1,"Export parameter data"),l(),s(2,"mat-dialog-content",1)(3,"form",2)(4,"label"),c(5," Start "),s(6,"span",3),c(7,"(optional)"),l(),w(8,"ya-date-time-input",4),l(),w(9,"br"),s(10,"label"),c(11," Stop "),s(12,"span",3),c(13,"(optional)"),l(),w(14,"ya-date-time-input",5),l(),w(15,"br"),s(16,"label"),c(17," CSV column delimiter"),w(18,"br")(19,"ya-select",6),l(),w(20,"br"),s(21,"label"),c(22," Interval (ms) "),s(23,"span",3),c(24,"(optional)"),l(),w(25,"br")(26,"input",7),l()()(),s(27,"mat-dialog-actions",8)(28,"button",9),c(29,"CANCEL"),l(),s(30,"ya-download-button",10),T(31,"async"),k("click",function(){return o.closeDialog()}),c(32," DOWNLOAD "),l()()),a&2&&(d(3),y("formGroup",o.form),d(16),y("options",o.delimiterOptions),d(11),y("link",P(31,5,o.downloadURL$))("primary",!0)("disabled",!o.form.valid))},dependencies:[U,ee,Te,Xe,he,Ce,xe,De,Ne,ut,He,$e,gt,ia,Tt],encapsulation:2,changeDetection:0});let e=t;return e})();function fh(e,t){e&1&&(s(0,"th",15),c(1,"Severity"),l())}function _h(e,t){if(e&1&&w(0,"app-alarm-level",17),e&2){let i=h().$implicit;y("level",i.monitoringResult)}}function gh(e,t){e&1&&(s(0,"span"),c(1,"-"),l())}function vh(e,t){if(e&1&&(s(0,"td",16),v(1,_h,1,1,"app-alarm-level",17)(2,gh,2,0,"span"),l()),e&2){let i=t.$implicit;d(),b(i.monitoringResult?1:-1),d(),b(i.monitoringResult?-1:2)}}function yh(e,t){e&1&&(s(0,"th",15),c(1,"Generation time"),l())}function Ch(e,t){if(e&1&&(s(0,"td",16),c(1),T(2,"datetime"),l()),e&2){let i,n=t.$implicit;d(),Y((i=P(2,1,n.generationTime))!==null&&i!==void 0?i:"-")}}function xh(e,t){e&1&&(s(0,"th",15),c(1,"Reception time"),l())}function bh(e,t){if(e&1&&(s(0,"td",16),c(1),T(2,"datetime"),l()),e&2){let i,n=t.$implicit;d(),Y((i=P(2,1,n.acquisitionTime))!==null&&i!==void 0?i:"-")}}function Sh(e,t){e&1&&(s(0,"th",15),c(1,"Raw"),l())}function wh(e,t){if(e&1&&(s(0,"td",18),w(1,"ya-value",19),l()),e&2){let i=t.$implicit;d(),y("value",i.rawValue)}}function Th(e,t){e&1&&(s(0,"th",15),c(1,"Eng"),l())}function Dh(e,t){if(e&1&&(s(0,"td",18),w(1,"ya-value",19),l()),e&2){let i=t.$implicit;d(),y("value",i.engValue)}}function Ph(e,t){e&1&&(s(0,"th",15),c(1,"Range condition"),l())}function Eh(e,t){if(e&1&&(s(0,"td",16),c(1),l()),e&2){let i=t.$implicit;d(),Y(i.rangeCondition||"-")}}function kh(e,t){e&1&&(s(0,"th",15),c(1,"Acquisition status"),l())}function Ah(e,t){if(e&1&&(s(0,"td",16),c(1),l()),e&2){let i=t.$implicit;d(),Y(i.acquisitionStatus||"-")}}function Mh(e,t){e&1&&w(0,"th",20)}function Rh(e,t){e&1&&w(0,"td",16)}function Lh(e,t){e&1&&w(0,"tr",21)}function Ih(e,t){if(e&1){let i=V();s(0,"tr",22),T(1,"async"),k("click",function(){let a=A(i).$implicit,o=h(2);return M(o.selectedValue.emit(a))}),l()}if(e&2){let i=t.$implicit,n=h(2);de("selected",P(1,2,n.selectedValue)===i)}}function Oh(e,t){if(e&1&&(s(0,"table",0),G(1,1),v(2,fh,2,0,"th",2)(3,vh,3,2,"td",3),W(),G(4,4),v(5,yh,2,0,"th",2)(6,Ch,3,3,"td",3),W(),G(7,5),v(8,xh,2,0,"th",2)(9,bh,3,3,"td",3),W(),G(10,6),v(11,Sh,2,0,"th",2)(12,wh,2,1,"td",7),W(),G(13,8),v(14,Th,2,0,"th",2)(15,Dh,2,1,"td",7),W(),G(16,9),v(17,Ph,2,0,"th",2)(18,Eh,2,1,"td",3),W(),G(19,10),v(20,kh,2,0,"th",2)(21,Ah,2,1,"td",3),W(),G(22,11),v(23,Mh,1,0,"th",12)(24,Rh,1,0,"td",3),W(),v(25,Lh,1,0,"tr",13)(26,Ih,2,4,"tr",14),l()),e&2){let i=h();y("dataSource",i.dataSource),d(25),y("matHeaderRowDef",i.displayedColumns),d(),y("matRowDefColumns",i.displayedColumns)}}var $l=(()=>{let t=class t{constructor(){this.selectedValue=new it,this.displayedColumns=["severity","generationTime","rawValue","engValue","rangeCondition","acquisitionStatus","actions"]}};t.\u0275fac=function(a){return new(a||t)},t.\u0275cmp=F({type:t,selectors:[["app-parameter-values-table"]],inputs:{dataSource:"dataSource"},outputs:{selectedValue:"selectedValue"},standalone:!0,features:[N],decls:1,vars:1,consts:[["mat-table","",1,"ya-data-table","expand",3,"dataSource"],["matColumnDef","severity"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","generationTime"],["matColumnDef","receptionTime"],["matColumnDef","rawValue"],["mat-cell","","class","wrap200",4,"matCellDef"],["matColumnDef","engValue"],["matColumnDef","rangeCondition"],["matColumnDef","acquisitionStatus"],["matColumnDef","actions"],["mat-header-cell","","class","expand",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",3,"selected","click",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],[3,"level"],["mat-cell","",1,"wrap200"],[3,"value"],["mat-header-cell","",1,"expand"],["mat-header-row",""],["mat-row","",3,"click"]],template:function(a,o){a&1&&v(0,Oh,27,3,"table",0),a&2&&b(o.dataSource?0:-1)},dependencies:[Jt,U,ee,Be,ft,_t,ot,ht,wt,Ue,Ge,We,ze,Xi,Le],encapsulation:2,changeDetection:0});let e=t;return e})();var Wa=class extends Gt{constructor(t,i){super(),this.yamcs=t,this.qualifiedName=i,this.pageSize=100,this.pvals$=new B([]),this.loading$=new B(!1)}connect(t){return this.pvals$}isEmpty(){return this.pvals$.value.length===0}loadParameterValues(t){return this.loading$.next(!0),this.loadPage(bt(et({},t),{limit:this.pageSize+1})).then(i=>{this.pvals$.next(i)}).finally(()=>this.loading$.next(!1))}hasMore(){return this.offscreenRecord!=null}loadPage(t){return this.yamcs.yamcsClient.getParameterValues(this.yamcs.instance,this.qualifiedName,t).then(i=>(i.length>this.pageSize?this.offscreenRecord=i.splice(i.length-1,1)[0]:this.offscreenRecord=null,i))}async loadMoreData(t){if(this.offscreenRecord)return this.loadPage(bt(et({},t),{stop:this.offscreenRecord.generationTime,limit:this.pageSize+1})).then(i=>{let n=this.pvals$.getValue().concat(i);this.pvals$.next(n)})}disconnect(){this.pvals$.complete(),this.loading$.complete()}};var za=e=>({value:e});function Fh(e,t){if(e&1&&w(0,"app-alarm-level",16),e&2){let i=h();y("level",i.monitoringResult)}}function Vh(e,t){e&1&&(s(0,"span"),c(1,"-"),l())}function Nh(e,t){e&1&&fn(0)}function $h(e,t){e&1&&fn(0)}function Hh(e,t){e&1&&fn(0)}function Bh(e,t){e&1&&fn(0)}function Uh(e,t){if(e&1&&(s(0,"ya-detail-toolbar"),c(1," Value Detail "),l(),s(2,"div",13)(3,"div",14),c(4,"Severity"),l(),s(5,"div",15),v(6,Fh,1,1,"app-alarm-level",16)(7,Vh,2,0,"span"),l(),s(8,"div",14),c(9,"Generation time"),l(),s(10,"div",15),c(11),T(12,"datetime"),l(),s(13,"div",14),c(14,"Valid for"),l(),s(15,"div",15),c(16),T(17,"millisDuration"),l(),s(18,"div",14),c(19," Raw value "),v(20,Nh,1,0,"ng-container",17),l(),s(21,"div",15),v(22,$h,1,0,"ng-container",17),l(),s(23,"div",14),c(24," Engineering value "),v(25,Hh,1,0,"ng-container",17),l(),s(26,"div",15),v(27,Bh,1,0,"ng-container",17),l(),s(28,"div",14),c(29,"Range condition"),l(),s(30,"div",15),c(31),l(),s(32,"div",14),c(33,"Acquisition status"),l(),s(34,"div",15),c(35),l()()),e&2){let i=t;h();let n=oe(30),a=oe(32);d(6),b(i.monitoringResult?6:-1),d(),b(i.monitoringResult?-1:7),d(4),I(" ",P(12,14,i.generationTime)," "),d(5),I(" ",P(17,16,i.expireMillis)||"-"," "),d(4),y("ngTemplateOutlet",n)("ngTemplateOutletContext",Z(18,za,i.rawValue)),d(2),y("ngTemplateOutlet",a)("ngTemplateOutletContext",Z(20,za,i.rawValue)),d(3),y("ngTemplateOutlet",n)("ngTemplateOutletContext",Z(22,za,i.engValue)),d(2),y("ngTemplateOutlet",a)("ngTemplateOutletContext",Z(24,za,i.engValue)),d(4),I(" ",i.rangeCondition||"-"," "),d(4),I(" ",i.acquisitionStatus||"-"," ")}}function Gh(e,t){e&1&&(s(0,"ya-detail-toolbar"),c(1," Select a value "),l())}function Wh(e,t){if(e&1){let i=V();w(0,"ya-date-time-input",18)(1,"ya-date-time-input",19),s(2,"button",20),k("click",function(){A(i);let a=h();return M(a.applyCustomDates())}),c(3," Apply "),l()}if(e&2){let i=h();d(2),y("disabled",i.filterForm.invalid)}}function zh(e,t){if(e&1){let i=V();s(0,"button",21),k("click",function(){A(i);let a=h();return M(a.jumpToNow())}),c(1,"Jump to now"),l()}}function qh(e,t){e&1&&w(0,"ya-dots")}function Yh(e,t){if(e&1&&(s(0,"span"),c(1," Showing data from "),s(2,"b"),c(3,"the last hour"),l(),c(4," ending at "),s(5,"b"),c(6),T(7,"datetime"),l(),c(8," (Mission Time) "),l()),e&2){let i=h();d(6),Y(P(7,1,i.validStop))}}function jh(e,t){if(e&1&&(s(0,"span"),c(1," Showing data from "),s(2,"b"),c(3,"the last 6 hours"),l(),c(4," ending at "),s(5,"b"),c(6),T(7,"datetime"),l(),c(8," (Mission Time) "),l()),e&2){let i=h();d(6),Y(P(7,1,i.validStop))}}function Xh(e,t){if(e&1&&(s(0,"span"),c(1," Showing data from "),s(2,"b"),c(3,"the last 24 hours"),l(),c(4," ending at "),s(5,"b"),c(6),T(7,"datetime"),l(),c(8," (Mission Time) "),l()),e&2){let i=h();d(6),Y(P(7,1,i.validStop))}}function Zh(e,t){e&1&&(s(0,"span"),c(1," Showing data from "),s(2,"b"),c(3,"all time"),l()())}function Qh(e,t){if(e&1&&(s(0,"span"),c(1," Showing data from "),s(2,"b"),c(3),T(4,"datetime"),l(),c(5," to "),s(6,"b"),c(7),T(8,"datetime"),l(),c(9," (Mission Time) "),l()),e&2){let i=h();d(3),Y(P(4,2,i.validStart)),d(4),Y(P(8,4,i.validStop))}}function Kh(e,t){e&1&&(s(0,"ya-empty-message"),c(1," No records found matching current filter in the selected time range. "),l())}function Jh(e,t){if(e&1){let i=V();s(0,"mat-toolbar"),w(1,"span",9),s(2,"button",20),k("click",function(){A(i);let a=h();return M(a.loadMoreData())}),c(3," Load More "),l(),w(4,"span",9),l()}if(e&2){let i=h();d(2),y("disabled",!i.dataSource.hasMore())}}function ef(e,t){if(e&1){let i=V();s(0,"ya-more",22)(1,"button",23),k("click",function(){A(i);let a=h().value,o=h();return M(o.copyHex(a.binaryValue))}),c(2,"Copy Hex"),l(),s(3,"button",23),k("click",function(){A(i);let a=h().value,o=h();return M(o.copyBinary(a.binaryValue))}),c(4,"Copy Binary"),l()()}}function tf(e,t){if(e&1&&v(0,ef,5,0,"ya-more",22),e&2){let i,n=t.value;b((i=n==null?null:n.type)==="BINARY"?0:-1)}}function nf(e,t){if(e&1&&w(0,"app-hex",24),e&2){let i=h().value;y("base64String",i.binaryValue)}}function af(e,t){if(e&1&&w(0,"ya-value",25),e&2){let i=h().value;y("value",i)}}function of(e,t){if(e&1&&v(0,nf,1,1,"app-hex",24)(1,af,1,1,"ya-value",25),e&2){let i,n=t.value;b((i=n==null?null:n.type)==="BINARY"?0:1)}}var hn="PT1H",Hl=(()=>{let t=class t{constructor(n,a,o,r,p,m){this.route=n,this.router=a,this.yamcs=o,this.dialog=r,this.clipboard=p,this.messageService=m,this.qualifiedName=Mt.required({alias:"parameter"}),this.intervalOptions=[{id:"PT1H",label:"Last Hour"},{id:"PT6H",label:"Last 6 Hours"},{id:"P1D",label:"Last 24 Hours"},{id:"NO_LIMIT",label:"No Limit"},{id:"CUSTOM",label:"Custom"}],this.filterForm=new at({interval:new te(hn),customStart:new te(null),customStop:new te(null)}),this.downloadURL$=new B(null)}ngOnInit(){let n=this.qualifiedName();this.dataSource=new Wa(this.yamcs,n),this.validStop=this.yamcs.getMissionTime(),this.validStart=$.subtractDuration(this.validStop,hn),this.appliedInterval=hn,this.initializeOptions(),this.loadData(),this.filterForm.get("interval").valueChanges.forEach(a=>{if(a==="CUSTOM"){let o=this.validStart||this.yamcs.getMissionTime(),r=this.validStop||this.yamcs.getMissionTime();this.filterForm.get("customStart").setValue($.toISOString(o)),this.filterForm.get("customStop").setValue($.toISOString(r))}else a==="NO_LIMIT"?(this.validStart=null,this.validStop=null,this.appliedInterval=a,this.loadData()):(this.validStop=this.yamcs.getMissionTime(),this.validStart=$.subtractDuration(this.validStop,a),this.appliedInterval=a,this.loadData())})}initializeOptions(){let n=this.route.snapshot.queryParamMap;if(n.has("interval"))if(this.appliedInterval=n.get("interval"),this.filterForm.get("interval").setValue(this.appliedInterval),this.appliedInterval==="CUSTOM"){let a=n.get("customStart");this.filterForm.get("customStart").setValue(a),this.validStart=new Date(a);let o=n.get("customStop");this.filterForm.get("customStop").setValue(o),this.validStop=new Date(o)}else this.appliedInterval==="NO_LIMIT"?(this.validStart=null,this.validStop=null):(this.validStop=this.yamcs.getMissionTime(),this.validStart=$.subtractDuration(this.validStop,this.appliedInterval));else this.appliedInterval=hn,this.validStop=this.yamcs.getMissionTime(),this.validStart=$.subtractDuration(this.validStop,hn)}jumpToNow(){let n=this.filterForm.value.interval;n==="NO_LIMIT"?this.filterForm.get("interval").setValue(hn):(this.validStop=this.yamcs.getMissionTime(),this.validStart=$.subtractDuration(this.validStop,n),this.loadData())}applyCustomDates(){this.validStart=$.toDate(this.filterForm.value.customStart),this.validStop=$.toDate(this.filterForm.value.customStop),this.appliedInterval="CUSTOM",this.loadData()}loadData(){this.updateURL();let n={};if(this.validStart){let a=new Date(this.validStart.getTime());a.setUTCMilliseconds(this.validStart.getUTCMilliseconds()-1),n.start=a.toISOString()}this.validStop&&(n.stop=this.validStop.toISOString()),this.dataSource.loadParameterValues(n).catch(a=>this.messageService.showError(a))}loadMoreData(){let n={};if(this.validStart){let a=new Date(this.validStart.getTime());a.setUTCMilliseconds(this.validStart.getUTCMilliseconds()-1),n.start=a.toISOString()}this.dataSource.loadMoreData(n).catch(a=>this.messageService.showError(a))}copyHex(n){let a=$.convertBase64ToHex(n);this.clipboard.copy(a)}copyBinary(n){let a=window.atob(n);this.clipboard.copy(a)}updateURL(){this.router.navigate([],{replaceUrl:!0,relativeTo:this.route,queryParams:{interval:this.appliedInterval,customStart:this.appliedInterval==="CUSTOM"?this.filterForm.value.customStart:null,customStop:this.appliedInterval==="CUSTOM"?this.filterForm.value.customStop:null},queryParamsHandling:"merge"})}exportParameterData(){this.dialog.open(Nl,{width:"400px",data:{parameter:this.qualifiedName(),start:this.validStart,stop:this.validStop}})}ngOnDestroy(){this.dataSource?.disconnect()}};t.\u0275fac=function(a){return new(a||t)(D(we),D(Me),D(X),D(Ve),D(Wi),D(Qe))},t.\u0275cmp=F({type:t,selectors:[["ng-component"]],inputs:{qualifiedName:[1,"parameter","qualifiedName"]},standalone:!0,features:[N],decls:33,vars:16,consts:[["table",""],["valueActionsTemplate",""],["valueTemplate",""],[1,"table-wrapper"],[1,"panel-content"],[3,"formGroup"],[1,"filter-bar"],["icon","access_time","formControlName","interval",3,"options"],[1,"ya-button"],[2,"flex","1 1 auto"],[1,"ya-button","primary",2,"margin-right","0",3,"click"],[1,"table-status"],[3,"dataSource"],[2,"padding","0 16px"],[1,"block-title"],[1,"block"],[3,"level"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],["formControlName","customStart"],["formControlName","customStop"],[1,"ya-button",3,"click","disabled"],[1,"ya-button",3,"click"],["icon","more_horiz"],["mat-menu-item","",3,"click"],[3,"base64String"],[3,"value"]],template:function(a,o){if(a&1){let r=V();s(0,"ya-detail-pane"),v(1,Uh,36,26),T(2,"async"),v(3,Gh,2,0,"ya-detail-toolbar"),l(),s(4,"div",3)(5,"div",4)(6,"form",5)(7,"div",6),w(8,"ya-select",7),v(9,Wh,4,1)(10,zh,2,0,"button",8)(11,qh,1,0,"ya-dots"),T(12,"async"),w(13,"div",9),s(14,"button",10),k("click",function(){return A(r),M(o.exportParameterData())}),s(15,"mat-icon"),c(16,"download"),l(),c(17," Export CSV "),l()()(),s(18,"div",11),v(19,Yh,9,3,"span")(20,jh,9,3,"span")(21,Xh,9,3,"span")(22,Zh,4,0,"span")(23,Qh,10,6,"span"),l(),w(24,"app-parameter-values-table",12,0),v(26,Kh,2,0,"ya-empty-message")(27,Jh,5,1,"mat-toolbar"),T(28,"async"),l()(),v(29,tf,1,1,"ng-template",null,1,gi)(31,of,2,1,"ng-template",null,2,gi)}if(a&2){let r,p,m=oe(25);d(),b((r=P(2,10,m.selectedValue))?1:3,r),d(5),y("formGroup",o.filterForm),d(2),y("options",o.intervalOptions),d(),b(o.filterForm.value.interval==="CUSTOM"?9:-1),d(),b(o.filterForm.value.interval!=="CUSTOM"?10:-1),d(),b(P(12,12,o.dataSource.loading$)?11:-1),d(8),b((p=o.appliedInterval)==="PT1H"?19:p==="PT6H"?20:p==="P1D"?21:p==="NO_LIMIT"?22:p==="CUSTOM"?23:-1),d(5),y("dataSource",o.dataSource),d(2),b(o.dataSource.isEmpty()?26:-1),d(),b(!P(28,14,o.dataSource.loading$)&&!o.dataSource.isEmpty()?27:-1)}},dependencies:[Jt,Qi,$l,U,qo,ee,Te,he,Ce,xe,De,fe,mt,Gi,gt,Yi,ji,jt,Xt,Ot,Tt,Xi,Le,pr],styles:[".detail[_ngcontent-%COMP%]{background-color:#fcfcfc;float:right;height:100%;width:450px;overflow:auto;border-left:1px solid #d3d3d3;box-sizing:border-box}.table-wrapper[_ngcontent-%COMP%]{position:relative;overflow:auto;height:100%}.table-status[_ngcontent-%COMP%]{background-color:var(--y-background-color);height:24px;line-height:24px;font-size:12px;padding-left:6px}.table-status[_ngcontent-%COMP%]   .message-zone[_ngcontent-%COMP%]{float:right;height:24px;line-height:24px;font-size:12px;padding-right:6px}"],changeDetection:0});let e=t;return e})();var rf=["container"],Nt="http://www.w3.org/2000/svg",Bl=(()=>{let t=class t{ngOnChanges(){this.pval&&this.indicator&&this.redraw()}ngAfterViewInit(){let n=this.container.nativeElement,a=document.createElementNS(Nt,"rect");a.setAttribute("x","0"),a.setAttribute("y","0"),a.setAttribute("width","100"),a.setAttribute("height","50"),a.setAttribute("shape-rendering","crispEdges"),a.style.fill="#00ff00",n.appendChild(a),this.watchLowRange=document.createElementNS(Nt,"rect"),this.watchLowRange.setAttribute("x","0"),this.watchLowRange.setAttribute("y","0"),this.watchLowRange.setAttribute("width","0"),this.watchLowRange.setAttribute("height","50"),this.watchLowRange.setAttribute("shape-rendering","crispEdges"),this.watchLowRange.style.fill="#ffff98",n.appendChild(this.watchLowRange),this.watchHighRange=document.createElementNS(Nt,"rect"),this.watchHighRange.setAttribute("x","0"),this.watchHighRange.setAttribute("y","0"),this.watchHighRange.setAttribute("width","0"),this.watchHighRange.setAttribute("height","50"),this.watchHighRange.setAttribute("shape-rendering","crispEdges"),this.watchHighRange.style.fill="#ffff98",n.appendChild(this.watchHighRange),this.warningLowRange=document.createElementNS(Nt,"rect"),this.warningLowRange.setAttribute("x","0"),this.warningLowRange.setAttribute("y","0"),this.warningLowRange.setAttribute("width","0"),this.warningLowRange.setAttribute("height","50"),this.warningLowRange.setAttribute("shape-rendering","crispEdges"),this.warningLowRange.style.fill="#ffff00",n.appendChild(this.warningLowRange),this.warningHighRange=document.createElementNS(Nt,"rect"),this.warningHighRange.setAttribute("x","0"),this.warningHighRange.setAttribute("y","0"),this.warningHighRange.setAttribute("width","0"),this.warningHighRange.setAttribute("height","50"),this.warningHighRange.setAttribute("shape-rendering","crispEdges"),this.warningHighRange.style.fill="#ffff00",n.appendChild(this.warningHighRange),this.distressLowRange=document.createElementNS(Nt,"rect"),this.distressLowRange.setAttribute("x","0"),this.distressLowRange.setAttribute("y","0"),this.distressLowRange.setAttribute("width","0"),this.distressLowRange.setAttribute("height","50"),this.distressLowRange.setAttribute("shape-rendering","crispEdges"),this.distressLowRange.style.fill="#ff6600",n.appendChild(this.distressLowRange),this.distressHighRange=document.createElementNS(Nt,"rect"),this.distressHighRange.setAttribute("x","0"),this.distressHighRange.setAttribute("y","0"),this.distressHighRange.setAttribute("width","0"),this.distressHighRange.setAttribute("height","50"),this.distressHighRange.setAttribute("shape-rendering","crispEdges"),this.distressHighRange.style.fill="#ff6600",n.appendChild(this.distressHighRange),this.criticalLowRange=document.createElementNS(Nt,"rect"),this.criticalLowRange.setAttribute("x","0"),this.criticalLowRange.setAttribute("y","0"),this.criticalLowRange.setAttribute("width","0"),this.criticalLowRange.setAttribute("height","50"),this.criticalLowRange.setAttribute("shape-rendering","crispEdges"),this.criticalLowRange.style.fill="red",n.appendChild(this.criticalLowRange),this.criticalHighRange=document.createElementNS(Nt,"rect"),this.criticalHighRange.setAttribute("x","0"),this.criticalHighRange.setAttribute("y","0"),this.criticalHighRange.setAttribute("width","0"),this.criticalHighRange.setAttribute("height","50"),this.criticalHighRange.setAttribute("shape-rendering","crispEdges"),this.criticalHighRange.style.fill="red",n.appendChild(this.criticalHighRange),this.severeLowRange=document.createElementNS(Nt,"rect"),this.severeLowRange.setAttribute("x","0"),this.severeLowRange.setAttribute("y","0"),this.severeLowRange.setAttribute("width","0"),this.severeLowRange.setAttribute("height","50"),this.severeLowRange.setAttribute("shape-rendering","crispEdges"),this.severeLowRange.style.fill="#800000",n.appendChild(this.severeLowRange),this.severeHighRange=document.createElementNS(Nt,"rect"),this.severeHighRange.setAttribute("x","0"),this.severeHighRange.setAttribute("y","0"),this.severeHighRange.setAttribute("width","0"),this.severeHighRange.setAttribute("height","50"),this.severeHighRange.setAttribute("shape-rendering","crispEdges"),this.severeHighRange.style.fill="#800000",n.appendChild(this.severeHighRange),this.indicator=document.createElementNS(Nt,"polygon"),this.indicator.classList.add("indicator"),this.indicator.style.fill="black",this.indicator.style.visibility="hidden",n.appendChild(this.indicator),this.pval&&this.redraw()}redraw(){let n,a,o=new Map;if(this.pval.alarmRange)for(let r of this.pval.alarmRange)o.set(r.level,r),r.minInclusive!==void 0&&(n===void 0||r.minInclusive<n)&&(n=r.minInclusive),r.minExclusive!==void 0&&(n===void 0||r.minExclusive<n)&&(n=r.minExclusive),r.maxInclusive!==void 0&&(a===void 0||r.maxInclusive>a)&&(a=r.maxInclusive),r.maxExclusive!==void 0&&(a===void 0||r.maxExclusive>a)&&(a=r.maxExclusive);if(this.criticalHighRange.setAttribute("width","0"),this.criticalLowRange.setAttribute("width","0"),this.indicator.style.visibility="hidden",n!==void 0&&a!==void 0&&n!==a){let r=n-(a-n)/5,p=a+(a-n)/5,m=100/(p-r),u=o.get("WATCH");if(u){if(u.minInclusive){let C=(u.minInclusive-r)*m;this.watchLowRange.setAttribute("width",String(C))}else if(u.minExclusive){let C=(u.minExclusive-r)*m;this.watchLowRange.setAttribute("width",String(C))}if(u.maxInclusive){let C=(u.maxInclusive-r)*m;this.watchHighRange.setAttribute("x",String(C)),this.watchHighRange.setAttribute("width",String(100-C))}else if(u.maxExclusive){let C=(u.maxExclusive-r)*m;this.watchHighRange.setAttribute("x",String(C)),this.watchHighRange.setAttribute("width",String(100-C))}}let f=o.get("WARNING");if(f){if(f.minInclusive){let C=(f.minInclusive-r)*m;this.warningLowRange.setAttribute("width",String(C))}else if(f.minExclusive){let C=(f.minExclusive-r)*m;this.warningLowRange.setAttribute("width",String(C))}if(f.maxInclusive){let C=(f.maxInclusive-r)*m;this.warningHighRange.setAttribute("x",String(C)),this.warningHighRange.setAttribute("width",String(100-C))}else if(f.maxExclusive){let C=(f.maxExclusive-r)*m;this.warningHighRange.setAttribute("x",String(C)),this.warningHighRange.setAttribute("width",String(100-C))}}let _=o.get("DISTRESS");if(_){if(_.minInclusive){let C=(_.minInclusive-r)*m;this.distressLowRange.setAttribute("width",String(C))}else if(_.minExclusive){let C=(_.minExclusive-r)*m;this.distressLowRange.setAttribute("width",String(C))}if(_.maxInclusive){let C=(_.maxInclusive-r)*m;this.distressHighRange.setAttribute("x",String(C)),this.distressHighRange.setAttribute("width",String(100-C))}else if(_.maxExclusive){let C=(_.maxExclusive-r)*m;this.distressHighRange.setAttribute("x",String(C)),this.distressHighRange.setAttribute("width",String(100-C))}}let x=o.get("CRITICAL");if(x){if(x.minInclusive){let C=(x.minInclusive-r)*m;this.criticalLowRange.setAttribute("width",String(C))}else if(x.minExclusive){let C=(x.minExclusive-r)*m;this.criticalLowRange.setAttribute("width",String(C))}if(x.maxInclusive){let C=(x.maxInclusive-r)*m;this.criticalHighRange.setAttribute("x",String(C)),this.criticalHighRange.setAttribute("width",String(100-C))}else if(x.maxExclusive){let C=(x.maxExclusive-r)*m;this.criticalHighRange.setAttribute("x",String(C)),this.criticalHighRange.setAttribute("width",String(100-C))}}let g=o.get("SEVERE");if(g){if(g.minInclusive){let C=(g.minInclusive-r)*m;this.severeLowRange.setAttribute("width",String(C))}else if(g.minExclusive){let C=(g.minExclusive-r)*m;this.severeLowRange.setAttribute("width",String(C))}if(g.maxInclusive){let C=(g.maxInclusive-r)*m;this.severeHighRange.setAttribute("x",String(C)),this.severeHighRange.setAttribute("width",String(100-C))}else if(g.maxExclusive){let C=(g.maxExclusive-r)*m;this.severeHighRange.setAttribute("x",String(C)),this.severeHighRange.setAttribute("width",String(100-C))}}let S=this.getNumericValue(this.pval);if(S!==void 0){let E=(Math.min(Math.max(S,r),p)-r)*m;this.indicator.setAttribute("points",`${E},25 ${E-3.5},100 ${E+3.5},100`),this.indicator.style.visibility="visible"}else this.indicator.style.visibility="hidden"}}getNumericValue(n){let a=n.engValue;switch(a.type){case"FLOAT":return a.floatValue;case"DOUBLE":return a.doubleValue;case"UINT32":return a.uint32Value;case"SINT32":return a.sint32Value;case"UINT64":return a.uint64Value;case"SINT64":return a.sint64Value}}};t.\u0275fac=function(a){return new(a||t)},t.\u0275cmp=F({type:t,selectors:[["app-severity-meter"]],viewQuery:function(a,o){if(a&1&&ue(rf,7),a&2){let r;ce(r=pe())&&(o.container=r.first)}},inputs:{pval:"pval"},standalone:!0,features:[At,N],decls:2,vars:0,consts:[["container",""],["width","100%","height","8px","viewBox","0 0 100 100","preserveAspectRatio","none",2,"overflow","visible"]],template:function(a,o){a&1&&(Nn(),w(0,"svg",1,0))},encapsulation:2,changeDetection:0});let e=t;return e})();var Ul=(e,t)=>({c:e,system:t}),qa=e=>({c:e}),lf=()=>[],sf=e=>["/mdb/parameters/",e];function cf(e,t){if(e&1&&(s(0,"a",5),c(1),l()),e&2){let i=t,n=h(2);y("queryParams",_i(2,Ul,n.yamcs.context,i)),d(),I(" ",i," ")}}function pf(e,t){if(e&1&&(s(0,"dt"),c(1),l(),s(2,"dd"),c(3),l()),e&2){let i=t.$implicit;d(),Y(i.namespace),d(2),Y(i.name)}}function mf(e,t){e&1&&(s(0,"span",2),c(1),l()),e&2&&(d(),I(" ",t," "))}function df(e,t){e&1&&c(0," - ")}function uf(e,t){if(e&1&&(s(0,"dt"),c(1,"Signed"),l(),s(2,"dd"),c(3),l()),e&2){let i=h();d(3),Y(i.signed)}}function hf(e,t){e&1&&v(0,uf,4,1),e&2&&b(t.signed!==void 0?0:-1)}function ff(e,t){if(e&1&&(s(0,"dt"),c(1,"Description"),l(),s(2,"dd"),w(3,"app-markdown",6),l()),e&2){let i=h();d(3),y("text",i.longDescription)}}function _f(e,t){if(e&1&&(s(0,"dt"),c(1,"Description"),l(),s(2,"dd"),c(3),l()),e&2){let i=h();d(3),I(" ",i.shortDescription||"-"," ")}}function gf(e,t){if(e&1&&v(0,ff,4,1)(1,_f,4,1),e&2){let i=t;b(i.longDescription?0:-1),d(),b(i.longDescription?-1:1)}}function vf(e,t){e&1&&c(0," - ")}function yf(e,t){if(e&1&&(s(0,"dl",0)(1,"dt"),c(2,"Entry"),l(),s(3,"dd"),c(4),T(5,"shortName"),l(),s(6,"dt"),c(7,"System"),l(),s(8,"dd"),v(9,cf,2,5,"a",5),T(10,"spaceSystemName"),l(),ne(11,pf,4,2,null,null,ie),T(13,"async"),s(14,"dt"),c(15,"Type"),l(),s(16,"dd"),v(17,mf,2,1,"span",2),T(18,"async"),v(19,df,1,0),l(),v(20,hf,1,1),T(21,"async"),s(22,"dt"),c(23,"Source"),l(),s(24,"dd"),c(25),T(26,"titlecase"),l(),v(27,gf,2,2),T(28,"async"),v(29,vf,1,0),l()),e&2){let i,n,a,o,r,p=h();d(4),Ht("",P(5,7,p.parameter.qualifiedName),"",p.offset,""),d(5),b((i=P(10,9,p.parameter.qualifiedName))?9:-1,i),d(2),ae((n=P(13,11,p.entry$))==null?null:n.alias),d(6),b((a=(a=P(18,13,p.ptype$))==null?null:a.engType)?17:19,a),d(3),b((o=P(21,15,p.ptype$))?20:-1,o),d(5),Y(P(26,17,p.parameter.dataSource)||"-"),d(2),b((r=P(28,19,p.entry$))?27:29,r)}}function Cf(e,t){if(e&1&&(s(0,"dt"),c(1,"Host Parameter"),l(),s(2,"dd")(3,"a",7),c(4),T(5,"shortName"),l()()),e&2){let i=h();d(3),y("routerLink","/telemetry/parameters"+i.parameter.qualifiedName)("queryParams",Z(5,qa,i.yamcs.context)),d(),I(" ",P(5,3,i.parameter.qualifiedName)," ")}}function xf(e,t){if(e&1&&(s(0,"dt"),c(1,"Parameter"),l(),s(2,"dd"),c(3),T(4,"shortName"),l()),e&2){let i=h();d(3),Y(P(4,1,i.parameter.qualifiedName))}}function bf(e,t){if(e&1&&(s(0,"a",5),c(1),l()),e&2){let i=t,n=h(2);y("queryParams",_i(2,Ul,n.yamcs.context,i)),d(),I(" ",i," ")}}function Sf(e,t){if(e&1&&(s(0,"dt"),c(1,"System"),l(),s(2,"dd"),v(3,bf,2,5,"a",5),T(4,"spaceSystemName"),l()),e&2){let i,n=h();d(3),b((i=P(4,1,n.parameter.qualifiedName))?3:-1,i)}}function wf(e,t){if(e&1&&(s(0,"dt"),c(1),l(),s(2,"dd"),c(3),l()),e&2){let i=t.$implicit;d(),Y(i.namespace),d(2),Y(i.name)}}function Tf(e,t){e&1&&(s(0,"span",2),c(1),l()),e&2&&(d(),I(" ",t," "))}function Df(e,t){e&1&&c(0," - ")}function Pf(e,t){if(e&1&&(s(0,"dt"),c(1,"Signed"),l(),s(2,"dd"),c(3),l()),e&2){let i=h();d(3),Y(i.parameter.type==null?null:i.parameter.type.signed)}}function Ef(e,t){if(e&1&&(s(0,"dt"),c(1,"Source"),l(),s(2,"dd"),c(3),T(4,"titlecase"),l()),e&2){let i=h();d(3),Y(P(4,1,i.parameter.dataSource)||"-")}}function kf(e,t){if(e&1&&(s(0,"dt"),c(1,"Description"),l(),s(2,"dd"),w(3,"app-markdown",6),l()),e&2){let i=h();d(3),y("text",i.parameter.longDescription)}}function Af(e,t){if(e&1&&(s(0,"dt"),c(1,"Description"),l(),s(2,"dd"),c(3),l()),e&2){let i=h();d(3),I(" ",i.parameter.shortDescription||"-"," ")}}function Mf(e,t){e&1&&(s(0,"span",2),c(1),l()),e&2&&(d(),I(" ",t," "))}function Rf(e,t){e&1&&c(0," - ")}function Lf(e,t){e&1&&(c(0),T(1,"units")),e&2&&I(" ",P(1,1,t)," ")}function If(e,t){if(e&1&&(s(0,"td")(1,"a",9),c(2),l()(),s(3,"td"),v(4,Mf,2,1,"span",2),T(5,"entryForOffset"),v(6,Rf,1,0),l(),s(7,"td"),c(8),T(9,"entryForOffset"),l(),s(10,"td")(11,"ya-expirable",10),c(12),T(13,"value"),v(14,Lf,2,3),T(15,"entryForOffset"),l()()),e&2){let i,n,a,o=t,r=h(),p=r.$implicit,m=r.$index,u=h(2),f=h();d(),y("routerLink","/telemetry/parameters"+f.parameter.qualifiedName+o)("queryParams",Z(19,qa,f.yamcs.context)),d(),I(" ",p," "),d(2),b((i=(i=tt(5,8,f.parameter,o))==null||i.type==null?null:i.type.engType)?4:6,i),d(4),Y(((n=tt(9,11,f.parameter,o))==null?null:n.shortDescription)||"-"),d(3),y("pval",f.pval),d(),I(" ",P(13,14,u.aggregateValue.value[m])," "),d(2),b((a=(a=tt(15,16,f.parameter,o))==null||a.type==null?null:a.type.unitSet)?14:-1,a)}}function Of(e,t){if(e&1&&(s(0,"tr"),v(1,If,16,21),l()),e&2){let i,n=t.$implicit,a=h(3);d(),b((i=(a.offset||"")+"."+n)?1:-1,i)}}function Ff(e,t){if(e&1&&(s(0,"table",8)(1,"tr")(2,"th"),c(3,"Member"),l(),s(4,"th"),c(5,"Type"),l(),s(6,"th"),c(7,"Description"),l(),s(8,"th"),c(9,"Value"),l()(),ne(10,Of,2,1,"tr",null,ie),l()),e&2){let i=h();d(10),ae(i.aggregateValue.name)}}function Vf(e,t){if(e&1&&(s(0,"tr")(1,"td")(2,"a",9),c(3),l()(),s(4,"td"),c(5),T(6,"value"),l()()),e&2){let i=t.$implicit,n=t.$index,a=h(3);d(2),y("routerLink","/telemetry/parameters"+a.parameter.qualifiedName+(a.offset||"")+"["+n+"]")("queryParams",Z(6,qa,a.yamcs.context)),d(),I(" ",n," "),d(2),Y(P(6,4,i))}}function Nf(e,t){if(e&1&&(s(0,"table",8)(1,"tr")(2,"th"),c(3,"Index"),l(),s(4,"th"),c(5,"Value"),l()(),ne(6,Vf,7,8,"tr",null,ie),l()),e&2){let i=h();d(6),ae(i.arrayValue||Li(0,lf))}}function $f(e,t){if(e&1&&(w(0,"app-alarm-level",15),c(1," \xA0 ")),e&2){let i=h(3);y("level",i.pval==null?null:i.pval.monitoringResult)}}function Hf(e,t){e&1&&(c(0),T(1,"units")),e&2&&I(" ",P(1,1,t)," ")}function Bf(e,t){if(e&1&&w(0,"app-severity-meter",10),e&2){let i=h(3);y("pval",i.pval)}}function Uf(e,t){if(e&1&&(s(0,"span",11)(1,"ya-expirable",12),v(2,$f,2,1),c(3),T(4,"value"),v(5,Hf,2,3),T(6,"parameterTypeForPath"),l()(),w(7,"br"),s(8,"div",13),v(9,Bf,1,1,"app-severity-meter",10),l(),s(10,"dl",14)(11,"dt"),c(12,"Generation time"),l(),s(13,"dd"),c(14),T(15,"datetime"),l(),s(16,"dt"),c(17,"Raw value"),l(),s(18,"dd"),c(19),T(20,"value"),l()()),e&2){let i,n,a=h(),o=h();d(),y("pval",o.pval),d(),b(o.pval!=null&&o.pval.monitoringResult?2:-1),d(),I(" ",P(4,7,a)," "),d(2),b((i=(i=P(6,9,o.parameter))==null?null:i.unitSet)?5:-1,i),d(4),b(o.pval!=null&&o.pval.alarmRange?9:-1),d(5),Y(P(15,11,o.pval==null?null:o.pval.generationTime)),d(5),Y((n=P(20,13,o.pval==null?null:o.pval.rawValue))!==null&&n!==void 0?n:"-")}}function Gf(e,t){if(e&1&&v(0,Ff,12,0,"table",8)(1,Nf,8,1,"table",8)(2,Uf,21,15),e&2){let i;b((i=t.type)==="AGGREGATE"?0:i==="ARRAY"?1:2)}}function Wf(e,t){e&1&&(s(0,"span",4),c(1,"---"),l())}function zf(e,t){e&1&&c(0," , ")}function qf(e,t){if(e&1&&(v(0,zf,1,0),s(1,"a",19),c(2),l(),c(3),T(4,"operator")),e&2){let i=t.$implicit,n=t.$index,a=h(4);b(n!==0?0:-1),d(),y("routerLink",Z(8,sf,i.parameter.qualifiedName))("queryParams",Z(10,qa,a.yamcs.context)),d(),I(" ",i.parameter.name," "),d(),Ht(" ",P(4,6,i.operator)," ",i.value," ")}}function Yf(e,t){if(e&1&&(s(0,"th"),ne(1,qf,5,12,null,null,ie),l()),e&2){let i=t.$implicit;d(),ae(i.comparison)}}function jf(e,t){if(e&1&&(w(0,"app-alarm-level",20),c(1)),e&2){let i=t;y("level",i)("grayscale",!0),d(),I(" ",i," ")}}function Xf(e,t){e&1&&(s(0,"span"),c(1,"-"),l())}function Zf(e,t){if(e&1&&(w(0,"app-alarm-level",20),c(1)),e&2){let i=t;y("level",i)("grayscale",!0),d(),I(" ",i," ")}}function Qf(e,t){e&1&&(s(0,"span"),c(1,"-"),l())}function Kf(e,t){if(e&1&&(s(0,"td"),v(1,Zf,2,3)(2,Qf,2,0,"span"),l()),e&2){let i,n=t.$implicit,a=h().$implicit,o=h(3);d(),b((i=o.getEnumerationAlarmLevel(n,a))?1:2,i)}}function Jf(e,t){if(e&1&&(s(0,"tr")(1,"td",4),c(2),l(),s(3,"td",4),c(4),l(),s(5,"td"),c(6),l(),s(7,"td"),v(8,jf,2,3)(9,Xf,2,0,"span"),l(),ne(10,Kf,3,1,"td",null,ie),l()),e&2){let i,n=t.$implicit,a=h(2),o=h();d(2),Y(n.value),d(2),Y(n.label),d(2),Y(n.description||"-"),d(2),b((i=o.getDefaultAlarmLevel(a.type,n))?8:9,i),d(2),ae(a.type.contextAlarm)}}function e_(e,t){if(e&1&&(s(0,"div",3),w(1,"mat-divider"),l(),s(2,"h4"),c(3,"Enumeration"),l(),s(4,"table",8)(5,"tr")(6,"th",16),c(7,"Value"),l(),s(8,"th",17),c(9,"Label"),l(),s(10,"th",18),c(11,"Description"),l(),s(12,"th"),c(13,"Alarm Level (default)"),l(),ne(14,Yf,3,0,"th",null,ie),l(),ne(16,Jf,12,4,"tr",null,ie),l()),e&2){let i=h();d(14),ae(i.type==null?null:i.type.contextAlarm),d(2),ae(i.type.enumValue)}}function t_(e,t){if(e&1&&v(0,e_,18,0),e&2){let i=t;b((i.type==null?null:i.type.engType)==="enumeration"?0:-1)}}var Gl=(()=>{let t=class t{constructor(n){this.yamcs=n,this.entry$=new B(null),this.ptype$=new B(null)}ngOnChanges(){if(this.parameter){if(this.offset){let n=$.getEntryForOffset(this.parameter,this.offset);this.entry$.next(n)}else this.entry$.next(this.parameter);this.ptype$.next($.getParameterTypeForPath(this.parameter)||null)}else this.entry$.next(null),this.ptype$.next(null)}getDefaultAlarmLevel(n,a){if(n&&n.defaultAlarm){let o=n.defaultAlarm;if(o.enumerationAlarm){for(let r of o.enumerationAlarm)if(r.label===a.label)return r.level}}}getEnumerationAlarmLevel(n,a){let o=n.alarm;for(let r of o.enumerationAlarm)if(r.label===a.label)return r.level}};t.\u0275fac=function(a){return new(a||t)(D(X))},t.\u0275cmp=F({type:t,selectors:[["app-parameter-detail"]],inputs:{parameter:"parameter",offset:"offset",pval:"pval"},standalone:!0,features:[At,N],decls:24,vars:16,consts:[[1,"dl-horizontal","no-lead","no-trail"],[1,"dl-horizontal","no-trail"],[1,"mono"],[1,"section-divider"],[2,"white-space","nowrap"],["routerLink","/telemetry/parameters",1,"ya-link",3,"queryParams"],[3,"text"],[1,"ya-link",3,"routerLink","queryParams"],["yaDataTable",""],[3,"routerLink","queryParams"],[3,"pval"],[1,"pval"],[2,"white-space","nowrap",3,"pval"],[1,"meter-size-constrainer"],[1,"dl-horizontal"],[3,"level"],[2,"width","50px"],[2,"width","100px"],[2,"width","300px"],[1,"secundary",3,"routerLink","queryParams"],[3,"level","grayscale"]],template:function(a,o){if(a&1&&(v(0,yf,30,21,"dl",0),s(1,"dl",1),v(2,Cf,6,7)(3,xf,5,3)(4,Sf,5,3),ne(5,wf,4,2,null,null,ie),s(7,"dt"),c(8,"Type"),l(),s(9,"dd"),v(10,Tf,2,1,"span",2)(11,Df,1,0),l(),v(12,Pf,4,1)(13,Ef,5,3)(14,kf,4,1)(15,Af,4,1),l(),s(16,"div",3),w(17,"mat-divider"),l(),s(18,"h4"),c(19,"Current value"),l(),v(20,Gf,3,1)(21,Wf,2,0,"span",4)(22,t_,1,1),T(23,"async")),a&2){let r,p,m;b(o.offset?0:-1),d(),de("no-lead",!o.offset),d(),b(o.offset?2:-1),d(),b(o.offset?-1:3),d(),b(o.offset?-1:4),d(),ae(o.parameter.alias),d(5),b((r=o.parameter.type==null?null:o.parameter.type.engType)?10:11,r),d(2),b((o.parameter.type==null?null:o.parameter.type.signed)!==void 0?12:-1),d(),b(o.offset?-1:13),d(),b(o.parameter.longDescription?14:-1),d(),b(o.parameter.longDescription?-1:15),d(5),b((p=o.pval==null?null:o.pval.engValue)?20:-1,p),d(),b(o.pval!=null&&o.pval.engValue?-1:21),d(),b((m=P(23,14,o.entry$))?22:-1,m)}},dependencies:[Jt,xr,Bl,U,ee,Ii,Re,pi,qt,Zt,Le,sr,mr,Zi,ra,ur,Kt,Ft],styles:[".meter-size-constrainer[_ngcontent-%COMP%]{display:inline-block;width:160px;position:relative}.dl-horizontal[_ngcontent-%COMP%]   dt[_ngcontent-%COMP%]{text-align:left}span.pval[_ngcontent-%COMP%]{font-size:16px;line-height:20px;margin:-8px 0 16px;bottom:-5px;color:#000000fc;font-weight:400}.pval-frame[_ngcontent-%COMP%]{display:inline-block;min-width:412px;border:1px solid #e7e7e7;border-radius:2px;box-shadow:0 1px 3px #0000001f}.pval-frame[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{border-bottom:1px solid #d3d3d3;height:64px;line-height:64px;padding-left:24px;position:relative}.pval-frame[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .action[_ngcontent-%COMP%]{position:absolute;top:0;right:0}.pval-frame[_ngcontent-%COMP%]   .body[_ngcontent-%COMP%]{padding:24px}.mat-icon.unchecked[_ngcontent-%COMP%]{visibility:hidden}"],changeDetection:0});let e=t;return e})();function i_(e,t){if(e&1&&(w(0,"app-parameter-detail",1),T(1,"async"),T(2,"async")),e&2){let i=h();y("parameter",t)("offset",P(1,3,i.offset$))("pval",P(2,5,i.pval$))}}var Wl=(()=>{let t=class t{constructor(n,a){this.yamcs=n,this.synchronizer=a,this.qualifiedName=Mt.required({alias:"parameter"}),this.parameter$=new B(null),this.offset$=new B(null),this.parameterValue$=new B(null),this.dirty=!1,this.pval$=new B(null),this.syncSubscription=this.synchronizer.syncFast(()=>{this.dirty&&(this.pval$.next(this.parameterValue$.value),this.dirty=!1)})}ngOnChanges(){let n=this.qualifiedName();this.yamcs.yamcsClient.getParameter(this.yamcs.instance,n).then(a=>{this.parameter$.next(a),n!==a.qualifiedName?this.offset$.next(n.substring(a.qualifiedName.length)):this.offset$.next(null),this.parameterValueSubscription&&this.parameterValueSubscription.cancel(),this.parameterValue$.next(null),this.pval$.next(null),this.parameterValueSubscription=this.yamcs.yamcsClient.createParameterSubscription({instance:this.yamcs.instance,processor:this.yamcs.processor,id:[{name:n}],abortOnInvalid:!1,sendFromCache:!0,updateOnExpiration:!0,action:"REPLACE"},o=>{this.parameterValue$.next(o.values?o.values[0]:null),this.pval$.value==null?this.pval$.next(this.parameterValue$.value):this.dirty=!0})})}ngOnDestroy(){this.parameterValueSubscription?.cancel(),this.syncSubscription?.unsubscribe()}};t.\u0275fac=function(a){return new(a||t)(D(X),D(vt))},t.\u0275cmp=F({type:t,selectors:[["ng-component"]],inputs:{qualifiedName:[1,"parameter","qualifiedName"]},standalone:!0,features:[At,N],decls:3,vars:3,consts:[[1,"panel-content"],[3,"parameter","offset","pval"]],template:function(a,o){if(a&1&&(s(0,"div",0),v(1,i_,3,7,"app-parameter-detail",1),T(2,"async"),l()),a&2){let r;d(),b((r=P(2,1,o.parameter$))?1:-1,r)}},dependencies:[Gl,U,ee],encapsulation:2,changeDetection:0});let e=t;return e})();function n_(e,t){if(e&1&&(s(0,"option",8),c(1),l()),e&2){let i=t.$implicit;y("value",i.label),d(),I(" ",i.label," ")}}function a_(e,t){if(e&1&&(s(0,"label")(1,"div",3)(2,"div",4),c(3),l()(),c(4),w(5,"ya-errors",5),s(6,"select",6)(7,"option",7),c(8,"-- select an option --"),l(),ne(9,n_,2,2,"option",8,ie),l()()),e&2){let i=h(),n=h();d(3),Y(n.parameter.type==null?null:n.parameter.type.engType),d(),I(" ",n.parameter.name," "),d(),y("controlName",i),d(),y("formControlName",i),d(3),ae(n.parameter.type==null?null:n.parameter.type.enumValue)}}function o_(e,t){if(e&1&&(s(0,"label"),c(1),w(2,"ya-errors",5)(3,"br")(4,"input",9),c(5," true"),w(6,"br")(7,"input",10),c(8," false "),l()),e&2){let i=h(),n=h();d(),I(" ",n.parameter.name," "),d(),y("controlName",i),d(2),y("formControlName",i),d(3),y("formControlName",i)}}function r_(e,t){if(e&1&&(s(0,"label"),c(1),w(2,"ya-errors",5)(3,"ya-date-time-input",6),l()),e&2){let i=h(),n=h();d(),I(" ",n.parameter.name," "),d(),y("controlName",i),d(),y("formControlName",i)}}function l_(e,t){if(e&1&&(s(0,"label")(1,"div",3)(2,"div",4),T(3,"async"),c(4),l()(),c(5),w(6,"ya-errors",5,0)(8,"ya-binary-input",6),l()),e&2){let i=oe(7),n=h(),a=h();d(2),de("error",P(3,6,i.invalid$)),d(2),I(" ",a.parameter.type==null?null:a.parameter.type.engType," "),d(),I(" ",a.parameter.name," "),d(),y("controlName",n),d(2),y("formControlName",n)}}function s_(e,t){if(e&1&&w(0,"app-parameter-form",12)(1,"br"),e&2){let i=t.$implicit,n=h(3);y("parameter",i)("formGroup",n.formGroup)("parent",n.parent?n.parent+"."+n.parameter.name:n.parameter.name)}}function c_(e,t){if(e&1&&(s(0,"label")(1,"div",3)(2,"div",4),c(3),l()(),c(4),s(5,"div",11),ne(6,s_,2,3,null,null,ie),l()()),e&2){let i=h(2);d(3),Y(i.parameter.type==null?null:i.parameter.type.engType),d(),I(" ",i.parameter.name," "),d(2),ae(i.parameter.type==null?null:i.parameter.type.member)}}function p_(e,t){if(e&1&&(s(0,"div",4),c(1),T(2,"units"),l()),e&2){let i=h(3);d(),I(" ",P(2,1,i.parameter.type==null?null:i.parameter.type.unitSet)," ")}}function m_(e,t){e&1&&(s(0,"div",4),c(1,"unsigned"),l())}function d_(e,t){if(e&1&&(s(0,"div",2)(1,"div",3),T(2,"async"),v(3,p_,3,3,"div",4)(4,m_,2,0,"div",4),s(5,"div",4),c(6),l()(),c(7),w(8,"ya-errors",5,0)(10,"input",13),l()),e&2){let i=oe(9),n=h(),a=h();d(),de("error",P(2,8,i.invalid$)),d(2),b(a.parameter.type!=null&&a.parameter.type.unitSet?3:-1),d(),b((a.parameter.type==null?null:a.parameter.type.signed)===!1?4:-1),d(2),Y(a.parameter.type==null?null:a.parameter.type.engType),d(),I(" ",a.parameter.name," "),d(),y("controlName",n),d(2),y("formControlName",n)}}function u_(e,t){e&1&&c(0," Setting array values via this website is not yet supported. ")}function h_(e,t){e&1&&c(0," Setting array values via this website is not yet supported. ")}function f_(e,t){e&1&&c(0," Setting array values via this website is not yet supported. ")}function __(e,t){e&1&&c(0," Setting array values via this website is not yet supported. ")}function g_(e,t){e&1&&c(0," Setting array values via this website is not yet supported. ")}function v_(e,t){e&1&&c(0," Setting array values via this website is not yet supported. ")}function y_(e,t){e&1&&c(0," Setting array values via this website is not yet supported. ")}function C_(e,t){e&1&&c(0," Setting array values via this website is not yet supported. ")}function x_(e,t){e&1&&c(0," Setting array values via this website is not yet supported. ")}function b_(e,t){if(e&1&&(s(0,"div",4),c(1),T(2,"units"),l()),e&2){let i=h(3);d(),I(" ",P(2,1,i.parameter.type==null?null:i.parameter.type.unitSet)," ")}}function S_(e,t){if(e&1&&(s(0,"label")(1,"div",3),T(2,"async"),v(3,b_,3,3,"div",4),s(4,"div",4),c(5),l()(),c(6),w(7,"ya-errors",5,0)(9,"input",13),l()),e&2){let i=oe(8),n=h(),a=h();d(),de("error",P(2,7,i.invalid$)),d(2),b(a.parameter.type!=null&&a.parameter.type.unitSet?3:-1),d(2),Y(a.parameter.type==null?null:a.parameter.type.engType),d(),I(" ",a.parameter.name," "),d(),y("controlName",n),d(2),y("formControlName",n)}}function w_(e,t){if(e&1&&(G(0,1),v(1,a_,11,4,"label")(2,o_,9,4,"label")(3,r_,4,3,"label")(4,l_,9,8,"label")(5,c_,8,2,"label")(6,d_,11,10,"div",2)(7,u_,1,0)(8,h_,1,0)(9,f_,1,0)(10,__,1,0)(11,g_,1,0)(12,v_,1,0)(13,y_,1,0)(14,C_,1,0)(15,x_,1,0)(16,S_,10,9,"label"),W()),e&2){let i,n=h();y("formGroup",n.formGroup),d(),b((i=n.parameter.type==null?null:n.parameter.type.engType)==="enumeration"?1:i==="boolean"?2:i==="time"?3:i==="binary"?4:i==="aggregate"?5:i==="integer"?6:i==="float[]"?7:i==="double[]"?8:i==="integer[]"?9:i==="enumeration[]"?10:i==="string[]"?11:i==="boolean[]"?12:i==="time[]"?13:i==="binary[]"?14:i==="aggregate[]"?15:16)}}var zl=(()=>{let t=class t{constructor(){this.controlName$=new B(null)}ngOnInit(){this.parent?this.controlName$.next(this.parent+"."+this.parameter.name):this.controlName$.next(this.parameter.name)}};t.\u0275fac=function(a){return new(a||t)},t.\u0275cmp=F({type:t,selectors:[["app-parameter-form"]],inputs:{formGroup:"formGroup",parameter:"parameter",parent:"parent"},standalone:!0,features:[N],decls:2,vars:3,consts:[["err",""],[3,"formGroup"],[1,"label"],[1,"meta"],[1,"item"],[3,"controlName"],[3,"formControlName"],["hidden","","disabled","","selected","","value",""],[3,"value"],["type","radio","value","true",3,"formControlName"],["type","radio","value","false",3,"formControlName"],[1,"members"],[3,"parameter","formGroup","parent"],["type","text",3,"formControlName"]],template:function(a,o){if(a&1&&(v(0,w_,17,2,"ng-container",1),T(1,"async")),a&2){let r;b((r=P(1,1,o.controlName$))?0:-1,r)}},dependencies:[t,U,ee,Vi,Ni,Xe,Fi,Xo,he,Ce,xe,De,er,gt,ir,Kt],styles:[".meta[_ngcontent-%COMP%]{position:absolute;top:0;right:0;display:flex}.meta[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]{flex:none;background-color:#eee;font-weight:400;font-family:Roboto Mono,monospace;color:#000000a7;padding-left:2px;padding-right:2px;margin-left:10px}.meta.error[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]{background-color:#dc143c;color:#fff}.members[_ngcontent-%COMP%]{margin-top:5px;padding-top:5px;padding-left:10px}"],changeDetection:0});let e=t;return e})();var ql=(()=>{let t=class t{constructor(n,a){this.dialogRef=n,this.data=a,this.form=new at({}),this.parameter=a.parameter;let o=this.getValidatorsForType(this.parameter.type);this.parameter.type.engType==="aggregate"?this.addMemberControls(this.parameter.name+".",this.parameter.type.member||[]):this.form.addControl(this.parameter.name,new te(null,o))}addMemberControls(n,a){for(let o of a)if(o.type.engType==="aggregate")this.addMemberControls(n+o.name+".",o.type.member||[]);else{let r=n+o.name,p=this.getValidatorsForType(o.type);this.form.addControl(r,new te("",p))}}getValidatorsForType(n){let a=[Ee.required];return n.engType==="integer"?(a.push(Jn.requireInteger),n.signed===!1&&a.push(Jn.requireUnsigned)):n.engType==="float"&&a.push(Jn.requireFloat),a}setValue(){let n=this.toValue("",this.parameter);this.dialogRef.close(n)}toValue(n,a){let o=this.form.value[n+a.name];switch(a.type.engType){case"boolean":return{type:"BOOLEAN",booleanValue:o==="true"};case"float":return{type:"FLOAT",floatValue:o};case"double":return{type:"DOUBLE",doubleValue:o};case"enumeration":return{type:"STRING",stringValue:o};case"integer":return{type:"SINT32",sint32Value:o};case"string":return{type:"STRING",stringValue:o};case"time":return{type:"TIMESTAMP",stringValue:$.toISOString(o)};case"binary":return{type:"BINARY",binaryValue:$.convertHexToBase64(o)};case"aggregate":let r=[],p=[];for(let m of a.type.member||[])r.push(m.name),p.push(this.toValue(n+a.name+".",m));return{type:"AGGREGATE",aggregateValue:{name:r,value:p}};default:throw new Error(`Unexpected type: ${a.type.engType}`)}}};t.\u0275fac=function(a){return new(a||t)(D(Fe),D(Ze))},t.\u0275cmp=F({type:t,selectors:[["app-set-parameter-dialog"]],standalone:!0,features:[N],decls:10,vars:4,consts:[["mat-dialog-title",""],[1,"ya-form",3,"formGroup"],[3,"parameter","formGroup"],["align","end"],["mat-dialog-close","",1,"ya-button"],[1,"ya-button","primary",3,"click","disabled"]],template:function(a,o){a&1&&(s(0,"h2",0),c(1,"Set parameter value"),l(),s(2,"mat-dialog-content")(3,"form",1),w(4,"app-parameter-form",2),l()(),s(5,"mat-dialog-actions",3)(6,"button",4),c(7,"CANCEL"),l(),s(8,"button",5),k("click",function(){return o.setValue()}),c(9,"SET"),l()()),a&2&&(d(3),y("formGroup",o.form),d(),y("parameter",o.parameter)("formGroup",o.form),d(4),y("disabled",!o.form.valid))},dependencies:[zl,U,Te,Ce,xe,Ne,ut,He,$e],encapsulation:2});let e=t;return e})();var Mn=e=>({c:e}),T_=(e,t)=>({c:e,system:t}),D_=e=>["/mdb/parameters",e];function P_(e,t){if(e&1&&(s(0,"a",15),c(1),l()),e&2){let i=h().$implicit,n=h(2);y("queryParams",_i(2,T_,n.yamcs.context,i.path)),d(),Y(i.name)}}function E_(e,t){if(e&1&&(v(0,P_,2,5,"a",15),c(1," / ")),e&2){let i=t.$index;b(i!==0?0:-1)}}function k_(e,t){if(e&1){let i=V();s(0,"button",16),k("click",function(){A(i);let a=h(2);return M(a.setParameter())}),s(1,"mat-icon"),c(2,"edit"),l(),c(3," Set value "),l()}}function A_(e,t){if(e&1&&(s(0,"a",8)(1,"mat-icon"),c(2,"auto_stories"),l(),c(3," View in MDB "),l()),e&2){let i=h(),n=h();y("routerLink",Z(2,D_,i.qualifiedName))("queryParams",Z(4,Mn,n.yamcs.context))}}function M_(e,t){if(e&1&&(s(0,"a",11,3),c(2," Chart "),l()),e&2){let i=oe(1),n=h(2);y("active",i.isActive)("queryParams",Z(2,Mn,n.yamcs.context))}}function R_(e,t){if(e&1&&(s(0,"a",12,4),c(2," Alarm History "),l()),e&2){let i=oe(1),n=h(2);y("active",i.isActive)("queryParams",Z(2,Mn,n.yamcs.context))}}function L_(e,t){if(e&1&&(s(0,"a",13,5),c(2," Historical Data "),l()),e&2){let i=oe(1),n=h(2);y("active",i.isActive)("queryParams",Z(2,Mn,n.yamcs.context))}}function I_(e,t){if(e&1&&(s(0,"app-instance-page")(1,"app-instance-toolbar"),ne(2,E_,2,1,null,null,ie),T(4,"parents"),s(5,"span"),c(6),T(7,"shortName"),T(8,"async"),l(),w(9,"ya-title-copy",6),T(10,"async"),c(11," \xA0\xA0\xA0 "),v(12,k_,4,0,"button",7),T(13,"async"),v(14,A_,4,6,"a",8),l(),s(15,"nav",9,0)(17,"a",10,1),c(19," Summary "),l(),v(20,M_,3,4,"a",11)(21,R_,3,4,"a",12)(22,L_,3,4,"a",13),l(),s(23,"div",14)(24,"mat-tab-nav-panel",null,2),w(26,"router-outlet"),l()()()),e&2){let i=t,n=oe(16),a=oe(18),o=oe(25),r=h();d(2),ae(P(4,14,i.qualifiedName)),d(4),Ht("",P(7,16,i.qualifiedName),"",P(8,18,r.offset$),""),d(3),y("text",i.qualifiedName+(P(10,20,r.offset$)||"")),d(3),b(r.isWritable()&&r.maySetParameter()&&!P(13,22,r.offset$)?12:-1),d(2),b(r.mayReadMissionDatabase()?14:-1),d(),y("mat-stretch-tabs",!1)("tabPanel",o),d(2),y("active",a.isActive)("queryParams",Z(24,Mn,r.yamcs.context)),d(3),b(r.config.tmArchive?20:-1),d(),b(r.mayReadAlarms()?21:-1),d(),b(r.config.tmArchive?22:-1),d(),de("noscroll",n.selectedIndex===1)}}var Yl=(()=>{let t=class t{constructor(n,a,o,r,p,m,u){this.yamcs=n,this.authService=a,this.messageService=o,this.dialog=r,this.title=p,this.formatter=m,this.qualifiedName=Mt.required({alias:"parameter"}),this.parameter$=new B(null),this.offset$=new B(null),this.parameterValue$=new B(null),this.config=u.getConfig()}ngOnChanges(){let n=this.qualifiedName();this.yamcs.yamcsClient.getParameter(this.yamcs.instance,n).then(a=>{this.parameter$.next(a),n!==a.qualifiedName?this.offset$.next(n.substring(a.qualifiedName.length)):this.offset$.next(null),this.updateTitle()}).catch(a=>{this.messageService.showError(a)}),this.parameterValueSubscription&&this.parameterValueSubscription.cancel(),this.parameterValueSubscription=this.yamcs.yamcsClient.createParameterSubscription({instance:this.yamcs.instance,processor:this.yamcs.processor,id:[{name:n}],abortOnInvalid:!1,sendFromCache:!0,updateOnExpiration:!0,action:"REPLACE"},a=>{this.parameterValue$.next(a.values?a.values[0]:null),this.updateTitle()})}updateTitle(){let n=this.parameter$.getValue(),a=this.offset$.getValue();if(n){let o=n.name;a&&(o+=a);let r=this.parameterValue$.getValue();r?.engValue&&(o+=": "+this.formatter.formatValue(r.engValue),n.type&&n.type.unitSet&&(o+=" "+$.getUnits(n.type.unitSet)),r.rangeCondition&&r.rangeCondition==="LOW"?o+=" \u2193":r.rangeCondition&&r.rangeCondition==="HIGH"&&(o+=" \u2191")),this.title.setTitle(o)}}isWritable(){let n=this.parameter$.value;return n?n.dataSource==="LOCAL"||n.dataSource==="EXTERNAL1"||n.dataSource==="EXTERNAL2"||n.dataSource==="EXTERNAL3":!1}maySetParameter(){let n=this.parameter$.value;return n?this.authService.getUser().hasObjectPrivilege("WriteParameter",n.qualifiedName):!1}mayReadAlarms(){return this.authService.getUser().hasSystemPrivilege("ReadAlarms")}mayReadMissionDatabase(){return this.authService.getUser().hasSystemPrivilege("GetMissionDatabase")}setParameter(){let n=this.parameter$.value;this.dialog.open(ql,{width:"600px",data:{parameter:this.parameter$.value}}).afterClosed().subscribe(o=>{o&&this.yamcs.yamcsClient.setParameterValue(this.yamcs.instance,this.yamcs.processor,n.qualifiedName,o).catch(r=>this.messageService.showError(r))})}ngOnDestroy(){this.parameterValueSubscription?.cancel()}};t.\u0275fac=function(a){return new(a||t)(D(X),D(yt),D(Qe),D(Ve),D(nt),D(qi),D(Pe))},t.\u0275cmp=F({type:t,selectors:[["ng-component"]],inputs:{qualifiedName:[1,"parameter","qualifiedName"]},standalone:!0,features:[At,N],decls:2,vars:3,consts:[["tabs",""],["rla","routerLinkActive"],["tabPanel",""],["rlb","routerLinkActive"],["rlc","routerLinkActive"],["rld","routerLinkActive"],[3,"text"],["mat-button","","color","primary"],["mat-button","","color","primary",3,"routerLink","queryParams"],["mat-tab-nav-bar","",1,"secondary",3,"mat-stretch-tabs","tabPanel"],["mat-tab-link","","routerLink","-/summary","routerLinkActive","",3,"active","queryParams"],["mat-tab-link","","routerLink","-/chart","routerLinkActive","",3,"active","queryParams"],["mat-tab-link","","routerLink","-/alarms","routerLinkActive","",3,"active","queryParams"],["mat-tab-link","","routerLink","-/data","routerLinkActive","",3,"active","queryParams"],[1,"tab-content-wrapper"],["routerLink","/telemetry/parameters",1,"ya-link","ya-header-link",3,"queryParams"],["mat-button","","color","primary",3,"click"]],template:function(a,o){if(a&1&&(v(0,I_,27,26,"app-instance-page"),T(1,"async")),a&2){let r;b((r=P(1,1,o.parameter$))?0:-1,r)}},dependencies:[Je,Ke,U,ee,ai,Re,Gn,Bi,dt,fe,Zn,Kn,Qn,ar,dr,ra],styles:[".tab-content-wrapper[_ngcontent-%COMP%]{position:absolute;inset:37px 0 0;overflow:auto}.tab-content-wrapper.noscroll[_ngcontent-%COMP%]{overflow:hidden}"],changeDetection:0});let e=t;return e})();var O_=e=>{let t=e,i=e.findIndex(a=>a.path==="-");i!==-1&&(t=e.slice(0,i));let n="/"+t.map(a=>a.path).join("/");return{consumed:t,posParams:{packet:new Xa(n,{})}}},F_=e=>{let t=e,i=e.findIndex(a=>a.path==="-");i!==-1&&(t=e.slice(0,i));let n="/"+t.map(a=>a.path).join("/");return{consumed:t,posParams:{parameter:new Xa(n,{})}}},rS=[{path:"",canActivate:[Ka,Qa],canActivateChild:[Ja],runGuardsAndResolvers:"always",component:fr,children:[{path:"",pathMatch:"full",redirectTo:"home"},{path:"displays",pathMatch:"full",redirectTo:"displays/browse"},{path:"displays/browse",component:zr,children:[{path:"**",component:Gr}]},{path:"displays/files",component:Wr,providers:[io],children:[{path:"**",component:Nr,canDeactivate:[Tr],data:{showRangeSelector:!0}}]},{path:"packets",children:[{path:"",pathMatch:"full",component:Xr},{matcher:O_,children:[{path:"-/log/:gentime/:seqno",component:Zr}]}]},{path:"parameters",children:[{path:"",pathMatch:"full",component:nl,title:"Parameters"},{matcher:F_,component:Yl,children:[{path:"",pathMatch:"full",redirectTo:"-/summary"},{path:"-/summary",component:Wl},{path:"-/chart",component:Vl},{path:"-/data",component:Hl},{path:"-/alarms",component:sl}]}]},{path:"parameter-lists",pathMatch:"full",component:el},{path:"parameter-lists/create",pathMatch:"full",component:Qr},{path:"parameter-lists/:list",component:rl,children:[{path:"",pathMatch:"full",redirectTo:"realtime"},{path:"realtime",component:ol},{path:"data",component:Jr}]},{path:"parameter-lists/:list/edit",pathMatch:"full",component:Kr},{path:"ext",canActivate:[Ka,Qa],canActivateChild:[Ja],runGuardsAndResolvers:"always",children:[{path:":extension",component:hr}]}]}];export{rS as ROUTES};
