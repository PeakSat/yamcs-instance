import{a as rt,b as at,c as ge,f as st,g as lt,h as mt,i as ct,j as ye}from"./chunk-ISJZ4IJQ.js";import{b as Xe,c as Ze,d as et,e as tt,f as ot}from"./chunk-FTOGDGWN.js";import{$b as Ge,Aa as s,Ad as He,Ba as Me,Bb as N,Bd as X,Ca as fe,Da as Re,Db as R,Eb as L,F as B,Fd as We,Ga as M,Gb as Oe,Ib as ce,Jb as j,K as g,L as y,La as T,Ma as D,Mb as Fe,Na as Ae,Nb as q,Od as Ye,Q as Te,Qb as U,Re as Z,Ue as Ke,Ve as A,X as _,Xe as it,Y as v,Yb as pe,Yd as Qe,Ye as nt,_a as me,_b as Ne,a as Ce,aa as ee,ac as $e,ca as C,da as ke,e as F,ea as he,fc as ze,ga as te,ha as xe,hc as Le,ia as De,ib as Pe,ja as Be,ka as a,la as l,ma as S,mb as Ie,mc as je,ob as Ee,p as Se,qa as ie,qc as H,ra as h,rc as W,sa as z,sc as qe,tc as Y,te as Je,uc as Q,vc as J,wa as ae,wc as K,xa as se,xc as Ue,ya as le,yb as Ve,yd as w}from"./chunk-YLFXKKOP.js";var pt=(()=>{let o=class o{constructor(e,i,t,n){this.dialogRef=e,this.yamcs=i,this.downloadURL$=new F(null),this.form=t.group({start:[null,N.required],stop:[null,N.required]}),this.form.valueChanges.subscribe(x=>{if(this.form.valid){let G=i.yamcsClient.getPacketsDownloadURL(i.instance,{start:w.toISOString(x.start),stop:w.toISOString(x.stop),format:"raw"});this.downloadURL$.next(G)}else this.downloadURL$.next(null)});let r=n.start,d=n.stop;(!r||!d)&&(d=this.yamcs.getMissionTime(),r=w.subtractDuration(d,"PT1H")),this.form.setValue({start:w.toISOString(r),stop:w.toISOString(d)})}closeDialog(){this.dialogRef.close()}};o.\u0275fac=function(i){return new(i||o)(v(H),v(Z),v(pe),v(W))},o.\u0275cmp=B({type:o,selectors:[["app-download-dump-dialog"]],standalone:!0,features:[M],decls:16,vars:6,consts:[["mat-dialog-title",""],[1,"ya-form",3,"formGroup"],["formControlName","start"],["formControlName","stop"],["align","end"],["mat-dialog-close","",1,"ya-button"],[3,"click","link","disabled","primary"]],template:function(i,t){i&1&&(a(0,"h2",0),s(1,"Download Packet Dump"),l(),a(2,"mat-dialog-content")(3,"form",1)(4,"label"),s(5," Start "),S(6,"ya-date-time-input",2),l(),a(7,"label"),s(8," Stop "),S(9,"ya-date-time-input",3),l()()(),a(10,"mat-dialog-actions",4)(11,"button",5),s(12,"CANCEL"),l(),a(13,"ya-download-button",6),T(14,"async"),h("click",function(){return t.closeDialog()}),s(15," DOWNLOAD "),l()()),i&2&&(_(3),C("formGroup",t.form),_(10),C("link",D(14,4,t.downloadURL$))("disabled",!t.form.valid)("primary",!0))},dependencies:[A,me,j,R,L,q,U,Y,Q,K,J,X,We],encapsulation:2});let p=o;return p})();var dt=(()=>{let o=class o{constructor(e,i){this.dialogRef=e,this.data=i,this.date=new ce(null,[N.required]),this.data.date&&this.date.setValue(w.toISOString(this.data.date))}select(){let e=w.toDate(this.date.value);this.dialogRef.close({date:e})}};o.\u0275fac=function(i){return new(i||o)(v(H),v(W))},o.\u0275cmp=B({type:o,selectors:[["app-jump-to-dialog"]],standalone:!0,features:[M],decls:11,vars:1,consts:[["mat-dialog-title",""],[1,"ya-form"],[3,"formControl"],["align","end"],["mat-dialog-close","",1,"ya-button"],[1,"ya-button","primary",3,"click"]],template:function(i,t){i&1&&(a(0,"h2",0),s(1,"Jump to date"),l(),a(2,"mat-dialog-content",1)(3,"label"),s(4," Date "),S(5,"ya-date-time-input",2),l()(),a(6,"mat-dialog-actions",3)(7,"button",4),s(8,"CANCEL"),l(),a(9,"button",5),h("click",function(){return t.select()}),s(10,"OK"),l()()),i&2&&(_(5),C("formControl",t.date))},dependencies:[A,R,Fe,Y,Q,K,J,X],encapsulation:2});let p=o;return p})();var P=class extends lt{constructor(o,m,e,i,t){super(o),this.label=m,this.borderWidth=0,this.multiline=!1,this.itemBorderColor="rgba(0, 0, 0, 0.1)",this.itemBorderWidth=1,this.itemCornerRadius=0,this.itemTextOverflow="hide",this.itemHeight=20,this.backgroundRGB=e,this.itemBackground=this.backgroundRGB.toCssString(),this.foregroundRGB=i,this.itemTextColor=this.foregroundRGB.toCssString(),this.formatter=t,this.addItemClickListener(n=>{let{start:r,stop:d}=n.item;r&&d?this.timeline.setSelection(r,d):this.timeline.clearSelection()})}setupTooltip(o){this.addItemMouseMoveListener(m=>{let{start:e,stop:i,data:t}=m.item,n=t.name+`
`;if(n+=`Start: ${this.formatter.formatDateTime(e,!0)}
`,n+=`Stop : ${this.formatter.formatDateTime(i,!0)}
`,t.count>=0){let r=(i-e)/1e3;n+=`Count: ${t.count}`,t.count>1&&(n+=` (${(t.count/r).toFixed(3)} Hz)`)}else t.description&&(n+=t.description);o.show(n,m.clientX,m.clientY)}),this.addItemMouseLeaveListener(m=>{o.hide()})}loadData(o){let m=[];for(let e of o.records){let i=w.toDate(e.first).getTime(),t=w.toDate(e.last).getTime(),n={start:i,stop:t,data:{name:o.name,count:e.num}};if(e.num>1){let r=(t-i)/1e3,d=e.num/r;d>=.1?n.label=`${d.toFixed(1)} Hz`:n.label="< 0.1 Hz",d>=1?n.background=this.backgroundRGB.toCssString(1):d>=.3?n.background=this.backgroundRGB.toCssString(d):n.background=this.backgroundRGB.toCssString(.3)}m.push(n)}this.items=m}};var k=class{constructor(o,m,e){this.r=o,this.g=m,this.b=e}toCssString(o){return o===void 0?`rgb(${this.r},${this.g},${this.b})`:`rgba(${this.r},${this.g}, ${this.b}, ${o})`}};var ue=class extends rt{constructor(o){super(o);let m=document.createElement("canvas");m.width=30,m.height=30;let e=m.getContext("2d");e.fillStyle="rgba(148, 0, 211, 0.07)",e.fillRect(0,0,30,30),e.beginPath(),e.moveTo(30,0),e.lineTo(0,30),e.strokeStyle="rgba(221, 221, 221, 0.2)",e.stroke(),this.pattern=e.createPattern(m,"repeat")}drawOverlay(o){if(!this.replayRequest)return;let{start:m,stop:e,endAction:i}=this.replayRequest;if(m&&e){let t=Math.round(this.timeline.positionTime(new Date(m).getTime())),n=Math.round(this.timeline.positionTime(new Date(e).getTime()));if(o.fillRect({x:t+.5,y:0,width:n-t,height:o.ctx.canvas.height,fill:this.pattern}),o.strokePath({color:"rgba(148, 0, 211, 0.3)",lineWidth:1,path:new ge(t+.5,0).lineTo(t+.5,o.ctx.canvas.height)}),o.strokePath({color:"rgba(148, 0, 211, 0.3)",lineWidth:1,path:new ge(n+.5,0).lineTo(n+.5,o.ctx.canvas.height)}),i==="LOOP"){let{fontFamily:r,textSize:d}=this.timeline;o.fillText({x:n-3,y:0,align:"right",baseline:"top",text:"\u221E",color:"darkviolet",font:`${d}px ${r}`})}}}get replayRequest(){return this._replayRequest}set replayRequest(o){this._replayRequest=o,this.reportMutation()}};var I=class extends at{constructor(o,m){super(o),this.label=m,this.background="#f5f5f5",this.contentHeight=20}};var ut=(()=>{let o=class o{constructor(e,i,t,n){this.dialogRef=e,this.yamcs=t,this.data=n;let r=t.getMissionTime(),d;this.data&&(this.data.start&&(r=this.data.start),this.data.stop&&(d=this.data.stop)),this.form=i.group({start:[w.toISOString(r),[N.required]],stop:[d?w.toISOString(d):""]})}submit(){let e={start:w.toISOString(this.form.value.start)};this.form.value.stop&&(e.stop=w.toISOString(this.form.value.stop)),this.dialogRef.close(e)}};o.\u0275fac=function(i){return new(i||o)(v(H),v(pe),v(Z),v(W))},o.\u0275cmp=B({type:o,selectors:[["app-modify-replay-dialog"]],standalone:!0,features:[M],decls:20,vars:2,consts:[["mat-dialog-title",""],[1,"ya-form",3,"formGroup"],["formControlName","start"],[1,"hint"],["formControlName","stop"],["align","end"],["mat-dialog-close","",1,"ya-button"],[1,"ya-button","primary",3,"click","disabled"]],template:function(i,t){i&1&&(a(0,"h2",0),s(1,"Configure replay"),l(),a(2,"mat-dialog-content")(3,"form",1)(4,"label"),s(5," Start time"),S(6,"br")(7,"ya-date-time-input",2),l(),S(8,"br"),a(9,"label"),s(10," Stop time "),a(11,"span",3),s(12,"(optional)"),l(),S(13,"ya-date-time-input",4),l(),S(14,"br"),l()(),a(15,"mat-dialog-actions",5)(16,"button",6),s(17,"CANCEL"),l(),a(18,"button",7),h("click",function(){return t.submit()}),s(19,"SUBMIT"),l()()),i&2&&(_(3),C("formGroup",t.form),_(15),C("disabled",!t.form.valid))},dependencies:[A,j,R,L,q,U,Y,Q,K,J,X],encapsulation:2});let p=o;return p})();var Bt=["tt"],ht=(()=>{let o=class o{show(e,i,t){let n=this.tt.nativeElement;n.style.left=i+"px",n.style.top=t+"px",n.style.display="block",n.innerText=e}hide(){let e=this.tt.nativeElement;e.style.display="none"}};o.\u0275fac=function(i){return new(i||o)},o.\u0275cmp=B({type:o,selectors:[["ng-component"]],viewQuery:function(i,t){if(i&1&&ae(Bt,7),i&2){let n;se(n=le())&&(t.tt=n.first)}},standalone:!0,features:[M],decls:2,vars:0,consts:[["tt",""],[1,"ya-tooltip"]],template:function(i,t){i&1&&S(0,"div",1,0)},styles:[".ya-tooltip[_ngcontent-%COMP%]{position:absolute;display:none;white-space:pre;color:#fff;border-radius:2px;max-width:250px;padding:6px 8px;margin-top:14px;background:#616161e6;font-family:Roboto Mono,monospace;font-size:10px}"]});let p=o;return p})();var Mt=["container"];function Rt(p,o){if(p&1){let m=ie();a(0,"button",2),h("click",function(){let i=g(m),t=z(),n=z();return y(n.enableLoop(t,i.endAction!=="LOOP"))}),a(1,"mat-icon"),s(2),l(),s(3),l()}if(p&2){let m=o;C("disabled",!m.start||!m.stop),_(2),Me(m.endAction==="LOOP"?"repeat_on":"repeat"),_(),fe(" Repeat: ",m.endAction==="LOOP"?"on":"off"," ")}}function At(p,o){if(p&1&&ee(0,Rt,4,3,"button",19),p&2){let m;te((m=o.replayRequest)?0:-1,m)}}function Pt(p,o){if(p&1){let m=ie();a(0,"button",20),T(1,"async"),h("click",function(){g(m);let i=z();return y(i.fitSelection())}),a(2,"mat-icon"),s(3,"fit_screen"),l(),s(4," Fit selection "),l()}if(p&2){let m=z();C("disabled",!D(1,1,m.rangeSelection$))}}function It(p,o){if(p&1){let m=ie();a(0,"label",21)(1,"input",22),h("change",function(){g(m);let i=z();return y(i.updateLegend())}),l(),s(2),l()}if(p&2){let m=o.$implicit;ke("background",m.bg)("color",m.fg),_(),C("formControlName",m.id),_(),fe(" ",m.name," ")}}function Et(p,o){if(p&1&&(a(0,"span"),s(1),T(2,"datetime"),T(3,"datetime"),l()),p&2){let m=o;_(),Re(" ",Ae(2,2,m==null?null:m.start,!1)," \u2013 ",D(3,5,m==null?null:m.stop)," ")}}var ft=new k(255,204,0),gt=new k(28,75,139),yt=new k(255,165,0),vt=new k(173,94,0),wt=new k(255,255,102),_t=new k(28,75,139),bt=new k(238,232,170),Ct=new k(85,85,85),St=new k(255,222,173),Tt=new k(28,75,139);function ne(p){return"linear-gradient(to right, "+p.toCssString(.3)+" 30%, "+p.toCssString()+")"}var kt=(()=>{let o=class o{constructor(e,i,t,n,r,d,x,G,oe,b){this.yamcs=i,this.route=t,this.router=n,this.overlay=r,this.dialog=d,this.snackBar=x,this.messageService=G,this.synchronizer=oe,this.formatter=b,this.legendOptions=[{id:"packets",name:"Packets",bg:ne(bt),fg:Ct.toCssString(),checked:!0},{id:"parameters",name:"Parameter Groups",bg:ne(St),fg:Tt.toCssString(),checked:!0},{id:"commands",name:"Commands",bg:ne(ft),fg:gt.toCssString(),checked:!1},{id:"events",name:"Events",bg:ne(wt),fg:_t.toCssString(),checked:!1}],this.processor$=new F(null),this.rangeSelection$=new F(null),this.viewportRange$=new F(null),this.tool$=new F("hand"),this.packetNames=[],this.subscriptions=[],e.setTitle("Archive browser"),(i.connectionInfo$.value?.instance?.capabilities||[]).indexOf("ccsds-completeness")!==-1&&(this.legendOptions=[{id:"completeness",name:"Completeness",bg:ne(yt),fg:vt.toCssString(),checked:!0},...this.legendOptions]),this.processor$.next(i.getProcessor()),i.processor&&(this.processorSubscription=this.yamcs.yamcsClient.createProcessorSubscription({instance:i.instance,processor:i.processor},u=>{this.processor$.next(u)})),this.filterForm=new Oe({});let re=this.route.snapshot.queryParamMap;for(let u of this.legendOptions){let f=u.checked;re.has(u.id)&&(f=re.get(u.id)==="true"),this.filterForm.addControl(u.id,new ce(f))}let E=new Te(document.body),V=this.overlay.position().flexibleConnectedTo(E).withPositions([{originX:"start",originY:"top",overlayX:"start",overlayY:"top"}]).withPush(!1),O=this.overlay.create({positionStrategy:V}),c=new Ge(ht);this.tooltipInstance=O.attach(c).instance}hideTooltip(){this.tooltipInstance.hide()}ngAfterViewInit(){this.yamcs.yamcsClient.getPacketNames(this.yamcs.instance).then(e=>{this.packetNames=e.packets||[],this.initializeTimeline()})}initializeTimeline(){this.timeline=new st(this.container.nativeElement),this.timeline.addViewportChangeListener(r=>{this.viewportRange$.next({start:new Date(r.start),stop:new Date(r.stop)})}),this.viewportRange$.pipe(Se(400)).forEach(r=>{this.refreshData();let d={};for(let x of this.legendOptions)d[x.id]=this.filterForm.value[x.id];this.router.navigate([],{replaceUrl:!0,relativeTo:this.route,queryParamsHandling:"merge",queryParams:Ce({start:new Date(r.start).toISOString(),stop:new Date(r.stop).toISOString()},d)})}),this.timeline.addViewportDoubleClickListener(r=>{this.yamcs.getProcessor()?.replay&&this.yamcs.yamcsClient.editReplayProcessor(this.yamcs.instance,this.yamcs.processor,{seek:new Date(r.time).toISOString()}).catch(x=>this.messageService.showError(x))});let e=this.route.snapshot.queryParamMap;if(e.get("start")&&e.get("stop")){let r=w.toDate(e.get("start")),d=w.toDate(e.get("stop"));this.timeline.setViewRange(r.getTime(),d.getTime())}else{let r=this.yamcs.getMissionTime();r.setUTCHours(0,0,0,0);let d=new Date(r.getTime());d.setUTCDate(r.getUTCDate()+1),this.timeline.setViewRange(r.getTime(),d.getTime())}let i=new mt(this.timeline);i.time=this.yamcs.getMissionTime().getTime();let t=new ue(this.timeline);this.subscriptions.push(this.synchronizer.sync(()=>{i.time=this.yamcs.getMissionTime().getTime();let r=this.processor$.value?.replayRequest;t.replayRequest=r})),new ct(this.timeline);let n=new ye(this.timeline);n.contentHeight=20,n.label="UTC",n.timezone="UTC",n.frozen=!0,n.fullHeight=!0,this.timeline.addViewportSelectionListener(r=>{r.selection?this.rangeSelection$.next({start:new Date(r.selection.start),stop:new Date(r.selection.stop)}):this.rangeSelection$.next(null)})}fitAll(){let e=[];e.push(this.yamcs.yamcsClient.getPackets(this.yamcs.instance,{limit:1,order:"asc"})),e.push(this.yamcs.yamcsClient.getPackets(this.yamcs.instance,{limit:1,order:"desc"})),Promise.all(e).then(i=>{let t=i[0],n=i[1];if(t.packet?.length&&n.packet?.length){let r=w.toDate(t.packet[0].generationTime),d=w.toDate(n.packet[0].generationTime);this.timeline.setViewRange(r.getTime(),d.getTime())}}).catch(i=>this.messageService.showError(i))}fitSelection(){var e=this.rangeSelection$.value;e&&(this.timeline.setViewRange(e.start.getTime(),e.stop.getTime()),this.timeline.clearSelection())}jumpToToday(){let e=this.yamcs.getMissionTime();e.setUTCHours(0,0,0,0);let i=e.getTime();e.setUTCDate(e.getUTCDate()+1);let t=e.getTime();this.timeline.setViewRange(i,t)}jumpToNow(){let e=this.yamcs.getMissionTime();this.timeline.panTo(e.getTime())}openJumpToDialog(){let e=this.timeline.center;this.dialog.open(dt,{width:"400px",data:{date:new Date(e)}}).afterClosed().subscribe(t=>{t&&this.timeline.panTo(t.date.getTime())})}toggleMove(e){this.timeline.panBy(e),window.clearInterval(this.moveInterval),this.moveInterval=window.setInterval(()=>this.timeline.panBy(e),50)}untoggleMove(){window.clearInterval(this.moveInterval),this.moveInterval=void 0}pageLeft(){let{start:e,stop:i}=this.timeline,t=this.timeline.distanceBetween(e,i);this.timeline.panBy(-t)}pageRight(){let{start:e,stop:i}=this.timeline,t=this.timeline.distanceBetween(e,i);this.timeline.panBy(t)}zoomIn(){this.timeline.zoomIn()}zoomOut(){this.timeline.zoomOut()}setTool(e){this.tool$.next(e),this.timeline.tool=e}replayRange(){let e=this.rangeSelection$.value;if(e){let i=this.processor$.value;i?.replay?this.modifyReplay(i,e):this.startReplay(e)}}startReplay(e){this.dialog.open(Ze,{width:"400px",data:{start:e.start,stop:e.stop}}).afterClosed().subscribe(i=>{i&&(this.snackBar.open("Initializing replay...",void 0,{horizontalPosition:"end"}),this.yamcs.yamcsClient.createProcessor(i).then(()=>{this.yamcs.switchContext(this.yamcs.instance,i.name),this.snackBar.open("Joining replay",void 0,{duration:3e3,horizontalPosition:"end"})}).catch(t=>{this.snackBar.open("Failed to initialize replay",void 0,{duration:3e3,horizontalPosition:"end"})}))})}modifyReplay(e,i){this.dialog.open(ut,{width:"400px",data:{start:i.start,stop:i.stop}}).afterClosed().subscribe(t=>{t&&(this.snackBar.open("Updating replay...",void 0,{horizontalPosition:"end"}),this.yamcs.yamcsClient.editReplayProcessor(e.instance,e.name,t).catch(n=>{this.messageService.showError(n)}).finally(()=>this.snackBar.dismiss()))})}enableLoop(e,i){this.yamcs.yamcsClient.editReplayProcessor(e.instance,e.name,{loop:i}).catch(t=>this.messageService.showError(t))}downloadDump(){let e=this.rangeSelection$.value;e&&this.dialog.open(pt,{width:"400px",data:{start:e.start,stop:e.stop}})}updateLegend(){this.refreshData()}refreshData(){let e=this.timeline.stop-this.timeline.start,i=w.clampDate(this.timeline.start-e).toISOString(),t=w.clampDate(this.timeline.stop+e).toISOString(),n=Math.min(Math.floor(e/1e3),2147483647),r=Promise.resolve([]);this.filterForm.value.completeness&&(r=this.yamcs.yamcsClient.streamCompletenessIndex(this.yamcs.instance,{start:i,stop:t,mergeTime:n}).then(b=>this.groupRecordsByName(b)));let d=Promise.resolve([]);this.filterForm.value.packets&&(d=this.yamcs.yamcsClient.streamPacketIndex(this.yamcs.instance,{start:i,stop:t,mergeTime:n}).then(b=>this.groupRecordsByName(b)));let x=Promise.resolve([]);this.filterForm.value.parameters&&(x=this.yamcs.yamcsClient.streamParameterIndex(this.yamcs.instance,{start:i,stop:t,mergeTime:n}).then(b=>this.groupRecordsByName(b)));let G=Promise.resolve([]);this.filterForm.value.commands&&(G=this.yamcs.yamcsClient.streamCommandIndex(this.yamcs.instance,{start:i,stop:t,mergeTime:n}).then(b=>this.groupRecordsByName(b)));let oe=Promise.resolve([]);this.filterForm.value.events&&(oe=this.yamcs.yamcsClient.streamEventIndex(this.yamcs.instance,{start:i,stop:t,mergeTime:n}).then(b=>this.groupRecordsByName(b))),Promise.all([r,d,x,G,oe]).then(b=>{let $=b[0],re=b[1],E=b[2],V=b[3],O=b[4];for(let c of this.timeline.getBands())c instanceof ye||this.timeline.removeChild(c);$.sort((c,u)=>c.name.localeCompare(u.name));for(let c=0;c<$.length;c++){c===0&&new I(this.timeline,"Completeness");let u=$[c],f=new P(this.timeline,u.name,yt,vt,this.formatter);f.borderWidth=c===$.length-1?1:0,f.marginBottom=c===$.length-1?20:0,f.setupTooltip(this.tooltipInstance),f.loadData(u)}if(this.filterForm.value.packets)for(let c=0;c<this.packetNames.length;c++){c===0&&new I(this.timeline,"Packets");let u=this.packetNames[c],f=new P(this.timeline,u,bt,Ct,this.formatter);f.borderWidth=c===this.packetNames.length-1?1:0,f.marginBottom=c===this.packetNames.length-1?20:0,f.setupTooltip(this.tooltipInstance);let be=re.find(xt=>xt.name===u);be&&f.loadData(be)}E.sort((c,u)=>c.name.localeCompare(u.name));for(let c=0;c<E.length;c++){c===0&&new I(this.timeline,"Parameter Groups");let u=E[c],f=new P(this.timeline,u.name,St,Tt,this.formatter);f.borderWidth=c===E.length-1?1:0,f.marginBottom=c===E.length-1?20:0,f.setupTooltip(this.tooltipInstance),f.loadData(u)}V.sort((c,u)=>c.name.localeCompare(u.name));for(let c=0;c<V.length;c++){c===0&&new I(this.timeline,"Commands");let u=V[c],f=new P(this.timeline,u.name,ft,gt,this.formatter);f.borderWidth=c===V.length-1?1:0,f.marginBottom=c===V.length-1?30:0,f.setupTooltip(this.tooltipInstance),f.loadData(u)}O.sort((c,u)=>c.name.localeCompare(u.name));for(let c=0;c<O.length;c++){c===0&&new I(this.timeline,"Events");let u=O[c],f=new P(this.timeline,u.name,wt,_t,this.formatter);f.borderWidth=c===O.length-1?1:0,f.marginBottom=c===O.length-1?20:0,f.setupTooltip(this.tooltipInstance),f.loadData(u)}})}groupRecordsByName(e){let i=new Map;for(let t of e){let n=i.get(t.id.name);n||(n={name:t.id.name,records:[]},i.set(t.id.name,n)),n.records.push(t)}return[...i.values()]}ngOnDestroy(){this.processorSubscription?.cancel(),this.subscriptions.forEach(e=>e.unsubscribe()),this.timeline.disconnect()}};o.\u0275fac=function(i){return new(i||o)(v(Pe),v(Z),v(Ie),v(Ee),v($e),v(qe),v(Ue),v(Qe),v(Ke),v(He))},o.\u0275cmp=B({type:o,selectors:[["ng-component"]],viewQuery:function(i,t){if(i&1&&ae(Mt,7),i&2){let n;se(n=le())&&(t.container=n.first)}},hostBindings:function(i,t){i&1&&h("mouseleave",function(){return t.hideTooltip()})},standalone:!0,features:[M],decls:88,vars:24,consts:[["container",""],["noscroll","true"],["mat-button","","color","primary",3,"click","disabled"],["mat-icon-button","","color","primary","matTooltip","Refresh view",3,"click"],[2,"height","24px","margin","6px"],[3,"formGroup"],[1,"ya-button",3,"click"],[1,"ya-button",3,"mousedown","mouseup","mouseleave"],["matTooltip","Show all archive data",1,"ya-button",3,"click"],["matTooltip","Zoom to selected range",1,"ya-button",3,"disabled"],["matTooltip","Use pan tool",1,"ya-button",3,"click"],["matTooltip","Use range selection tool",1,"ya-button",3,"click"],[1,"legend","no-select",3,"background","color"],[1,"timeline-container"],[1,"zoom-actions"],[1,"zoom-actions-inner","elevation-z1"],["mat-button","",3,"click"],[1,"separator"],[1,"info"],["mat-button","","color","primary",3,"disabled"],["matTooltip","Zoom to selected range",1,"ya-button",3,"click","disabled"],[1,"legend","no-select"],["type","checkbox",3,"change","formControlName"]],template:function(i,t){if(i&1){let n=ie();a(0,"app-instance-page",1)(1,"app-instance-toolbar"),s(2," Archive browser \xA0\xA0\xA0 "),a(3,"button",2),T(4,"async"),h("click",function(){return g(n),y(t.replayRange())}),a(5,"mat-icon"),s(6,"video_settings"),l(),s(7," Replay range "),l(),ee(8,At,1,1),T(9,"async"),a(10,"button",2),T(11,"async"),h("click",function(){return g(n),y(t.downloadDump())}),a(12,"mat-icon"),s(13,"file_download"),l(),s(14," Download dump "),l(),a(15,"button",3),h("click",function(){return g(n),y(t.refreshData())}),a(16,"mat-icon"),s(17,"refresh"),l()()(),a(18,"div",4)(19,"form",5)(20,"button",6),h("click",function(){return g(n),y(t.pageLeft())}),a(21,"mat-icon"),s(22,"west"),l()(),a(23,"button",7),h("mousedown",function(){return g(n),y(t.toggleMove(-50))})("mouseup",function(){return g(n),y(t.untoggleMove())})("mouseleave",function(){return g(n),y(t.untoggleMove())}),a(24,"mat-icon"),s(25,"chevron_left"),l()(),a(26,"button",7),h("mousedown",function(){return g(n),y(t.toggleMove(50))})("mouseup",function(){return g(n),y(t.untoggleMove())})("mouseleave",function(){return g(n),y(t.untoggleMove())}),a(27,"mat-icon"),s(28,"chevron_right"),l()(),a(29,"button",6),h("click",function(){return g(n),y(t.pageRight())}),a(30,"mat-icon"),s(31,"east"),l()(),s(32," \xA0 "),a(33,"button",8),h("click",function(){return g(n),y(t.fitAll())}),a(34,"mat-icon"),s(35,"fit_screen"),l(),s(36," Fit all "),l(),ee(37,Pt,5,3,"button",9),T(38,"async"),a(39,"button",6),h("click",function(){return g(n),y(t.jumpToToday())}),a(40,"mat-icon"),s(41,"today"),l(),s(42," Today "),l(),a(43,"button",6),h("click",function(){return g(n),y(t.jumpToNow())}),a(44,"mat-icon"),s(45,"my_location"),l()(),a(46,"button",6),h("click",function(){return g(n),y(t.openJumpToDialog())}),a(47,"mat-icon"),s(48,"directions"),l(),s(49," Jump to... "),l(),s(50," \xA0 "),a(51,"button",6),h("click",function(){return g(n),y(t.zoomIn())}),a(52,"mat-icon"),s(53,"add"),l()(),a(54,"button",6),h("click",function(){return g(n),y(t.zoomOut())}),a(55,"mat-icon"),s(56,"remove"),l()(),s(57," \xA0 "),a(58,"button",10),T(59,"async"),h("click",function(){return g(n),y(t.setTool("hand"))}),a(60,"mat-icon"),s(61,"pan_tool"),l()(),a(62,"button",11),T(63,"async"),h("click",function(){return g(n),y(t.setTool("range-select"))}),a(64,"mat-icon"),s(65,"highlight_alt"),l()(),s(66," \xA0\xA0\xA0\xA0 "),De(67,It,3,6,"label",12,xe),l()(),S(69,"div",13,0),a(71,"div",14)(72,"div",15)(73,"button",16),h("click",function(){return g(n),y(t.zoomIn())}),a(74,"mat-icon"),s(75,"add"),l()(),S(76,"span",17),a(77,"button",16),h("click",function(){return g(n),y(t.zoomOut())}),a(78,"mat-icon"),s(79,"remove"),l()()()(),a(80,"div",18),ee(81,Et,4,7,"span"),T(82,"async"),a(83,"ya-help")(84,"p"),s(85," This view allows inspecting the content of the TM Archive, as well as retrieving data as packets. Data is grouped by packet name in bands. For each band, index blocks indicate the presence of data at a particular time range. Note that a single index block does not necessarily mean that there was no gap in the data. When zooming in, more gaps may appear. "),l(),a(86,"p"),s(87,"Pan around by grabbing the canvas."),l()()()()}if(i&2){let n,r;_(3),C("disabled",!D(4,10,t.rangeSelection$)),_(5),te((n=D(9,12,t.processor$))?8:-1,n),_(2),C("disabled",!D(11,14,t.rangeSelection$)),_(9),C("formGroup",t.filterForm),_(18),te(D(38,16,t.tool$)==="range-select"?37:-1),_(21),he("active",D(59,18,t.tool$)==="hand"),_(4),he("active",D(63,20,t.tool$)==="range-select"),_(5),Be(t.legendOptions),_(14),te((r=D(82,22,t.viewportRange$))?81:-1,r)}},dependencies:[et,Xe,A,me,j,Ve,R,L,q,U,ze,Le,Ne,je,Ye,Je],styles:[".tooltip[_ngcontent-%COMP%]{position:absolute}.ya-button.active[_ngcontent-%COMP%]{color:#009e87}.timeline-container[_ngcontent-%COMP%]{line-height:0;border-top:1px solid rgba(0,0,0,.1);position:absolute;inset:36px 0 0}.zoom-actions[_ngcontent-%COMP%]{position:absolute;bottom:35px;left:201px;right:0;margin:0 auto;text-align:center}.zoom-actions-inner[_ngcontent-%COMP%]{display:inline-block;background-color:#fafafa}.zoom-actions[_ngcontent-%COMP%]   .mat-button[_ngcontent-%COMP%]{line-height:inherit;min-width:0}.zoom-actions[_ngcontent-%COMP%]   .mat-mdc-button[_ngcontent-%COMP%]:not(:disabled){color:#000}.info[_ngcontent-%COMP%]{position:absolute;bottom:35px;right:0;padding:0 16px;opacity:.75;font-size:small}label.legend[_ngcontent-%COMP%]{font-size:small;padding:3px 5px;margin-right:10px;border:1px solid rgba(0,0,0,.1)}"],changeDetection:0});let p=o;return p})();var Ni=[{path:"",canActivate:[it,tt],canActivateChild:[nt],runGuardsAndResolvers:"always",component:ot,children:[{path:"",pathMatch:"full",component:kt}]}];export{Ni as ROUTES};
